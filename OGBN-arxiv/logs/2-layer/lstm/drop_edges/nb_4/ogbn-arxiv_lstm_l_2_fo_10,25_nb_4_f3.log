[04:21:53] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 4 parts and get 2021168 edge cuts
main start at this time 1651551693.4547734
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029116392135620117
global_2_local spend time (sec) 0.0355682373046875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004881143569946289
A = g.adjacency_matrix() spent  0.02225518226623535
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08767032623291016
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.287090539932251
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1865477561950684

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.208 seconds
Metis partitioning: 4.814 seconds
Split the graph: 3.060 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.171586751937866
23257
23198
22251
22235
total k batches seeds list generation spend  19.065719604492188
after graph partition
graph partition algorithm spend time 19.19539499282837
23257
23198
22251
22235
partition_len_list
[36233, 38757, 69101, 53941]
shared_neighbor_graph_partition_s0 selection method  spend 19.278396129608154
time for parepare:  0.01637887954711914
local_output_nid generation:  0.0028638839721679688
local_in_edges_tensor generation:  0.0036919116973876953
mini_batch_src_global generation:  0.006746768951416016
r_  generation:  0.06367611885070801
local_output_nid generation:  0.0036962032318115234
local_in_edges_tensor generation:  0.0039217472076416016
mini_batch_src_global generation:  0.005933284759521484
r_  generation:  0.05361795425415039
local_output_nid generation:  0.003537893295288086
local_in_edges_tensor generation:  0.004745960235595703
mini_batch_src_global generation:  0.008717536926269531
r_  generation:  0.08542728424072266
local_output_nid generation:  0.0039484500885009766
local_in_edges_tensor generation:  0.0037813186645507812
mini_batch_src_global generation:  0.006836891174316406
r_  generation:  0.05902242660522461
----------------------check_connections_block total spend ----------------------------- 0.40263915061950684
generate_one_block  0.08469510078430176
generate_one_block  0.06600236892700195
generate_one_block  0.11981010437011719
generate_one_block  0.07193207740783691
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023781538009643555
gen group dst list time:  0.005897998809814453
time for parepare:  0.021358489990234375
local_output_nid generation:  0.0051882266998291016
local_in_edges_tensor generation:  0.010448694229125977
mini_batch_src_global generation:  0.007242679595947266
r_  generation:  0.07996392250061035
local_output_nid generation:  0.007835626602172852
local_in_edges_tensor generation:  0.007141590118408203
mini_batch_src_global generation:  0.007944583892822266
r_  generation:  0.07874178886413574
local_output_nid generation:  0.011760711669921875
local_in_edges_tensor generation:  0.0146331787109375
mini_batch_src_global generation:  0.017465829849243164
r_  generation:  0.18915414810180664
local_output_nid generation:  0.011541604995727539
local_in_edges_tensor generation:  0.010411739349365234
mini_batch_src_global generation:  0.014244318008422852
r_  generation:  0.13771533966064453
----------------------check_connections_block total spend ----------------------------- 0.7436912059783936
generate_one_block  0.10367560386657715
generate_one_block  0.09780740737915039
generate_one_block  0.25980305671691895
generate_one_block  0.18866991996765137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7436912059783936
block generation total time  0.6499559879302979
average batch blocks generation time:  0.16248899698257446
pseudo mini batch 0 input nodes size: 52038
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.028168201446533203  GigaBytes
Max Memory Allocated: 0.028168201446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02834177017211914  GigaBytes
Max Memory Allocated: 0.02834177017211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02834177017211914  GigaBytes
Max Memory Allocated: 0.02834177017211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146219253540039  GigaBytes
Max Memory Allocated: 0.03146219253540039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146219253540039  GigaBytes
Max Memory Allocated: 0.03146219253540039  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146219253540039  GigaBytes
Max Memory Allocated: 0.03146219253540039  GigaBytes

torch.Size([52038, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146219253540039  GigaBytes
Max Memory Allocated: 0.03146219253540039  GigaBytes

m.shape torch.Size([3697, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1436772346496582  GigaBytes
Max Memory Allocated: 0.1451411247253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1436772346496582  GigaBytes
Max Memory Allocated: 0.1451411247253418  GigaBytes

 h.shape torch.Size([1, 3697, 128]), torch.Size([1, 3697, 128])
----------------------------------------3
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1472029685974121  GigaBytes
Max Memory Allocated: 0.1472029685974121  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17554855346679688  GigaBytes
Max Memory Allocated: 0.17731142044067383  GigaBytes

rst.shape  torch.Size([1, 3697, 128])
m.shape torch.Size([3812, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17745113372802734  GigaBytes
Max Memory Allocated: 0.1775369644165039  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.17745113372802734  GigaBytes
Max Memory Allocated: 0.1775369644165039  GigaBytes

 h.shape torch.Size([1, 3812, 128]), torch.Size([1, 3812, 128])
----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18108654022216797  GigaBytes
Max Memory Allocated: 0.18108654022216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.23561763763427734  GigaBytes
Max Memory Allocated: 0.23925304412841797  GigaBytes

rst.shape  torch.Size([1, 3812, 128])
m.shape torch.Size([3507, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.2388167381286621  GigaBytes
Max Memory Allocated: 0.23925304412841797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.2388167381286621  GigaBytes
Max Memory Allocated: 0.23925304412841797  GigaBytes

 h.shape torch.Size([1, 3507, 128]), torch.Size([1, 3507, 128])
----------------------------------------3
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24219703674316406  GigaBytes
Max Memory Allocated: 0.24219703674316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.31676769256591797  GigaBytes
Max Memory Allocated: 0.32178449630737305  GigaBytes

rst.shape  torch.Size([1, 3507, 128])
m.shape torch.Size([2948, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32124853134155273  GigaBytes
Max Memory Allocated: 0.32178449630737305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32124853134155273  GigaBytes
Max Memory Allocated: 0.32178449630737305  GigaBytes

 h.shape torch.Size([1, 2948, 128]), torch.Size([1, 2948, 128])
----------------------------------------3
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3244204521179199  GigaBytes
Max Memory Allocated: 0.3244204521179199  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.4064822196960449  GigaBytes
Max Memory Allocated: 0.41210508346557617  GigaBytes

rst.shape  torch.Size([1, 2948, 128])
m.shape torch.Size([2576, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41121816635131836  GigaBytes
Max Memory Allocated: 0.41210508346557617  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41121816635131836  GigaBytes
Max Memory Allocated: 0.41210508346557617  GigaBytes

 h.shape torch.Size([1, 2576, 128]), torch.Size([1, 2576, 128])
----------------------------------------3
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41373205184936523  GigaBytes
Max Memory Allocated: 0.41373205184936523  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5037617683410645  GigaBytes
Max Memory Allocated: 0.5099034309387207  GigaBytes

rst.shape  torch.Size([1, 2576, 128])
m.shape torch.Size([2149, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5086817741394043  GigaBytes
Max Memory Allocated: 0.5099034309387207  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5086817741394043  GigaBytes
Max Memory Allocated: 0.5099034309387207  GigaBytes

 h.shape torch.Size([1, 2149, 128]), torch.Size([1, 2149, 128])
----------------------------------------3
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5109243392944336  GigaBytes
Max Memory Allocated: 0.5109243392944336  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6013803482055664  GigaBytes
Max Memory Allocated: 0.6075286865234375  GigaBytes

rst.shape  torch.Size([1, 2149, 128])
m.shape torch.Size([1906, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6075286865234375  GigaBytes
Max Memory Allocated: 0.6076784133911133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6075286865234375  GigaBytes
Max Memory Allocated: 0.6076784133911133  GigaBytes

 h.shape torch.Size([1, 1906, 128]), torch.Size([1, 1906, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.6093463897705078  GigaBytes
Max Memory Allocated: 0.6093463897705078  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.7002315521240234  GigaBytes
Max Memory Allocated: 0.7065935134887695  GigaBytes

rst.shape  torch.Size([1, 1906, 128])
m.shape torch.Size([1679, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.7057275772094727  GigaBytes
Max Memory Allocated: 0.7065935134887695  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.7057275772094727  GigaBytes
Max Memory Allocated: 0.7065935134887695  GigaBytes

 h.shape torch.Size([1, 1679, 128]), torch.Size([1, 1679, 128])
----------------------------------------3
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7073287963867188  GigaBytes
Max Memory Allocated: 0.7073287963867188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.7995481491088867  GigaBytes
Max Memory Allocated: 0.806269645690918  GigaBytes

rst.shape  torch.Size([1, 1679, 128])
m.shape torch.Size([1422, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8054690361022949  GigaBytes
Max Memory Allocated: 0.806269645690918  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8054690361022949  GigaBytes
Max Memory Allocated: 0.806269645690918  GigaBytes

 h.shape torch.Size([1, 1422, 128]), torch.Size([1, 1422, 128])
----------------------------------------3
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8068251609802246  GigaBytes
Max Memory Allocated: 0.8068251609802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.8960509300231934  GigaBytes
Max Memory Allocated: 0.902153491973877  GigaBytes

rst.shape  torch.Size([1, 1422, 128])
m.shape torch.Size([12537, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9559197425842285  GigaBytes
Max Memory Allocated: 0.9573211669921875  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9559197425842285  GigaBytes
Max Memory Allocated: 0.9573211669921875  GigaBytes

 h.shape torch.Size([1, 12537, 128]), torch.Size([1, 12537, 128])
----------------------------------------3
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.9678759574890137  GigaBytes
Max Memory Allocated: 0.9678759574890137  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.8167672157287598  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

rst.shape  torch.Size([1, 12537, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7199621200561523  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7545166015625  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7890710830688477  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7542462348937988  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

torch.Size([36233, 256])
first layer input nodes number: 52038
first layer output nodes number: 36233
edges number: 224350
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7894611358642578  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.8240156173706055  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.8333325386047363  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.8333325386047363  GigaBytes
Max Memory Allocated: 1.8773140907287598  GigaBytes

m.shape torch.Size([2868, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.02396821975708  GigaBytes
Max Memory Allocated: 2.0242691040039062  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.02396821975708  GigaBytes
Max Memory Allocated: 2.0242691040039062  GigaBytes

 h.shape torch.Size([1, 2868, 256]), torch.Size([1, 2868, 256])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0294384956359863  GigaBytes
Max Memory Allocated: 2.0294384956359863  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0740671157836914  GigaBytes
Max Memory Allocated: 2.0771875381469727  GigaBytes

rst.shape  torch.Size([1, 2868, 256])
m.shape torch.Size([2679, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.076481819152832  GigaBytes
Max Memory Allocated: 2.0771875381469727  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.076481819152832  GigaBytes
Max Memory Allocated: 2.0771875381469727  GigaBytes

 h.shape torch.Size([1, 2679, 256]), torch.Size([1, 2679, 256])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.081921100616455  GigaBytes
Max Memory Allocated: 2.081921100616455  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.159392833709717  GigaBytes
Max Memory Allocated: 2.1645026206970215  GigaBytes

rst.shape  torch.Size([1, 2679, 256])
m.shape torch.Size([2335, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.1635708808898926  GigaBytes
Max Memory Allocated: 2.1645026206970215  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.1635708808898926  GigaBytes
Max Memory Allocated: 2.1645026206970215  GigaBytes

 h.shape torch.Size([1, 2335, 256]), torch.Size([1, 2335, 256])
----------------------------------------3
 Nvidia-smi: 3.4666748046875 GB
    Memory Allocated: 2.1680245399475098  GigaBytes
Max Memory Allocated: 2.1680245399475098  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.266005039215088  GigaBytes
Max Memory Allocated: 2.2726855278015137  GigaBytes

rst.shape  torch.Size([1, 2335, 256])
m.shape torch.Size([1906, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.271106243133545  GigaBytes
Max Memory Allocated: 2.2726855278015137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.271106243133545  GigaBytes
Max Memory Allocated: 2.2726855278015137  GigaBytes

 h.shape torch.Size([1, 1906, 256]), torch.Size([1, 1906, 256])
----------------------------------------3
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.2748990058898926  GigaBytes
Max Memory Allocated: 2.2748990058898926  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3803257942199707  GigaBytes
Max Memory Allocated: 2.387596607208252  GigaBytes

rst.shape  torch.Size([1, 1906, 256])
m.shape torch.Size([1632, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3863511085510254  GigaBytes
Max Memory Allocated: 2.387596607208252  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3863511085510254  GigaBytes
Max Memory Allocated: 2.387596607208252  GigaBytes

 h.shape torch.Size([1, 1632, 256]), torch.Size([1, 1632, 256])
----------------------------------------3
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.38954496383667  GigaBytes
Max Memory Allocated: 2.38954496383667  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.506349563598633  GigaBytes
Max Memory Allocated: 2.514131546020508  GigaBytes

rst.shape  torch.Size([1, 1632, 256])
m.shape torch.Size([1339, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.512354850769043  GigaBytes
Max Memory Allocated: 2.514131546020508  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.512354850769043  GigaBytes
Max Memory Allocated: 2.514131546020508  GigaBytes

 h.shape torch.Size([1, 1339, 256]), torch.Size([1, 1339, 256])
----------------------------------------3
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.5150632858276367  GigaBytes
Max Memory Allocated: 2.5150632858276367  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6274232864379883  GigaBytes
Max Memory Allocated: 2.635085105895996  GigaBytes

rst.shape  torch.Size([1, 1339, 256])
m.shape torch.Size([1151, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6336889266967773  GigaBytes
Max Memory Allocated: 2.635085105895996  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6336889266967773  GigaBytes
Max Memory Allocated: 2.635085105895996  GigaBytes

 h.shape torch.Size([1, 1151, 256]), torch.Size([1, 1151, 256])
----------------------------------------3
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6363954544067383  GigaBytes
Max Memory Allocated: 2.6363954544067383  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7528505325317383  GigaBytes
Max Memory Allocated: 2.7605342864990234  GigaBytes

rst.shape  torch.Size([1, 1151, 256])
m.shape torch.Size([995, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7590231895446777  GigaBytes
Max Memory Allocated: 2.7605342864990234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7590231895446777  GigaBytes
Max Memory Allocated: 2.7605342864990234  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.760921001434326  GigaBytes
Max Memory Allocated: 2.760921001434326  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8729567527770996  GigaBytes
Max Memory Allocated: 2.8805480003356934  GigaBytes

rst.shape  torch.Size([1, 995, 256])
m.shape torch.Size([862, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.879464626312256  GigaBytes
Max Memory Allocated: 2.8805480003356934  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.879464626312256  GigaBytes
Max Memory Allocated: 2.8805480003356934  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8811087608337402  GigaBytes
Max Memory Allocated: 2.8811087608337402  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.9863333702087402  GigaBytes
Max Memory Allocated: 2.99373197555542  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([774, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.992950439453125  GigaBytes
Max Memory Allocated: 2.99373197555542  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.992950439453125  GigaBytes
Max Memory Allocated: 2.99373197555542  GigaBytes

 h.shape torch.Size([1, 774, 256]), torch.Size([1, 774, 256])
----------------------------------------3
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.994426727294922  GigaBytes
Max Memory Allocated: 2.994426727294922  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.100372314453125  GigaBytes
Max Memory Allocated: 3.1077537536621094  GigaBytes

rst.shape  torch.Size([1, 774, 256])
m.shape torch.Size([697, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.1070032119750977  GigaBytes
Max Memory Allocated: 3.1077537536621094  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.1070032119750977  GigaBytes
Max Memory Allocated: 3.1077537536621094  GigaBytes

 h.shape torch.Size([1, 697, 256]), torch.Size([1, 697, 256])
----------------------------------------3
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.108332633972168  GigaBytes
Max Memory Allocated: 3.108332633972168  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.215704917907715  GigaBytes
Max Memory Allocated: 3.2230167388916016  GigaBytes

rst.shape  torch.Size([1, 697, 256])
m.shape torch.Size([574, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.221660614013672  GigaBytes
Max Memory Allocated: 3.2230167388916016  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.221660614013672  GigaBytes
Max Memory Allocated: 3.2230167388916016  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.2227554321289062  GigaBytes
Max Memory Allocated: 3.2230167388916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3164215087890625  GigaBytes
Max Memory Allocated: 3.3229904174804688  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([503, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3221592903137207  GigaBytes
Max Memory Allocated: 3.3229904174804688  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3221592903137207  GigaBytes
Max Memory Allocated: 3.3229904174804688  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3231186866760254  GigaBytes
Max Memory Allocated: 3.3231186866760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 3.412752628326416  GigaBytes
Max Memory Allocated: 3.4189887046813965  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([460, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 3.4184627532958984  GigaBytes
Max Memory Allocated: 3.4189887046813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 3.4184627532958984  GigaBytes
Max Memory Allocated: 3.4189887046813965  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 3.419340133666992  GigaBytes
Max Memory Allocated: 3.419340133666992  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.507356643676758  GigaBytes
Max Memory Allocated: 3.513498306274414  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([388, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.512511730194092  GigaBytes
Max Memory Allocated: 3.513498306274414  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.512511730194092  GigaBytes
Max Memory Allocated: 3.513498306274414  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.513251781463623  GigaBytes
Max Memory Allocated: 3.513498306274414  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8182373046875 GB
    Memory Allocated: 3.592989444732666  GigaBytes
Max Memory Allocated: 3.5985398292541504  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([322, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8182373046875 GB
    Memory Allocated: 3.59757137298584  GigaBytes
Max Memory Allocated: 3.5985398292541504  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8182373046875 GB
    Memory Allocated: 3.59757137298584  GigaBytes
Max Memory Allocated: 3.5985398292541504  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 4.8182373046875 GB
    Memory Allocated: 3.5981855392456055  GigaBytes
Max Memory Allocated: 3.5985398292541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8826904296875 GB
    Memory Allocated: 3.670196533203125  GigaBytes
Max Memory Allocated: 3.67510986328125  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([332, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8826904296875 GB
    Memory Allocated: 3.675314426422119  GigaBytes
Max Memory Allocated: 3.6753358840942383  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8826904296875 GB
    Memory Allocated: 3.675314426422119  GigaBytes
Max Memory Allocated: 3.6753358840942383  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 4.8846435546875 GB
    Memory Allocated: 3.675947666168213  GigaBytes
Max Memory Allocated: 3.675947666168213  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.7539467811584473  GigaBytes
Max Memory Allocated: 3.759329319000244  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([276, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.7584052085876465  GigaBytes
Max Memory Allocated: 3.759329319000244  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.7584052085876465  GigaBytes
Max Memory Allocated: 3.759329319000244  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 4.9744873046875 GB
    Memory Allocated: 3.7589316368103027  GigaBytes
Max Memory Allocated: 3.759329319000244  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 3.8271079063415527  GigaBytes
Max Memory Allocated: 3.831845760345459  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([223, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 3.8309173583984375  GigaBytes
Max Memory Allocated: 3.831845760345459  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 3.8309173583984375  GigaBytes
Max Memory Allocated: 3.831845760345459  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 3.8313426971435547  GigaBytes
Max Memory Allocated: 3.831845760345459  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.888338088989258  GigaBytes
Max Memory Allocated: 3.892378807067871  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([255, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.8930273056030273  GigaBytes
Max Memory Allocated: 3.8930463790893555  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.8930273056030273  GigaBytes
Max Memory Allocated: 3.8930463790893555  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.1014404296875 GB
    Memory Allocated: 3.8935136795043945  GigaBytes
Max Memory Allocated: 3.8935136795043945  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1697998046875 GB
    Memory Allocated: 3.962092399597168  GigaBytes
Max Memory Allocated: 3.96695613861084  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([226, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1697998046875 GB
    Memory Allocated: 3.9664111137390137  GigaBytes
Max Memory Allocated: 3.96695613861084  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1697998046875 GB
    Memory Allocated: 3.9664111137390137  GigaBytes
Max Memory Allocated: 3.96695613861084  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 5.1697998046875 GB
    Memory Allocated: 3.9668421745300293  GigaBytes
Max Memory Allocated: 3.96695613861084  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.030639171600342  GigaBytes
Max Memory Allocated: 4.035165309906006  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([170, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.034446716308594  GigaBytes
Max Memory Allocated: 4.035165309906006  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.034446716308594  GigaBytes
Max Memory Allocated: 4.035165309906006  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.034770965576172  GigaBytes
Max Memory Allocated: 4.035165309906006  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3045654296875 GB
    Memory Allocated: 4.085029602050781  GigaBytes
Max Memory Allocated: 4.088596343994141  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([144, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.3045654296875 GB
    Memory Allocated: 4.088050842285156  GigaBytes
Max Memory Allocated: 4.088596343994141  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3045654296875 GB
    Memory Allocated: 4.088050842285156  GigaBytes
Max Memory Allocated: 4.088596343994141  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 5.3045654296875 GB
    Memory Allocated: 4.088325500488281  GigaBytes
Max Memory Allocated: 4.088596343994141  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.132820129394531  GigaBytes
Max Memory Allocated: 4.135978698730469  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([151, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.136166095733643  GigaBytes
Max Memory Allocated: 4.1361799240112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.136166095733643  GigaBytes
Max Memory Allocated: 4.1361799240112305  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.136454105377197  GigaBytes
Max Memory Allocated: 4.136454105377197  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4002685546875 GB
    Memory Allocated: 4.1851277351379395  GigaBytes
Max Memory Allocated: 4.188583850860596  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([1995, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4490966796875 GB
    Memory Allocated: 4.232920169830322  GigaBytes
Max Memory Allocated: 4.2331061363220215  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4490966796875 GB
    Memory Allocated: 4.232920169830322  GigaBytes
Max Memory Allocated: 4.2331061363220215  GigaBytes

 h.shape torch.Size([1, 1995, 256]), torch.Size([1, 1995, 256])
----------------------------------------3
 Nvidia-smi: 5.4490966796875 GB
    Memory Allocated: 4.236725330352783  GigaBytes
Max Memory Allocated: 4.236725330352783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2205810546875 GB
    Memory Allocated: 4.919575214385986  GigaBytes
Max Memory Allocated: 4.967139720916748  GigaBytes

rst.shape  torch.Size([1, 1995, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.752562046051025  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.756101131439209  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.760411739349365  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.756699085235596  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([23257, 40])
input nodes number: 36233
output nodes number: 23257
edges number: 194316
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.760682106018066  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.2440185546875 GB
    Memory Allocated: 4.760683059692383  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.04380655288696289  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

pseudo mini batch 1 input nodes size: 56296
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03465700149536133  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03465700149536133  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.06150102615356445  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.06167411804199219  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03610992431640625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03873920440673828  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03873920440673828  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03873920440673828  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([56296, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03873920440673828  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

m.shape torch.Size([5344, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.1428666114807129  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.1428666114807129  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 5344, 128]), torch.Size([1, 5344, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.1479630470275879  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.18940210342407227  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 5344, 128])
m.shape torch.Size([5325, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.19193220138549805  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.19193220138549805  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 5325, 128]), torch.Size([1, 5325, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.19701051712036133  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.27318525314331055  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 5325, 128])
m.shape torch.Size([4529, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.2774815559387207  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.2774815559387207  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 4529, 128]), torch.Size([1, 4529, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.2818007469177246  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.3786749839782715  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 4529, 128])
m.shape torch.Size([3736, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.38364124298095703  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.38364124298095703  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3736, 128]), torch.Size([1, 3736, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.3872041702270508  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.49052906036376953  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3736, 128])
m.shape torch.Size([3034, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.49598121643066406  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.49598121643066406  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3034, 128]), torch.Size([1, 3034, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.4990196228027344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.6062321662902832  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3034, 128])
m.shape torch.Size([2449, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.6115221977233887  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.6115221977233887  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2449, 128]), torch.Size([1, 2449, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.614448070526123  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.7209935188293457  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2449, 128])
m.shape torch.Size([2014, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.7265481948852539  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.7265481948852539  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2014, 128]), torch.Size([1, 2014, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.7284688949584961  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.8259682655334473  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2014, 128])
m.shape torch.Size([1765, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.8317408561706543  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.8317408561706543  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.8334240913391113  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.9301676750183105  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1467, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.9356217384338379  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.9356217384338379  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1467, 128]), torch.Size([1, 1467, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.9370207786560059  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.0265593528747559  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1467, 128])
m.shape torch.Size([9094, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.069223403930664  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.069223403930664  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 9094, 128]), torch.Size([1, 9094, 128])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.0778961181640625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6936588287353516  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 9094, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6081771850585938  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6451387405395508  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6821002960205078  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6448497772216797  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([38757, 256])
first layer input nodes number: 56296
first layer output nodes number: 38757
edges number: 206750
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6825218200683594  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.7194833755493164  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.7287240028381348  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.7287240028381348  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

m.shape torch.Size([3959, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.8737468719482422  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.8737468719482422  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3959, 256]), torch.Size([1, 3959, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.8812980651855469  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.9436674118041992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3959, 256])
m.shape torch.Size([3467, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.946556568145752  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.946556568145752  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3467, 256]), torch.Size([1, 3467, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.9536385536193848  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.052830219268799  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3467, 256])
m.shape torch.Size([2782, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.0575456619262695  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.0575456619262695  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2782, 256]), torch.Size([1, 2782, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.062943458557129  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.180779457092285  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2782, 256])
m.shape torch.Size([2164, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.1867637634277344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.1867637634277344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2164, 256]), torch.Size([1, 2164, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.1911091804504395  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.3173375129699707  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2164, 256])
m.shape torch.Size([1763, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.3236241340637207  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.3236241340637207  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1763, 256]), torch.Size([1, 1763, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.327162742614746  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.454129695892334  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1763, 256])
m.shape torch.Size([1374, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.459867477416992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.459867477416992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1374, 256]), torch.Size([1, 1374, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.4642391204833984  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.5941848754882812  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1374, 256])
m.shape torch.Size([1131, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.5996084213256836  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.5996084213256836  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.6018590927124023  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.711888313293457  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([957, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.718168258666992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.718168258666992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.7199935913085938  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.824350357055664  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([796, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.8303232192993164  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.8303232192993164  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.831841468811035  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.929009437561035  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([661, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.934603691101074  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.934603691101074  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.9358644485473633  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.0288357734680176  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([528, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.033787727355957  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.033787727355957  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.034794807434082  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1137208938598633  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([439, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1186890602111816  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1186890602111816  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1195263862609863  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1914162635803223  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([384, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1957955360412598  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1957955360412598  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.1965279579162598  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.265141010284424  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([325, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.269148349761963  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.269148349761963  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.269768238067627  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.333012104034424  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([311, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.337185859680176  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.337185859680176  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.3377790451049805  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.402334213256836  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([222, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.405451774597168  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.405451774597168  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.4058752059936523  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.4537229537963867  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([201, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.4567956924438477  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.4567956924438477  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.457179069519043  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.5031843185424805  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([174, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.506002902984619  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.506002902984619  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.5063347816467285  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.548483371734619  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([160, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.551239490509033  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.551239490509033  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.551544666290283  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.592438220977783  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([131, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.5950851440429688  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.5950851440429688  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.595335006713867  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.630565643310547  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.6328024864196777  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.6328024864196777  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.633025646209717  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.666053295135498  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.6680989265441895  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.6680989265441895  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.6682934761047363  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.698448657989502  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([98, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7005181312561035  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7005181312561035  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.700705051422119  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7309861183166504  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([88, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7329225540161133  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7329225540161133  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.733090400695801  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.7614564895629883  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([864, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.782133102416992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.782133102416992  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.783781051635742  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 4.074334144592285  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 864, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.9541945457458496  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.9586234092712402  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.962080478668213  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.9574785232543945  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([23198, 40])
input nodes number: 38757
output nodes number: 23198
edges number: 146012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.9578585624694824  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 3.9578590393066406  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.04392099380493164  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

pseudo mini batch 2 input nodes size: 95252
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03602790832519531  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.03602790832519531  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.08144760131835938  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.08161354064941406  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.0545964241027832  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.060452938079833984  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.060452938079833984  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.060452938079833984  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([95252, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 0.060452938079833984  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

m.shape torch.Size([3998, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.32370758056640625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.32370758056640625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3998, 128]), torch.Size([1, 3998, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.32752037048339844  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.35886383056640625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3998, 128])
m.shape torch.Size([4168, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.36077022552490234  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.36077022552490234  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 4168, 128]), torch.Size([1, 4168, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.3647451400756836  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.42436885833740234  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 4168, 128])
m.shape torch.Size([3700, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.4282188415527344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.4282188415527344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3700, 128]), torch.Size([1, 3700, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.4317646026611328  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.5097446441650391  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3700, 128])
m.shape torch.Size([3369, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.5144062042236328  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.5144062042236328  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3369, 128]), torch.Size([1, 3369, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.5177154541015625  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.6126604080200195  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3369, 128])
m.shape torch.Size([3164, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.6190862655639648  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.6190862655639648  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 3164, 128]), torch.Size([1, 3164, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.6221036911010742  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.731473445892334  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 3164, 128])
m.shape torch.Size([2892, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.7382388114929199  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.7382388114929199  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2892, 128]), torch.Size([1, 2892, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.7410907745361328  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.8615684509277344  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2892, 128])
m.shape torch.Size([2764, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.8691902160644531  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.8691902160644531  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2764, 128]), torch.Size([1, 2764, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 0.8723983764648438  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.0041961669921875  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2764, 128])
m.shape torch.Size([2600, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.012796401977539  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.012796401977539  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2600, 128]), torch.Size([1, 2600, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.0152950286865234  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.1615333557128906  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2600, 128])
m.shape torch.Size([2426, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.1697702407836914  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.1697702407836914  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2426, 128]), torch.Size([1, 2426, 128])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.172156810760498  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 1.320971965789795  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2426, 128])
m.shape torch.Size([40020, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 1.5112214088439941  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 1.5112214088439941  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 40020, 128]), torch.Size([1, 40020, 128])
----------------------------------------3
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 1.5502839088439941  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.269934177398682  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 40020, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.027580261230469  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.093480110168457  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.159379959106445  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.092965126037598  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

torch.Size([69101, 256])
first layer input nodes number: 95252
first layer output nodes number: 69101
edges number: 532264
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.160091876983643  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.225991725921631  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.242466926574707  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.0604248046875 GB
    Memory Allocated: 4.242466926574707  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

m.shape torch.Size([2636, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.490464687347412  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.490464687347412  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2636, 256]), torch.Size([1, 2636, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.495492458343506  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.535714626312256  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2636, 256])
m.shape torch.Size([2236, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.537498950958252  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.537498950958252  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 2236, 256]), torch.Size([1, 2236, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.542402267456055  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.607393264770508  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 2236, 256])
m.shape torch.Size([1687, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.610128402709961  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.610128402709961  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1687, 256]), torch.Size([1, 1687, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.613714218139648  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.686426162719727  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1687, 256])
m.shape torch.Size([1320, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.689708232879639  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.689708232879639  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1320, 256]), torch.Size([1, 1320, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.6924052238464355  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.770288467407227  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1320, 256])
m.shape torch.Size([1180, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.774166584014893  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.774166584014893  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 1180, 256]), torch.Size([1, 1180, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.7771992683410645  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.865783214569092  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 1180, 256])
m.shape torch.Size([938, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.869946002960205  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.869946002960205  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 938, 256]), torch.Size([1, 938, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.871735095977783  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.951462268829346  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

rst.shape  torch.Size([1, 938, 256])
m.shape torch.Size([763, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.955826282501221  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.955826282501221  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 4.957281589508057  GigaBytes
Max Memory Allocated: 4.984308242797852  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.030161380767822  GigaBytes
Max Memory Allocated: 5.035254955291748  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([634, 8, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.034308910369873  GigaBytes
Max Memory Allocated: 5.035254955291748  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.034308910369873  GigaBytes
Max Memory Allocated: 5.035254955291748  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.035518169403076  GigaBytes
Max Memory Allocated: 5.035518169403076  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.104812145233154  GigaBytes
Max Memory Allocated: 5.109649181365967  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([622, 9, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.109588146209717  GigaBytes
Max Memory Allocated: 5.109649181365967  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.109588146209717  GigaBytes
Max Memory Allocated: 5.109649181365967  GigaBytes

 h.shape torch.Size([1, 622, 256]), torch.Size([1, 622, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.110774517059326  GigaBytes
Max Memory Allocated: 5.110774517059326  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.18837308883667  GigaBytes
Max Memory Allocated: 5.193711757659912  GigaBytes

rst.shape  torch.Size([1, 622, 256])
m.shape torch.Size([568, 10, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.193239212036133  GigaBytes
Max Memory Allocated: 5.193711757659912  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.193239212036133  GigaBytes
Max Memory Allocated: 5.193711757659912  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.19432258605957  GigaBytes
Max Memory Allocated: 5.19432258605957  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.272005081176758  GigaBytes
Max Memory Allocated: 5.277421951293945  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([522, 11, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.276982307434082  GigaBytes
Max Memory Allocated: 5.277421951293945  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.276982307434082  GigaBytes
Max Memory Allocated: 5.277421951293945  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.27797794342041  GigaBytes
Max Memory Allocated: 5.27797794342041  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.356438636779785  GigaBytes
Max Memory Allocated: 5.36191463470459  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([495, 12, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.361649990081787  GigaBytes
Max Memory Allocated: 5.36191463470459  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.361649990081787  GigaBytes
Max Memory Allocated: 5.36191463470459  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.362594127655029  GigaBytes
Max Memory Allocated: 5.362594127655029  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.444702625274658  GigaBytes
Max Memory Allocated: 5.450367450714111  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([423, 13, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.4495158195495605  GigaBytes
Max Memory Allocated: 5.450367450714111  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.4495158195495605  GigaBytes
Max Memory Allocated: 5.450367450714111  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.45032262802124  GigaBytes
Max Memory Allocated: 5.450367450714111  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.525865077972412  GigaBytes
Max Memory Allocated: 5.53110933303833  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([358, 14, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.530279159545898  GigaBytes
Max Memory Allocated: 5.53110933303833  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.530279159545898  GigaBytes
Max Memory Allocated: 5.53110933303833  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.530961990356445  GigaBytes
Max Memory Allocated: 5.53110933303833  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.600237846374512  GigaBytes
Max Memory Allocated: 5.60501766204834  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([333, 15, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.6046977043151855  GigaBytes
Max Memory Allocated: 5.60501766204834  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.6046977043151855  GigaBytes
Max Memory Allocated: 5.60501766204834  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.605332851409912  GigaBytes
Max Memory Allocated: 5.605332851409912  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.674025058746338  GigaBytes
Max Memory Allocated: 5.678788661956787  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([327, 16, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.678736209869385  GigaBytes
Max Memory Allocated: 5.678788661956787  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.678736209869385  GigaBytes
Max Memory Allocated: 5.678788661956787  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.6793599128723145  GigaBytes
Max Memory Allocated: 5.6793599128723145  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.752935886383057  GigaBytes
Max Memory Allocated: 5.757925510406494  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([300, 17, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.75752592086792  GigaBytes
Max Memory Allocated: 5.757925510406494  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.75752592086792  GigaBytes
Max Memory Allocated: 5.757925510406494  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.758098125457764  GigaBytes
Max Memory Allocated: 5.758098125457764  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.827849864959717  GigaBytes
Max Memory Allocated: 5.832713603973389  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([300, 18, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.832754135131836  GigaBytes
Max Memory Allocated: 5.832774639129639  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.832754135131836  GigaBytes
Max Memory Allocated: 5.832774639129639  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.83332633972168  GigaBytes
Max Memory Allocated: 5.83332633972168  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.906797409057617  GigaBytes
Max Memory Allocated: 5.911947250366211  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([281, 19, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.911643028259277  GigaBytes
Max Memory Allocated: 5.911947250366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.911643028259277  GigaBytes
Max Memory Allocated: 5.911947250366211  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.912178993225098  GigaBytes
Max Memory Allocated: 5.912178993225098  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.985179901123047  GigaBytes
Max Memory Allocated: 5.99027156829834  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([269, 20, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.99008321762085  GigaBytes
Max Memory Allocated: 5.99027156829834  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.99008321762085  GigaBytes
Max Memory Allocated: 5.99027156829834  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 5.990596294403076  GigaBytes
Max Memory Allocated: 5.990596294403076  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.063416957855225  GigaBytes
Max Memory Allocated: 6.06854772567749  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([255, 21, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.068307399749756  GigaBytes
Max Memory Allocated: 6.06854772567749  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.068307399749756  GigaBytes
Max Memory Allocated: 6.06854772567749  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.068793773651123  GigaBytes
Max Memory Allocated: 6.068793773651123  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.140777111053467  GigaBytes
Max Memory Allocated: 6.145884037017822  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([192, 22, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.144593715667725  GigaBytes
Max Memory Allocated: 6.145884037017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.144593715667725  GigaBytes
Max Memory Allocated: 6.145884037017822  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.144959926605225  GigaBytes
Max Memory Allocated: 6.145884037017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.201722621917725  GigaBytes
Max Memory Allocated: 6.205750942230225  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([190, 23, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.205739974975586  GigaBytes
Max Memory Allocated: 6.205756664276123  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.205739974975586  GigaBytes
Max Memory Allocated: 6.205756664276123  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.20610237121582  GigaBytes
Max Memory Allocated: 6.20610237121582  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.264810562133789  GigaBytes
Max Memory Allocated: 6.268978118896484  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([192, 24, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.2690582275390625  GigaBytes
Max Memory Allocated: 6.269075393676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.2690582275390625  GigaBytes
Max Memory Allocated: 6.269075393676758  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.2694244384765625  GigaBytes
Max Memory Allocated: 6.2694244384765625  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.3313140869140625  GigaBytes
Max Memory Allocated: 6.3357086181640625  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([5230, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.457611560821533  GigaBytes
Max Memory Allocated: 6.458098888397217  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.457611560821533  GigaBytes
Max Memory Allocated: 6.458098888397217  GigaBytes

 h.shape torch.Size([1, 5230, 256]), torch.Size([1, 5230, 256])
----------------------------------------3
 Nvidia-smi: 9.3026123046875 GB
    Memory Allocated: 6.467586994171143  GigaBytes
Max Memory Allocated: 6.467586994171143  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.23769235610962  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 5230, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.00978136062622  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.013267993927002  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.016583919525146  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.01293134689331  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([22251, 40])
input nodes number: 69101
output nodes number: 22251
edges number: 253614
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.013641834259033  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.013642311096191  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.07073307037353516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

pseudo mini batch 3 input nodes size: 94420
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.0546259880065918  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.0546259880065918  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.09964895248413086  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.09981489181518555  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.0542292594909668  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.057940006256103516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.057940006256103516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.057940006256103516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([94420, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.057940006256103516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([5455, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.23092937469482422  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.23092937469482422  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 5455, 128]), torch.Size([1, 5455, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.2361316680908203  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.27775001525878906  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 5455, 128])
m.shape torch.Size([5446, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.28034257888793945  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.28034257888793945  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 5446, 128]), torch.Size([1, 5446, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.2855362892150879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.36344194412231445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 5446, 128])
m.shape torch.Size([4594, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3674168586730957  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3674168586730957  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4594, 128]), torch.Size([1, 4594, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3725857734680176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.46935319900512695  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4594, 128])
m.shape torch.Size([3990, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.47477293014526367  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.47477293014526367  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3990, 128]), torch.Size([1, 3990, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.47878599166870117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5910096168518066  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3990, 128])
m.shape torch.Size([3480, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5968985557556152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5968985557556152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3480, 128]), torch.Size([1, 3480, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.6010661125183105  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7215962409973145  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3480, 128])
m.shape torch.Size([2858, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7281136512756348  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7281136512756348  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2858, 128]), torch.Size([1, 2858, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7311358451843262  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8556027412414551  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2858, 128])
m.shape torch.Size([2548, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8627448081970215  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8627448081970215  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2548, 128]), torch.Size([1, 2548, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8652210235595703  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.988156795501709  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2548, 128])
m.shape torch.Size([2323, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9966616630554199  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9966616630554199  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2323, 128]), torch.Size([1, 2323, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9988899230957031  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.1301050186157227  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2323, 128])
m.shape torch.Size([1997, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.1375675201416016  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.1375675201416016  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1997, 128]), torch.Size([1, 1997, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.1394720077514648  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.2637910842895508  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1997, 128])
m.shape torch.Size([21250, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.3641667366027832  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.3641667366027832  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 21250, 128]), torch.Size([1, 21250, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.384432315826416  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.8232884407043457  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 21250, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.672147750854492  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7235898971557617  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7750320434570312  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7231879234313965  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([53941, 256])
first layer input nodes number: 94420
first layer output nodes number: 53941
edges number: 347530
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.775737762451172  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.8271799087524414  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.840040683746338  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.840040683746338  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([3965, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.9891629219055176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.9891629219055176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3965, 256]), torch.Size([1, 3965, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.996725559234619  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0592103004455566  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3965, 256])
m.shape torch.Size([3324, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0618185997009277  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0618185997009277  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3324, 256]), torch.Size([1, 3324, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0690064430236816  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.1651291847229004  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3324, 256])
m.shape torch.Size([2473, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.168578624725342  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.168578624725342  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2473, 256]), torch.Size([1, 2473, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.173776626586914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.2808518409729004  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2473, 256])
m.shape torch.Size([1930, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.2859134674072266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.2859134674072266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1930, 256]), torch.Size([1, 1930, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.2898521423339844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.398561477661133  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1930, 256])
m.shape torch.Size([1647, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.404440402984619  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.404440402984619  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1647, 256]), torch.Size([1, 1647, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.407741069793701  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.5264859199523926  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1647, 256])
m.shape torch.Size([1217, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.531935691833496  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.531935691833496  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1217, 256]), torch.Size([1, 1217, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.53438663482666  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.641620635986328  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1217, 256])
m.shape torch.Size([1000, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.6471433639526367  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.6471433639526367  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.649050712585449  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.747147560119629  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([886, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7530064582824707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7530064582824707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7546963691711426  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8519139289855957  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([696, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8570895195007324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8570895195007324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.85841703414917  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.946498394012451  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([596, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.9515633583068848  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.9515633583068848  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.952700138092041  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.0352044105529785  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([456, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.039457321166992  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.039457321166992  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.040327072143555  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.109702110290527  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([429, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.1149210929870605  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.1149210929870605  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.115739345550537  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.1852946281433105  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([346, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.189208984375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.189208984375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.189868927001953  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.251522064208984  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([291, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.255107879638672  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.255107879638672  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.25566291809082  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.312158584594727  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([257, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.315586566925049  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.315586566925049  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.316076755523682  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.369418621063232  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([240, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.372864246368408  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.372864246368408  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.373322010040283  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.425049304962158  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([197, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.42803955078125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.42803955078125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.428415298461914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.473505020141602  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([198, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.476742744445801  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.476742744445801  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.477120399475098  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.525082588195801  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([172, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.528042793273926  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.528042793273926  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.5283708572387695  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.572331428527832  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([152, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.575089454650879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.575089454650879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.575379371643066  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.616257667541504  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([119, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.6185150146484375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.6185150146484375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.618741989135742  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes
[04:22:18] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 4 parts and get 1917854 edge cuts

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.652334213256836  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([92, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.654166221618652  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.654166221618652  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.654341697692871  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.681540489196777  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([87, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.683376312255859  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.683376312255859  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.683542251586914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.710424423217773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([94, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.712510108947754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.712510108947754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.712689399719238  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.742989540100098  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([1371, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.775842666625977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.775842666625977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1371, 256]), torch.Size([1, 1371, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 4.778816223144531  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.239051818847656  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1371, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.114802360534668  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.118643760681152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.121957302093506  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.117949962615967  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([22235, 40])
input nodes number: 53941
output nodes number: 22235
edges number: 150308
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.11887264251709  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 5.118873119354248  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.06534910202026367  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.07089948654174805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.07089948654174805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04141765832901001 |0.08719116449356079 |0.26756948232650757 |0.00013822317123413086 |0.09598356485366821 |0.005840301513671875 |
----------------------------------------------------------pseudo_mini_loss sum 5.321277618408203
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  496038
Number of first layer input nodes during this epoch:  298006
Number of first layer output nodes during this epoch:  198032
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.07089900970458984  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02449631690979004
global_2_local spend time (sec) 0.045598506927490234
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004387617111206055
A = g.adjacency_matrix() spent  0.008962631225585938
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07986044883728027
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.367006778717041
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2410647869110107

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.248 seconds
Metis partitioning: 4.925 seconds
Split the graph: 3.393 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.657565593719482
22656
23182
22515
22588
total k batches seeds list generation spend  20.164410829544067
after graph partition
graph partition algorithm spend time 20.288223028182983
22656
23182
22515
22588
partition_len_list
[35648, 40724, 53419, 68835]
shared_neighbor_graph_partition_s0 selection method  spend 20.38470149040222
time for parepare:  0.016932249069213867
local_output_nid generation:  0.003106355667114258
local_in_edges_tensor generation:  0.0035707950592041016
mini_batch_src_global generation:  0.005785465240478516
r_  generation:  0.0708155632019043
local_output_nid generation:  0.003901958465576172
local_in_edges_tensor generation:  0.0041713714599609375
mini_batch_src_global generation:  0.006323575973510742
r_  generation:  0.05818343162536621
local_output_nid generation:  0.0039424896240234375
local_in_edges_tensor generation:  0.0034885406494140625
mini_batch_src_global generation:  0.0054662227630615234
r_  generation:  0.05388617515563965
local_output_nid generation:  0.003981351852416992
local_in_edges_tensor generation:  0.0055844783782958984
mini_batch_src_global generation:  0.011951208114624023
r_  generation:  0.08800077438354492
----------------------check_connections_block total spend ----------------------------- 0.43092870712280273
generate_one_block  0.08650374412536621
generate_one_block  0.07468771934509277
generate_one_block  0.07284259796142578
generate_one_block  0.12682056427001953
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04903268814086914
gen group dst list time:  0.005504608154296875
time for parepare:  0.019614219665527344
local_output_nid generation:  0.005349159240722656
local_in_edges_tensor generation:  0.019502878189086914
mini_batch_src_global generation:  0.006642580032348633
r_  generation:  0.0764007568359375
local_output_nid generation:  0.00849461555480957
local_in_edges_tensor generation:  0.009278059005737305
mini_batch_src_global generation:  0.009656190872192383
r_  generation:  0.08680129051208496
local_output_nid generation:  0.011121511459350586
local_in_edges_tensor generation:  0.01273965835571289
mini_batch_src_global generation:  0.011523962020874023
r_  generation:  0.12967920303344727
local_output_nid generation:  0.011189699172973633
local_in_edges_tensor generation:  0.013909578323364258
mini_batch_src_global generation:  0.01891803741455078
r_  generation:  0.19218087196350098
----------------------check_connections_block total spend ----------------------------- 0.7570364475250244
generate_one_block  0.09650015830993652
generate_one_block  0.1125631332397461
generate_one_block  0.15735530853271484
generate_one_block  0.27268528938293457
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.07089900970458984  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

connection checking time:  0.7570364475250244
block generation total time  0.639103889465332
average batch blocks generation time:  0.159775972366333
block dataloader generation time/epoch 22.751673221588135
pseudo mini batch 0 input nodes size: 50089
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.06013345718383789  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.06013345718383789  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.08401775360107422  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.08418655395507812  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.038997650146484375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.04193115234375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.04193115234375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.04193115234375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([50089, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.04193115234375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([4017, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.14849567413330078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.14849567413330078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.1523265838623047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.1834259033203125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([4034, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.18535757064819336  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.18535757064819336  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4034, 128]), torch.Size([1, 4034, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.189422607421875  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.24808120727539062  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4034, 128])
m.shape torch.Size([3562, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.25192832946777344  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.25192832946777344  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3562, 128]), torch.Size([1, 3562, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.25571250915527344  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3321418762207031  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3562, 128])
m.shape torch.Size([3015, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3355388641357422  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3355388641357422  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3015, 128]), torch.Size([1, 3015, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.3384828567504883  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.4252338409423828  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3015, 128])
m.shape torch.Size([2570, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.42992353439331055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.42992353439331055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2570, 128]), torch.Size([1, 2570, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.43271398544311523  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5216250419616699  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2570, 128])
m.shape torch.Size([2183, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5266451835632324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5266451835632324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.5288147926330566  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.6238994598388672  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([1837, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.6283097267150879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.6283097267150879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.6300616264343262  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7176566123962402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1612, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7229299545288086  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7229299545288086  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.7244672775268555  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8120946884155273  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([1387, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8172783851623535  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.8172783851623535  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1387, 128]), torch.Size([1, 1387, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.818601131439209  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.903256893157959  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1387, 128])
m.shape torch.Size([11431, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9571027755737305  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9571027755737305  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 11431, 128]), torch.Size([1, 11431, 128])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 0.9685931205749512  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.7438783645629883  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 11431, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.6522159576416016  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.6862125396728516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.7202091217041016  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.6859469413757324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([35648, 256])
first layer input nodes number: 50089
first layer output nodes number: 35648
edges number: 213327
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.7205843925476074  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.7545809745788574  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.76308012008667  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.76308012008667  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([3110, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9403772354125977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9403772354125977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3110, 256]), torch.Size([1, 3110, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9467353820800781  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9952402114868164  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3110, 256])
m.shape torch.Size([2798, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9976844787597656  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 1.9976844787597656  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2798, 256]), torch.Size([1, 2798, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.004042625427246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.0896100997924805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2798, 256])
m.shape torch.Size([2363, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.093742847442627  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.093742847442627  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2363, 256]), torch.Size([1, 2363, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.098717212677002  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.1984663009643555  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2363, 256])
m.shape torch.Size([1862, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.203371524810791  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.203371524810791  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1862, 256]), torch.Size([1, 1862, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.207002639770508  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.311291217803955  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1862, 256])
m.shape torch.Size([1558, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.317002773284912  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.317002773284912  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1558, 256]), torch.Size([1, 1558, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.3200087547302246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.4294209480285645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1558, 256])
m.shape torch.Size([1321, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.43528413772583  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.43528413772583  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1321, 256]), torch.Size([1, 1321, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.4379525184631348  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.550684928894043  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1321, 256])
m.shape torch.Size([1084, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.556084156036377  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.556084156036377  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1084, 256]), torch.Size([1, 1084, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.5581932067871094  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.6661934852600098  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1084, 256])
m.shape torch.Size([933, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.6723337173461914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.6723337173461914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 933, 256]), torch.Size([1, 933, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.6741132736206055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7759485244750977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 933, 256])
m.shape torch.Size([807, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7820396423339844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.7820396423339844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 807, 256]), torch.Size([1, 807, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.783578872680664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.882089614868164  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 807, 256])
m.shape torch.Size([727, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.888307571411133  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.888307571411133  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 727, 256]), torch.Size([1, 727, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.8896942138671875  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.9894256591796875  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 727, 256])
m.shape torch.Size([645, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.995551586151123  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.995551586151123  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 2.996781826019287  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.093203067779541  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([538, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0987930297851562  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0987930297851562  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.0998191833496094  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.1880645751953125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([469, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.1934118270874023  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.1934118270874023  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.1943063735961914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.276742935180664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([409, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.28179931640625  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.28179931640625  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.2825794219970703  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.3618717193603516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([344, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.366441249847412  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.366441249847412  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.3670973777770996  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.436906337738037  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([301, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.441710948944092  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.441710948944092  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.4422850608825684  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.5072617530822754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([312, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.5120725631713867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.5120725631713867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.512667655944824  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.586153984069824  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.59023380279541  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.59023380279541  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.5907163619995117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.65200138092041  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([209, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.6555771827697754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.6555771827697754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.655975818634033  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.70939302444458  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([228, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7135767936706543  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7135767936706543  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.7140116691589355  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.775329113006592  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([209, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.779330253601074  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.779330253601074  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.779728889465332  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8387269973754883  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8414669036865234  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8414669036865234  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8417320251464844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8828258514404297  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.885810375213623  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.885810375213623  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.8860793113708496  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.9296469688415527  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([136, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.932649612426758  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.932649612426758  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 10.5135498046875 GB
    Memory Allocated: 3.9329090118408203  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 3.976747512817383  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([1760, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.01890754699707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.01890754699707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1760, 256]), torch.Size([1, 1760, 256])
----------------------------------------3
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.02226448059082  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.6135759353637695  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1760, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.4584059715271  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.46199369430542  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.46577787399292  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.462021350860596  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([22656, 40])
input nodes number: 35648
output nodes number: 22656
edges number: 180237
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.462202072143555  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5408935546875 GB
    Memory Allocated: 4.462203025817871  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04737997055053711  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

pseudo mini batch 1 input nodes size: 62722
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.03874492645263672  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.03874492645263672  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06865310668945312  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06882619857788086  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.044773101806640625  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([62722, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04773139953613281  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([4882, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.16523361206054688  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.16523361206054688  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4882, 128]), torch.Size([1, 4882, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.17048168182373047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.20796585083007812  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4882, 128])
m.shape torch.Size([4954, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2103729248046875  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2103729248046875  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4954, 128]), torch.Size([1, 4954, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.21509742736816406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.28786468505859375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4954, 128])
m.shape torch.Size([4317, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2925891876220703  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2925891876220703  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4317, 128]), torch.Size([1, 4317, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2971525192260742  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.3877267837524414  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4317, 128])
m.shape torch.Size([3591, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.39284849166870117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.39284849166870117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3591, 128]), torch.Size([1, 3591, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.3966193199157715  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.49802446365356445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3591, 128])
m.shape torch.Size([3073, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.5029430389404297  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.5029430389404297  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3073, 128]), torch.Size([1, 3073, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.5068163871765137  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6152119636535645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3073, 128])
m.shape torch.Size([2508, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6209220886230469  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6209220886230469  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2508, 128]), torch.Size([1, 2508, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6236495971679688  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7289018630981445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2508, 128])
m.shape torch.Size([2143, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7344846725463867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7344846725463867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2143, 128]), torch.Size([1, 2143, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.737267017364502  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8401618003845215  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2143, 128])
m.shape torch.Size([1899, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8463840484619141  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8463840484619141  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8481950759887695  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.9514236450195312  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1614, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.9574446678161621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.9574446678161621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1614, 128]), torch.Size([1, 1614, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.9589838981628418  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.0574946403503418  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1614, 128])
m.shape torch.Size([11743, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.112720012664795  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.112720012664795  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 11743, 128]), torch.Size([1, 11743, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.1239190101623535  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.9190478324890137  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 11743, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.8193111419677734  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.8581485748291016  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.8969860076904297  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.8578448295593262  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([40724, 256])
first layer input nodes number: 62722
first layer output nodes number: 40724
edges number: 234667
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.8974556922912598  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.936293125152588  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.9462838172912598  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.9462838172912598  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([3554, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.1065497398376465  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.1065497398376465  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3554, 256]), torch.Size([1, 3554, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.113328456878662  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.167558193206787  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3554, 256])
m.shape torch.Size([3192, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.170304775238037  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.170304775238037  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3192, 256]), torch.Size([1, 3192, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.176530361175537  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.2678542137145996  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3192, 256])
m.shape torch.Size([2550, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.2722220420837402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.2722220420837402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2550, 256]), torch.Size([1, 2550, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.2775392532348633  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.3880667686462402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2550, 256])
m.shape torch.Size([2058, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.3930492401123047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.3930492401123047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2058, 256]), torch.Size([1, 2058, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.3974356651306152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.512237071990967  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2058, 256])
m.shape torch.Size([1736, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.5186171531677246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.5186171531677246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1736, 256]), torch.Size([1, 1736, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.5221939086914062  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.6431522369384766  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1736, 256])
m.shape torch.Size([1362, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.649351119995117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.649351119995117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1362, 256]), torch.Size([1, 1362, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.6520252227783203  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7649011611938477  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1362, 256])
m.shape torch.Size([1177, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7713990211486816  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7713990211486816  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7737574577331543  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.8920111656188965  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
m.shape torch.Size([1002, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.8985934257507324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.8985934257507324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1002, 256]), torch.Size([1, 1002, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.9005045890808105  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0117907524108887  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1002, 256])
m.shape torch.Size([827, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.017989158630371  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.017989158630371  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.019566535949707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.1231775283813477  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([719, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.1292996406555176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.1292996406555176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.1306710243225098  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.230954647064209  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([575, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.2363481521606445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.2363481521606445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.2374448776245117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.323324203491211  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([508, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3286352157592773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3286352157592773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.329604148864746  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.412604331970215  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([434, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4175429344177246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4175429344177246  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4183707237243652  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4945273399353027  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([377, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4991865158081055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4991865158081055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.499905586242676  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.5736446380615234  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([357, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.578474998474121  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.578474998474121  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.579155921936035  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.6527299880981445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([264, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.656449317932129  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.656449317932129  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.6569528579711914  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7168188095092773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([235, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.720407009124756  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.720407009124756  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.720855236053467  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7746424674987793  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([197, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7780814170837402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7780814170837402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7784571647644043  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8261771202087402  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([189, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8294410705566406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8294410705566406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.829801559448242  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8781070709228516  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([167, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8811373710632324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8811373710632324  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.881455898284912  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.926368236541748  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([127, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.928772449493408  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.928772449493408  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.9290146827697754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.964865207672119  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.9676833152770996  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.9676833152770996  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.9679484367370605  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.009042263031006  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([100, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.011120319366455  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.011120319366455  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.011311054229736  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.042210102081299  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([99, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.044398784637451  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.044398784637451  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.0445876121521  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.0764994621276855  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([1237, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.106128215789795  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.106128215789795  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.108602046966553  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.538276195526123  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.402795314788818  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.4069905281066895  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.410445213317871  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.406076908111572  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([23182, 40])
input nodes number: 40724
output nodes number: 23182
edges number: 162278
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.406420707702637  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.406421184539795  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.0534052848815918  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

pseudo mini batch 2 input nodes size: 93142
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04464006423950195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.04464006423950195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.08905363082885742  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.08922147750854492  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.05914020538330078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([93142, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06268024444580078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([5819, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.22936487197875977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.22936487197875977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 5819, 128]), torch.Size([1, 5819, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.23491430282592773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.28178930282592773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 5819, 128])
m.shape torch.Size([5851, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2845640182495117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2845640182495117  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 5851, 128]), torch.Size([1, 5851, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.2901439666748047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.37384605407714844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 5851, 128])
m.shape torch.Size([4901, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.3780655860900879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.3780655860900879  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4901, 128]), torch.Size([1, 4901, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.3831939697265625  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.4902687072753906  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4901, 128])
m.shape torch.Size([4078, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.49577808380126953  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.49577808380126953  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4078, 128]), torch.Size([1, 4078, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.5000743865966797  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6137943267822266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4078, 128])
m.shape torch.Size([3550, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6202278137207031  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6202278137207031  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3550, 128]), torch.Size([1, 3550, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.6240110397338867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7489604949951172  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3550, 128])
m.shape torch.Size([2890, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7548208236694336  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7548208236694336  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2890, 128]), torch.Size([1, 2890, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.7577953338623047  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8789310455322266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2890, 128])
m.shape torch.Size([2539, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8860278129577637  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8860278129577637  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2539, 128]), torch.Size([1, 2539, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.8884787559509277  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.011620044708252  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2539, 128])
m.shape torch.Size([2225, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.0188970565795898  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.0188970565795898  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2225, 128]), torch.Size([1, 2225, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.021155834197998  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.1451687812805176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2225, 128])
m.shape torch.Size([1961, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.1521615982055664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.1521615982055664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1961, 128]), torch.Size([1, 1961, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.154031753540039  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.2778701782226562  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1961, 128])
m.shape torch.Size([19605, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.3704190254211426  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.3704190254211426  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 19605, 128]), torch.Size([1, 19605, 128])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 1.389115810394287  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7249321937561035  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 19605, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.5804800987243652  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.6314244270324707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.682368755340576  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.631026268005371  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([53419, 256])
first layer input nodes number: 93142
first layer output nodes number: 53419
edges number: 332898
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.6830649375915527  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.734009265899658  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7467455863952637  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.7467455863952637  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([4221, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.888857364654541  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.888857364654541  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4221, 256]), torch.Size([1, 4221, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.8969082832336426  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.961315631866455  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4221, 256])
m.shape torch.Size([3540, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.964095115661621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.964095115661621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3540, 256]), torch.Size([1, 3540, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 2.970953941345215  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.072340965270996  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3540, 256])
m.shape torch.Size([2661, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0766377449035645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.0766377449035645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2661, 256]), torch.Size([1, 2661, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.081940174102783  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.19820499420166  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2661, 256])
m.shape torch.Size([2023, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.2026448249816895  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.2026448249816895  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2023, 256]), torch.Size([1, 2023, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.206587791442871  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3203349113464355  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2023, 256])
m.shape torch.Size([1713, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3266377449035645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3266377449035645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1713, 256]), torch.Size([1, 1713, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.3299641609191895  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4480977058410645  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1713, 256])
m.shape torch.Size([1220, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4534997940063477  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4534997940063477  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1220, 256]), torch.Size([1, 1220, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.4560093879699707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.5612711906433105  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1220, 256])
m.shape torch.Size([984, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.5660834312438965  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.5660834312438965  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 984, 256]), torch.Size([1, 984, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.567960262298584  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.6647772789001465  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 984, 256])
m.shape torch.Size([857, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.67042875289917  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.67042875289917  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.6720633506774902  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.7658181190490723  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([679, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.770874500274658  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.770874500274658  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.772169589996338  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.857435703277588  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([555, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8621225357055664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8621225357055664  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.8631811141967773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.93929386138916  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([459, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.943617343902588  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.943617343902588  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 3.944492816925049  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.014225482940674  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([389, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.018274307250977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.018274307250977  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.019016265869141  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.082832336425781  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([329, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.086572170257568  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.086572170257568  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.087199687957764  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.14623498916626  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([286, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.1497697830200195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.1497697830200195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.150315284729004  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.204419136047363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([234, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.207520008087158  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.207520008087158  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.207966327667236  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.255276203155518  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([218, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.258405685424805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.258405685424805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.258821487426758  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.305807113647461  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([179, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.308524131774902  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.308524131774902  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.308865547180176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.349835395812988  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([174, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.352674961090088  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.352674961090088  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.353006839752197  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.395155429840088  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([150, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.39772891998291  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.39772891998291  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.398015022277832  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.436352729797363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([131, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.438727855682373  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.438727855682373  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.4389777183532715  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.474208354949951  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([122, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.476546287536621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.476546287536621  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.476778984069824  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.511218070983887  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.51275110244751  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.51275110244751  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.512899875640869  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.535959720611572  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.5376763343811035  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.5376763343811035  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.537830829620361  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.562859058380127  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([88, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.564811706542969  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.564811706542969  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.564979553222656  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.593345642089844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([1144, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.6207499504089355  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.6207499504089355  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1144, 256]), torch.Size([1, 1144, 256])
----------------------------------------3
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.623354434967041  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 5.007631778717041  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1144, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.890510559082031  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.893886566162109  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.897241592407227  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.893697738647461  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([22515, 40])
input nodes number: 53419
output nodes number: 22515
edges number: 142160
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.8941850662231445  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 4.894185543060303  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.07003593444824219  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

pseudo mini batch 3 input nodes size: 93890
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.059061527252197266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.059061527252197266  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.10383176803588867  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.10400009155273438  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.059418678283691406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06598854064941406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06598854064941406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06598854064941406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([93890, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5447998046875 GB
    Memory Allocated: 0.06598854064941406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([3832, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.3284773826599121  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.3284773826599121  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3832, 128]), torch.Size([1, 3832, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.33213186264038086  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.36275196075439453  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3832, 128])
m.shape torch.Size([4050, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.3645792007446289  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.3645792007446289  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 4050, 128]), torch.Size([1, 4050, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.3690929412841797  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.42792701721191406  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 4050, 128])
m.shape torch.Size([3635, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.43097639083862305  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.43097639083862305  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3635, 128]), torch.Size([1, 3635, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.4349231719970703  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.5131149291992188  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3635, 128])
m.shape torch.Size([3336, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.5172796249389648  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.5172796249389648  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3336, 128]), torch.Size([1, 3336, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.5210685729980469  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.6167435646057129  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3336, 128])
m.shape torch.Size([3183, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.6231064796447754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.6231064796447754  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 3183, 128]), torch.Size([1, 3183, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.6261420249938965  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.7362289428710938  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 3183, 128])
m.shape torch.Size([2878, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.7429451942443848  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.7429451942443848  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2878, 128]), torch.Size([1, 2878, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.7457804679870605  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.8661856651306152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2878, 128])
m.shape torch.Size([2762, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.8744196891784668  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.8744196891784668  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2762, 128]), torch.Size([1, 2762, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 0.8770556449890137  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.009355068206787  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2762, 128])
m.shape torch.Size([2586, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.0179028511047363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.0179028511047363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2586, 128]), torch.Size([1, 2586, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.020369052886963  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.161221981048584  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2586, 128])
m.shape torch.Size([2449, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.1704988479614258  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.1704988479614258  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2449, 128]), torch.Size([1, 2449, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.1729087829589844  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.3290233612060547  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2449, 128])
m.shape torch.Size([40124, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.5192618370056152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.5192618370056152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 40124, 128]), torch.Size([1, 40124, 128])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 1.5583243370056152  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.283925533294678  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 40124, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.041534423828125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.107180595397949  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.172826766967773  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.106667518615723  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

torch.Size([68835, 256])
first layer input nodes number: 93890
first layer output nodes number: 68835
edges number: 532667
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.173528671264648  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.239174842834473  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.256370544433594  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.256370544433594  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

m.shape torch.Size([2543, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.50916051864624  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.50916051864624  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2543, 256]), torch.Size([1, 2543, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.514010906219482  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.552943706512451  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2543, 256])
m.shape torch.Size([2176, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.55540132522583  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.55540132522583  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 2176, 256]), torch.Size([1, 2176, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.559809684753418  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.624629020690918  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 2176, 256])
m.shape torch.Size([1703, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.62827205657959  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.62827205657959  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1703, 256]), torch.Size([1, 1703, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.631832599639893  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.704941272735596  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1703, 256])
m.shape torch.Size([1377, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.708569526672363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.708569526672363  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1377, 256]), torch.Size([1, 1377, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.711258888244629  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.789928436279297  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1377, 256])
m.shape torch.Size([1215, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.794172763824463  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.794172763824463  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 1215, 256]), torch.Size([1, 1215, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.797000408172607  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.885895252227783  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 1215, 256])
m.shape torch.Size([965, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.889865875244141  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.889865875244141  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.891706466674805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.971386909484863  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([800, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.975849151611328  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.975849151611328  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 4.977375030517578  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.053668975830078  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([680, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.05813455581665  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.05813455581665  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.059431552886963  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.133360385894775  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 680, 256])
m.shape torch.Size([663, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.139317989349365  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.139317989349365  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.14058256149292  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.22151517868042  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([598, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.226630687713623  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.226630687713623  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.227771282196045  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.308894634246826  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([524, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.313864707946777  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.313864707946777  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.314864158630371  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.392952919006348  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([502, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.398243427276611  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.398243427276611  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.399200916290283  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.48173189163208  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([424, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.486551284790039  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.486551284790039  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.487360000610352  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.562943458557129  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([362, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.567410469055176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.567410469055176  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.568100929260254  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.639100074768066  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([354, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.643858432769775  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.643858432769775  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.644533634185791  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.7183003425598145  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([328, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.723006725311279  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.723006725311279  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.723632335662842  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.796081066131592  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([304, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.80157470703125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.80157470703125  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.802154541015625  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.874847412109375  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([324, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.880163192749023  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.880163192749023  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.880781173706055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.959638595581055  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([288, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.9645891189575195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.9645891189575195  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 5.9651384353637695  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.040709018707275  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([281, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.045835971832275  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.045835971832275  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.046371936798096  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.122650623321533  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([259, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.127610206604004  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.127610206604004  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.128104209899902  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.203648567199707  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([200, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.207630634307861  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.207630634307861  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.208012104034424  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.267139911651611  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([197, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.271304130554199  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.271304130554199  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.271679878234863  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.332551002502441  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([202, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.33702278137207  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.33702278137207  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.337408065795898  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.402521133422852  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([5319, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.530134201049805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.530134201049805  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

 h.shape torch.Size([1, 5319, 256]), torch.Size([1, 5319, 256])[04:22:41] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 4 parts and get 1933829 edge cuts

----------------------------------------3
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 6.5407209396362305  GigaBytes
Max Memory Allocated: 8.36269235610962  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.327131271362305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 5319, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.094850540161133  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.098661422729492  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.102974891662598  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.098995685577393  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([22588, 40])
input nodes number: 68835
output nodes number: 22588
edges number: 259575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.100111961364746  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8006591796875 GB
    Memory Allocated: 8.100112438201904  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07684135437011719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07684135437011719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07684135437011719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04078954458236694 |0.0031605958938598633 |0.13298183679580688 |0.00010335445404052734 |0.095059335231781 |0.004671812057495117 |
----------------------------------------------------------pseudo_mini_loss sum 4.598102569580078
Total (block generation + training)time/epoch 23.88414716720581
Training time/epoch 1.1319713592529297
Training time without block to device /epoch 1.1193289756774902
Training time without total dataloading part /epoch 0.9172499179840088
load block tensor time/epoch 0.16315817832946777
block to device time/epoch 0.012642383575439453
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  498469
Number of first layer input nodes during this epoch:  299843
Number of first layer output nodes during this epoch:  198626
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07684087753295898  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018407344818115234
global_2_local spend time (sec) 0.04157662391662598
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004490852355957031
A = g.adjacency_matrix() spent  0.008992671966552734
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08161234855651855
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3068289756774902
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1873219013214111

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.235 seconds
Metis partitioning: 4.952 seconds
Split the graph: 3.377 seconds
Construct subgraphs: 0.036 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.614345073699951
23217
23192
22270
22262
total k batches seeds list generation spend  19.54698419570923
after graph partition
graph partition algorithm spend time 19.681102514266968
23217
23192
22270
22262
partition_len_list
[40503, 36598, 67663, 50439]
shared_neighbor_graph_partition_s0 selection method  spend 19.776146173477173
time for parepare:  0.017017841339111328
local_output_nid generation:  0.0032281875610351562
local_in_edges_tensor generation:  0.004657268524169922
mini_batch_src_global generation:  0.01504373550415039
r_  generation:  0.06092238426208496
local_output_nid generation:  0.004717111587524414
local_in_edges_tensor generation:  0.006098508834838867
mini_batch_src_global generation:  0.00845646858215332
r_  generation:  0.06641006469726562
local_output_nid generation:  0.0039272308349609375
local_in_edges_tensor generation:  0.005922555923461914
mini_batch_src_global generation:  0.009993314743041992
r_  generation:  0.08487153053283691
local_output_nid generation:  0.004275798797607422
local_in_edges_tensor generation:  0.004024028778076172
mini_batch_src_global generation:  0.006581306457519531
r_  generation:  0.05703473091125488
----------------------check_connections_block total spend ----------------------------- 0.44196176528930664
generate_one_block  0.08017778396606445
generate_one_block  0.08457756042480469
generate_one_block  0.12803292274475098
generate_one_block  0.07971477508544922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0481264591217041
gen group dst list time:  0.0074231624603271484
time for parepare:  0.022871732711791992
local_output_nid generation:  0.01620197296142578
local_in_edges_tensor generation:  0.01938343048095703
mini_batch_src_global generation:  0.007361412048339844
r_  generation:  0.09157443046569824
local_output_nid generation:  0.00999307632446289
local_in_edges_tensor generation:  0.006578207015991211
mini_batch_src_global generation:  0.009758710861206055
r_  generation:  0.0838918685913086
local_output_nid generation:  0.014324426651000977
local_in_edges_tensor generation:  0.01961684226989746
mini_batch_src_global generation:  0.018811464309692383
r_  generation:  0.19398832321166992
local_output_nid generation:  0.01966714859008789
local_in_edges_tensor generation:  0.012722969055175781
mini_batch_src_global generation:  0.01483297348022461
r_  generation:  0.12396979331970215
----------------------check_connections_block total spend ----------------------------- 0.797858476638794
generate_one_block  0.11583423614501953
generate_one_block  0.10504412651062012
generate_one_block  0.2394421100616455
generate_one_block  0.16415905952453613
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07684087753295898  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

connection checking time:  0.797858476638794
block generation total time  0.6244795322418213
average batch blocks generation time:  0.15611988306045532
block dataloader generation time/epoch 22.459674954414368
pseudo mini batch 0 input nodes size: 63961
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.05985260009765625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.05985260009765625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.09035158157348633  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.09052467346191406  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04558610916137695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.048520565032958984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.048520565032958984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.048520565032958984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([63961, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.048520565032958984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([4942, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.16515779495239258  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.16515779495239258  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4942, 128]), torch.Size([1, 4942, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.16987085342407227  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.20757532119750977  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4942, 128])
m.shape torch.Size([4956, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2099452018737793  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2099452018737793  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4956, 128]), torch.Size([1, 4956, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.21467161178588867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2874445915222168  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4956, 128])
m.shape torch.Size([4281, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.29217100143432617  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.29217100143432617  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4281, 128]), torch.Size([1, 4281, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2966122627258301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3880043029785156  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4281, 128])
m.shape torch.Size([3537, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3936781883239746  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3936781883239746  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3537, 128]), torch.Size([1, 3537, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3970513343811035  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4948725700378418  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3537, 128])
m.shape torch.Size([3066, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5004959106445312  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5004959106445312  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3066, 128]), torch.Size([1, 3066, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5035238265991211  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6113219261169434  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3066, 128])
m.shape torch.Size([2476, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6171698570251465  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6171698570251465  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2476, 128]), torch.Size([1, 2476, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6196198463439941  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7243452072143555  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2476, 128])
m.shape torch.Size([2116, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7302274703979492  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7302274703979492  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2116, 128]), torch.Size([1, 2116, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.732567310333252  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8360810279846191  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2116, 128])
m.shape torch.Size([1878, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8431439399719238  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8431439399719238  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1878, 128]), torch.Size([1, 1878, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8449349403381348  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9470219612121582  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1878, 128])
m.shape torch.Size([1533, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9527053833007812  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9527053833007812  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1533, 128]), torch.Size([1, 1533, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.954167366027832  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.047734260559082  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1533, 128])
m.shape torch.Size([11718, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1028790473937988  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1028790473937988  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 11718, 128]), torch.Size([1, 11718, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1140542030334473  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.9074902534484863  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 11718, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.809861660003662  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8484883308410645  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8871150016784668  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8481864929199219  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([40503, 256])
first layer input nodes number: 63961
first layer output nodes number: 40503
edges number: 232844
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8875937461853027  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.926220417022705  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.9364218711853027  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.9364218711853027  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([3636, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.095339298248291  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.095339298248291  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3636, 256]), torch.Size([1, 3636, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1022744178771973  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1577553749084473  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3636, 256])
m.shape torch.Size([3246, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1605277061462402  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1605277061462402  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3246, 256]), torch.Size([1, 3246, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.167090892791748  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.2628321647644043  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3246, 256])
m.shape torch.Size([2603, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.266284942626953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.266284942626953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2603, 256]), torch.Size([1, 2603, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.2714157104492188  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.38320255279541  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2603, 256])
m.shape torch.Size([2062, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.3883614540100098  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.3883614540100098  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2062, 256]), torch.Size([1, 2062, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.392336368560791  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.508922576904297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2062, 256])
m.shape torch.Size([1748, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5149598121643066  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5149598121643066  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5183820724487305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.6405458450317383  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
m.shape torch.Size([1359, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.6467161178588867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.6467161178588867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1359, 256]), torch.Size([1, 1359, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.6494626998901367  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7641820907592773  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1359, 256])
m.shape torch.Size([1170, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7703094482421875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7703094482421875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.772693634033203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.8915343284606934  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
m.shape torch.Size([986, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.89747953414917  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.89747953414917  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 986, 256]), torch.Size([1, 986, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.899360179901123  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.010261058807373  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 986, 256])
m.shape torch.Size([790, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.0161547660827637  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.0161547660827637  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.0176615715026855  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.114894390106201  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([709, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.120955467224121  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.120955467224121  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.122307777404785  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2203760147094727  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([553, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2255468368530273  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2255468368530273  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2266016006469727  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.311311721801758  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([499, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.316539764404297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.316539764404297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.3174915313720703  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.3999481201171875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([418, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4046950340270996  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4046950340270996  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4054923057556152  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.480384349822998  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([359, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.485203742980957  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.485203742980957  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4858884811401367  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5544748306274414  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([347, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5591354370117188  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5591354370117188  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5597972869873047  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6304101943969727  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([258, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.634047031402588  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.634047031402588  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6345391273498535  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6918463706970215  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([233, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6954073905944824  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6954073905944824  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6958518028259277  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7491812705993652  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([196, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.752350330352783  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.752350330352783  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7527241706848145  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.800201892852783  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([169, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8035707473754883  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8035707473754883  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8038930892944336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8470869064331055  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([163, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8500590324401855  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8500590324401855  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.850369930267334  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8942065238952637  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([135, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8967761993408203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8967761993408203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.89703369140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9351425170898438  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([124, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.937635898590088  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.937635898590088  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9378724098205566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.974531650543213  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([103, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9766907691955566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9766907691955566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9768872261047363  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.008713245391846  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([100, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.010921955108643  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.010921955108643  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.011112689971924  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.043346881866455  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([1251, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.073310852050781  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.073310852050781  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1251, 256]), torch.Size([1, 1251, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.07569694519043  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.505673408508301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1251, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.371418476104736  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.3748860359191895  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.378345966339111  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.3747053146362305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([23217, 40])
input nodes number: 40503
output nodes number: 23217
edges number: 160788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.3748369216918945  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.374837875366211  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.053954124450683594  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

pseudo mini batch 1 input nodes size: 51709
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04524374008178711  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04524374008178711  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07063436508178711  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07080745697021484  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04013538360595703  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04319000244140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04319000244140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04319000244140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([51709, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04319000244140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([3899, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.15398788452148438  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.15398788452148438  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3899, 128]), torch.Size([1, 3899, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.1577897071838379  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.18810033798217773  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3899, 128])
m.shape torch.Size([4026, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.1900806427001953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.1900806427001953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4026, 128]), torch.Size([1, 4026, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.19442319869995117  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2527499198913574  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4026, 128])
m.shape torch.Size([3581, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2567896842956543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2567896842956543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3581, 128]), torch.Size([1, 3581, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.26056861877441406  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3379554748535156  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3581, 128])
m.shape torch.Size([3093, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3421473503112793  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3421473503112793  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3093, 128]), torch.Size([1, 3093, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.34536314010620117  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4332394599914551  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3093, 128])
m.shape torch.Size([2627, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4376697540283203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4376697540283203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2627, 128]), torch.Size([1, 2627, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.44056224822998047  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5331940650939941  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2627, 128])
m.shape torch.Size([2296, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5385103225708008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5385103225708008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2296, 128]), torch.Size([1, 2296, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5408697128295898  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6406402587890625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2296, 128])
m.shape torch.Size([1897, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6458773612976074  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6458773612976074  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1897, 128]), torch.Size([1, 1897, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6476864814758301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7381424903869629  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1897, 128])
m.shape torch.Size([1725, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7438182830810547  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7438182830810547  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1725, 128]), torch.Size([1, 1725, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7454633712768555  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8394794464111328  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1725, 128])
m.shape torch.Size([1479, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8450274467468262  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8450274467468262  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1479, 128]), torch.Size([1, 1479, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.846437931060791  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.937746524810791  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1479, 128])
m.shape torch.Size([11975, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9941425323486328  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9941425323486328  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 11975, 128]), torch.Size([1, 11975, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0055627822875977  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8169975280761719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 11975, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.720491886138916  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.755648136138916  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.790550708770752  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.7551217079162598  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([36598, 256])
first layer input nodes number: 51709
first layer output nodes number: 36598
edges number: 222117
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.790937900543213  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8258404731750488  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8345661163330078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.8345661163330078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([2991, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0192999839782715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0192999839782715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2991, 256]), torch.Size([1, 2991, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0250048637390137  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.071502208709717  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2991, 256])
m.shape torch.Size([2773, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0739803314208984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0739803314208984  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2773, 256]), torch.Size([1, 2773, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.0794572830200195  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1587934494018555  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2773, 256])
m.shape torch.Size([2408, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1630921363830566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1630921363830566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2408, 256]), torch.Size([1, 2408, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.167893886566162  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.2698755264282227  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2408, 256])
m.shape torch.Size([1943, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.274919033050537  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.274919033050537  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1943, 256]), torch.Size([1, 1943, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.2790627479553223  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.392275810241699  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1943, 256])
m.shape torch.Size([1615, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.397487163543701  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.397487163543701  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1615, 256]), torch.Size([1, 1615, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.400569438934326  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.511838436126709  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1615, 256])
m.shape torch.Size([1355, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5181126594543457  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5181126594543457  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1355, 256]), torch.Size([1, 1355, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5209927558898926  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.633403778076172  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1355, 256])
m.shape torch.Size([1114, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.639606475830078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.639606475830078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1114, 256]), torch.Size([1, 1114, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.641925811767578  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7533974647521973  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1114, 256])
m.shape torch.Size([998, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7600088119506836  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7600088119506836  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7619123458862305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.8734846115112305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([863, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.879998207092285  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.879998207092285  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.8816442489624023  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.987362861633301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([755, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.9937963485717773  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.9937963485717773  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.995236396789551  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.098391532897949  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([681, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.1048717498779297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.1048717498779297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.106170654296875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2076597213745117  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([554, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.213399887084961  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.213399887084961  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.214456558227539  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.309368133544922  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([481, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.314849853515625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.314849853515625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.315767288208008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4004993438720703  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([438, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4059343338012695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4059343338012695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4067697525024414  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.489476203918457  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([365, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.494320869445801  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.494320869445801  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4950170516967773  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.56964111328125  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([324, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.574275493621826  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.574275493621826  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5748934745788574  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.645564556121826  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([320, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.650484085083008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.650484085083008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.651094436645508  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7252368927001953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([260, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7294301986694336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7294301986694336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.729926109313965  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.795269012451172  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([228, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.799184799194336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.799184799194336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.799619674682617  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8578929901123047  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([237, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.862231731414795  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.862231731414795  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8626837730407715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.926421642303467  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([220, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.931159019470215  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.931159019470215  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9315786361694336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9936819076538086  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([147, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9965806007385254  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9965806007385254  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.996860980987549  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.040319919586182  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([151, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.04351806640625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.04351806640625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.043806076049805  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.090463638305664  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([136, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.093456745147705  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.093456745147705  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.093716144561768  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.13755464553833  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([1835, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.181516647338867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.181516647338867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1835, 256]), torch.Size([1, 1835, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.185016632080078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.806281089782715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1835, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.645668983459473  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.649450302124023  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.65290641784668  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.648952007293701  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([23192, 40])
input nodes number: 36598
output nodes number: 23192
edges number: 187678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.649711608886719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.649712085723877  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.049420833587646484  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

pseudo mini batch 2 input nodes size: 92048
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04044914245605469  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.04044914245605469  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.08434104919433594  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.08450698852539062  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.05894327163696289  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06473398208618164  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06473398208618164  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06473398208618164  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([92048, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06473398208618164  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([3852, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.32240962982177734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.32240962982177734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3852, 128]), torch.Size([1, 3852, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.32693052291870117  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3577151298522949  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3852, 128])
m.shape torch.Size([4044, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.35955190658569336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.35955190658569336  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4044, 128]), torch.Size([1, 4044, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3640151023864746  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.42250871658325195  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4044, 128])
m.shape torch.Size([3618, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.42575597763061523  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.42575597763061523  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3618, 128]), torch.Size([1, 3618, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4294095039367676  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5070805549621582  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3618, 128])
m.shape torch.Size([3244, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.511542797088623  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.511542797088623  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3244, 128]), torch.Size([1, 3244, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5148148536682129  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6086640357971191  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3244, 128])
m.shape torch.Size([3064, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6134533882141113  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6134533882141113  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3064, 128]), torch.Size([1, 3064, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6163754463195801  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7247109413146973  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3064, 128])
m.shape torch.Size([2806, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7307400703430176  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7307400703430176  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2806, 128]), torch.Size([1, 2806, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.734076976776123  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8538174629211426  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2806, 128])
m.shape torch.Size([2648, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8613181114196777  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8613181114196777  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2648, 128]), torch.Size([1, 2648, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8639187812805176  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9929909706115723  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2648, 128])
m.shape torch.Size([2472, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0005669593811035  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0005669593811035  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2472, 128]), torch.Size([1, 2472, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0036721229553223  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.144014835357666  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2472, 128])
m.shape torch.Size([2389, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1524171829223633  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1524171829223633  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2389, 128]), torch.Size([1, 2389, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1554064750671387  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.3023381233215332  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2389, 128])
m.shape torch.Size([39526, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.4896736145019531  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.4896736145019531  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 39526, 128]), torch.Size([1, 39526, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.5287361145019531  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.220119476318359  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 39526, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9809622764587402  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.045490741729736  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.110019207000732  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.044986248016357  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([67663, 256])
first layer input nodes number: 92048
first layer output nodes number: 67663
edges number: 522999
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.1107072830200195  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.175235748291016  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.191368103027344  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.191368103027344  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([2624, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.438959121704102  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.438959121704102  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2624, 256]), torch.Size([1, 2624, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.444429397583008  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.48539924621582  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2624, 256])
m.shape torch.Size([2253, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.486995220184326  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.486995220184326  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2253, 256]), torch.Size([1, 2253, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.49200963973999  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.562375545501709  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2253, 256])
m.shape torch.Size([1714, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.564582824707031  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.564582824707031  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1714, 256]), torch.Size([1, 1714, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.568347930908203  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.640270233154297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1714, 256])
m.shape torch.Size([1303, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.643645286560059  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.643645286560059  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1303, 256]), torch.Size([1, 1303, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.646245956420898  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.720235824584961  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1303, 256])
m.shape torch.Size([1169, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.724361419677734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.724361419677734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.727032661437988  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.811918258666992  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([930, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.815661430358887  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.815661430358887  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 930, 256]), torch.Size([1, 930, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.817435264587402  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.894560813903809  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 930, 256])
m.shape torch.Size([764, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.8988142013549805  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.8988142013549805  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.900271415710449  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.973955154418945  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([635, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.978109359741211  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.978109359741211  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 635, 256]), torch.Size([1, 635, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.979320526123047  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.049245834350586  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 635, 256])
m.shape torch.Size([629, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.054081439971924  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.054081439971924  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.055281162261963  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.133070468902588  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([583, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.1380743980407715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.1380743980407715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.139186382293701  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.2185893058776855  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([497, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.223288059234619  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.223288059234619  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.224236011505127  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.300507068634033  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([483, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.305603981018066  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.305603981018066  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.306525230407715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.385724067687988  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([423, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.3905487060546875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.3905487060546875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.391355514526367  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.4676947593688965  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([357, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.472095489501953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.472095489501953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.472776412963867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.541990280151367  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([342, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.546580791473389  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.546580791473389  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.5472331047058105  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.616380214691162  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([324, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.621273040771484  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.621273040771484  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.621891021728516  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.691783905029297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([298, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.696344375610352  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.696344375610352  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.69691276550293  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.766490936279297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([316, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.771673679351807  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.771673679351807  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.772276401519775  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.849607944488525  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([283, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.854475021362305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.854475021362305  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.855014801025391  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.9280595779418945  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([261, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.932806968688965  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.932806968688965  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 5.933304786682129  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.005942344665527  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([260, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.010941505432129  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.010941505432129  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.01143741607666  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.086640357971191  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([192, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.090452194213867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.090452194213867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.090818405151367  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.147581100463867  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([197, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.151752948760986  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.151752948760986  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.15212869644165  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.2129998207092285  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([194, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.217287063598633  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.217287063598633  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.217657089233398  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.280191421508789  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([5239, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.405889987945557  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.405889987945557  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 5239, 256]), torch.Size([1, 5239, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 6.415882587432861  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 8.188547611236572  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 5239, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.96121072769165  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.964663028717041  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.967981815338135  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.9643635749816895  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([22270, 40])
input nodes number: 67663
output nodes number: 22270
edges number: 254099
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.964704990386963  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 7.964705467224121  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.07456684112548828  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

pseudo mini batch 3 input nodes size: 88333
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.058614253997802734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.058614253997802734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.10073471069335938  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.10090065002441406  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.056842803955078125  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06024169921875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06024169921875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06024169921875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([88333, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06024169921875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([5589, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.21706676483154297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.21706676483154297  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 5589, 128]), torch.Size([1, 5589, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.2223968505859375  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.26503753662109375  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 5589, 128])
m.shape torch.Size([5460, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.267702579498291  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.267702579498291  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 5460, 128]), torch.Size([1, 5460, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.27290964126586914  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.351015567779541  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 5460, 128])
m.shape torch.Size([4658, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3550753593444824  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.3550753593444824  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4658, 128]), torch.Size([1, 4658, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.35975027084350586  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.457944393157959  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4658, 128])
m.shape torch.Size([3838, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4630436897277832  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4630436897277832  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3838, 128]), torch.Size([1, 3838, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4671363830566406  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5732822418212891  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3838, 128])
m.shape torch.Size([3326, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5793819427490234  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5793819427490234  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3326, 128]), torch.Size([1, 3326, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5829067230224609  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7003240585327148  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3326, 128])
m.shape torch.Size([2703, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7064714431762695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7064714431762695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2703, 128]), torch.Size([1, 2703, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.7090845108032227  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8218498229980469  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2703, 128])
m.shape torch.Size([2321, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.82830810546875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.82830810546875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2321, 128]), torch.Size([1, 2321, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8307685852050781  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9470672607421875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2321, 128])
m.shape torch.Size([2079, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9538912773132324  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9538912773132324  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2079, 128]), torch.Size([1, 2079, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.9560084342956543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0724239349365234  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2079, 128])
m.shape torch.Size([1785, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0790929794311523  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0790929794311523  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1785, 128]), torch.Size([1, 1785, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0807952880859375  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.1902732849121094  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1785, 128])
m.shape torch.Size([18680, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.2784953117370605  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.2784953117370605  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 18680, 128]), torch.Size([1, 18680, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.296720027923584  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5620932579040527  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 18680, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.4255895614624023  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.473691940307617  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.521794319152832  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.473315715789795  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([50439, 256])
first layer input nodes number: 88333
first layer output nodes number: 50439
edges number: 314427
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.5224547386169434  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.570557117462158  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.582582950592041  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.582582950592041  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

m.shape torch.Size([4177, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7239303588867188  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7239303588867188  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 4177, 256]), torch.Size([1, 4177, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.7318973541259766  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.795633316040039  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 4177, 256])
m.shape torch.Size([3434, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.798567771911621  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.798567771911621  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 3434, 256]), torch.Size([1, 3434, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.80576229095459  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.904332160949707  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 3434, 256])
m.shape torch.Size([2552, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.9086198806762695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.9086198806762695  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2552, 256]), torch.Size([1, 2552, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.9136362075805664  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.0227203369140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2552, 256])
m.shape torch.Size([2012, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.027960777282715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.027960777282715  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 2012, 256]), torch.Size([1, 2012, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.0323028564453125  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.1468286514282227  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 2012, 256])
m.shape torch.Size([1690, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.152688503265381  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.152688503265381  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1690, 256]), torch.Size([1, 1690, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.1561217308044434  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2779765129089355  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1690, 256])
m.shape torch.Size([1224, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.282773017883301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.282773017883301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1224, 256]), torch.Size([1, 1224, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.2852487564086914  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.391955852508545  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1224, 256])
m.shape torch.Size([997, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.3974967002868652  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.3974967002868652  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 997, 256]), torch.Size([1, 997, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.3993983268737793  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.4967799186706543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 997, 256])
m.shape torch.Size([853, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5023880004882812  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5023880004882812  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5040149688720703  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.5970659255981445  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([694, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6022558212280273  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6022558212280273  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 694, 256]), torch.Size([1, 694, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.603579521179199  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.688633918762207  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 694, 256])
m.shape torch.Size([552, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6932778358459473  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6932778358459473  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.6943306922912598  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7702431678771973  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([472, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.774707317352295  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.774707317352295  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.7756075859069824  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.846004009246826  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([401, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8501791954040527  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8501791954040527  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.8509440422058105  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.916318416595459  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([334, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.920109272003174  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.920109272003174  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.920746326446533  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9806981086730957  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([280, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.984147548675537  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.984147548675537  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 3.9846816062927246  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.038640022277832  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([235, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.04176139831543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.04176139831543  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.042209625244141  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.0897216796875  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([205, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.092650413513184  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.092650413513184  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.09304141998291  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.137225151062012  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([179, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.139954566955566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.139954566955566  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.14029598236084  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.181265830993652  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([176, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.184140205383301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.184140205383301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.184475898742676  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.227108955383301  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([156, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.229790210723877  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.229790210723877  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.230087757110596  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.269958972930908  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([146, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.272616863250732  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.272616863250732  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.272895336151123  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.312160015106201  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.314079761505127  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.314079761505127  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.314274311065674  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.343067646026611  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.344936847686768  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.344936847686768  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.345114231109619  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.372608661651611  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.374309539794922  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.374309539794922  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.374439239501953  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.395450592041016  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([95, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.397577285766602  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.397577285766602  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.397758483886719  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.428380966186523  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([1135, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.455562591552734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.455562591552734  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

 h.shape torch.Size([1, 1135, 256]), torch.Size([1, 1135, 256])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.458524703979492  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.841414451599121  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

rst.shape  torch.Size([1, 1135, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.72459077835083  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.728574275970459  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.731891632080078  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.7277421951293945  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

torch.Size([22262, 40])
input nodes number: 50439
output nodes number: 22262
edges number: 141685
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.7281494140625  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 4.728149890899658  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes
Using backend: pytorch

-----------------------------------------after loss backward
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06659793853759766  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06659793853759766  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.06659793853759766  GigaBytes
Max Memory Allocated: 8.453946113586426  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04817557334899902 |0.00400012731552124 |0.13292109966278076 |9.948015213012695e-05 |0.0878644585609436 |0.0049245357513427734 |
----------------------------------------------------------pseudo_mini_loss sum 3.7100539207458496
Total (block generation + training)time/epoch 23.60045862197876
Training time/epoch 1.1488184928894043
Training time without block to device /epoch 1.1328179836273193
Training time without total dataloading part /epoch 0.8884646892547607
load block tensor time/epoch 0.1927022933959961
block to device time/epoch 0.01600050926208496
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  491254
Number of first layer input nodes during this epoch:  296051
Number of first layer output nodes during this epoch:  195203
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
