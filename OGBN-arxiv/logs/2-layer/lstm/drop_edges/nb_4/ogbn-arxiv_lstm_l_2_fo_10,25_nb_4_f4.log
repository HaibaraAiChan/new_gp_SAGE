[04:23:14] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28387380 edges into 4 parts and get 1918587 edge cuts
main start at this time 1651551773.1625385
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03549456596374512
global_2_local spend time (sec) 0.03508472442626953
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0049054622650146484
A = g.adjacency_matrix() spent  0.007578849792480469
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1035468578338623
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3522071838378906
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1939125061035156

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366})
Convert a graph into a bidirected graph: 1.217 seconds
Metis partitioning: 4.884 seconds
Split the graph: 3.198 seconds
Construct subgraphs: 0.091 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.403402328491211
23144
22770
22589
22438
total k batches seeds list generation spend  20.192536115646362
after graph partition
graph partition algorithm spend time 20.282774925231934
23144
22770
22589
22438
partition_len_list
[39343, 35114, 68125, 53127]
shared_neighbor_graph_partition_s0 selection method  spend 20.365925550460815
time for parepare:  0.017544269561767578
local_output_nid generation:  0.0028340816497802734
local_in_edges_tensor generation:  0.0035746097564697266
mini_batch_src_global generation:  0.004903316497802734
r_  generation:  0.05294084548950195
local_output_nid generation:  0.0036864280700683594
local_in_edges_tensor generation:  0.0043528079986572266
mini_batch_src_global generation:  0.007201671600341797
r_  generation:  0.06166982650756836
local_output_nid generation:  0.0036454200744628906
local_in_edges_tensor generation:  0.005789279937744141
mini_batch_src_global generation:  0.01111292839050293
r_  generation:  0.08612585067749023
local_output_nid generation:  0.003974199295043945
local_in_edges_tensor generation:  0.003522634506225586
mini_batch_src_global generation:  0.00699162483215332
r_  generation:  0.05937385559082031
----------------------check_connections_block total spend ----------------------------- 0.40979838371276855
generate_one_block  0.0665125846862793
generate_one_block  0.07814764976501465
generate_one_block  0.12958240509033203
generate_one_block  0.07484078407287598
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.07532310485839844
gen group dst list time:  0.0052852630615234375
time for parepare:  0.021912574768066406
local_output_nid generation:  0.005756855010986328
local_in_edges_tensor generation:  0.02534770965576172
mini_batch_src_global generation:  0.006646394729614258
r_  generation:  0.08084321022033691
local_output_nid generation:  0.007033824920654297
local_in_edges_tensor generation:  0.006566524505615234
mini_batch_src_global generation:  0.007996797561645508
r_  generation:  0.07639765739440918
local_output_nid generation:  0.011167287826538086
local_in_edges_tensor generation:  0.020946741104125977
mini_batch_src_global generation:  0.028968334197998047
r_  generation:  0.18598079681396484
local_output_nid generation:  0.012468099594116211
local_in_edges_tensor generation:  0.0191650390625
mini_batch_src_global generation:  0.015204906463623047
r_  generation:  0.14058876037597656
----------------------check_connections_block total spend ----------------------------- 0.7857592105865479
generate_one_block  0.11174583435058594
generate_one_block  0.0935370922088623
generate_one_block  0.2431025505065918
generate_one_block  0.21270298957824707
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7857592105865479
block generation total time  0.6610884666442871
average batch blocks generation time:  0.16527211666107178
pseudo mini batch 0 input nodes size: 58784
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.030807971954345703  GigaBytes
Max Memory Allocated: 0.030807971954345703  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.030980587005615234  GigaBytes
Max Memory Allocated: 0.030980587005615234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.030980587005615234  GigaBytes
Max Memory Allocated: 0.030980587005615234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03371572494506836  GigaBytes
Max Memory Allocated: 0.03371572494506836  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03371572494506836  GigaBytes
Max Memory Allocated: 0.03371572494506836  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03371572494506836  GigaBytes
Max Memory Allocated: 0.03371572494506836  GigaBytes

torch.Size([58784, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03371572494506836  GigaBytes
Max Memory Allocated: 0.03371572494506836  GigaBytes

m.shape torch.Size([5075, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14274168014526367  GigaBytes
Max Memory Allocated: 0.1433258056640625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14274168014526367  GigaBytes
Max Memory Allocated: 0.1433258056640625  GigaBytes

 h.shape torch.Size([1, 5075, 128]), torch.Size([1, 5075, 128])
----------------------------------------3
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1475815773010254  GigaBytes
Max Memory Allocated: 0.1475815773010254  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.1866440773010254  GigaBytes
Max Memory Allocated: 0.18906402587890625  GigaBytes

rst.shape  torch.Size([1, 5075, 128])
m.shape torch.Size([5199, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18918228149414062  GigaBytes
Max Memory Allocated: 0.1892991065979004  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18918228149414062  GigaBytes
Max Memory Allocated: 0.1892991065979004  GigaBytes

 h.shape torch.Size([1, 5199, 128]), torch.Size([1, 5199, 128])
----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.19414043426513672  GigaBytes
Max Memory Allocated: 0.19414043426513672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2685127258300781  GigaBytes
Max Memory Allocated: 0.2734708786010742  GigaBytes

rst.shape  torch.Size([1, 5199, 128])
m.shape torch.Size([4443, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.27316951751708984  GigaBytes
Max Memory Allocated: 0.2734708786010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.27316951751708984  GigaBytes
Max Memory Allocated: 0.2734708786010742  GigaBytes

 h.shape torch.Size([1, 4443, 128]), torch.Size([1, 4443, 128])
----------------------------------------3
 Nvidia-smi: 1.4842529296875 GB
    Memory Allocated: 0.2777080535888672  GigaBytes
Max Memory Allocated: 0.2777080535888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.37354135513305664  GigaBytes
Max Memory Allocated: 0.3798971176147461  GigaBytes

rst.shape  torch.Size([1, 4443, 128])
m.shape torch.Size([3652, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3783884048461914  GigaBytes
Max Memory Allocated: 0.3798971176147461  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.3783884048461914  GigaBytes
Max Memory Allocated: 0.3798971176147461  GigaBytes

 h.shape torch.Size([1, 3652, 128]), torch.Size([1, 3652, 128])
----------------------------------------3
 Nvidia-smi: 1.5819091796875 GB
    Memory Allocated: 0.38199329376220703  GigaBytes
Max Memory Allocated: 0.38199329376220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.48364830017089844  GigaBytes
Max Memory Allocated: 0.4906139373779297  GigaBytes

rst.shape  torch.Size([1, 3652, 128])
m.shape torch.Size([3047, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.48879575729370117  GigaBytes
Max Memory Allocated: 0.4906139373779297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.48879575729370117  GigaBytes
Max Memory Allocated: 0.4906139373779297  GigaBytes

 h.shape torch.Size([1, 3047, 128]), torch.Size([1, 3047, 128])
----------------------------------------3
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.49242162704467773  GigaBytes
Max Memory Allocated: 0.49242162704467773  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.601201057434082  GigaBytes
Max Memory Allocated: 0.6084656715393066  GigaBytes

rst.shape  torch.Size([1, 3047, 128])
m.shape torch.Size([2440, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.6067290306091309  GigaBytes
Max Memory Allocated: 0.6084656715393066  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.6067290306091309  GigaBytes
Max Memory Allocated: 0.6084656715393066  GigaBytes

 h.shape torch.Size([1, 2440, 128]), torch.Size([1, 2440, 128])
----------------------------------------3
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.6092114448547363  GigaBytes
Max Memory Allocated: 0.6092114448547363  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7161388397216797  GigaBytes
Max Memory Allocated: 0.7231197357177734  GigaBytes

rst.shape  torch.Size([1, 2440, 128])
m.shape torch.Size([2061, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7218546867370605  GigaBytes
Max Memory Allocated: 0.7231197357177734  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7218546867370605  GigaBytes
Max Memory Allocated: 0.7231197357177734  GigaBytes

 h.shape torch.Size([1, 2061, 128]), torch.Size([1, 2061, 128])
----------------------------------------3
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7241024971008301  GigaBytes
Max Memory Allocated: 0.7241024971008301  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8262887001037598  GigaBytes
Max Memory Allocated: 0.8331680297851562  GigaBytes

rst.shape  torch.Size([1, 2061, 128])
m.shape torch.Size([1824, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8314051628112793  GigaBytes
Max Memory Allocated: 0.8331680297851562  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0311279296875 GB
    Memory Allocated: 0.8314051628112793  GigaBytes
Max Memory Allocated: 0.8331680297851562  GigaBytes

 h.shape torch.Size([1, 1824, 128]), torch.Size([1, 1824, 128])
----------------------------------------3
 Nvidia-smi: 2.0330810546875 GB
    Memory Allocated: 0.8331446647644043  GigaBytes
Max Memory Allocated: 0.8331680297851562  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.9322962760925293  GigaBytes
Max Memory Allocated: 0.9392542839050293  GigaBytes

rst.shape  torch.Size([1, 1824, 128])
m.shape torch.Size([1507, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.9378938674926758  GigaBytes
Max Memory Allocated: 0.9392542839050293  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.9378938674926758  GigaBytes
Max Memory Allocated: 0.9392542839050293  GigaBytes

 h.shape torch.Size([1, 1507, 128]), torch.Size([1, 1507, 128])
----------------------------------------3
 Nvidia-smi: 2.1483154296875 GB
    Memory Allocated: 0.9393310546875  GigaBytes
Max Memory Allocated: 0.9393310546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 1.0316681861877441  GigaBytes
Max Memory Allocated: 1.0381355285644531  GigaBytes

rst.shape  torch.Size([1, 1507, 128])
m.shape torch.Size([10095, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.079777717590332  GigaBytes
Max Memory Allocated: 1.0809063911437988  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.079777717590332  GigaBytes
Max Memory Allocated: 1.0809063911437988  GigaBytes

 h.shape torch.Size([1, 10095, 128]), torch.Size([1, 10095, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0894050598144531  GigaBytes
Max Memory Allocated: 1.0894050598144531  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0682373046875 GB
    Memory Allocated: 1.7826261520385742  GigaBytes
Max Memory Allocated: 1.8314542770385742  GigaBytes

rst.shape  torch.Size([1, 10095, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.0877685546875 GB
    Memory Allocated: 1.6923460960388184  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.0877685546875 GB
    Memory Allocated: 1.7298665046691895  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.7673869132995605  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.7295732498168945  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

torch.Size([39343, 256])
first layer input nodes number: 58784
first layer output nodes number: 39343
edges number: 216817
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.767827033996582  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1268310546875 GB
    Memory Allocated: 1.8053474426269531  GigaBytes
Max Memory Allocated: 1.8348069190979004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1658935546875 GB
    Memory Allocated: 1.814727783203125  GigaBytes
Max Memory Allocated: 1.852248191833496  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1658935546875 GB
    Memory Allocated: 1.814727783203125  GigaBytes
Max Memory Allocated: 1.852248191833496  GigaBytes

m.shape torch.Size([3761, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 1.9637765884399414  GigaBytes
Max Memory Allocated: 1.9637908935546875  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 1.9637765884399414  GigaBytes
Max Memory Allocated: 1.9637908935546875  GigaBytes

 h.shape torch.Size([1, 3761, 256]), torch.Size([1, 3761, 256])
----------------------------------------3
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 1.9709501266479492  GigaBytes
Max Memory Allocated: 1.9709501266479492  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 2.0283384323120117  GigaBytes
Max Memory Allocated: 2.0319252014160156  GigaBytes

rst.shape  torch.Size([1, 3761, 256])
m.shape torch.Size([3415, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 2.0319762229919434  GigaBytes
Max Memory Allocated: 2.0320019721984863  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 2.0319762229919434  GigaBytes
Max Memory Allocated: 2.0320019721984863  GigaBytes

 h.shape torch.Size([1, 3415, 256]), torch.Size([1, 3415, 256])
----------------------------------------3
 Nvidia-smi: 3.3104248046875 GB
    Memory Allocated: 2.038489818572998  GigaBytes
Max Memory Allocated: 2.038489818572998  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4100341796875 GB
    Memory Allocated: 2.1381278038024902  GigaBytes
Max Memory Allocated: 2.144641399383545  GigaBytes

rst.shape  torch.Size([1, 3415, 256])
m.shape torch.Size([2714, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4100341796875 GB
    Memory Allocated: 2.1426968574523926  GigaBytes
Max Memory Allocated: 2.144641399383545  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4100341796875 GB
    Memory Allocated: 2.1426968574523926  GigaBytes
Max Memory Allocated: 2.144641399383545  GigaBytes

 h.shape torch.Size([1, 2714, 256]), torch.Size([1, 2714, 256])
----------------------------------------3
 Nvidia-smi: 3.4100341796875 GB
    Memory Allocated: 2.148921489715576  GigaBytes
Max Memory Allocated: 2.148921489715576  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 2.2636265754699707  GigaBytes
Max Memory Allocated: 2.2713913917541504  GigaBytes

rst.shape  torch.Size([1, 2714, 256])
m.shape torch.Size([2150, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 2.2693042755126953  GigaBytes
Max Memory Allocated: 2.2713913917541504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 2.2693042755126953  GigaBytes
Max Memory Allocated: 2.2713913917541504  GigaBytes

 h.shape torch.Size([1, 2150, 256]), torch.Size([1, 2150, 256])
----------------------------------------3
 Nvidia-smi: 3.5233154296875 GB
    Memory Allocated: 2.2735767364501953  GigaBytes
Max Memory Allocated: 2.2735767364501953  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.394674777984619  GigaBytes
Max Memory Allocated: 2.402876377105713  GigaBytes

rst.shape  torch.Size([1, 2150, 256])
m.shape torch.Size([1775, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.400784969329834  GigaBytes
Max Memory Allocated: 2.402876377105713  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.400784969329834  GigaBytes
Max Memory Allocated: 2.402876377105713  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 2.4043679237365723  GigaBytes
Max Memory Allocated: 2.4043679237365723  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8162841796875 GB
    Memory Allocated: 2.528775215148926  GigaBytes
Max Memory Allocated: 2.5372390747070312  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1385, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8162841796875 GB
    Memory Allocated: 2.535069465637207  GigaBytes
Max Memory Allocated: 2.5372390747070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8162841796875 GB
    Memory Allocated: 2.535069465637207  GigaBytes
Max Memory Allocated: 2.5372390747070312  GigaBytes

 h.shape torch.Size([1, 1385, 256]), torch.Size([1, 1385, 256])
----------------------------------------3
 Nvidia-smi: 3.8162841796875 GB
    Memory Allocated: 2.5378007888793945  GigaBytes
Max Memory Allocated: 2.5378007888793945  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6567282676696777  GigaBytes
Max Memory Allocated: 2.6646533012390137  GigaBytes

rst.shape  torch.Size([1, 1385, 256])
m.shape torch.Size([1139, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6629562377929688  GigaBytes
Max Memory Allocated: 2.6646533012390137  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.6629562377929688  GigaBytes
Max Memory Allocated: 2.6646533012390137  GigaBytes

 h.shape torch.Size([1, 1139, 256]), torch.Size([1, 1139, 256])
----------------------------------------3
 Nvidia-smi: 3.8944091796875 GB
    Memory Allocated: 2.665437698364258  GigaBytes
Max Memory Allocated: 2.665437698364258  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 2.777827262878418  GigaBytes
Max Memory Allocated: 2.785430908203125  GigaBytes

rst.shape  torch.Size([1, 1139, 256])
m.shape torch.Size([974, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 2.7841033935546875  GigaBytes
Max Memory Allocated: 2.785430908203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 2.7841033935546875  GigaBytes
Max Memory Allocated: 2.785430908203125  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 4.0115966796875 GB
    Memory Allocated: 2.785961151123047  GigaBytes
Max Memory Allocated: 2.785961151123047  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.8966217041015625  GigaBytes
Max Memory Allocated: 2.904052734375  GigaBytes

rst.shape  torch.Size([1, 974, 256])
m.shape torch.Size([790, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.90252685546875  GigaBytes
Max Memory Allocated: 2.904052734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1248779296875 GB
    Memory Allocated: 2.90252685546875  GigaBytes
Max Memory Allocated: 2.904052734375  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.904033660888672  GigaBytes
Max Memory Allocated: 2.904052734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 3.002471923828125  GigaBytes
Max Memory Allocated: 3.00994873046875  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([696, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 3.009247303009033  GigaBytes
Max Memory Allocated: 3.00994873046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 3.009247303009033  GigaBytes
Max Memory Allocated: 3.00994873046875  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 4.2244873046875 GB
    Memory Allocated: 3.0105748176574707  GigaBytes
Max Memory Allocated: 3.0105748176574707  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.1089653968811035  GigaBytes
Max Memory Allocated: 3.115602970123291  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([531, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.1139159202575684  GigaBytes
Max Memory Allocated: 3.115602970123291  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.1139159202575684  GigaBytes
Max Memory Allocated: 3.115602970123291  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.114928722381592  GigaBytes
Max Memory Allocated: 3.115602970123291  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 3.19392728805542  GigaBytes
Max Memory Allocated: 3.199497699737549  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([457, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 3.1986918449401855  GigaBytes
Max Memory Allocated: 3.199497699737549  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 3.1986918449401855  GigaBytes
Max Memory Allocated: 3.199497699737549  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.4256591796875 GB
    Memory Allocated: 3.199563503265381  GigaBytes
Max Memory Allocated: 3.199563503265381  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 3.2744364738464355  GigaBytes
Max Memory Allocated: 3.2796664237976074  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([388, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 3.278848648071289  GigaBytes
Max Memory Allocated: 3.2796664237976074  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 3.278848648071289  GigaBytes
Max Memory Allocated: 3.2796664237976074  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 4.4920654296875 GB
    Memory Allocated: 3.2795886993408203  GigaBytes
Max Memory Allocated: 3.2796664237976074  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5819091796875 GB
    Memory Allocated: 3.34829044342041  GigaBytes
Max Memory Allocated: 3.3531007766723633  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([336, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5819091796875 GB
    Memory Allocated: 3.3524417877197266  GigaBytes
Max Memory Allocated: 3.3531007766723633  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5819091796875 GB
    Memory Allocated: 3.3524417877197266  GigaBytes
Max Memory Allocated: 3.3531007766723633  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 4.5819091796875 GB
    Memory Allocated: 3.3530826568603516  GigaBytes
Max Memory Allocated: 3.3531007766723633  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.419027328491211  GigaBytes
Max Memory Allocated: 3.423513412475586  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([325, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.4233927726745605  GigaBytes
Max Memory Allocated: 3.423513412475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.4233927726745605  GigaBytes
Max Memory Allocated: 3.423513412475586  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.6307373046875 GB
    Memory Allocated: 3.4240126609802246  GigaBytes
Max Memory Allocated: 3.4240126609802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.4924988746643066  GigaBytes
Max Memory Allocated: 3.497152805328369  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([233, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.495772361755371  GigaBytes
Max Memory Allocated: 3.497152805328369  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.495772361755371  GigaBytes
Max Memory Allocated: 3.497152805328369  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.4962167739868164  GigaBytes
Max Memory Allocated: 3.497152805328369  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.5464353561401367  GigaBytes
Max Memory Allocated: 3.549990653991699  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([211, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.549661159515381  GigaBytes
Max Memory Allocated: 3.549990653991699  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.549661159515381  GigaBytes
Max Memory Allocated: 3.549990653991699  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 4.7733154296875 GB
    Memory Allocated: 3.5500636100769043  GigaBytes
Max Memory Allocated: 3.5500636100769043  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8240966796875 GB
    Memory Allocated: 3.598357677459717  GigaBytes
Max Memory Allocated: 3.601778507232666  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([179, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8240966796875 GB
    Memory Allocated: 3.6012535095214844  GigaBytes
Max Memory Allocated: 3.601778507232666  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8240966796875 GB
    Memory Allocated: 3.6012535095214844  GigaBytes
Max Memory Allocated: 3.601778507232666  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 4.8240966796875 GB
    Memory Allocated: 3.601594924926758  GigaBytes
Max Memory Allocated: 3.601778507232666  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8768310546875 GB
    Memory Allocated: 3.6449546813964844  GigaBytes
Max Memory Allocated: 3.6480274200439453  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([170, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8768310546875 GB
    Memory Allocated: 3.647888660430908  GigaBytes
Max Memory Allocated: 3.6480274200439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8768310546875 GB
    Memory Allocated: 3.647888660430908  GigaBytes
Max Memory Allocated: 3.6480274200439453  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 4.8768310546875 GB
    Memory Allocated: 3.6482129096984863  GigaBytes
Max Memory Allocated: 3.6482129096984863  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9139404296875 GB
    Memory Allocated: 3.691662311553955  GigaBytes
Max Memory Allocated: 3.6947426795959473  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([136, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.9139404296875 GB
    Memory Allocated: 3.6941146850585938  GigaBytes
Max Memory Allocated: 3.6947426795959473  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9139404296875 GB
    Memory Allocated: 3.6941146850585938  GigaBytes
Max Memory Allocated: 3.6947426795959473  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 4.9139404296875 GB
    Memory Allocated: 3.6943740844726562  GigaBytes
Max Memory Allocated: 3.6947426795959473  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9471435546875 GB
    Memory Allocated: 3.7309494018554688  GigaBytes
Max Memory Allocated: 3.7335433959960938  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([121, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.9471435546875 GB
    Memory Allocated: 3.733262062072754  GigaBytes
Max Memory Allocated: 3.7335433959960938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9471435546875 GB
    Memory Allocated: 3.733262062072754  GigaBytes
Max Memory Allocated: 3.7335433959960938  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 4.9471435546875 GB
    Memory Allocated: 3.733492851257324  GigaBytes
Max Memory Allocated: 3.7335433959960938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 3.7676496505737305  GigaBytes
Max Memory Allocated: 3.7700729370117188  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 3.769796848297119  GigaBytes
Max Memory Allocated: 3.7700729370117188  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 3.769796848297119  GigaBytes
Max Memory Allocated: 3.7700729370117188  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 4.9783935546875 GB
    Memory Allocated: 3.77000093460083  GigaBytes
Max Memory Allocated: 3.7700729370117188  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0096435546875 GB
    Memory Allocated: 3.8016343116760254  GigaBytes
Max Memory Allocated: 3.8043293952941895  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([101, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0096435546875 GB
    Memory Allocated: 3.8042449951171875  GigaBytes
Max Memory Allocated: 3.8043293952941895  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0096435546875 GB
    Memory Allocated: 3.8042449951171875  GigaBytes
Max Memory Allocated: 3.8043293952941895  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.0096435546875 GB
    Memory Allocated: 3.8044376373291016  GigaBytes
Max Memory Allocated: 3.8044376373291016  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0584716796875 GB
    Memory Allocated: 3.8356456756591797  GigaBytes
Max Memory Allocated: 3.8378610610961914  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([86, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0584716796875 GB
    Memory Allocated: 3.837533473968506  GigaBytes
Max Memory Allocated: 3.8378610610961914  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0584716796875 GB
    Memory Allocated: 3.837533473968506  GigaBytes
Max Memory Allocated: 3.8378610610961914  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 5.0584716796875 GB
    Memory Allocated: 3.8376975059509277  GigaBytes
Max Memory Allocated: 3.8378610610961914  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0858154296875 GB
    Memory Allocated: 3.8654189109802246  GigaBytes
Max Memory Allocated: 3.867387294769287  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([964, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.8889541625976562  GigaBytes
Max Memory Allocated: 3.8890442848205566  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.8889541625976562  GigaBytes
Max Memory Allocated: 3.8890442848205566  GigaBytes

 h.shape torch.Size([1, 964, 256]), torch.Size([1, 964, 256])
----------------------------------------3
 Nvidia-smi: 5.1112060546875 GB
    Memory Allocated: 3.8907928466796875  GigaBytes
Max Memory Allocated: 3.8907928466796875  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4783935546875 GB
    Memory Allocated: 4.2144012451171875  GigaBytes
Max Memory Allocated: 4.2378387451171875  GigaBytes

rst.shape  torch.Size([1, 964, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.091348171234131  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.094934940338135  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.098383903503418  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.0946245193481445  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

torch.Size([23144, 40])
input nodes number: 39343
output nodes number: 23144
edges number: 150170
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.098539352416992  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.098540306091309  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.045372962951660156  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

pseudo mini batch 1 input nodes size: 49198
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03720569610595703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03720569610595703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.060665130615234375  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.06083488464355469  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.032631874084472656  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03555774688720703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03555774688720703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03555774688720703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

torch.Size([49198, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.03555774688720703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

m.shape torch.Size([3971, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.1405777931213379  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.1405777931213379  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 3971, 128]), torch.Size([1, 3971, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.1443648338317871  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.17537641525268555  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 3971, 128])
m.shape torch.Size([3936, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.17723655700683594  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.17723655700683594  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 3936, 128]), torch.Size([1, 3936, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.1813812255859375  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.2395172119140625  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 3936, 128])
m.shape torch.Size([3522, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.24267864227294922  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.24267864227294922  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 3522, 128]), torch.Size([1, 3522, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.2463393211364746  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.32241201400756836  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 3522, 128])
m.shape torch.Size([2973, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.3264198303222656  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.3264198303222656  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 2973, 128]), torch.Size([1, 2973, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.32970428466796875  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.4129462242126465  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 2973, 128])
m.shape torch.Size([2514, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.417513370513916  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.417513370513916  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 2514, 128]), torch.Size([1, 2514, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.4201774597167969  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.5089960098266602  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 2514, 128])
m.shape torch.Size([2139, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.5139169692993164  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.5139169692993164  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 2139, 128]), torch.Size([1, 2139, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.5160918235778809  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.6045804023742676  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 2139, 128])
m.shape torch.Size([1849, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.6097321510314941  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.6097321510314941  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1849, 128]), torch.Size([1, 1849, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.6114954948425293  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7000832557678223  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1849, 128])
m.shape torch.Size([1585, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7052478790283203  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7052478790283203  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7067594528198242  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7929191589355469  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1356, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7979826927185059  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7979826927185059  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1356, 128]), torch.Size([1, 1356, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.7992758750915527  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.882382869720459  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1356, 128])
m.shape torch.Size([11269, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.9354710578918457  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.9354710578918457  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 11269, 128]), torch.Size([1, 11269, 128])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 0.9462180137634277  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.7101855278015137  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 11269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.6196832656860352  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.6531705856323242  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.6866579055786133  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.6529088020324707  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

torch.Size([35114, 256])
first layer input nodes number: 49198
first layer output nodes number: 35114
edges number: 210222
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.6870265007019043  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.9647216796875 GB
    Memory Allocated: 1.7205138206481934  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 1.7288856506347656  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.9998779296875 GB
    Memory Allocated: 1.7288856506347656  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

m.shape torch.Size([3076, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9083776473999023  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9083776473999023  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 3076, 256]), torch.Size([1, 3076, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9151992797851562  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.962813377380371  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 3076, 256])
m.shape torch.Size([2765, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9651951789855957  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9651951789855957  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 2765, 256]), torch.Size([1, 2765, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 1.9707703590393066  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.050093173980713  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 2765, 256])
m.shape torch.Size([2373, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.0542988777160645  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.0542988777160645  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 2373, 256]), torch.Size([1, 2373, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.059034824371338  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.159670829772949  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 2373, 256])
m.shape torch.Size([1895, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.1646933555603027  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.1646933555603027  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1895, 256]), torch.Size([1, 1895, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.1684012413024902  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.2744460105895996  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1895, 256])
m.shape torch.Size([1571, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.2800521850585938  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.2800521850585938  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1571, 256]), torch.Size([1, 1571, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.2833943367004395  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.3940892219543457  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1571, 256])
m.shape torch.Size([1305, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.3996715545654297  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.3996715545654297  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1305, 256]), torch.Size([1, 1305, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.402456283569336  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.5143938064575195  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1305, 256])
m.shape torch.Size([1110, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.5196781158447266  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.5196781158447266  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1110, 256]), torch.Size([1, 1110, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.521969795227051  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.632143974304199  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 1110, 256])
m.shape torch.Size([945, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.6383519172668457  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.6383519172668457  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 945, 256]), torch.Size([1, 945, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.6401543617248535  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.742893695831299  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 945, 256])
m.shape torch.Size([825, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.749129295349121  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.749129295349121  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 825, 256]), torch.Size([1, 825, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.7507028579711914  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.8535356521606445  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 825, 256])
m.shape torch.Size([717, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.859745502471924  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.859745502471924  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.8611130714416504  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.9600253105163574  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([655, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.966266632080078  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.966266632080078  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 655, 256]), torch.Size([1, 655, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 2.9675159454345703  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.064962387084961  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 655, 256])
m.shape torch.Size([555, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.070739269256592  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.070739269256592  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 555, 256]), torch.Size([1, 555, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.0717978477478027  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.1635193824768066  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 555, 256])
m.shape torch.Size([471, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.168875217437744  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.168875217437744  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.169773578643799  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.2534337043762207  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([417, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.2585959434509277  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.2585959434509277  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.2593913078308105  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.3400797843933105  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([339, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.344569683074951  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.344569683074951  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.3452162742614746  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4159445762634277  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([311, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4209647178649902  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4209647178649902  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.421557903289795  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4902358055114746  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([319, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4951515197753906  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.4951515197753906  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.495759963989258  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.569869041442871  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([258, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.574028491973877  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.574028491973877  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.5745205879211426  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.6392502784729004  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([211, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.642857551574707  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.642857551574707  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.6432600021362305  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.697188377380371  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([240, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7016005516052246  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7016005516052246  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7020583152770996  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7666029930114746  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([208, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7705726623535156  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7705726623535156  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.7709693908691406  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.8296852111816406  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([149, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.832768440246582  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.832768440246582  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.833052635192871  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.877102851867676  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([143, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.880122184753418  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.880122184753418  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.88039493560791  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.9245805740356445  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([139, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.9276509284973145  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.9276509284973145  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.9279160499572754  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 3.972721576690674  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([1773, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 4.015191078186035  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 4.015191078186035  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

 h.shape torch.Size([1, 1773, 256]), torch.Size([1, 1773, 256])
----------------------------------------3
 Nvidia-smi: 6.1756591796875 GB
    Memory Allocated: 4.018572807312012  GigaBytes
Max Memory Allocated: 4.27978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2186279296875 GB
    Memory Allocated: 4.62890625  GigaBytes
Max Memory Allocated: 4.671875  GigaBytes

rst.shape  torch.Size([1, 1773, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.471404075622559  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.474797248840332  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.4781904220581055  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.474627494812012  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

torch.Size([22770, 40])
input nodes number: 35114
output nodes number: 22770
edges number: 182274
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.475003242492676  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.2420654296875 GB
    Memory Allocated: 4.475003719329834  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.04119396209716797  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

pseudo mini batch 2 input nodes size: 92139
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.03257608413696289  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.03257608413696289  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.07651138305664062  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.07667970657348633  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.05305051803588867  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.05956602096557617  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.05956602096557617  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.05956602096557617  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

torch.Size([92139, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.5955810546875 GB
    Memory Allocated: 0.05956602096557617  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

m.shape torch.Size([3744, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.32084083557128906  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.32084083557128906  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 3744, 128]), torch.Size([1, 3744, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.32441139221191406  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.35370445251464844  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 3744, 128])
m.shape torch.Size([3943, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.35649681091308594  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.35649681091308594  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 3943, 128]), torch.Size([1, 3943, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.36116933822631836  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.4192671775817871  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 3943, 128])
m.shape torch.Size([3600, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.42209911346435547  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.42209911346435547  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.42673492431640625  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.5045604705810547  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 3600, 128])
m.shape torch.Size([3303, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.5094127655029297  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.5094127655029297  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 3303, 128]), torch.Size([1, 3303, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.5127043724060059  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.6073856353759766  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 3303, 128])
m.shape torch.Size([3139, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.6126632690429688  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.6126632690429688  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 3139, 128]), torch.Size([1, 3139, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.6163663864135742  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.7256789207458496  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 3139, 128])
m.shape torch.Size([2877, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.7331628799438477  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.7331628799438477  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2877, 128]), torch.Size([1, 2877, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.7359538078308105  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.8562078475952148  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2877, 128])
m.shape torch.Size([2711, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.8644390106201172  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.8644390106201172  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2711, 128]), torch.Size([1, 2711, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.8674287796020508  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 0.9978775978088379  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2711, 128])
m.shape torch.Size([2563, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.006361961364746  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.006361961364746  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2563, 128]), torch.Size([1, 2563, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.0088768005371094  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.1491870880126953  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2563, 128])
m.shape torch.Size([2429, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.1583890914916992  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.1583890914916992  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2429, 128]), torch.Size([1, 2429, 128])
----------------------------------------3
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.160787582397461  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8514404296875 GB
    Memory Allocated: 1.3107986450195312  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2429, 128])
m.shape torch.Size([39816, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0428466796875 GB
    Memory Allocated: 1.499497890472412  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0428466796875 GB
    Memory Allocated: 1.499497890472412  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 39816, 128]), torch.Size([1, 39816, 128])
----------------------------------------3
 Nvidia-smi: 7.0428466796875 GB
    Memory Allocated: 1.538560390472412  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.251115322113037  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 39816, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.0101518630981445  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.07512092590332  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.140089988708496  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.074613094329834  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

torch.Size([68125, 256])
first layer input nodes number: 92139
first layer output nodes number: 68125
edges number: 528101
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.140778541564941  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.205747604370117  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.22199010848999  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.22199010848999  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

m.shape torch.Size([2514, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.475368976593018  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.475368976593018  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2514, 256]), torch.Size([1, 2514, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.48105525970459  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.519766807556152  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2514, 256])
m.shape torch.Size([2160, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.52152156829834  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.52152156829834  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 2160, 256]), torch.Size([1, 2160, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.5260396003723145  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.588367462158203  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 2160, 256])
m.shape torch.Size([1728, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.59128999710083  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.59128999710083  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 1728, 256]), torch.Size([1, 1728, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.594656467437744  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.667604446411133  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

rst.shape  torch.Size([1, 1728, 256])
m.shape torch.Size([1363, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.671196937561035  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.671196937561035  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

 h.shape torch.Size([1, 1363, 256]), torch.Size([1, 1363, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.6739726066589355  GigaBytes
Max Memory Allocated: 4.691520690917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.750704288482666  GigaBytes
Max Memory Allocated: 4.755903720855713  GigaBytes

rst.shape  torch.Size([1, 1363, 256])
m.shape torch.Size([1197, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.755156993865967  GigaBytes
Max Memory Allocated: 4.755903720855713  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.755156993865967  GigaBytes
Max Memory Allocated: 4.755903720855713  GigaBytes

 h.shape torch.Size([1, 1197, 256]), torch.Size([1, 1197, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.757453441619873  GigaBytes
Max Memory Allocated: 4.757453441619873  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.841254234313965  GigaBytes
Max Memory Allocated: 4.8470869064331055  GigaBytes

rst.shape  torch.Size([1, 1197, 256])
m.shape torch.Size([991, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.8454813957214355  GigaBytes
Max Memory Allocated: 4.8470869064331055  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.8454813957214355  GigaBytes
Max Memory Allocated: 4.8470869064331055  GigaBytes

 h.shape torch.Size([1, 991, 256]), torch.Size([1, 991, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.847371578216553  GigaBytes
Max Memory Allocated: 4.847371578216553  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.930537700653076  GigaBytes
Max Memory Allocated: 4.936208248138428  GigaBytes

rst.shape  torch.Size([1, 991, 256])
m.shape torch.Size([797, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.93495512008667  GigaBytes
Max Memory Allocated: 4.936208248138428  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.93495512008667  GigaBytes
Max Memory Allocated: 4.936208248138428  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 4.9364752769470215  GigaBytes
Max Memory Allocated: 4.9364752769470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.0124831199646  GigaBytes
Max Memory Allocated: 5.01780366897583  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([677, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.016928672790527  GigaBytes
Max Memory Allocated: 5.01780366897583  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.016928672790527  GigaBytes
Max Memory Allocated: 5.01780366897583  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.018219947814941  GigaBytes
Max Memory Allocated: 5.018219947814941  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.092398643493652  GigaBytes
Max Memory Allocated: 5.097563743591309  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([656, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.097427845001221  GigaBytes
Max Memory Allocated: 5.097563743591309  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.097427845001221  GigaBytes
Max Memory Allocated: 5.097563743591309  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.098679065704346  GigaBytes
Max Memory Allocated: 5.098679065704346  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.178757190704346  GigaBytes
Max Memory Allocated: 5.184387683868408  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([616, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.184052467346191  GigaBytes
Max Memory Allocated: 5.184387683868408  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.184052467346191  GigaBytes
Max Memory Allocated: 5.184387683868408  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.185227394104004  GigaBytes
Max Memory Allocated: 5.185227394104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.270844459533691  GigaBytes
Max Memory Allocated: 5.276719093322754  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([523, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.275786399841309  GigaBytes
Max Memory Allocated: 5.276719093322754  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.275786399841309  GigaBytes
Max Memory Allocated: 5.276719093322754  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.2767839431762695  GigaBytes
Max Memory Allocated: 5.2767839431762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.354649543762207  GigaBytes
Max Memory Allocated: 5.360215187072754  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([511, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.360044479370117  GigaBytes
Max Memory Allocated: 5.360215187072754  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.360044479370117  GigaBytes
Max Memory Allocated: 5.360215187072754  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.361019134521484  GigaBytes
Max Memory Allocated: 5.361019134521484  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.443979263305664  GigaBytes
Max Memory Allocated: 5.449865341186523  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([429, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.449419975280762  GigaBytes
Max Memory Allocated: 5.449865341186523  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.449419975280762  GigaBytes
Max Memory Allocated: 5.449865341186523  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.450238227844238  GigaBytes
Max Memory Allocated: 5.450238227844238  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.525915145874023  GigaBytes
Max Memory Allocated: 5.531233787536621  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([372, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.530511856079102  GigaBytes
Max Memory Allocated: 5.531233787536621  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.530511856079102  GigaBytes
Max Memory Allocated: 5.531233787536621  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.531221389770508  GigaBytes
Max Memory Allocated: 5.531233787536621  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.602293014526367  GigaBytes
Max Memory Allocated: 5.607259750366211  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([352, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.60701322555542  GigaBytes
Max Memory Allocated: 5.607259750366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.60701322555542  GigaBytes
Max Memory Allocated: 5.607259750366211  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.60768461227417  GigaBytes
Max Memory Allocated: 5.60768461227417  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.68037748336792  GigaBytes
Max Memory Allocated: 5.685412883758545  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([325, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.68503999710083  GigaBytes
Max Memory Allocated: 5.685412883758545  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.68503999710083  GigaBytes
Max Memory Allocated: 5.685412883758545  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.685659885406494  GigaBytes
Max Memory Allocated: 5.685659885406494  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.758041858673096  GigaBytes
Max Memory Allocated: 5.763000965118408  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([309, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.762781143188477  GigaBytes
Max Memory Allocated: 5.763000965118408  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.762781143188477  GigaBytes
Max Memory Allocated: 5.763000965118408  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.763370513916016  GigaBytes
Max Memory Allocated: 5.763370513916016  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.837054252624512  GigaBytes
Max Memory Allocated: 5.842063903808594  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([319, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.842278480529785  GigaBytes
Max Memory Allocated: 5.842299938201904  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.842278480529785  GigaBytes
Max Memory Allocated: 5.842299938201904  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.842886924743652  GigaBytes
Max Memory Allocated: 5.842886924743652  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.921027183532715  GigaBytes
Max Memory Allocated: 5.9265031814575195  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([296, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.926128387451172  GigaBytes
Max Memory Allocated: 5.9265031814575195  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.926128387451172  GigaBytes
Max Memory Allocated: 5.9265031814575195  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 5.926692962646484  GigaBytes
Max Memory Allocated: 5.926692962646484  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.003959655761719  GigaBytes
Max Memory Allocated: 6.0093231201171875  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([281, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.0090789794921875  GigaBytes
Max Memory Allocated: 6.0093231201171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.0090789794921875  GigaBytes
Max Memory Allocated: 6.0093231201171875  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.009614944458008  GigaBytes
Max Memory Allocated: 6.009614944458008  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.086534023284912  GigaBytes
Max Memory Allocated: 6.091893672943115  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([265, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.091614723205566  GigaBytes
Max Memory Allocated: 6.091893672943115  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.091614723205566  GigaBytes
Max Memory Allocated: 6.091893672943115  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.092120170593262  GigaBytes
Max Memory Allocated: 6.092120170593262  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.167943954467773  GigaBytes
Max Memory Allocated: 6.173251152038574  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([196, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.171835899353027  GigaBytes
Max Memory Allocated: 6.173251152038574  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.171835899353027  GigaBytes
Max Memory Allocated: 6.173251152038574  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.172209739685059  GigaBytes
Max Memory Allocated: 6.173251152038574  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.230154991149902  GigaBytes
Max Memory Allocated: 6.234267234802246  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([197, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.234323024749756  GigaBytes
Max Memory Allocated: 6.234340190887451  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.234323024749756  GigaBytes
Max Memory Allocated: 6.234340190887451  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.23469877243042  GigaBytes
Max Memory Allocated: 6.23469877243042  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.295569896697998  GigaBytes
Max Memory Allocated: 6.299890995025635  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([200, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.299995422363281  GigaBytes
Max Memory Allocated: 6.300013542175293  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.299995422363281  GigaBytes
Max Memory Allocated: 6.300013542175293  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.300376892089844  GigaBytes
Max Memory Allocated: 6.300376892089844  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.364845275878906  GigaBytes
Max Memory Allocated: 6.369422912597656  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([5315, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 6.4925994873046875  GigaBytes
Max Memory Allocated: 6.4930949211120605  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 6.4925994873046875  GigaBytes
Max Memory Allocated: 6.4930949211120605  GigaBytes

 h.shape torch.Size([1, 5315, 256]), torch.Size([1, 5315, 256])
----------------------------------------3
 Nvidia-smi: 8.8846435546875 GB
    Memory Allocated: 6.502737045288086  GigaBytes
Max Memory Allocated: 6.502737045288086  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.286947250366211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.055057525634766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.058638572692871  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.06225872039795  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.058509349822998  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([22589, 40])
input nodes number: 68125
output nodes number: 22589
edges number: 259932
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.059373378753662  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.9783935546875 GB
    Memory Allocated: 8.05937385559082  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07098388671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 3 input nodes size: 93253
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.0532383918762207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.0532383918762207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.09770488739013672  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.09787225723266602  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.05376863479614258  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.057431697845458984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.057431697845458984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.057431697845458984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([93253, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.057431697845458984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([5523, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2270803451538086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2270803451538086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5523, 128]), torch.Size([1, 5523, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2323474884033203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.27448463439941406  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5523, 128])
m.shape torch.Size([5470, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2770676612854004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2770676612854004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5470, 128]), torch.Size([1, 5470, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2822842597961426  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.3605332374572754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5470, 128])
m.shape torch.Size([4595, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.3644981384277344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.3644981384277344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4595, 128]), torch.Size([1, 4595, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.36924171447753906  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.4677128791809082  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4595, 128])
m.shape torch.Size([3902, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.4729642868041992  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.4729642868041992  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3902, 128]), torch.Size([1, 3902, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.47696971893310547  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5881333351135254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3902, 128])
m.shape torch.Size([3474, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.593630313873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.593630313873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3474, 128]), torch.Size([1, 3474, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.596989631652832  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7167325019836426  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3474, 128])
m.shape torch.Size([2835, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7231869697570801  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7231869697570801  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2835, 128]), torch.Size([1, 2835, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7261157035827637  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8496303558349609  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2835, 128])
m.shape torch.Size([2504, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8563895225524902  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8563895225524902  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2504, 128]), torch.Size([1, 2504, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8588848114013672  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9826278686523438  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2504, 128])
m.shape torch.Size([2239, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9897055625915527  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9897055625915527  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2239, 128]), torch.Size([1, 2239, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9919638633728027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.1163034439086914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2239, 128])
m.shape torch.Size([1933, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.1235313415527344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.1235313415527344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1933, 128]), torch.Size([1, 1933, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.1253747940063477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.2433557510375977  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1933, 128])
m.shape torch.Size([20652, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.3409104347229004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.3409104347229004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 20652, 128]), torch.Size([1, 20652, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.3606057167053223  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7589707374572754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 20652, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.611100673675537  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.661766529083252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.712432384490967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.661370277404785  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([53127, 256])
first layer input nodes number: 93253
first layer output nodes number: 53127
edges number: 339593
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7131295204162598  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7637953758239746  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7764620780944824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7764620780944824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([4077, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.9272780418395996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.9272780418395996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4077, 256]), torch.Size([1, 4077, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.935054302215576  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.997445583343506  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4077, 256])
m.shape torch.Size([3366, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.000028133392334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.000028133392334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3366, 256]), torch.Size([1, 3366, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0068845748901367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1040563583374023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3366, 256])
m.shape torch.Size([2462, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1076745986938477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1076745986938477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2462, 256]), torch.Size([1, 2462, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.112534523010254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2201294898986816  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2462, 256])
m.shape torch.Size([1912, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2248406410217285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2248406410217285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1912, 256]), torch.Size([1, 1912, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2288923263549805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.340315818786621  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1912, 256])
m.shape torch.Size([1679, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.3459949493408203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.3459949493408203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1679, 256]), torch.Size([1, 1679, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.34938907623291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.469167709350586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1679, 256])
m.shape torch.Size([1187, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.474411964416504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.474411964416504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.476677894592285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5776400566101074  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
m.shape torch.Size([999, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5832295417785645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5832295417785645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 999, 256]), torch.Size([1, 999, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.585134983062744  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.681837558746338  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 999, 256])
m.shape torch.Size([876, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6876206398010254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6876206398010254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 876, 256]), torch.Size([1, 876, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.689291477203369  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.784529209136963  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 876, 256])
m.shape torch.Size([705, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7899060249328613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7899060249328613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 705, 256]), torch.Size([1, 705, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.791250705718994  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8799614906311035  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 705, 256])
m.shape torch.Size([570, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.884768009185791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.884768009185791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.885855197906494  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.963064670562744  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([494, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.9677438735961914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.9677438735961914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.968686103820801  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.044886589050293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([414, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.049190521240234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.049190521240234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.049980163574219  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.118892669677734  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([368, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.123851299285889  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.123851299285889  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.124553203582764  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.189180850982666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([309, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.19298791885376  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.19298791885376  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.193577289581299  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.253662586212158  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([273, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.257303714752197  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.257303714752197  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.257824420928955  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.3142571449279785  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([242, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.317718505859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.317718505859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.318180084228516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.370338439941406  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([191, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.373228549957275  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.373228549957275  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.373592853546143  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.417309284210205  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([192, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4204487800598145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4204487800598145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4208149909973145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4673237800598145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([159, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4700446128845215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.4700446128845215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.470347881317139  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.510985851287842  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.5137176513671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.5137176513671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.514003753662109  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.554344177246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([123, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.5566840171813965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.5566840171813965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.556918621063232  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.591639995574951  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([104, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.593721866607666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.593721866607666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.5939202308654785  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes
[04:23:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28447620 edges into 4 parts and get 1933211 edge cuts

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.624666690826416  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.6262922286987305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.6262922286987305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.62644100189209  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.650542259216309  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([100, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.652774810791016  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.652774810791016  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.652965545654297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.685199737548828  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([1408, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.718935966491699  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.718935966491699  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1408, 256]), torch.Size([1, 1408, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.721865653991699  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.212100028991699  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1408, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.085757732391357  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.089645862579346  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.092989444732666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.088933944702148  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([22438, 40])
input nodes number: 53127
output nodes number: 22438
edges number: 151874
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.089260101318359  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 5.089260578155518  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.06469011306762695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07024049758911133  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07024049758911133  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.035338640213012695 |0.08443659543991089 |0.2646840810775757 |0.00013196468353271484 |0.10098177194595337 |0.005706787109375 |
----------------------------------------------------------pseudo_mini_loss sum 5.319631576538086
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  489083
Number of first layer input nodes during this epoch:  293374
Number of first layer output nodes during this epoch:  195709
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07024002075195312  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01731419563293457
global_2_local spend time (sec) 0.04382777214050293
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004271984100341797
A = g.adjacency_matrix() spent  0.007662296295166016
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08128976821899414
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.4443163871765137
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.179868221282959

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432})
Convert a graph into a bidirected graph: 1.326 seconds
Metis partitioning: 4.919 seconds
Split the graph: 3.261 seconds
Construct subgraphs: 0.066 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.585102796554565
23206
23128
22265
22342
total k batches seeds list generation spend  20.698761701583862
after graph partition
graph partition algorithm spend time 20.833842992782593
23206
23128
22265
22342
partition_len_list
[39987, 38018, 53084, 67918]
shared_neighbor_graph_partition_s0 selection method  spend 20.927062511444092
time for parepare:  0.01674509048461914
local_output_nid generation:  0.0030105113983154297
local_in_edges_tensor generation:  0.003431081771850586
mini_batch_src_global generation:  0.0051076412200927734
r_  generation:  0.05318307876586914
local_output_nid generation:  0.0037806034088134766
local_in_edges_tensor generation:  0.004182100296020508
mini_batch_src_global generation:  0.0070874691009521484
r_  generation:  0.06338810920715332
local_output_nid generation:  0.003696918487548828
local_in_edges_tensor generation:  0.003453969955444336
mini_batch_src_global generation:  0.005457878112792969
r_  generation:  0.053350210189819336
local_output_nid generation:  0.0038449764251708984
local_in_edges_tensor generation:  0.004605531692504883
mini_batch_src_global generation:  0.009800434112548828
r_  generation:  0.08517909049987793
----------------------check_connections_block total spend ----------------------------- 0.39496779441833496
generate_one_block  0.07667207717895508
generate_one_block  0.0843043327331543
generate_one_block  0.07078385353088379
generate_one_block  0.12000370025634766
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.047870635986328125
gen group dst list time:  0.005472660064697266
time for parepare:  0.021609067916870117
local_output_nid generation:  0.006016969680786133
local_in_edges_tensor generation:  0.021306753158569336
mini_batch_src_global generation:  0.006839752197265625
r_  generation:  0.07988238334655762
local_output_nid generation:  0.007552623748779297
local_in_edges_tensor generation:  0.00857686996459961
mini_batch_src_global generation:  0.010105133056640625
r_  generation:  0.08543992042541504
local_output_nid generation:  0.011155843734741211
local_in_edges_tensor generation:  0.010619878768920898
mini_batch_src_global generation:  0.012596368789672852
r_  generation:  0.12956881523132324
local_output_nid generation:  0.011542797088623047
local_in_edges_tensor generation:  0.013797521591186523
mini_batch_src_global generation:  0.018161773681640625
r_  generation:  0.1871659755706787
----------------------check_connections_block total spend ----------------------------- 0.7597391605377197
generate_one_block  0.10475802421569824
generate_one_block  0.10943818092346191
generate_one_block  0.1578831672668457
generate_one_block  0.23174190521240234
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07024002075195312  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

connection checking time:  0.7597391605377197
block generation total time  0.6038212776184082
average batch blocks generation time:  0.15095531940460205
block dataloader generation time/epoch 23.205509901046753
pseudo mini batch 0 input nodes size: 58636
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.05908060073852539  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.05908060073852539  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.08704042434692383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.08721351623535156  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04257965087890625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.045368194580078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.045368194580078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.045368194580078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([58636, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.045368194580078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([5220, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.15604829788208008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.15604829788208008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5220, 128]), torch.Size([1, 5220, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.16141939163208008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.20124483108520508  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5220, 128])
m.shape torch.Size([5259, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.20377111434936523  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.20377111434936523  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5259, 128]), torch.Size([1, 5259, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.20962810516357422  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.28485870361328125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5259, 128])
m.shape torch.Size([4480, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.288759708404541  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.288759708404541  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4480, 128]), torch.Size([1, 4480, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.2940511703491211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.39133596420288086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4480, 128])
m.shape torch.Size([3713, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.39628171920776367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.39628171920776367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3713, 128]), torch.Size([1, 3713, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.3998227119445801  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5026788711547852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3713, 128])
m.shape torch.Size([3065, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5081601142883301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5081601142883301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3065, 128]), torch.Size([1, 3065, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5112090110778809  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6200857162475586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3065, 128])
m.shape torch.Size([2499, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6254730224609375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6254730224609375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2499, 128]), torch.Size([1, 2499, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6285724639892578  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7379202842712402  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2499, 128])
m.shape torch.Size([2113, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.743781566619873  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.743781566619873  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7460775375366211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8493142127990723  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([1837, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8553142547607422  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8553142547607422  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8570661544799805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9569244384765625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1541, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9626617431640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9626617431640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9641313552856445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.0592541694641113  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([10260, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.107442855834961  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.107442855834961  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 10260, 128]), torch.Size([1, 10260, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.1180992126464844  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8128128051757812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 10260, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.7214422225952148  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.7605047225952148  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.7986392974853516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.7592787742614746  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([39987, 256])
first layer input nodes number: 58636
first layer output nodes number: 39987
edges number: 220305
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.7990784645080566  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8381409645080566  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8467469215393066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8467469215393066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3852, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9990949630737305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9990949630737305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3852, 256]), torch.Size([1, 3852, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.006442070007324  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.065218925476074  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3852, 256])
m.shape torch.Size([3370, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.068023681640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.068023681640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3370, 256]), torch.Size([1, 3370, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.074451446533203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.1713638305664062  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3370, 256])
m.shape torch.Size([2631, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.175736427307129  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.175736427307129  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2631, 256]), torch.Size([1, 2631, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.181459426879883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.291860580444336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2631, 256])
m.shape torch.Size([2131, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.297544479370117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.297544479370117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2131, 256]), torch.Size([1, 2131, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.3024749755859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.421813488006592  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2131, 256])
m.shape torch.Size([1726, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.4280757904052734  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.4280757904052734  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1726, 256]), torch.Size([1, 1726, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.4313907623291016  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.5525851249694824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1726, 256])
m.shape torch.Size([1361, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.558518886566162  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.558518886566162  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1361, 256]), torch.Size([1, 1361, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.5612502098083496  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.676175594329834  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1361, 256])
m.shape torch.Size([1133, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.6821579933166504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.6821579933166504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1133, 256]), torch.Size([1, 1133, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.684457302093506  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7941017150878906  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1133, 256])
m.shape torch.Size([963, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.8002657890319824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.8002657890319824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 963, 256]), torch.Size([1, 963, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.802102565765381  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.9076457023620605  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 963, 256])
m.shape torch.Size([795, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.913604259490967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.913604259490967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.9151206016540527  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.012697696685791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([670, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0183792114257812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0183792114257812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 670, 256]), torch.Size([1, 670, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0196571350097656  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1110877990722656  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 670, 256])
m.shape torch.Size([542, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1161794662475586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1161794662475586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.117213249206543  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2006568908691406  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([474, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2056069374084473  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2056069374084473  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2065110206604004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2875428199768066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([404, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2921390533447266  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2921390533447266  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.292909622192383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.3647899627685547  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([339, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.368966579437256  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.368966579437256  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.3696131706237793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.434060573577881  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([321, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4383654594421387  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4383654594421387  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4389777183532715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5048136711120605  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([243, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.508244514465332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.508244514465332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5087080001831055  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.561081886291504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([219, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5644288063049316  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5644288063049316  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5648465156555176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.61497163772583  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([203, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6182751655578613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6182751655578613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6186623573303223  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6678357124328613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([188, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6710753440856934  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6710753440856934  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.671433925628662  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7194838523864746  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([148, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7221498489379883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7221498489379883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7224321365356445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.762234687805176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([127, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7646570205688477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7646570205688477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.764899253845215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8007497787475586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([112, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8030009269714355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8030009269714355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8032145500183105  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8363261222839355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([104, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8385186195373535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8385186195373535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.838716983795166  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.870851993560791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([91, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.872852325439453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.872852325439453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.873025894165039  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.9023590087890625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([1059, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.927718162536621  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.927718162536621  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1059, 256]), torch.Size([1, 1059, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.929793357849121  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.29201602935791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1059, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.164434432983398  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.167896270751953  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.17181396484375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.168179035186768  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([23206, 40])
input nodes number: 39987
output nodes number: 23206
edges number: 153737
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.168768405914307  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.168769359588623  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.051013946533203125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 1 input nodes size: 57709
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04269886016845703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04269886016845703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.07021665573120117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.0703892707824707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04225635528564453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([57709, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.04548358917236328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3696, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.16504764556884766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.16504764556884766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3696, 128]), torch.Size([1, 3696, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.16857242584228516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.19735956192016602  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3696, 128])
m.shape torch.Size([3756, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.19917917251586914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.19917917251586914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3756, 128]), torch.Size([1, 3756, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.20276117324829102  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.25940942764282227  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3756, 128])
m.shape torch.Size([3508, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.26166391372680664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.26166391372680664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3508, 128]), torch.Size([1, 3508, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.26509904861450195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.33929872512817383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3508, 128])
m.shape torch.Size([3038, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.34342050552368164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.34342050552368164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3038, 128]), torch.Size([1, 3038, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.3465418815612793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.434110164642334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3038, 128])
m.shape torch.Size([2669, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.4388904571533203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.4388904571533203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2669, 128]), torch.Size([1, 2669, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.44174623489379883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5357265472412109  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2669, 128])
m.shape torch.Size([2303, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5410428047180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5410428047180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2303, 128]), torch.Size([1, 2303, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.5433030128479004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6434187889099121  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2303, 128])
m.shape torch.Size([2040, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.648165225982666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.648165225982666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2040, 128]), torch.Size([1, 2040, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.6501107215881348  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7476143836975098  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2040, 128])
m.shape torch.Size([1790, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7534699440002441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7534699440002441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1790, 128]), torch.Size([1, 1790, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.7551770210266113  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8530335426330566  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1790, 128])
m.shape torch.Size([1518, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8586945533752441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8586945533752441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1518, 128]), torch.Size([1, 1518, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.8601422309875488  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 0.9527935981750488  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1518, 128])
m.shape torch.Size([13700, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.0173964500427246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.0173964500427246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 13700, 128]), torch.Size([1, 13700, 128])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.0304617881774902  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9581007957458496  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 13700, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8539447784423828  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8902015686035156  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9264583587646484  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.8899178504943848  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([38018, 256])
first layer input nodes number: 57709
first layer output nodes number: 38018
edges number: 240309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9268903732299805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9631471633911133  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9722113609313965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 1.9722113609313965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([2883, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.1614599227905273  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.1614599227905273  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2883, 256]), torch.Size([1, 2883, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.168776512145996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.2127676010131836  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2883, 256])
m.shape torch.Size([2647, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.21510648727417  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.21510648727417  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2647, 256]), torch.Size([1, 2647, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.2201552391052246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.295886516571045  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2647, 256])
m.shape torch.Size([2326, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.3000693321228027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.3000693321228027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2326, 256]), torch.Size([1, 2326, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.304800510406494  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.407285213470459  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2326, 256])
m.shape torch.Size([1892, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.4123411178588867  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.4123411178588867  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1892, 256]), torch.Size([1, 1892, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.416433334350586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.522563934326172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1892, 256])
m.shape torch.Size([1605, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.528472900390625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.528472900390625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1605, 256]), torch.Size([1, 1605, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.5317916870117188  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.645432472229004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1605, 256])
m.shape torch.Size([1347, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.651669979095459  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.651669979095459  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1347, 256]), torch.Size([1, 1347, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.6543021202087402  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7671566009521484  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1347, 256])
m.shape torch.Size([1172, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7734951972961426  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7734951972961426  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1172, 256]), torch.Size([1, 1172, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.7758026123046875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.893376350402832  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1172, 256])
m.shape torch.Size([1000, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.8999476432800293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.8999476432800293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 2.901854991912842  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.013007640838623  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([852, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0194239616394043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0194239616394043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 852, 256]), torch.Size([1, 852, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.0210490226745605  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1251444816589355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 852, 256])
m.shape torch.Size([793, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.131953716278076  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.131953716278076  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.1334662437438965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.2411112785339355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([678, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.247523307800293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.247523307800293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 678, 256]), torch.Size([1, 678, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.24881649017334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.349991798400879  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 678, 256])
m.shape torch.Size([570, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.355919361114502  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.355919361114502  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.357006549835205  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.449711322784424  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([491, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4553027153015137  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4553027153015137  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.4562392234802246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.5453858375549316  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([449, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.550959587097168  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.550959587097168  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.551815986633301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6386709213256836  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([381, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.643735885620117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.643735885620117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.6444625854492188  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.722860336303711  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([324, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7274794578552246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.7274794578552246  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.728097438812256  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.799619197845459  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([335, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.804783821105957  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.804783821105957  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.805422782897949  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.883563995361328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([254, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.887639045715332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.887639045715332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.8881235122680664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.949650764465332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([213, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.953298568725586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.953298568725586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 3.953704833984375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.008144378662109  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([254, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.012824058532715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.012824058532715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.013308525085449  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.081618309020996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([209, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.085594654083252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.085594654083252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.08599328994751  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.144991397857666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([168, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.14834451675415  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.14834451675415  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.148664951324463  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.1983323097229  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([143, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.201333522796631  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.201333522796631  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 10.4744873046875 GB
    Memory Allocated: 4.201606273651123  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 4.245791912078857  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([148, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 4.249069690704346  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 4.249069690704346  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 4.249351978302002  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.297058582305908  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([1994, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.344829559326172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.344829559326172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1994, 256]), torch.Size([1, 1994, 256])
----------------------------------------3
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.349364280700684  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 5.031611442565918  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1994, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.866868019104004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.871186256408691  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.875504493713379  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.871013641357422  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([23128, 40])
input nodes number: 38018
output nodes number: 23128
edges number: 192668
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.872326374053955  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5350341796875 GB
    Memory Allocated: 4.872326850891113  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05254411697387695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 2 input nodes size: 92729
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.043112754821777344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.043112754821777344  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.08732938766479492  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.08749532699584961  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05980491638183594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06337547302246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06337547302246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06337547302246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([92729, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06337547302246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([5550, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2310776710510254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2310776710510254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5550, 128]), torch.Size([1, 5550, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.23637056350708008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2787137031555176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5550, 128])
m.shape torch.Size([5704, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2815070152282715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2815070152282715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5704, 128]), torch.Size([1, 5704, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.28694677352905273  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.37533044815063477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5704, 128])
m.shape torch.Size([4777, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3786048889160156  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3786048889160156  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4777, 128]), torch.Size([1, 4777, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.38341426849365234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4854850769042969  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4777, 128])
m.shape torch.Size([3984, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.49080610275268555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.49080610275268555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3984, 128]), torch.Size([1, 3984, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4949836730957031  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6078376770019531  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3984, 128])
m.shape torch.Size([3531, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.614356517791748  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.614356517791748  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3531, 128]), torch.Size([1, 3531, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6179399490356445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.740509033203125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3531, 128])
m.shape torch.Size([2838, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7469449043273926  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7469449043273926  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2838, 128]), torch.Size([1, 2838, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7500619888305664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8722825050354004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2838, 128])
m.shape torch.Size([2534, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8796343803405762  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8796343803405762  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2534, 128]), torch.Size([1, 2534, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8822240829467773  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.00457763671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2534, 128])
m.shape torch.Size([2222, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0116472244262695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0116472244262695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2222, 128]), torch.Size([1, 2222, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0139131546020508  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.137711524963379  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2222, 128])
m.shape torch.Size([1935, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1446685791015625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1446685791015625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1935, 128]), torch.Size([1, 1935, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1465139389038086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.2646169662475586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1935, 128])
m.shape torch.Size([20009, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.3591046333312988  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.3591046333312988  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 20009, 128]), torch.Size([1, 20009, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.3781867027282715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.739302158355713  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 20009, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.5933876037597656  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.644012451171875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.6946372985839844  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.6436166763305664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([53084, 256])
first layer input nodes number: 92729
first layer output nodes number: 53084
edges number: 334927
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.6953301429748535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.745954990386963  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.758650302886963  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.758650302886963  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([4049, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.902129650115967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.902129650115967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4049, 256]), torch.Size([1, 4049, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9107956886291504  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.973026752471924  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4049, 256])
m.shape torch.Size([3456, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.976199150085449  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.976199150085449  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3456, 256]), torch.Size([1, 3456, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9835805892944336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0824575424194336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3456, 256])
m.shape torch.Size([2573, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.086580753326416  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.086580753326416  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2573, 256]), torch.Size([1, 2573, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.091947078704834  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.203446388244629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2573, 256])
m.shape torch.Size([1957, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2085165977478027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2085165977478027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1957, 256]), torch.Size([1, 1957, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.212833881378174  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3251733779907227  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1957, 256])
m.shape torch.Size([1687, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.330925941467285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.330925941467285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1687, 256]), torch.Size([1, 1687, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3349642753601074  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4552297592163086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1687, 256])
m.shape torch.Size([1248, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.460817813873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.460817813873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1248, 256]), torch.Size([1, 1248, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.463408946990967  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5700507164001465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1248, 256])
m.shape torch.Size([968, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5753731727600098  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5753731727600098  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 968, 256]), torch.Size([1, 968, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5772194862365723  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6695351600646973  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 968, 256])
m.shape torch.Size([860, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.675224781036377  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.675224781036377  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 860, 256]), torch.Size([1, 860, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6768651008605957  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7703633308410645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 860, 256])
m.shape torch.Size([717, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.775745391845703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.775745391845703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7771129608154297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.867372512817383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([566, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.872586727142334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.872586727142334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.873666286468506  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9506125450134277  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([467, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.955010414123535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.955010414123535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9559011459350586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.025575637817383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([395, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.029686450958252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.029686450958252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.030439853668213  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.0949482917785645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([343, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.098857402801514  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.098857402801514  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.099511623382568  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.160589694976807  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([291, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.164178371429443  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.164178371429443  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.164733409881592  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.2221574783325195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([242, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.225368976593018  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.225368976593018  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.225830554962158  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.2747578620910645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([211, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.277771949768066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.277771949768066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.27817440032959  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.323651313781738  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([175, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.326309680938721  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.326309680938721  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.326643466949463  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.366697788238525  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([182, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.369679927825928  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.369679927825928  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.3700270652771  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.414113521575928  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([153, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.416734218597412  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.416734218597412  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.417026042938232  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.456130504608154  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([137, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.4586181640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.4586181640625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.458879470825195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.495723724365234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([123, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.49807596206665  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.49807596206665  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.498310565948486  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.533031940460205  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.534606456756592  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.534606456756592  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.534759044647217  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.558410167694092  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([83, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.560168743133545  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.560168743133545  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.560327053070068  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.585973262786865  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([93, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.588039398193359  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.588039398193359  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.588216781616211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.618194580078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([1209, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.647156238555908  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.647156238555908  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1209, 256]), torch.Size([1, 1209, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.6498122215271  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.05623197555542  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1209, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.938337802886963  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.94165563583374  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.944973468780518  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.9414896965026855  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([22265, 40])
input nodes number: 53084
output nodes number: 22265
edges number: 144223
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.941051006317139  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.941051483154297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07001543045043945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 3 input nodes size: 92989
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05880451202392578  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05880451202392578  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.10314512252807617  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.10331201553344727  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.058929443359375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0653071403503418  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0653071403503418  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0653071403503418  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([92989, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0653071403503418  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3901, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3236093521118164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3236093521118164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3901, 128]), torch.Size([1, 3901, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3273296356201172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.35811567306518555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3901, 128])
m.shape torch.Size([4102, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.35997581481933594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.35997581481933594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4102, 128]), torch.Size([1, 4102, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3643498420715332  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.42339563369750977  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4102, 128])
m.shape torch.Size([3599, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4265880584716797  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4265880584716797  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3599, 128]), torch.Size([1, 3599, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4304656982421875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5073461532592773  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3599, 128])
m.shape torch.Size([3308, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5122003555297852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5122003555297852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3308, 128]), torch.Size([1, 3308, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5154938697814941  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.610405445098877  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3308, 128])
m.shape torch.Size([3115, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6156520843505859  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6156520843505859  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3115, 128]), torch.Size([1, 3115, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6193175315856934  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7286181449890137  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3115, 128])
m.shape torch.Size([2807, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7360448837280273  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7360448837280273  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2807, 128]), torch.Size([1, 2807, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7388052940368652  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8591852188110352  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2807, 128])
m.shape torch.Size([2676, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8659863471984863  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8659863471984863  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2676, 128]), torch.Size([1, 2676, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8694486618041992  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9989891052246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2676, 128])
m.shape torch.Size([2489, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0072078704833984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0072078704833984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2489, 128]), torch.Size([1, 2489, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0097136497497559  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1494030952453613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2489, 128])
m.shape torch.Size([2391, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1584773063659668  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1584773063659668  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2391, 128]), torch.Size([1, 2391, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1608171463012695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.3085346221923828  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2391, 128])
m.shape torch.Size([39530, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.4958882331848145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.4958882331848145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 39530, 128]), torch.Size([1, 39530, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.5349507331848145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.242050647735596  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 39530, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.002933979034424  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.0677056312561035  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.132477283477783  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.067199230194092  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([67918, 256])
first layer input nodes number: 92989
first layer output nodes number: 67918
edges number: 524014
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.133172035217285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.197943687438965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.214136600494385  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.214136600494385  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([2644, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.461543560028076  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.461543560028076  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2644, 256]), torch.Size([1, 2644, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.467794418334961  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.508138656616211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2644, 256])
m.shape torch.Size([2233, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.509909629821777  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.509909629821777  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2233, 256]), torch.Size([1, 2233, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.514468669891357  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.581501483917236  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2233, 256])
m.shape torch.Size([1747, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.584409236907959  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.584409236907959  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1747, 256]), torch.Size([1, 1747, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.587965965270996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.663280963897705  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1747, 256])
m.shape torch.Size([1340, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.66676664352417  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.66676664352417  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1340, 256]), torch.Size([1, 1340, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.669590473175049  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.74512243270874  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1340, 256])
m.shape torch.Size([1204, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.749630928039551  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.749630928039551  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1204, 256]), torch.Size([1, 1204, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.75209379196167  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.835464954376221  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1204, 256])
m.shape torch.Size([912, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.839576244354248  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.839576244354248  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.841315746307373  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.916114330291748  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([772, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.920438766479492  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.920438766479492  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.921911239624023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.995977401733398  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([649, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.000231742858887  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.000231742858887  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.001469612121582  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.072028160095215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([612, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.0767035484313965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.0767035484313965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.077870845794678  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.155141353607178  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([570, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.160036563873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.160036563873291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.161123752593994  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.239279270172119  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([516, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.2441911697387695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.2441911697387695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.245175361633301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.322949409484863  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([498, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.3282012939453125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.3282012939453125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.329151153564453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.411491394042969  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([418, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.416239261627197  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.416239261627197  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.417036533355713  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.492125034332275  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([355, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.4965033531188965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.4965033531188965  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.497180461883545  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.566234111785889  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([345, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.570869445800781  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.570869445800781  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.571527481079102  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.641322135925293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([333, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.646114349365234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.646114349365234  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.646749496459961  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.720062255859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([301, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.724662780761719  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.724662780761719  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.725236892700195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.795126914978027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([309, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.800185680389404  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.800185680389404  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.800775051116943  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.877171993255615  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([282, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.8820271492004395  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.8820271492004395  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.882565021514893  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.956312656402588  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([268, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.961195468902588  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.961195468902588  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 5.961706638336182  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.034420490264893  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([258, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.039372444152832  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.039372444152832  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.039864540100098  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.114783763885498  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([196, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.119338512420654  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.119338512420654  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.1197123527526855  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.177657604217529  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([189, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.1816487312316895  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.1816487312316895  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.182009220123291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.240408420562744  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([193, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.244680404663086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.244680404663086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.245048522949219  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.307260513305664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([5198, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.4319748878479  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.4319748878479  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes
[04:24:03] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28452268 edges into 4 parts and get 1960095 edge cuts

 h.shape torch.Size([1, 5198, 256]), torch.Size([1, 5198, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 6.44188928604126  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 8.1872239112854  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.960987091064453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.964319229125977  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.967927932739258  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.964428901672363  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([22342, 40])
input nodes number: 67918
output nodes number: 22342
edges number: 253622
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.965116500854492  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 7.96511697769165  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07560014724731445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07560014724731445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07560014724731445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.043060898780822754 |0.004499912261962891 |0.13289809226989746 |0.00010561943054199219 |0.08857738971710205 |0.004900932312011719 |
----------------------------------------------------------pseudo_mini_loss sum 4.6020283699035645
Total (block generation + training)time/epoch 24.35419273376465
Training time/epoch 1.1483643054962158
Training time without block to device /epoch 1.1303646564483643
Training time without total dataloading part /epoch 0.8912253379821777
load block tensor time/epoch 0.17224359512329102
block to device time/epoch 0.017999649047851562
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  501070
Number of first layer input nodes during this epoch:  302063
Number of first layer output nodes during this epoch:  199007
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07559967041015625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0169374942779541
global_2_local spend time (sec) 0.039792776107788086
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00410008430480957
A = g.adjacency_matrix() spent  0.012097358703613281
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0915060043334961
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.393934726715088
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1805760860443115

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096})
Convert a graph into a bidirected graph: 1.178 seconds
Metis partitioning: 4.928 seconds
Split the graph: 3.356 seconds
Construct subgraphs: 0.045 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.520031690597534
23308
22256
23174
22203
total k batches seeds list generation spend  20.61575722694397
after graph partition
graph partition algorithm spend time 20.724390506744385
23308
22256
23174
22203
partition_len_list
[41206, 34314, 69876, 53496]
shared_neighbor_graph_partition_s0 selection method  spend 20.819297552108765
time for parepare:  0.01688361167907715
local_output_nid generation:  0.003236055374145508
local_in_edges_tensor generation:  0.003616809844970703
mini_batch_src_global generation:  0.0058727264404296875
r_  generation:  0.05860090255737305
local_output_nid generation:  0.0040454864501953125
local_in_edges_tensor generation:  0.0061206817626953125
mini_batch_src_global generation:  0.007596731185913086
r_  generation:  0.06191849708557129
local_output_nid generation:  0.00395512580871582
local_in_edges_tensor generation:  0.00471949577331543
mini_batch_src_global generation:  0.009135961532592773
r_  generation:  0.09107804298400879
local_output_nid generation:  0.004264354705810547
local_in_edges_tensor generation:  0.003549814224243164
mini_batch_src_global generation:  0.006621122360229492
r_  generation:  0.056302785873413086
----------------------check_connections_block total spend ----------------------------- 0.4118483066558838
generate_one_block  0.08266329765319824
generate_one_block  0.08127665519714355
generate_one_block  0.12941288948059082
generate_one_block  0.0700986385345459
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03340959548950195
gen group dst list time:  0.0055942535400390625
time for parepare:  0.023014307022094727
local_output_nid generation:  0.006395578384399414
local_in_edges_tensor generation:  0.019778013229370117
mini_batch_src_global generation:  0.007361650466918945
r_  generation:  0.08729171752929688
local_output_nid generation:  0.006880521774291992
local_in_edges_tensor generation:  0.005422353744506836
mini_batch_src_global generation:  0.00802159309387207
r_  generation:  0.07651257514953613
local_output_nid generation:  0.012018918991088867
local_in_edges_tensor generation:  0.014636754989624023
mini_batch_src_global generation:  0.02616095542907715
r_  generation:  0.19569611549377441
local_output_nid generation:  0.011392831802368164
local_in_edges_tensor generation:  0.010016918182373047
mini_batch_src_global generation:  0.013749361038208008
r_  generation:  0.12868189811706543
----------------------check_connections_block total spend ----------------------------- 0.7610878944396973
generate_one_block  0.11237192153930664
generate_one_block  0.09489727020263672
generate_one_block  0.2393035888671875
generate_one_block  0.15856504440307617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.07559967041015625  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

connection checking time:  0.7610878944396973
block generation total time  0.605137825012207
average batch blocks generation time:  0.15128445625305176
block dataloader generation time/epoch 23.15915608406067
pseudo mini batch 0 input nodes size: 64197
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05894279479980469  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05894279479980469  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0895543098449707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.08972835540771484  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04522085189819336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04820394515991211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04820394515991211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04820394515991211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([64197, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04820394515991211  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([4967, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.16706609725952148  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.16706609725952148  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4967, 128]), torch.Size([1, 4967, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.17180299758911133  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.20969820022583008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4967, 128])
m.shape torch.Size([5020, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.21211719512939453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.21211719512939453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5020, 128]), torch.Size([1, 5020, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.2169046401977539  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.28871631622314453  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 5020, 128])
m.shape torch.Size([4350, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.29325389862060547  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.29325389862060547  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4350, 128]), torch.Size([1, 4350, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.29754161834716797  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.39016199111938477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4350, 128])
m.shape torch.Size([3664, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3949308395385742  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3949308395385742  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3664, 128]), torch.Size([1, 3664, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3993954658508301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5037188529968262  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3664, 128])
m.shape torch.Size([3081, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5093173980712891  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5093173980712891  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3081, 128]), torch.Size([1, 3081, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5129451751708984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6218528747558594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3081, 128])
m.shape torch.Size([2523, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6276021003723145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6276021003723145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2523, 128]), torch.Size([1, 2523, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6302742958068848  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7389249801635742  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2523, 128])
m.shape torch.Size([2146, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7452225685119629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7452225685119629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2146, 128]), torch.Size([1, 2146, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7474794387817383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8512625694274902  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2146, 128])
m.shape torch.Size([1941, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8584256172180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8584256172180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1941, 128]), torch.Size([1, 1941, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8602766990661621  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9657883644104004  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1941, 128])
m.shape torch.Size([1586, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9716691970825195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9716691970825195  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1586, 128]), torch.Size([1, 1586, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9731817245483398  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.0699834823608398  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1586, 128])
m.shape torch.Size([11928, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1261043548583984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1261043548583984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 11928, 128]), torch.Size([1, 11928, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.1374797821044922  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9521732330322266  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 11928, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.8525757789611816  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.8918728828430176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9311699867248535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.8915657997131348  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([41206, 256])
first layer input nodes number: 64197
first layer output nodes number: 41206
edges number: 237360
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9316506385803223  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9709477424621582  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9807720184326172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9807720184326172  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3599, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1416754722595215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1416754722595215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3599, 256]), torch.Size([1, 3599, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1485400199890137  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.203456401824951  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3599, 256])
m.shape torch.Size([3200, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2063465118408203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2063465118408203  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3200, 256]), torch.Size([1, 3200, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2129993438720703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3045520782470703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3200, 256])
m.shape torch.Size([2595, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3089828491210938  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3089828491210938  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2595, 256]), torch.Size([1, 2595, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3142595291137695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.4240026473999023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2595, 256])
m.shape torch.Size([2097, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.4295902252197266  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.4295902252197266  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2097, 256]), torch.Size([1, 2097, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.4340295791625977  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.553218364715576  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2097, 256])
m.shape torch.Size([1745, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.559229850769043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.559229850769043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1745, 256]), torch.Size([1, 1745, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.5628128051757812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.687641143798828  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1745, 256])
m.shape torch.Size([1360, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.693819999694824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.693819999694824  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1360, 256]), torch.Size([1, 1360, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.6965370178222656  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.8112425804138184  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1360, 256])
m.shape torch.Size([1152, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.8173604011535645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.8173604011535645  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1152, 256]), torch.Size([1, 1152, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.819784164428711  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.937497138977051  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1152, 256])
m.shape torch.Size([1036, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9436721801757812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9436721801757812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1036, 256]), torch.Size([1, 1036, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9457130432128906  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0619421005249023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1036, 256])
m.shape torch.Size([804, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0679092407226562  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0679092407226562  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0694427490234375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.170574188232422  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([720, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.176727771759033  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.176727771759033  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.178101062774658  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.276520252227783  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([571, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2818708419799805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2818708419799805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2829599380493164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3692550659179688  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([502, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3745007514953613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3745007514953613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.375458240509033  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4581799507141113  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([431, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4630866050720215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4630866050720215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4639086723327637  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5403170585632324  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([369, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5448713302612305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5448713302612305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5455751419067383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6156091690063477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([352, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6203322410583496  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6203322410583496  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6210036277770996  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.693650722503662  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([264, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6973748207092285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6973748207092285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.697878360748291  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7571024894714355  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([237, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.760723114013672  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.760723114013672  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7611751556396484  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.815420150756836  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([194, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8185505867004395  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8185505867004395  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.818920612335205  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8659138679504395  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([175, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.868924617767334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.868924617767334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.869258403778076  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9139857292175293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([162, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.916933059692383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.916933059692383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9172420501708984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9608097076416016  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.963319778442383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.963319778442383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.963571548461914  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.000833511352539  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.0036468505859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.0036468505859375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.003911972045898  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.045005798339844  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([110, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.047489166259766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.047489166259766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.047698974609375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.081687927246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([99, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.083867073059082  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.083867073059082  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.0840559005737305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.115967750549316  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([1263, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.1467790603637695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.1467790603637695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1263, 256]), torch.Size([1, 1263, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.150097846984863  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.579785346984863  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.443332195281982  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.446805477142334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.4502787590026855  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.44663143157959  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([23308, 40])
input nodes number: 41206
output nodes number: 23308
edges number: 162820
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.448007106781006  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.448008060455322  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05495786666870117  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 1 input nodes size: 48038
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04611635208129883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04611635208129883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06955385208129883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.06971979141235352  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.03893423080444336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04181718826293945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04181718826293945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04181718826293945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([48038, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04181718826293945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3758, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.14525556564331055  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.14525556564331055  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3758, 128]), torch.Size([1, 3758, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.14883947372436523  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.1794447898864746  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3758, 128])
m.shape torch.Size([3832, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.18130731582641602  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.18130731582641602  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3832, 128]), torch.Size([1, 3832, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.18589353561401367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.24297666549682617  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3832, 128])
m.shape torch.Size([3362, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.24595880508422852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.24595880508422852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3362, 128]), torch.Size([1, 3362, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.24957799911499023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.32265615463256836  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3362, 128])
m.shape torch.Size([2875, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3265366554260254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.3265366554260254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2875, 128]), torch.Size([1, 2875, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.32956743240356445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.411163330078125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2875, 128])
m.shape torch.Size([2485, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4153785705566406  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.4153785705566406  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2485, 128]), torch.Size([1, 2485, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.41778564453125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.5063080787658691  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2485, 128])
m.shape torch.Size([2091, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.510533332824707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.510533332824707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2091, 128]), torch.Size([1, 2091, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.512662410736084  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6034054756164551  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2091, 128])
m.shape torch.Size([1796, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.608403205871582  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.608403205871582  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1796, 128]), torch.Size([1, 1796, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6101160049438477  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.6957559585571289  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1796, 128])
m.shape torch.Size([1554, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7008275985717773  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7008275985717773  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1554, 128]), torch.Size([1, 1554, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7023096084594727  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7867841720581055  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1554, 128])
m.shape torch.Size([1361, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7918839454650879  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7918839454650879  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1361, 128]), torch.Size([1, 1361, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.7931818962097168  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.8762507438659668  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1361, 128])
m.shape torch.Size([11200, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9290075302124023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9290075302124023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 11200, 128]), torch.Size([1, 11200, 128])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.9396886825561523  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.7017126083374023  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 11200, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.6109628677368164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.6436872482299805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.6764116287231445  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.6434311866760254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([34314, 256])
first layer input nodes number: 48038
first layer output nodes number: 34314
edges number: 207232
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.676771640777588  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.709496021270752  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.717677116394043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.717677116394043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([2933, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.8943672180175781  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.8943672180175781  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2933, 256]), torch.Size([1, 2933, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.901045799255371  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9486494064331055  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2933, 256])
m.shape torch.Size([2709, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9503474235534668  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.9503474235534668  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2709, 256]), torch.Size([1, 2709, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 1.956615924835205  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.0365653038024902  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2709, 256])
m.shape torch.Size([2254, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.039888858795166  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.039888858795166  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2254, 256]), torch.Size([1, 2254, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.0446953773498535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1451306343078613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2254, 256])
m.shape torch.Size([1832, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1495914459228516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.1495914459228516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1832, 256]), torch.Size([1, 1832, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.153085708618164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2563605308532715  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1832, 256])
m.shape torch.Size([1538, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2618894577026367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.2618894577026367  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1538, 256]), torch.Size([1, 1538, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.265355110168457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3748178482055664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1538, 256])
m.shape torch.Size([1299, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3808422088623047  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3808422088623047  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1299, 256]), torch.Size([1, 1299, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.3834781646728516  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.4959826469421387  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1299, 256])
m.shape torch.Size([1104, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.502171516418457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.502171516418457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1104, 256]), torch.Size([1, 1104, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.5044965744018555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.613706111907959  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1104, 256])
m.shape torch.Size([916, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.619696617126465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.619696617126465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 916, 256]), torch.Size([1, 916, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.621443748474121  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.72165584564209  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 916, 256])
m.shape torch.Size([827, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.727936267852783  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.727936267852783  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.729513645172119  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.832876682281494  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([722, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.8390274047851562  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.8390274047851562  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.840404510498047  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9396133422851562  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([653, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.945828914642334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.945828914642334  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 653, 256]), torch.Size([1, 653, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 2.9470744132995605  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.0442233085632324  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 653, 256])
m.shape torch.Size([533, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.049747943878174  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.049747943878174  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.050764560699463  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.1382651329040527  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([470, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.143629550933838  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.143629550933838  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.1445260047912598  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2271571159362793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([429, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2324814796447754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.2324814796447754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.233299732208252  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.314415454864502  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([345, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3189802169799805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3189802169799805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.319638252258301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3910770416259766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([307, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3954691886901855  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.3954691886901855  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.396054744720459  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4645285606384277  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([312, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4697532653808594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.4697532653808594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.470348358154297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.543224334716797  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.547304153442383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.547304153442383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.5477867126464844  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.609071731567383  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([215, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6127567291259766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6127567291259766  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6131668090820312  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6681175231933594  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([239, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.672506809234619  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.672506809234619  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.6729626655578613  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7372384071350098  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([205, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7411484718322754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.7411484718322754  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.741539478302002  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.799408435821533  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([140, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8023996353149414  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8023996353149414  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.802666664123535  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8440561294555664  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([145, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.847128391265869  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.847128391265869  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.847404956817627  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8922085762023926  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([137, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.895230770111084  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.895230770111084  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.8954920768737793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.939652919769287  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([1739, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9813075065612793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9813075065612793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1739, 256]), torch.Size([1, 1739, 256])
----------------------------------------3
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 3.9846243858337402  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.569945812225342  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1739, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.416993618011475  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.42050313949585  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.423819541931152  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.420144081115723  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([22256, 40])
input nodes number: 34314
output nodes number: 22256
edges number: 179632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.419848918914795  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 4.419849395751953  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.04669761657714844  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

pseudo mini batch 2 input nodes size: 94161
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.03821706771850586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.03821706771850586  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.08311653137207031  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.08328962326049805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.05968618392944336  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0666046142578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0666046142578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0666046142578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([94161, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.5389404296875 GB
    Memory Allocated: 0.0666046142578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([3935, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.33292102813720703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.33292102813720703  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3935, 128]), torch.Size([1, 3935, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.3370699882507324  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.3680129051208496  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3935, 128])
m.shape torch.Size([4175, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.3698892593383789  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.3698892593383789  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 4175, 128]), torch.Size([1, 4175, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.373870849609375  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.4335947036743164  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 4175, 128])
m.shape torch.Size([3768, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.43746471405029297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.43746471405029297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3768, 128]), torch.Size([1, 3768, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.4412202835083008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.5221529006958008  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3768, 128])
m.shape torch.Size([3404, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.5268487930297852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.5268487930297852  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3404, 128]), torch.Size([1, 3404, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.5301733016967773  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.6254115104675293  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3404, 128])
m.shape torch.Size([3214, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.6314511299133301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.6314511299133301  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 3214, 128]), torch.Size([1, 3214, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.6346306800842285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.7461981773376465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 3214, 128])
m.shape torch.Size([2969, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.7538609504699707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.7538609504699707  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2969, 128]), torch.Size([1, 2969, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.7566924095153809  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.8785204887390137  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2969, 128])
m.shape torch.Size([2810, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.8870148658752441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.8870148658752441  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2810, 128]), torch.Size([1, 2810, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 0.8896946907043457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.0290932655334473  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2810, 128])
m.shape torch.Size([2601, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.0384726524353027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.0384726524353027  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2601, 128]), torch.Size([1, 2601, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.0409812927246094  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.1879348754882812  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2601, 128])
m.shape torch.Size([2487, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.1973676681518555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.1973676681518555  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2487, 128]), torch.Size([1, 2487, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.199793815612793  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.355689525604248  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2487, 128])
m.shape torch.Size([40513, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.547684669494629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.547684669494629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 40513, 128]), torch.Size([1, 40513, 128])
----------------------------------------3
 Nvidia-smi: 10.7967529296875 GB
    Memory Allocated: 1.586747169494629  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.341427803039551  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 40513, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.094954013824463  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.16221284866333  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.229471683502197  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.161692142486572  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

torch.Size([69876, 256])
first layer input nodes number: 94161
first layer output nodes number: 69876
edges number: 539080
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.230175495147705  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.297434329986572  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.313474178314209  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.313474178314209  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

m.shape torch.Size([2639, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.570563316345215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.570563316345215  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2639, 256]), torch.Size([1, 2639, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.575596809387207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.616131782531738  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2639, 256])
m.shape torch.Size([2313, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.618061542510986  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.618061542510986  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 2313, 256]), torch.Size([1, 2313, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.62278413772583  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.690950870513916  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 2313, 256])
m.shape torch.Size([1794, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.693918228149414  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.693918228149414  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1794, 256]), torch.Size([1, 1794, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.697551727294922  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.774791717529297  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1794, 256])
m.shape torch.Size([1375, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.778965950012207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.778965950012207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1375, 256]), torch.Size([1, 1375, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.781721591949463  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.8613200187683105  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1375, 256])
m.shape torch.Size([1237, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.86595344543457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.86595344543457  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.868437767028809  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.955598831176758  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
m.shape torch.Size([1015, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.960272789001465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.960272789001465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 4.9622087478637695  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.0459699630737305  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
m.shape torch.Size([851, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.050727844238281  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.050727844238281  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.052350997924805  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.1344804763793945  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([686, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.138943672180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.138943672180176  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 686, 256]), torch.Size([1, 686, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.140252113342285  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.215516090393066  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 686, 256])
m.shape torch.Size([662, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.220588684082031  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.220588684082031  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 662, 256]), torch.Size([1, 662, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.221851348876953  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.303518295288086  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 662, 256])
m.shape torch.Size([619, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.308836460113525  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.308836460113525  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 619, 256]), torch.Size([1, 619, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.310017108917236  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.395765781402588  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 619, 256])
m.shape torch.Size([533, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.400810718536377  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.400810718536377  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.401827335357666  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.481197834014893  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([515, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.486629486083984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.486629486083984  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.487611770629883  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.57110595703125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([430, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.575987815856934  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.575987815856934  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.576807975769043  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.654038429260254  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([374, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.658660888671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.658660888671875  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.659374237060547  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.730400085449219  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([360, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.735233783721924  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.735233783721924  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.735920429229736  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.809803485870361  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([337, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.815299034118652  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.815299034118652  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.81594181060791  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.889330863952637  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([296, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.893846035003662  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.893846035003662  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.894410610198975  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.963964939117432  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([334, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.9697089195251465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.9697089195251465  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 5.970345973968506  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.052510738372803  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([301, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.057689189910889  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.057689189910889  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.058263301849365  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.135542392730713  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([275, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.1405415534973145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.1405415534973145  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.141066074371338  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.217067241668701  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([273, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.222315311431885  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.222315311431885  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.222836017608643  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.302722454071045  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([208, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.306860446929932  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.306860446929932  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.307257175445557  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.368750095367432  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([194, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.372840404510498  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.372840404510498  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.373210430145264  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.433154582977295  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([205, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.4376983642578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.4376983642578125  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.438089370727539  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.504169464111328  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([5348, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.632481575012207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.632481575012207  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

 h.shape torch.Size([1, 5348, 256]), torch.Size([1, 5348, 256])
----------------------------------------3
 Nvidia-smi: 11.6151123046875 GB
    Memory Allocated: 6.642682075500488  GigaBytes
Max Memory Allocated: 8.413900375366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.441218376159668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 5348, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.205923557281494  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.209608554840088  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.21338701248169  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.209528923034668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

torch.Size([23174, 40])
input nodes number: 69876
output nodes number: 23174
edges number: 263330
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.210398197174072  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.7440185546875 GB
    Memory Allocated: 8.21039867401123  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.07775545120239258  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

pseudo mini batch 3 input nodes size: 95105
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.05986166000366211  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.05986166000366211  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.10521125793457031  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.1053767204284668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.06030416488647461  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.06382131576538086  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.06382131576538086  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.06382131576538086  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

torch.Size([95105, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.06382131576538086  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

m.shape torch.Size([5829, 1, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.23065805435180664  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.23065805435180664  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 5829, 128]), torch.Size([1, 5829, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.23657703399658203  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.28345203399658203  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 5829, 128])
m.shape torch.Size([5762, 2, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.28623151779174805  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.28623151779174805  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 5762, 128]), torch.Size([1, 5762, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.29172658920288086  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.37994956970214844  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 5762, 128])
m.shape torch.Size([4947, 3, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.38355016708374023  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.38355016708374023  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 4947, 128]), torch.Size([1, 4947, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.38826799392700195  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.4955286979675293  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 4947, 128])
m.shape torch.Size([4132, 4, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.5010509490966797  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.5010509490966797  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 4132, 128]), torch.Size([1, 4132, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.5053801536560059  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.619657039642334  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 4132, 128])
m.shape torch.Size([3594, 5, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.6262555122375488  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.6262555122375488  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 3594, 128]), torch.Size([1, 3594, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.6298527717590332  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.7545895576477051  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 3594, 128])
m.shape torch.Size([2871, 6, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.7607645988464355  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.7607645988464355  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 2871, 128]), torch.Size([1, 2871, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.7638578414916992  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.8851242065429688  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 2871, 128])
m.shape torch.Size([2526, 7, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.8921866416931152  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.8921866416931152  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 2526, 128]), torch.Size([1, 2526, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.8947587013244629  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.0167641639709473  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 2526, 128])
m.shape torch.Size([2241, 8, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.0238490104675293  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.0238490104675293  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 2241, 128]), torch.Size([1, 2241, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.0261178016662598  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.1510448455810547  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 2241, 128])
m.shape torch.Size([1947, 9, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.1583318710327148  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.1583318710327148  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 1947, 128]), torch.Size([1, 1947, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.1601886749267578  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.282911777496338  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 1947, 128])
m.shape torch.Size([19647, 10, 128])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.3756675720214844  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.3756675720214844  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 19647, 128]), torch.Size([1, 19647, 128])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 1.3948674201965332  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.7331271171569824  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 19647, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.588432788848877  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.6394505500793457  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.6904683113098145  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.639051914215088  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

torch.Size([53496, 256])
first layer input nodes number: 95105
first layer output nodes number: 53496
edges number: 333521
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.6911792755126953  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.742197036743164  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.7553863525390625  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.7553863525390625  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

m.shape torch.Size([4257, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.8935132026672363  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.8935132026672363  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 4257, 256]), torch.Size([1, 4257, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.902249813079834  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.9672064781188965  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 4257, 256])
m.shape torch.Size([3484, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.969843864440918  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.969843864440918  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 3484, 256]), torch.Size([1, 3484, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 2.977691650390625  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.0773696899414062  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 3484, 256])
m.shape torch.Size([2634, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.0816421508789062  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.0816421508789062  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 2634, 256]), torch.Size([1, 2634, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.0871691703796387  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.201523780822754  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 2634, 256])
m.shape torch.Size([2016, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.205982208251953  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.205982208251953  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 2016, 256]), torch.Size([1, 2016, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.2099385261535645  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.323884963989258  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 2016, 256])
m.shape torch.Size([1702, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.330141544342041  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.330141544342041  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 1702, 256]), torch.Size([1, 1702, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.333648204803467  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.452439785003662  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 1702, 256])
m.shape torch.Size([1194, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.457702159881592  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.457702159881592  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 1194, 256]), torch.Size([1, 1194, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.4601311683654785  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.559523105621338  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 1194, 256])
m.shape torch.Size([938, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.5645217895507812  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.5645217895507812  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 938, 256]), torch.Size([1, 938, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.5663108825683594  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.6557769775390625  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 938, 256])
m.shape torch.Size([834, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.6612954139709473  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.6612954139709473  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.662886142730713  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.7553277015686035  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([683, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.7604408264160156  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.7604408264160156  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.7617435455322266  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.845759391784668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 683, 256])
m.shape torch.Size([538, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.8502793312072754  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.8502793312072754  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.8513054847717285  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.924543857574463  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([446, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.928746223449707  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.928746223449707  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.9295969009399414  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 3.9987096786499023  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([387, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.002748012542725  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.002748012542725  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.003486156463623  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.06843376159668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([325, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.0721259117126465  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.0721259117126465  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.0727458000183105  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.132048606872559  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([262, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.1352643966674805  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.1352643966674805  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.135764122009277  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.186091423034668  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([232, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.1891865730285645  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.1891865730285645  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.189629077911377  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.236534595489502  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([203, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.239435195922852  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.239435195922852  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.2398223876953125  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.283575057983398  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([185, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.286404609680176  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.286404609680176  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.286757469177246  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.329100608825684  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([167, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.331813335418701  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.331813335418701  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.332131862640381  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.372584819793701  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([145, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.3750739097595215  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.3750739097595215  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.375350475311279  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.412410259246826  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([131, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.414790153503418  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.414790153503418  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.415040016174316  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.450270652770996  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([107, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.452305793762207  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.452305793762207  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.452509880065918  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.482714653015137  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.484071731567383  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.484071731567383  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.484203338623047  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.504602432250977  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.506084442138672  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.506084442138672  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.506217956542969  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.5278472900390625  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.529718399047852  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.529718399047852  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.529878616333008  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.556955337524414  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([1110, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.5835466384887695  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.5835466384887695  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

 h.shape torch.Size([1, 1110, 256]), torch.Size([1, 1110, 256])
----------------------------------------3
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.585857391357422  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.967283248901367  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

rst.shape  torch.Size([1, 1110, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.8549981117248535  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.858320713043213  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.861629486083984  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.8581414222717285  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

torch.Size([22203, 40])
input nodes number: 53496
output nodes number: 22203
edges number: 138468
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.858343124389648  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 4.858343601226807  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes
Using backend: pytorch

-----------------------------------------after loss backward
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.07069635391235352  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.07069635391235352  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 12.2479248046875 GB
    Memory Allocated: 0.07069635391235352  GigaBytes
Max Memory Allocated: 8.568724632263184  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03804904222488403 |0.002967357635498047 |0.1328398585319519 |0.00010466575622558594 |0.09401571750640869 |0.00373077392578125 |
----------------------------------------------------------pseudo_mini_loss sum 3.6539573669433594
Total (block generation + training)time/epoch 24.297412991523743
Training time/epoch 1.1275768280029297
Training time without block to device /epoch 1.1157073974609375
Training time without total dataloading part /epoch 0.911571741104126
load block tensor time/epoch 0.15219616889953613
block to device time/epoch 0.011869430541992188
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  500393
Number of first layer input nodes during this epoch:  301501
Number of first layer output nodes during this epoch:  198892
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
