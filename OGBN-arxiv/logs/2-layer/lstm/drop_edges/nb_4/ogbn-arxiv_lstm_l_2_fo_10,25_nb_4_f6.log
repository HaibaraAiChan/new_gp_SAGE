[04:25:53] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 4 parts and get 2001206 edge cuts
main start at this time 1651551932.6089394
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02791738510131836
global_2_local spend time (sec) 0.036336421966552734
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004491567611694336
A = g.adjacency_matrix() spent  0.007940530776977539
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07884097099304199
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3335418701171875
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2765426635742188

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.266 seconds
Metis partitioning: 5.040 seconds
Split the graph: 3.525 seconds
Construct subgraphs: 0.090 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.934518337249756
23276
23218
22189
22258
total k batches seeds list generation spend  20.138776540756226
after graph partition
graph partition algorithm spend time 20.27511692047119
23276
23218
22189
22258
partition_len_list
[36225, 38693, 52897, 69085]
shared_neighbor_graph_partition_s0 selection method  spend 20.358890295028687
time for parepare:  0.016936063766479492
local_output_nid generation:  0.002857685089111328
local_in_edges_tensor generation:  0.004412412643432617
mini_batch_src_global generation:  0.008026361465454102
r_  generation:  0.06496500968933105
local_output_nid generation:  0.003802776336669922
local_in_edges_tensor generation:  0.003894329071044922
mini_batch_src_global generation:  0.00715184211730957
r_  generation:  0.05516409873962402
local_output_nid generation:  0.003679990768432617
local_in_edges_tensor generation:  0.0034389495849609375
mini_batch_src_global generation:  0.006536960601806641
r_  generation:  0.05566906929016113
local_output_nid generation:  0.0038166046142578125
local_in_edges_tensor generation:  0.00483393669128418
mini_batch_src_global generation:  0.012031316757202148
r_  generation:  0.0859990119934082
----------------------check_connections_block total spend ----------------------------- 0.4260742664337158
generate_one_block  0.08867239952087402
generate_one_block  0.06578207015991211
generate_one_block  0.06945180892944336
generate_one_block  0.11726045608520508
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.051206111907958984
gen group dst list time:  0.005690336227416992
time for parepare:  0.02001357078552246
local_output_nid generation:  0.005199909210205078
local_in_edges_tensor generation:  0.018357276916503906
mini_batch_src_global generation:  0.0071375370025634766
r_  generation:  0.07929134368896484
local_output_nid generation:  0.008561372756958008
local_in_edges_tensor generation:  0.008725643157958984
mini_batch_src_global generation:  0.008023500442504883
r_  generation:  0.07794809341430664
local_output_nid generation:  0.011977910995483398
local_in_edges_tensor generation:  0.01251673698425293
mini_batch_src_global generation:  0.011274576187133789
r_  generation:  0.1315157413482666
local_output_nid generation:  0.012671947479248047
local_in_edges_tensor generation:  0.017724037170410156
mini_batch_src_global generation:  0.019919633865356445
r_  generation:  0.20471668243408203
----------------------check_connections_block total spend ----------------------------- 0.7718420028686523
generate_one_block  0.09881234169006348
generate_one_block  0.09393143653869629
generate_one_block  0.1573646068572998
generate_one_block  0.2530808448791504
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.7718420028686523
block generation total time  0.60318922996521
average batch blocks generation time:  0.1507973074913025
pseudo mini batch 0 input nodes size: 51954
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.028168201446533203  GigaBytes
Max Memory Allocated: 0.028168201446533203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02834177017211914  GigaBytes
Max Memory Allocated: 0.02834177017211914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02834177017211914  GigaBytes
Max Memory Allocated: 0.02834177017211914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146505355834961  GigaBytes
Max Memory Allocated: 0.03146505355834961  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146505355834961  GigaBytes
Max Memory Allocated: 0.03146505355834961  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146505355834961  GigaBytes
Max Memory Allocated: 0.03146505355834961  GigaBytes

torch.Size([51954, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.03146505355834961  GigaBytes
Max Memory Allocated: 0.03146505355834961  GigaBytes

m.shape torch.Size([3664, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14366769790649414  GigaBytes
Max Memory Allocated: 0.14515066146850586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14366769790649414  GigaBytes
Max Memory Allocated: 0.14515066146850586  GigaBytes

 h.shape torch.Size([1, 3664, 128]), torch.Size([1, 3664, 128])
----------------------------------------3
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.14716196060180664  GigaBytes
Max Memory Allocated: 0.14716196060180664  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1754288673400879  GigaBytes
Max Memory Allocated: 0.17717599868774414  GigaBytes

rst.shape  torch.Size([1, 3664, 128])
m.shape torch.Size([3813, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1774888038635254  GigaBytes
Max Memory Allocated: 0.17757463455200195  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3670654296875 GB
    Memory Allocated: 0.1774888038635254  GigaBytes
Max Memory Allocated: 0.17757463455200195  GigaBytes

 h.shape torch.Size([1, 3813, 128]), torch.Size([1, 3813, 128])
----------------------------------------3
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.18112516403198242  GigaBytes
Max Memory Allocated: 0.18112516403198242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.2356705665588379  GigaBytes
Max Memory Allocated: 0.23930692672729492  GigaBytes

rst.shape  torch.Size([1, 3813, 128])
m.shape torch.Size([3496, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.23885345458984375  GigaBytes
Max Memory Allocated: 0.23930692672729492  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.23885345458984375  GigaBytes
Max Memory Allocated: 0.23930692672729492  GigaBytes

 h.shape torch.Size([1, 3496, 128]), torch.Size([1, 3496, 128])
----------------------------------------3
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.24219655990600586  GigaBytes
Max Memory Allocated: 0.24219655990600586  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.3165884017944336  GigaBytes
Max Memory Allocated: 0.32158946990966797  GigaBytes

rst.shape  torch.Size([1, 3496, 128])
m.shape torch.Size([2958, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32111644744873047  GigaBytes
Max Memory Allocated: 0.32158946990966797  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32111644744873047  GigaBytes
Max Memory Allocated: 0.32158946990966797  GigaBytes

 h.shape torch.Size([1, 2958, 128]), torch.Size([1, 2958, 128])
----------------------------------------3
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.32428407669067383  GigaBytes
Max Memory Allocated: 0.32428407669067383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.40668535232543945  GigaBytes
Max Memory Allocated: 0.41232728958129883  GigaBytes

rst.shape  torch.Size([1, 2958, 128])
m.shape torch.Size([2557, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41137123107910156  GigaBytes
Max Memory Allocated: 0.41232728958129883  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41137123107910156  GigaBytes
Max Memory Allocated: 0.41232728958129883  GigaBytes

 h.shape torch.Size([1, 2557, 128]), torch.Size([1, 2557, 128])
----------------------------------------3
 Nvidia-smi: 1.6209716796875 GB
    Memory Allocated: 0.41407012939453125  GigaBytes
Max Memory Allocated: 0.41407012939453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5021634101867676  GigaBytes
Max Memory Allocated: 0.5082597732543945  GigaBytes

rst.shape  torch.Size([1, 2557, 128])
m.shape torch.Size([2153, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5070810317993164  GigaBytes
Max Memory Allocated: 0.5082597732543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5070810317993164  GigaBytes
Max Memory Allocated: 0.5082597732543945  GigaBytes

 h.shape torch.Size([1, 2153, 128]), torch.Size([1, 2153, 128])
----------------------------------------3
 Nvidia-smi: 1.7186279296875 GB
    Memory Allocated: 0.5094537734985352  GigaBytes
Max Memory Allocated: 0.5094537734985352  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5993523597717285  GigaBytes
Max Memory Allocated: 0.6055121421813965  GigaBytes

rst.shape  torch.Size([1, 2153, 128])
m.shape torch.Size([1921, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6047377586364746  GigaBytes
Max Memory Allocated: 0.6055121421813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.6047377586364746  GigaBytes
Max Memory Allocated: 0.6055121421813965  GigaBytes

 h.shape torch.Size([1, 1921, 128]), torch.Size([1, 1921, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.606569766998291  GigaBytes
Max Memory Allocated: 0.606569766998291  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.6981701850891113  GigaBytes
Max Memory Allocated: 0.7045822143554688  GigaBytes

rst.shape  torch.Size([1, 1921, 128])
m.shape torch.Size([1687, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.7036895751953125  GigaBytes
Max Memory Allocated: 0.7045822143554688  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9119873046875 GB
    Memory Allocated: 0.7036895751953125  GigaBytes
Max Memory Allocated: 0.7045822143554688  GigaBytes

 h.shape torch.Size([1, 1687, 128]), torch.Size([1, 1687, 128])
----------------------------------------3
 Nvidia-smi: 1.9139404296875 GB
    Memory Allocated: 0.7052984237670898  GigaBytes
Max Memory Allocated: 0.7052984237670898  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.7979030609130859  GigaBytes
Max Memory Allocated: 0.8043384552001953  GigaBytes

rst.shape  torch.Size([1, 1687, 128])
m.shape torch.Size([1423, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8032054901123047  GigaBytes
Max Memory Allocated: 0.8043384552001953  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8032054901123047  GigaBytes
Max Memory Allocated: 0.8043384552001953  GigaBytes

 h.shape torch.Size([1, 1423, 128]), torch.Size([1, 1423, 128])
----------------------------------------3
 Nvidia-smi: 2.0096435546875 GB
    Memory Allocated: 0.8045625686645508  GigaBytes
Max Memory Allocated: 0.8045625686645508  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.8930120468139648  GigaBytes
Max Memory Allocated: 0.8991189002990723  GigaBytes

rst.shape  torch.Size([1, 1423, 128])
m.shape torch.Size([12553, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9528803825378418  GigaBytes
Max Memory Allocated: 0.9542837142944336  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9528803825378418  GigaBytes
Max Memory Allocated: 0.9542837142944336  GigaBytes

 h.shape torch.Size([1, 12553, 128]), torch.Size([1, 12553, 128])
----------------------------------------3
 Nvidia-smi: 2.1893310546875 GB
    Memory Allocated: 0.9648518562316895  GigaBytes
Max Memory Allocated: 0.9648518562316895  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.814826488494873  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

rst.shape  torch.Size([1, 12553, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7179832458496094  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7525300979614258  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7870769500732422  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.7522597312927246  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

torch.Size([36225, 256])
first layer input nodes number: 51954
first layer output nodes number: 36225
edges number: 224593
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.787466049194336  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.8220129013061523  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.8313488960266113  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.8313488960266113  GigaBytes
Max Memory Allocated: 1.875373363494873  GigaBytes

m.shape torch.Size([2863, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.021982192993164  GigaBytes
Max Memory Allocated: 2.022465229034424  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.021982192993164  GigaBytes
Max Memory Allocated: 2.022465229034424  GigaBytes

 h.shape torch.Size([1, 2863, 256]), torch.Size([1, 2863, 256])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0274429321289062  GigaBytes
Max Memory Allocated: 2.0274429321289062  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0720200538635254  GigaBytes
Max Memory Allocated: 2.075169086456299  GigaBytes

rst.shape  torch.Size([1, 2863, 256])
m.shape torch.Size([2687, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0744547843933105  GigaBytes
Max Memory Allocated: 2.075169086456299  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.0744547843933105  GigaBytes
Max Memory Allocated: 2.075169086456299  GigaBytes

 h.shape torch.Size([1, 2687, 256]), torch.Size([1, 2687, 256])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.079874038696289  GigaBytes
Max Memory Allocated: 2.079874038696289  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.1575632095336914  GigaBytes
Max Memory Allocated: 2.1626882553100586  GigaBytes

rst.shape  torch.Size([1, 2687, 256])
m.shape torch.Size([2351, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.162741184234619  GigaBytes
Max Memory Allocated: 2.1627678871154785  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4471435546875 GB
    Memory Allocated: 2.162741184234619  GigaBytes
Max Memory Allocated: 2.1627678871154785  GigaBytes

 h.shape torch.Size([1, 2351, 256]), torch.Size([1, 2351, 256])
----------------------------------------3
 Nvidia-smi: 3.4666748046875 GB
    Memory Allocated: 2.1672253608703613  GigaBytes
Max Memory Allocated: 2.1672253608703613  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.2658772468566895  GigaBytes
Max Memory Allocated: 2.2726035118103027  GigaBytes

rst.shape  torch.Size([1, 2351, 256])
m.shape torch.Size([1909, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.270974636077881  GigaBytes
Max Memory Allocated: 2.2726035118103027  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.270974636077881  GigaBytes
Max Memory Allocated: 2.2726035118103027  GigaBytes

 h.shape torch.Size([1, 1909, 256]), torch.Size([1, 1909, 256])
----------------------------------------3
 Nvidia-smi: 3.5643310546875 GB
    Memory Allocated: 2.2749671936035156  GigaBytes
Max Memory Allocated: 2.2749671936035156  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3805599212646484  GigaBytes
Max Memory Allocated: 2.3878421783447266  GigaBytes

rst.shape  torch.Size([1, 1909, 256])
m.shape torch.Size([1616, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.386505603790283  GigaBytes
Max Memory Allocated: 2.3878421783447266  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.386505603790283  GigaBytes
Max Memory Allocated: 2.3878421783447266  GigaBytes

 h.shape torch.Size([1, 1616, 256]), torch.Size([1, 1616, 256])
----------------------------------------3
 Nvidia-smi: 3.7010498046875 GB
    Memory Allocated: 2.3896403312683105  GigaBytes
Max Memory Allocated: 2.3896403312683105  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.501192569732666  GigaBytes
Max Memory Allocated: 2.5088982582092285  GigaBytes

rst.shape  torch.Size([1, 1616, 256])
m.shape torch.Size([1344, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.5073485374450684  GigaBytes
Max Memory Allocated: 2.5088982582092285  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.5073485374450684  GigaBytes
Max Memory Allocated: 2.5088982582092285  GigaBytes

 h.shape torch.Size([1, 1344, 256]), torch.Size([1, 1344, 256])
----------------------------------------3
 Nvidia-smi: 3.8182373046875 GB
    Memory Allocated: 2.5099997520446777  GigaBytes
Max Memory Allocated: 2.5099997520446777  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.622927188873291  GigaBytes
Max Memory Allocated: 2.630617618560791  GigaBytes

rst.shape  torch.Size([1, 1344, 256])
m.shape torch.Size([1161, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6292905807495117  GigaBytes
Max Memory Allocated: 2.630617618560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6292905807495117  GigaBytes
Max Memory Allocated: 2.630617618560791  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 3.9158935546875 GB
    Memory Allocated: 2.6317129135131836  GigaBytes
Max Memory Allocated: 2.6317129135131836  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7475128173828125  GigaBytes
Max Memory Allocated: 2.755263328552246  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
m.shape torch.Size([990, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7536773681640625  GigaBytes
Max Memory Allocated: 2.755263328552246  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.7536773681640625  GigaBytes
Max Memory Allocated: 2.755263328552246  GigaBytes

 h.shape torch.Size([1, 990, 256]), torch.Size([1, 990, 256])
----------------------------------------3
 Nvidia-smi: 4.0330810546875 GB
    Memory Allocated: 2.755565643310547  GigaBytes
Max Memory Allocated: 2.755565643310547  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8672866821289062  GigaBytes
Max Memory Allocated: 2.8748397827148438  GigaBytes

rst.shape  torch.Size([1, 990, 256])
m.shape torch.Size([862, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8737993240356445  GigaBytes
Max Memory Allocated: 2.8748397827148438  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.8737993240356445  GigaBytes
Max Memory Allocated: 2.8748397827148438  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.1268310546875 GB
    Memory Allocated: 2.875443458557129  GigaBytes
Max Memory Allocated: 2.875443458557129  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.980668067932129  GigaBytes
Max Memory Allocated: 2.9880666732788086  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([773, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.9872756004333496  GigaBytes
Max Memory Allocated: 2.9880666732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.9872756004333496  GigaBytes
Max Memory Allocated: 2.9880666732788086  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.9887499809265137  GigaBytes
Max Memory Allocated: 2.9887499809265137  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.0945563316345215  GigaBytes
Max Memory Allocated: 3.101928234100342  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([692, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.10113525390625  GigaBytes
Max Memory Allocated: 3.101928234100342  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.10113525390625  GigaBytes
Max Memory Allocated: 3.101928234100342  GigaBytes

 h.shape torch.Size([1, 692, 256]), torch.Size([1, 692, 256])
----------------------------------------3
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 3.1024551391601562  GigaBytes
Max Memory Allocated: 3.1024551391601562  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.2054061889648438  GigaBytes
Max Memory Allocated: 3.212665557861328  GigaBytes

rst.shape  torch.Size([1, 692, 256])
m.shape torch.Size([574, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.211366653442383  GigaBytes
Max Memory Allocated: 3.212665557861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.211366653442383  GigaBytes
Max Memory Allocated: 3.212665557861328  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 4.4862060546875 GB
    Memory Allocated: 3.212461471557617  GigaBytes
Max Memory Allocated: 3.212665557861328  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.306184768676758  GigaBytes
Max Memory Allocated: 3.312753677368164  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([501, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3118972778320312  GigaBytes
Max Memory Allocated: 3.312753677368164  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3118972778320312  GigaBytes
Max Memory Allocated: 3.312753677368164  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 4.5877685546875 GB
    Memory Allocated: 3.3128528594970703  GigaBytes
Max Memory Allocated: 3.3128528594970703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 3.4026012420654297  GigaBytes
Max Memory Allocated: 3.4088125228881836  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([457, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 3.4082727432250977  GigaBytes
Max Memory Allocated: 3.4088125228881836  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 3.4082727432250977  GigaBytes
Max Memory Allocated: 3.4088125228881836  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 4.6756591796875 GB
    Memory Allocated: 3.409144401550293  GigaBytes
Max Memory Allocated: 3.409144401550293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.496875286102295  GigaBytes
Max Memory Allocated: 3.502976894378662  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([386, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.502004623413086  GigaBytes
Max Memory Allocated: 3.502976894378662  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.502004623413086  GigaBytes
Max Memory Allocated: 3.502976894378662  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 4.7479248046875 GB
    Memory Allocated: 3.5027408599853516  GigaBytes
Max Memory Allocated: 3.502976894378662  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 3.581851005554199  GigaBytes
Max Memory Allocated: 3.5873727798461914  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([325, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 3.5864810943603516  GigaBytes
Max Memory Allocated: 3.5873727798461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 3.5864810943603516  GigaBytes
Max Memory Allocated: 3.5873727798461914  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 3.5871009826660156  GigaBytes
Max Memory Allocated: 3.5873727798461914  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8865966796875 GB
    Memory Allocated: 3.6631851196289062  GigaBytes
Max Memory Allocated: 3.6681442260742188  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([331, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8865966796875 GB
    Memory Allocated: 3.668283462524414  GigaBytes
Max Memory Allocated: 3.668304443359375  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8865966796875 GB
    Memory Allocated: 3.668283462524414  GigaBytes
Max Memory Allocated: 3.668304443359375  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.8865966796875 GB
    Memory Allocated: 3.668914794921875  GigaBytes
Max Memory Allocated: 3.668914794921875  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.746201515197754  GigaBytes
Max Memory Allocated: 3.751567840576172  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([274, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.750626564025879  GigaBytes
Max Memory Allocated: 3.751567840576172  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.750626564025879  GigaBytes
Max Memory Allocated: 3.751567840576172  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.7511491775512695  GigaBytes
Max Memory Allocated: 3.751567840576172  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0233154296875 GB
    Memory Allocated: 3.818699836730957  GigaBytes
Max Memory Allocated: 3.8234033584594727  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([229, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0233154296875 GB
    Memory Allocated: 3.822620391845703  GigaBytes
Max Memory Allocated: 3.8234033584594727  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0233154296875 GB
    Memory Allocated: 3.822620391845703  GigaBytes
Max Memory Allocated: 3.8234033584594727  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 5.0233154296875 GB
    Memory Allocated: 3.823057174682617  GigaBytes
Max Memory Allocated: 3.8234033584594727  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.8815860748291016  GigaBytes
Max Memory Allocated: 3.885735511779785  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([255, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.8862695693969727  GigaBytes
Max Memory Allocated: 3.886288642883301  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.8862695693969727  GigaBytes
Max Memory Allocated: 3.886288642883301  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.1092529296875 GB
    Memory Allocated: 3.88675594329834  GigaBytes
Max Memory Allocated: 3.88675594329834  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.9553346633911133  GigaBytes
Max Memory Allocated: 3.960198402404785  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([227, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.9596734046936035  GigaBytes
Max Memory Allocated: 3.960198402404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.9596734046936035  GigaBytes
Max Memory Allocated: 3.960198402404785  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 5.1776123046875 GB
    Memory Allocated: 3.960106372833252  GigaBytes
Max Memory Allocated: 3.960198402404785  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2420654296875 GB
    Memory Allocated: 4.024185657501221  GigaBytes
Max Memory Allocated: 4.028731822967529  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([169, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.2420654296875 GB
    Memory Allocated: 4.027543067932129  GigaBytes
Max Memory Allocated: 4.028731822967529  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2420654296875 GB
    Memory Allocated: 4.027543067932129  GigaBytes
Max Memory Allocated: 4.028731822967529  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 5.2420654296875 GB
    Memory Allocated: 4.027865409851074  GigaBytes
Max Memory Allocated: 4.028731822967529  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2850341796875 GB
    Memory Allocated: 4.077828407287598  GigaBytes
Max Memory Allocated: 4.081374168395996  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([146, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.2850341796875 GB
    Memory Allocated: 4.080894947052002  GigaBytes
Max Memory Allocated: 4.081374168395996  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2850341796875 GB
    Memory Allocated: 4.080894947052002  GigaBytes
Max Memory Allocated: 4.081374168395996  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 5.2850341796875 GB
    Memory Allocated: 4.081173419952393  GigaBytes
Max Memory Allocated: 4.081374168395996  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3299560546875 GB
    Memory Allocated: 4.126286029815674  GigaBytes
Max Memory Allocated: 4.129659175872803  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([150, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.129607200622559  GigaBytes
Max Memory Allocated: 4.129659175872803  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3494873046875 GB
    Memory Allocated: 4.129607200622559  GigaBytes
Max Memory Allocated: 4.129659175872803  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 4.1298933029174805  GigaBytes
Max Memory Allocated: 4.1298933029174805  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4022216796875 GB
    Memory Allocated: 4.178244590759277  GigaBytes
Max Memory Allocated: 4.18167781829834  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([2004, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.4510498046875 GB
    Memory Allocated: 4.226253986358643  GigaBytes
Max Memory Allocated: 4.226440906524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4510498046875 GB
    Memory Allocated: 4.226253986358643  GigaBytes
Max Memory Allocated: 4.226440906524658  GigaBytes

 h.shape torch.Size([1, 2004, 256]), torch.Size([1, 2004, 256])
----------------------------------------3
 Nvidia-smi: 5.4510498046875 GB
    Memory Allocated: 4.230076313018799  GigaBytes
Max Memory Allocated: 4.230076313018799  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2225341796875 GB
    Memory Allocated: 4.913715839385986  GigaBytes
Max Memory Allocated: 4.9614949226379395  GigaBytes

rst.shape  torch.Size([1, 2004, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.746952533721924  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.751194477081299  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.755436420440674  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.751020908355713  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([23276, 40])
input nodes number: 36225
output nodes number: 23276
edges number: 194559
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.755706787109375  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.2459716796875 GB
    Memory Allocated: 4.755707740783691  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.044515132904052734  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

pseudo mini batch 1 input nodes size: 56232
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.035359859466552734  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.035359859466552734  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.06217336654663086  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.062346458435058594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.036782264709472656  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03941917419433594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03941917419433594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03941917419433594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([56232, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03941917419433594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

m.shape torch.Size([5311, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.14365053176879883  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.14365053176879883  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 5311, 128]), torch.Size([1, 5311, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.1494607925415039  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.18998050689697266  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 5311, 128])
m.shape torch.Size([5310, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.19251203536987305  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.19251203536987305  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 5310, 128]), torch.Size([1, 5310, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.19757652282714844  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.2736339569091797  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 5310, 128])
m.shape torch.Size([4469, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.2774949073791504  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.2774949073791504  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 4469, 128]), torch.Size([1, 4469, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.2826361656188965  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.37956762313842773  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 4469, 128])
m.shape torch.Size([3716, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.38372230529785156  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.38372230529785156  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3716, 128]), torch.Size([1, 3716, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.3873014450073242  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.49052906036376953  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3716, 128])
m.shape torch.Size([3042, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.49600982666015625  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.49600982666015625  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3042, 128]), torch.Size([1, 3042, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.4991874694824219  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.6086888313293457  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3042, 128])
m.shape torch.Size([2456, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.614264965057373  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.614264965057373  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2456, 128]), torch.Size([1, 2456, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.6168866157531738  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.7229123115539551  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2456, 128])
m.shape torch.Size([2013, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.7279744148254395  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.7279744148254395  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2013, 128]), torch.Size([1, 2013, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.7298941612243652  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.827216625213623  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2013, 128])
m.shape torch.Size([1761, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.8329744338989258  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.8329744338989258  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1761, 128]), torch.Size([1, 1761, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.8346538543701172  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.9303808212280273  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1761, 128])
m.shape torch.Size([1474, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.9358668327331543  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.9358668327331543  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.9372725486755371  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.027238368988037  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([9141, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.0701231956481934  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.0701231956481934  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 9141, 128]), torch.Size([1, 9141, 128])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.0797224044799805  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.6995491981506348  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 9141, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.6133246421813965  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.6502251625061035  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.6871256828308105  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.6499366760253906  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([38693, 256])
first layer input nodes number: 56232
first layer output nodes number: 38693
edges number: 207003
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.687546730041504  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.724447250366211  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.7336726188659668  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.7336726188659668  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

m.shape torch.Size([3930, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.8793444633483887  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.8793444633483887  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3930, 256]), torch.Size([1, 3930, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.8868403434753418  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.9485712051391602  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3930, 256])
m.shape torch.Size([3502, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.9507637023925781  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.9507637023925781  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3502, 256]), torch.Size([1, 3502, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 1.957796573638916  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.0579895973205566  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3502, 256])
m.shape torch.Size([2723, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.0625014305114746  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.0625014305114746  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2723, 256]), torch.Size([1, 2723, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.067826747894287  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.1830263137817383  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2723, 256])
m.shape torch.Size([2175, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.189497947692871  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.189497947692871  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2175, 256]), torch.Size([1, 2175, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.193690299987793  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.320990562438965  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2175, 256])
m.shape torch.Size([1778, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.3274388313293457  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.3274388313293457  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1778, 256]), torch.Size([1, 1778, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.3311753273010254  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.4580674171447754  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1778, 256])
m.shape torch.Size([1388, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.4639759063720703  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.4639759063720703  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1388, 256]), torch.Size([1, 1388, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.467484474182129  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.5978541374206543  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1388, 256])
m.shape torch.Size([1133, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.6033458709716797  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.6033458709716797  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1133, 256]), torch.Size([1, 1133, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.6055078506469727  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.7145371437072754  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1133, 256])
m.shape torch.Size([951, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.720686912536621  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.720686912536621  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.722500801086426  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.826573371887207  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([797, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.8325610160827637  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.8325610160827637  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.8340811729431152  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.9313712120056152  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([663, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.936983585357666  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.936983585357666  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 2.9382481575012207  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.0305538177490234  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([531, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.0355358123779297  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.0355358123779297  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.036548614501953  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.116177558898926  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([444, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.1207923889160156  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.1207923889160156  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.1216392517089844  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.1965198516845703  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([389, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.2009572982788086  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.2009572982788086  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.2016992568969727  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.270514488220215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([325, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.274517059326172  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.274517059326172  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.275136947631836  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.3386354446411133  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([304, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.3427085876464844  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.3427085876464844  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.3432884216308594  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.407655715942383  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([229, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4108877182006836  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4108877182006836  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4113245010375977  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4606809616088867  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([204, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4637961387634277  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4637961387634277  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.4641852378845215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.5108771324157715  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([175, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.5137104988098145  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.5137104988098145  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.5140442848205566  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.5564351081848145  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([160, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.559190273284912  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.559190273284912  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.559495449066162  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.600389003753662  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([134, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6036038398742676  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6036038398742676  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6038594245910645  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.639896869659424  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6421308517456055  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6421308517456055  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.6423540115356445  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.675381660461426  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.677427291870117  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.677427291870117  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.677621841430664  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7077770233154297  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([101, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7099127769470215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7099127769470215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7101054191589355  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7413134574890137  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([85, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.743177890777588  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.743177890777588  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.743340015411377  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.7707390785217285  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([878, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.791754722595215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.791754722595215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 878, 256]), torch.Size([1, 878, 256])
----------------------------------------3
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.793429374694824  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 4.089208602905273  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 878, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.969583511352539  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.9733314514160156  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.9767913818359375  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.972870349884033  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([23218, 40])
input nodes number: 38693
output nodes number: 23218
edges number: 146715
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.9725499153137207  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 3.972550392150879  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.04391288757324219  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

pseudo mini batch 2 input nodes size: 93420
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03600025177001953  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.03600025177001953  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.08054637908935547  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.08071184158325195  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.053725242614746094  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.057353973388671875  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.057353973388671875  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.057353973388671875  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([93420, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6248779296875 GB
    Memory Allocated: 0.057353973388671875  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

m.shape torch.Size([5463, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.22642183303833008  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.22642183303833008  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 5463, 128]), torch.Size([1, 5463, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.23163175582885742  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.27331113815307617  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 5463, 128])
m.shape torch.Size([5410, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.2758655548095703  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.2758655548095703  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 5410, 128]), torch.Size([1, 5410, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.2810502052307129  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3584408760070801  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 5410, 128])
m.shape torch.Size([4590, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.36249399185180664  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.36249399185180664  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 4590, 128]), torch.Size([1, 4590, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.3674330711364746  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.46465063095092773  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 4590, 128])
m.shape torch.Size([3903, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.4699063301086426  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.4699063301086426  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3903, 128]), torch.Size([1, 3903, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.47379255294799805  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5849790573120117  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3903, 128])
m.shape torch.Size([3422, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5903563499450684  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5903563499450684  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3422, 128]), torch.Size([1, 3422, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5936198234558105  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7111048698425293  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3422, 128])
m.shape torch.Size([2824, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.717552661895752  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.717552661895752  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2824, 128]), torch.Size([1, 2824, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7202811241149902  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.8400940895080566  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2824, 128])
m.shape torch.Size([2507, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.8464365005493164  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.8464365005493164  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2507, 128]), torch.Size([1, 2507, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.8489522933959961  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9727048873901367  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2507, 128])
m.shape torch.Size([2245, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9796690940856934  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9796690940856934  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2245, 128]), torch.Size([1, 2245, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.9818511009216309  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.1060309410095215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2245, 128])
m.shape torch.Size([1945, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.1133074760437012  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.1133074760437012  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1945, 128]), torch.Size([1, 1945, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.1151623725891113  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.234156608581543  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1945, 128])
m.shape torch.Size([20588, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.3314003944396973  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.3314003944396973  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 20588, 128]), torch.Size([1, 20588, 128])
----------------------------------------3
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 1.3510346412658691  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.7450661659240723  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 20588, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.598088264465332  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.6485347747802734  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.698981285095215  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.6481404304504395  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

torch.Size([52897, 256])
first layer input nodes number: 93420
first layer output nodes number: 52897
edges number: 338613
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.699679374694824  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.7501258850097656  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.76273775100708  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5057373046875 GB
    Memory Allocated: 2.76273775100708  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

m.shape torch.Size([4028, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9100255966186523  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9100255966186523  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 4028, 256]), torch.Size([1, 4028, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.917708396911621  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9798192977905273  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 4028, 256])
m.shape torch.Size([3311, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9823427200317383  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9823427200317383  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 3311, 256]), torch.Size([1, 3311, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 2.9888992309570312  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.084798812866211  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 3311, 256])
m.shape torch.Size([2522, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.0889134407043457  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.0889134407043457  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 2522, 256]), torch.Size([1, 2522, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.093972682952881  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.202749252319336  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 2522, 256])
m.shape torch.Size([1917, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.207620620727539  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.207620620727539  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1917, 256]), torch.Size([1, 1917, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.2115721702575684  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.3227381706237793  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1917, 256])
m.shape torch.Size([1634, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.3281893730163574  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.3281893730163574  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1634, 256]), torch.Size([1, 1634, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.3315682411193848  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.4513611793518066  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1634, 256])
m.shape torch.Size([1214, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.4566149711608887  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.4566149711608887  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1214, 256]), torch.Size([1, 1214, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.4591569900512695  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.563382148742676  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 1214, 256])
m.shape torch.Size([981, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.5687389373779297  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.5687389373779297  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 981, 256]), torch.Size([1, 981, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.5706100463867188  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.6673107147216797  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 981, 256])
m.shape torch.Size([900, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.673295497894287  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.673295497894287  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 900, 256]), torch.Size([1, 900, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.6750121116638184  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.7728590965270996  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 900, 256])
m.shape torch.Size([689, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.777960777282715  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.777960777282715  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 689, 256]), torch.Size([1, 689, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.7792749404907227  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.8640756607055664  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 689, 256])
m.shape torch.Size([568, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.86887788772583  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.86887788772583  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.8699612617492676  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.9482083320617676  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([462, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.9525513648986816  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.9525513648986816  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 3.953432559967041  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.023746967315674  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([426, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.028219699859619  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.028219699859619  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.029032230377197  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.099257946014404  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([341, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.103112697601318  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.103112697601318  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.103763103485107  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.163832187652588  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([290, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.167409420013428  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.167409420013428  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.167962551116943  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.2238078117370605  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([258, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.227603912353516  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.227603912353516  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.228096008300781  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.282070159912109  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([226, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.285299777984619  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.285299777984619  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.285730838775635  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.3344407081604  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([205, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.3375749588012695  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.3375749588012695  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.337965965270996  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.384886741638184  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([194, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.388047695159912  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.388047695159912  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.388417720794678  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.435410976409912  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([160, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.438148021697998  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.438148021697998  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.438453197479248  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.479346752166748  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([146, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.482000827789307  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.482000827789307  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.482279300689697  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.521543979644775  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([116, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.524184226989746  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.524184226989746  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.524405479431152  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.557150840759277  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([85, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.558837890625  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.558837890625  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.559000015258789  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.584129333496094  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.585949420928955  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.585949420928955  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.586113452911377  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.612686634063721  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([92, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.614727020263672  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.614727020263672  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.614902496337891  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.644557952880859  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([1338, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.676620006561279  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.676620006561279  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

 h.shape torch.Size([1, 1338, 256]), torch.Size([1, 1338, 256])
----------------------------------------3
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 4.67987585067749  GigaBytes
Max Memory Allocated: 4.978494167327881  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.135289669036865  GigaBytes
Max Memory Allocated: 5.167190074920654  GigaBytes

rst.shape  torch.Size([1, 1338, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.012047290802002  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.0157904624938965  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.020009517669678  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.016100883483887  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

torch.Size([22189, 40])
input nodes number: 52897
output nodes number: 22189
edges number: 148338
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.01694393157959  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6483154296875 GB
    Memory Allocated: 5.016944408416748  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.06499624252319336  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

pseudo mini batch 3 input nodes size: 95933
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.05400848388671875  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.05400848388671875  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.09975290298461914  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.09991884231567383  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.055207252502441406  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.06108283996582031  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.06108283996582031  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.06108283996582031  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

torch.Size([95933, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9334716796875 GB
    Memory Allocated: 0.06108283996582031  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

m.shape torch.Size([3935, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.3240375518798828  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.3240375518798828  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 3935, 128]), torch.Size([1, 3935, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.328127384185791  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.35895776748657227  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 3935, 128])
m.shape torch.Size([4095, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.36098670959472656  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.36098670959472656  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 4095, 128]), torch.Size([1, 4095, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.3652763366699219  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.4240303039550781  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 4095, 128])
m.shape torch.Size([3679, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.4273357391357422  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.4273357391357422  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 3679, 128]), torch.Size([1, 3679, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.4309868812561035  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.5088157653808594  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 3679, 128])
m.shape torch.Size([3317, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.5133881568908691  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.5133881568908691  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 3317, 128]), torch.Size([1, 3317, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.5171308517456055  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.6133284568786621  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 3317, 128])
m.shape torch.Size([3180, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.6185765266418457  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.6185765266418457  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 3180, 128]), torch.Size([1, 3180, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.6224265098571777  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.7326116561889648  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 3180, 128])
m.shape torch.Size([2857, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.7392692565917969  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.7392692565917969  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2857, 128]), torch.Size([1, 2857, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.7421479225158691  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.8621869087219238  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2857, 128])
m.shape torch.Size([2761, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.8703608512878418  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.8703608512878418  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2761, 128]), torch.Size([1, 2761, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 0.8730311393737793  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.00526762008667  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2761, 128])
m.shape torch.Size([2609, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.0139036178588867  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.0139036178588867  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2609, 128]), torch.Size([1, 2609, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.0163917541503906  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.162567138671875  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2609, 128])
m.shape torch.Size([2421, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.171712875366211  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.171712875366211  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2421, 128]), torch.Size([1, 2421, 128])
----------------------------------------3
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.1740570068359375  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 1.322256088256836  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2421, 128])
m.shape torch.Size([40231, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 1.5129380226135254  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 1.5129380226135254  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 40231, 128]), torch.Size([1, 40231, 128])
----------------------------------------3
 Nvidia-smi: 8.3846435546875 GB
    Memory Allocated: 1.5520005226135254  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.283724308013916  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 40231, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.03964376449585  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.105528354644775  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.171412944793701  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.105013370513916  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

torch.Size([69085, 256])
first layer input nodes number: 95933
first layer output nodes number: 69085
edges number: 533770
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.1721296310424805  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.238014221191406  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.254485607147217  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.0623779296875 GB
    Memory Allocated: 4.254485607147217  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

m.shape torch.Size([2607, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.503153324127197  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.503153324127197  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2607, 256]), torch.Size([1, 2607, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.5081257820129395  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.548520088195801  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2607, 256])
m.shape torch.Size([2206, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.551039218902588  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.551039218902588  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 2206, 256]), torch.Size([1, 2206, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.555281162261963  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.619932651519775  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 2206, 256])
m.shape torch.Size([1681, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.622675895690918  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.622675895690918  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 1681, 256]), torch.Size([1, 1681, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.626382827758789  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.69780158996582  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 1681, 256])
m.shape torch.Size([1319, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.701269626617432  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.701269626617432  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 1319, 256]), torch.Size([1, 1319, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.703885078430176  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.778068542480469  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 1319, 256])
m.shape torch.Size([1194, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.782416343688965  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.782416343688965  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 1194, 256]), torch.Size([1, 1194, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.784694671630859  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.86916971206665  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 1194, 256])
m.shape torch.Size([922, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.873096466064453  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.873096466064453  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 922, 256]), torch.Size([1, 922, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.874855041503906  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.954338073730469  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 922, 256])
m.shape torch.Size([770, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.958639621734619  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.958639621734619  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 770, 256]), torch.Size([1, 770, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 4.960108280181885  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.034103870391846  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 770, 256])
m.shape torch.Size([631, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.03822135925293  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.03822135925293  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.039424896240234  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.109371185302734  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([628, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.11420202255249  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.11420202255249  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

 h.shape torch.Size([1, 628, 256]), torch.Size([1, 628, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.1153998374938965  GigaBytes
Max Memory Allocated: 5.197818756103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.193089962005615  GigaBytes
Max Memory Allocated: 5.198480129241943  GigaBytes

rst.shape  torch.Size([1, 628, 256])
m.shape torch.Size([595, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.198209762573242  GigaBytes
Max Memory Allocated: 5.198480129241943  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.198209762573242  GigaBytes
Max Memory Allocated: 5.198480129241943  GigaBytes

 h.shape torch.Size([1, 595, 256]), torch.Size([1, 595, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.199344635009766  GigaBytes
Max Memory Allocated: 5.199344635009766  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.27992057800293  GigaBytes
Max Memory Allocated: 5.285594940185547  GigaBytes

rst.shape  torch.Size([1, 595, 256])
m.shape torch.Size([518, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.284830093383789  GigaBytes
Max Memory Allocated: 5.285594940185547  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.284830093383789  GigaBytes
Max Memory Allocated: 5.285594940185547  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.285818099975586  GigaBytes
Max Memory Allocated: 5.285818099975586  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.363870620727539  GigaBytes
Max Memory Allocated: 5.369304656982422  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([493, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.369062900543213  GigaBytes
Max Memory Allocated: 5.369304656982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.369062900543213  GigaBytes
Max Memory Allocated: 5.369304656982422  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.3700032234191895  GigaBytes
Max Memory Allocated: 5.3700032234191895  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.452002048492432  GigaBytes
Max Memory Allocated: 5.457643985748291  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([425, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.456842422485352  GigaBytes
Max Memory Allocated: 5.457643985748291  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.456842422485352  GigaBytes
Max Memory Allocated: 5.457643985748291  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.457653045654297  GigaBytes
Max Memory Allocated: 5.457653045654297  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.5327606201171875  GigaBytes
Max Memory Allocated: 5.538029670715332  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([362, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.537226676940918  GigaBytes
Max Memory Allocated: 5.538029670715332  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.537226676940918  GigaBytes
Max Memory Allocated: 5.538029670715332  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.537917137145996  GigaBytes
Max Memory Allocated: 5.538029670715332  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.607545375823975  GigaBytes
Max Memory Allocated: 5.6123785972595215  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([341, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.61211633682251  GigaBytes
Max Memory Allocated: 5.6123785972595215  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.61211633682251  GigaBytes
Max Memory Allocated: 5.6123785972595215  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.612766742706299  GigaBytes
Max Memory Allocated: 5.612766742706299  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.682889461517334  GigaBytes
Max Memory Allocated: 5.688111782073975  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([331, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.687826156616211  GigaBytes
Max Memory Allocated: 5.688111782073975  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.687826156616211  GigaBytes
Max Memory Allocated: 5.688111782073975  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.688457489013672  GigaBytes
Max Memory Allocated: 5.688457489013672  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.761601448059082  GigaBytes
Max Memory Allocated: 5.7666521072387695  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([290, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.766024589538574  GigaBytes
Max Memory Allocated: 5.7666521072387695  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.766024589538574  GigaBytes
Max Memory Allocated: 5.7666521072387695  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.76657772064209  GigaBytes
Max Memory Allocated: 5.7666521072387695  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.8346757888793945  GigaBytes
Max Memory Allocated: 5.839377403259277  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([305, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.8396759033203125  GigaBytes
Max Memory Allocated: 5.839696407318115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.8396759033203125  GigaBytes
Max Memory Allocated: 5.839696407318115  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.84025764465332  GigaBytes
Max Memory Allocated: 5.84025764465332  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.916589736938477  GigaBytes
Max Memory Allocated: 5.921825408935547  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([287, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.921540260314941  GigaBytes
Max Memory Allocated: 5.921825408935547  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.921540260314941  GigaBytes
Max Memory Allocated: 5.921825408935547  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.922087669372559  GigaBytes
Max Memory Allocated: 5.922087669372559  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 5.99739933013916  GigaBytes
Max Memory Allocated: 6.002599716186523  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([272, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.002354145050049  GigaBytes
Max Memory Allocated: 6.002599716186523  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.002354145050049  GigaBytes
Max Memory Allocated: 6.002599716186523  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.002872943878174  GigaBytes
Max Memory Allocated: 6.002872943878174  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.078575611114502  GigaBytes
Max Memory Allocated: 6.083763599395752  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([257, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.083503723144531  GigaBytes
Max Memory Allocated: 6.083763599395752  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.083503723144531  GigaBytes
Max Memory Allocated: 6.083763599395752  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.083993911743164  GigaBytes
Max Memory Allocated: 6.083993911743164  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.158612251281738  GigaBytes
Max Memory Allocated: 6.163759231567383  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([200, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.162596225738525  GigaBytes
Max Memory Allocated: 6.163759231567383  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.162596225738525  GigaBytes
Max Memory Allocated: 6.163759231567383  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.162977695465088  GigaBytes
Max Memory Allocated: 6.163759231567383  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.222105503082275  GigaBytes
Max Memory Allocated: 6.226301670074463  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([186, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.22602653503418  GigaBytes
Max Memory Allocated: 6.226301670074463  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.22602653503418  GigaBytes
Max Memory Allocated: 6.226301670074463  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.226381301879883  GigaBytes
Max Memory Allocated: 6.226381301879883  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.283853530883789  GigaBytes
Max Memory Allocated: 6.287933349609375  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([198, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.288243770599365  GigaBytes
Max Memory Allocated: 6.288261890411377  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.288243770599365  GigaBytes
Max Memory Allocated: 6.288261890411377  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.288621425628662  GigaBytes
Max Memory Allocated: 6.288621425628662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.352445125579834  GigaBytes
Max Memory Allocated: 6.3569769859313965  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([5240, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.478163719177246  GigaBytes
Max Memory Allocated: 6.478652000427246  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.478163719177246  GigaBytes
Max Memory Allocated: 6.478652000427246  GigaBytes

 h.shape torch.Size([1, 5240, 256]), torch.Size([1, 5240, 256])
----------------------------------------3
 Nvidia-smi: 10.3065185546875 GB
    Memory Allocated: 6.488158226013184  GigaBytes
Max Memory Allocated: 6.488158226013184  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.260430335998535  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 5240, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.032999992370605  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.03644847869873  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.039765357971191  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.036150932312012  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([22258, 40])
input nodes number: 69085
output nodes number: 22258
edges number: 254638
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.036537170410156  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.4315185546875 GB
    Memory Allocated: 8.036537647247314  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.07107019424438477  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.07662057876586914  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.07662057876586914  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04322457313537598 |0.08420544862747192 |0.2674560546875 |0.0001322031021118164 |0.09580838680267334 |0.005841732025146484 |
----------------------------------------------------------pseudo_mini_loss sum 5.319522857666016
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  494439
Number of first layer input nodes during this epoch:  297539
Number of first layer output nodes during this epoch:  196900
----------------------------------------before generate dataloader block 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.07662010192871094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01591944694519043
global_2_local spend time (sec) 0.042777061462402344
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043790340423583984
A = g.adjacency_matrix() spent  0.007508039474487305
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0788886547088623
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3241603374481201
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.364537000656128

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})[04:26:18] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 4 parts and get 1904294 edge cuts

Convert a graph into a bidirected graph: 1.316 seconds
Metis partitioning: 5.059 seconds
Split the graph: 3.525 seconds
Construct subgraphs: 0.046 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.960708618164062
23090
22641
22625
22585
total k batches seeds list generation spend  20.32384490966797
after graph partition
graph partition algorithm spend time 20.419811964035034
23090
22641
22625
22585
partition_len_list
[40375, 35491, 53450, 68577]
shared_neighbor_graph_partition_s0 selection method  spend 20.512492895126343
time for parepare:  0.017619609832763672
local_output_nid generation:  0.0031659603118896484
local_in_edges_tensor generation:  0.0035088062286376953
mini_batch_src_global generation:  0.005370616912841797
r_  generation:  0.057047128677368164
local_output_nid generation:  0.0037376880645751953
local_in_edges_tensor generation:  0.0045621395111083984
mini_batch_src_global generation:  0.00722503662109375
r_  generation:  0.0617060661315918
local_output_nid generation:  0.003911256790161133
local_in_edges_tensor generation:  0.0034198760986328125
mini_batch_src_global generation:  0.005377054214477539
r_  generation:  0.054291725158691406
local_output_nid generation:  0.003931999206542969
local_in_edges_tensor generation:  0.006186008453369141
mini_batch_src_global generation:  0.012763023376464844
r_  generation:  0.089019775390625
----------------------check_connections_block total spend ----------------------------- 0.4203979969024658
generate_one_block  0.0857076644897461
generate_one_block  0.09333133697509766
generate_one_block  0.07987451553344727
generate_one_block  0.1292588710784912
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0533442497253418
gen group dst list time:  0.005689144134521484
time for parepare:  0.02404475212097168
local_output_nid generation:  0.0062160491943359375
local_in_edges_tensor generation:  0.011830568313598633
mini_batch_src_global generation:  0.007308006286621094
r_  generation:  0.08859419822692871
local_output_nid generation:  0.008106231689453125
local_in_edges_tensor generation:  0.009677648544311523
mini_batch_src_global generation:  0.008422136306762695
r_  generation:  0.0841360092163086
local_output_nid generation:  0.0134429931640625
local_in_edges_tensor generation:  0.010691642761230469
mini_batch_src_global generation:  0.01294255256652832
r_  generation:  0.12849164009094238
local_output_nid generation:  0.012395143508911133
local_in_edges_tensor generation:  0.013867378234863281
mini_batch_src_global generation:  0.018544435501098633
r_  generation:  0.18935585021972656
----------------------check_connections_block total spend ----------------------------- 0.7637543678283691
generate_one_block  0.11048388481140137
generate_one_block  0.09560084342956543
generate_one_block  0.15645241737365723
generate_one_block  0.23777294158935547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.07662010192871094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

connection checking time:  0.7637543678283691
block generation total time  0.6003100872039795
average batch blocks generation time:  0.15007752180099487
block dataloader generation time/epoch 22.862258195877075
pseudo mini batch 0 input nodes size: 62245
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.060461997985839844  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.060461997985839844  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.09014272689819336  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.09031486511230469  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.04440450668334961  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.04733705520629883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.04733705520629883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.04733705520629883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([62245, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.04733705520629883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([4881, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.1637272834777832  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.1637272834777832  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4881, 128]), torch.Size([1, 4881, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.1692028045654297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.20668649673461914  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4881, 128])
m.shape torch.Size([4905, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.20909547805786133  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.20909547805786133  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4905, 128]), torch.Size([1, 4905, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.21377325057983398  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.2857513427734375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4905, 128])
m.shape torch.Size([4276, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.29042911529541016  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.29042911529541016  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4276, 128]), torch.Size([1, 4276, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.2947840690612793  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.38449811935424805  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4276, 128])
m.shape torch.Size([3541, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.38921308517456055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.38921308517456055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3541, 128]), torch.Size([1, 3541, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.39348411560058594  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.49489736557006836  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3541, 128])
m.shape torch.Size([3061, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5005068778991699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5005068778991699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3061, 128]), torch.Size([1, 3061, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.503654956817627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.6118984222412109  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3061, 128])
m.shape torch.Size([2488, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.617180347442627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.617180347442627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2488, 128]), torch.Size([1, 2488, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.6206164360046387  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.7255806922912598  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2488, 128])
m.shape torch.Size([2124, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.7314839363098145  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.7314839363098145  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2124, 128]), torch.Size([1, 2124, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.7338452339172363  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.837740421295166  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2124, 128])
m.shape torch.Size([1887, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.8441052436828613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.8441052436828613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1887, 128]), torch.Size([1, 1887, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.8459048271179199  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9484810829162598  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1887, 128])
m.shape torch.Size([1594, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9544219970703125  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9544219970703125  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1594, 128]), torch.Size([1, 1594, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9559421539306641  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.0537614822387695  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1594, 128])
m.shape torch.Size([11618, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.1084003448486328  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.1084003448486328  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 11618, 128]), torch.Size([1, 11618, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.1194801330566406  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9061450958251953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 11618, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.8075909614562988  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.8460955619812012  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.8846001625061035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.845794677734375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([40375, 256])
first layer input nodes number: 62245
first layer output nodes number: 40375
edges number: 232406
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.885066032409668  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9235706329345703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.933197021484375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.933197021484375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([3563, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.092339038848877  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.092339038848877  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3563, 256]), torch.Size([1, 3563, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.099134922027588  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.1535019874572754  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3563, 256])
m.shape torch.Size([3189, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.1562342643737793  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.1562342643737793  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3189, 256]), torch.Size([1, 3189, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.162574291229248  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.254951000213623  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3189, 256])
m.shape torch.Size([2570, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.259143829345703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.259143829345703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2570, 256]), torch.Size([1, 2570, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.2641658782958984  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.374286651611328  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2570, 256])
m.shape torch.Size([2042, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.379225730895996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.379225730895996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2042, 256]), torch.Size([1, 2042, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.383358955383301  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.501302719116211  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2042, 256])
m.shape torch.Size([1724, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.5076403617858887  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.5076403617858887  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1724, 256]), torch.Size([1, 1724, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.5112204551696777  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6362662315368652  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1724, 256])
m.shape torch.Size([1342, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6423611640930176  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6423611640930176  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1342, 256]), torch.Size([1, 1342, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.644928455352783  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.758997917175293  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1342, 256])
m.shape torch.Size([1157, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.7651686668395996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.7651686668395996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.7676138877868652  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.883073329925537  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
m.shape torch.Size([1003, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.8896822929382324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.8896822929382324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1003, 256]), torch.Size([1, 1003, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.8915953636169434  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.003535747528076  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1003, 256])
m.shape torch.Size([827, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.009733200073242  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.009733200073242  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.011310577392578  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.114253044128418  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([714, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.1203269958496094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.1203269958496094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.1216888427734375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.220775604248047  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([567, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.2260894775390625  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.2260894775390625  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.227170944213867  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.311899185180664  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([505, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.317183017730713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.317183017730713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.318146228790283  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4012227058410645  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([428, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4068288803100586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4068288803100586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4076452255249023  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4827489852905273  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([376, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.487400531768799  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.487400531768799  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4881176948547363  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.561710834503174  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([351, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.566579818725586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.566579818725586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.567249298095703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6405715942382812  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([261, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6442508697509766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6442508697509766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6447486877441406  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7022533416748047  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([233, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7058115005493164  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7058115005493164  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7062559127807617  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.759585380554199  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([202, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.762991428375244  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.762991428375244  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7633767127990723  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.812307834625244  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([187, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.815530300140381  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.815530300140381  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.815886974334717  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8636813163757324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([165, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8666749000549316  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8666749000549316  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8669896125793457  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9113640785217285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([126, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.913750171661377  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.913750171661377  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9139904975891113  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.949558734893799  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([137, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.952335834503174  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.952335834503174  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.952597141265869  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9930996894836426  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([98, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.99513578414917  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.99513578414917  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9953227043151855  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.025603771209717  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([98, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.02777099609375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.02777099609375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.027957916259766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.059547424316406  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([1225, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.088888645172119  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.088888645172119  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1225, 256]), torch.Size([1, 1225, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.0917277336120605  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.521872043609619  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1225, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.386476993560791  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.389917850494385  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.3933587074279785  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.389745712280273  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([23090, 40])
input nodes number: 40375
output nodes number: 23090
edges number: 161104
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.39021110534668  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 4.390212059020996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.053089141845703125  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

pseudo mini batch 1 input nodes size: 49884
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.044397830963134766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.044397830963134766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.06818437576293945  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.06835317611694336  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.038500308990478516  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.041425228118896484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.041425228118896484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.041425228118896484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([49884, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.041425228118896484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([4005, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.14742565155029297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.14742565155029297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4005, 128]), torch.Size([1, 4005, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.15175914764404297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.18283557891845703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4005, 128])
m.shape torch.Size([4017, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.18474531173706055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.18474531173706055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.18883085250854492  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.24735403060913086  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([3546, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.2501344680786133  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.2501344680786133  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3546, 128]), torch.Size([1, 3546, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.254117488861084  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.3310861587524414  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3546, 128])
m.shape torch.Size([3016, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.3353996276855469  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.3353996276855469  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3016, 128]), torch.Size([1, 3016, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.33869457244873047  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.42570018768310547  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3016, 128])
m.shape torch.Size([2572, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.43039417266845703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.43039417266845703  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2572, 128]), torch.Size([1, 2572, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.4328470230102539  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5211496353149414  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2572, 128])
m.shape torch.Size([2171, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5261344909667969  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5261344909667969  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2171, 128]), torch.Size([1, 2171, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.5282840728759766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.6233124732971191  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2171, 128])
m.shape torch.Size([1827, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.6275911331176758  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.6275911331176758  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1827, 128]), torch.Size([1, 1827, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.62933349609375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.7164516448974609  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1827, 128])
m.shape torch.Size([1605, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.721703052520752  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.721703052520752  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1605, 128]), torch.Size([1, 1605, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.723233699798584  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.8104805946350098  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1605, 128])
m.shape torch.Size([1389, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.815676212310791  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.815676212310791  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1389, 128]), torch.Size([1, 1389, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.8170008659362793  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9017786979675293  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1389, 128])
m.shape torch.Size([11343, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9552040100097656  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9552040100097656  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 11343, 128]), torch.Size([1, 11343, 128])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 0.9660215377807617  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.7352170944213867  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 11343, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.6439523696899414  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.6777992248535156  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.7116460800170898  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.677534580230713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([35491, 256])
first layer input nodes number: 49884
first layer output nodes number: 35491
edges number: 212187
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.712019920349121  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.7458667755126953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.754328727722168  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.754328727722168  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([3105, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9317712783813477  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9317712783813477  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3105, 256]), torch.Size([1, 3105, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9383811950683594  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9880361557006836  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3105, 256])
m.shape torch.Size([2790, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.989983081817627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.989983081817627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2790, 256]), torch.Size([1, 2790, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 1.9959487915039062  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.0757713317871094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2790, 256])
m.shape torch.Size([2344, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.080331802368164  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.080331802368164  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2344, 256]), torch.Size([1, 2344, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.0854239463806152  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.1849141120910645  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2344, 256])
m.shape torch.Size([1878, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.189903736114502  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.189903736114502  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1878, 256]), torch.Size([1, 1878, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.1935009956359863  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.2999324798583984  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1878, 256])
m.shape torch.Size([1561, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.305469512939453  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.305469512939453  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1561, 256]), torch.Size([1, 1561, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.3085098266601562  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.4174327850341797  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1561, 256])
m.shape torch.Size([1318, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.4233665466308594  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.4233665466308594  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1318, 256]), torch.Size([1, 1318, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.426114082336426  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.5396928787231445  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1318, 256])
m.shape torch.Size([1083, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.545722484588623  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.545722484588623  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1083, 256]), torch.Size([1, 1083, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.5478081703186035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6553382873535156  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1083, 256])
m.shape torch.Size([935, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6612706184387207  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6612706184387207  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 935, 256]), torch.Size([1, 935, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.6630539894104004  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.7676329612731934  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 935, 256])
m.shape torch.Size([808, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.773730754852295  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.773730754852295  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.7752718925476074  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.8739047050476074  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([720, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.880054473876953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.880054473876953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 720, 256]), torch.Size([1, 720, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.881427764892578  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.981037139892578  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 720, 256])
m.shape torch.Size([645, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.9871697425842285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.9871697425842285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 2.9883999824523926  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.0854125022888184  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([537, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.0909910202026367  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.0909910202026367  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 537, 256]), torch.Size([1, 537, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.092015266418457  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.180525779724121  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 537, 256])
m.shape torch.Size([472, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.185911178588867  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.185911178588867  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.1868114471435547  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.269904136657715  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([410, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.2749710083007812  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.2749710083007812  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.2757530212402344  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.3552932739257812  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([345, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.3598761558532715  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.3598761558532715  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.360534191131592  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4311299324035645  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([301, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4354300498962402  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.4354300498962402  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.436004161834717  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.501807689666748  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([314, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5066514015197754  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5066514015197754  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5072503089904785  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5808300971984863  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([253, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5849080085754395  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.5849080085754395  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.585390567779541  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6466755867004395  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([208, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6502327919006348  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6502327919006348  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.6506295204162598  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7037911415100098  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([229, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7079949378967285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7079949378967285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7084317207336426  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7700181007385254  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([209, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7744884490966797  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7744884490966797  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.7748870849609375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8338851928710938  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.836625099182129  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.836625099182129  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.83689022064209  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.877984046936035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([141, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8809685707092285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.8809685707092285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.881237506866455  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.924805164337158  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([137, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9278311729431152  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9278311729431152  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 10.9197998046875 GB
    Memory Allocated: 3.9280924797058105  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 3.9722533226013184  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([1759, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.014388561248779  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.014388561248779  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1759, 256]), torch.Size([1, 1759, 256])
----------------------------------------3
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.0177435874938965  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.608729839324951  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1759, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.455323219299316  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.459078788757324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.4624528884887695  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.458528518676758  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([22641, 40])
input nodes number: 35491
output nodes number: 22641
edges number: 180258
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.4592766761779785  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 4.459277153015137  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.047428131103515625  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

pseudo mini batch 2 input nodes size: 93149
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.03881502151489258  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.08323192596435547  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.08340072631835938  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.05944538116455078  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06299114227294922  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06299114227294922  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06299114227294922  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([93149, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06299114227294922  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([5811, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.22962093353271484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.22962093353271484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 5811, 128]), torch.Size([1, 5811, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.23516273498535156  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.28203773498535156  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 5811, 128])
m.shape torch.Size([5888, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.2848086357116699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.2848086357116699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 5888, 128]), torch.Size([1, 5888, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.2904238700866699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3746523857116699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 5888, 128])
m.shape torch.Size([4900, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.37885427474975586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.37885427474975586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4900, 128]), torch.Size([1, 4900, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.38422536849975586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.491208553314209  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4900, 128])
m.shape torch.Size([4101, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.49669408798217773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.49669408798217773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4101, 128]), torch.Size([1, 4101, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.5011968612670898  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6146163940429688  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4101, 128])
m.shape torch.Size([3579, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6211938858032227  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6211938858032227  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3579, 128]), torch.Size([1, 3579, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6249246597290039  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7504067420959473  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3579, 128])
m.shape torch.Size([2884, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7569513320922852  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7569513320922852  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2884, 128]), torch.Size([1, 2884, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.760033130645752  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8816800117492676  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2884, 128])
m.shape torch.Size([2516, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8887028694152832  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8887028694152832  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2516, 128]), torch.Size([1, 2516, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8912854194641113  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0141682624816895  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2516, 128])
m.shape torch.Size([2234, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0214905738830566  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0214905738830566  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2234, 128]), torch.Size([1, 2234, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0236563682556152  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1478400230407715  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2234, 128])
m.shape torch.Size([1951, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1551475524902344  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1551475524902344  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1951, 128]), torch.Size([1, 1951, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.157008171081543  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.2807130813598633  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1951, 128])
m.shape torch.Size([19586, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.373176097869873  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.373176097869873  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 19586, 128]), torch.Size([1, 19586, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.3918547630310059  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.7265658378601074  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 19586, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.5830225944519043  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.6339964866638184  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.6849703788757324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.6335978507995605  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([53450, 256])
first layer input nodes number: 93149
first layer output nodes number: 53450
edges number: 332793
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.685666561126709  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.736640453338623  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.7493839263916016  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.7493839263916016  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([4226, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.8917646408081055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.8917646408081055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4226, 256]), torch.Size([1, 4226, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.899825096130371  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.964308738708496  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4226, 256])
m.shape torch.Size([3556, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.9671144485473633  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.9671144485473633  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3556, 256]), torch.Size([1, 3556, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 2.973935127258301  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.0757875442504883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3556, 256])
m.shape torch.Size([2654, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.0800299644470215  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.0800299644470215  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2654, 256]), torch.Size([1, 2654, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.0855584144592285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.1985764503479004  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2654, 256])
m.shape torch.Size([2031, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.2038536071777344  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.2038536071777344  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2031, 256]), torch.Size([1, 2031, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.2079405784606934  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.321995735168457  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2031, 256])
m.shape torch.Size([1719, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.328320026397705  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.328320026397705  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1719, 256]), torch.Size([1, 1719, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.331638813018799  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.4502134323120117  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1719, 256])
m.shape torch.Size([1246, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.4556775093078613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.4556775093078613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.4581551551818848  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.564234733581543  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([1000, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.5692996978759766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.5692996978759766  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1000, 256]), torch.Size([1, 1000, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.571207046508789  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.6683902740478516  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1000, 256])
m.shape torch.Size([862, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.6740646362304688  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.6740646362304688  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.675708770751953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.7737932205200195  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([681, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.7788619995117188  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.7788619995117188  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.780160903930664  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.8649721145629883  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([565, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.869753360748291  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.869753360748291  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.87083101272583  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.948019504547119  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([465, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.952396869659424  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.952396869659424  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 3.9532837867736816  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.0232672691345215  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([390, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.027322292327881  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.027322292327881  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.028066158294678  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.092260837554932  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([331, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.096024990081787  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.096024990081787  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.096656322479248  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.156246662139893  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([287, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.159792900085449  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.159792900085449  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.160340309143066  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.216830253601074  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([240, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.220016956329346  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.220016956329346  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.220474720001221  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.268997669219971  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([224, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.272213459014893  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.272213459014893  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.272640705108643  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.320919513702393  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([179, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.3236308097839355  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.3236308097839355  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.323972225189209  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.3649420738220215  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([171, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.367730140686035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.367730140686035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.368056297302246  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.409478187561035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([152, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.412091255187988  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.412091255187988  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.412381172180176  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.451230049133301  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([131, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.453603267669678  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.453603267669678  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.453853130340576  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.489083766937256  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.491320610046387  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.491320610046387  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.491543769836426  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.524571418762207  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.526130676269531  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.526130676269531  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.526281356811523  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.5496368408203125  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([83, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.551396369934082  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.551396369934082  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.5515546798706055  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.577200889587402  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([86, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.579105854034424  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.579105854034424  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.579269886016846  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.606991291046143  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([1150, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.634541988372803  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.634541988372803  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.637007236480713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.040853977203369  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.923099040985107  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.926757335662842  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.930826187133789  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.926999092102051  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([22625, 40])
input nodes number: 53450
output nodes number: 22625
edges number: 143017
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.927182674407959  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.927183151245117  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.07005453109741211  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

pseudo mini batch 3 input nodes size: 93505
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.059061527252197266  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.059061527252197266  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.10364818572998047  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.10381650924682617  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.059230804443359375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06523656845092773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06523656845092773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06523656845092773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([93505, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.06523656845092773  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([3807, 1, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3278994560241699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3278994560241699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3807, 128]), torch.Size([1, 3807, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3315300941467285  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3630557060241699  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3807, 128])
m.shape torch.Size([4017, 2, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3648710250854492  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3648710250854492  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.3687019348144531  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.4273662567138672  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([3622, 3, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.43152332305908203  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.43152332305908203  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3622, 128]), torch.Size([1, 3622, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.4351658821105957  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.5129780769348145  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3622, 128])
m.shape torch.Size([3296, 4, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.5170044898986816  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.5170044898986816  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3296, 128]), torch.Size([1, 3296, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.520836353302002  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6155714988708496  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3296, 128])
m.shape torch.Size([3165, 5, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6218581199645996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6218581199645996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 3165, 128]), torch.Size([1, 3165, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.6248764991760254  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7335381507873535  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 3165, 128])
m.shape torch.Size([2856, 6, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7402000427246094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7402000427246094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2856, 128]), torch.Size([1, 2856, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.7430419921875  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8634610176086426  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2856, 128])
m.shape torch.Size([2743, 7, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8707895278930664  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8707895278930664  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2743, 128]), torch.Size([1, 2743, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 0.8744440078735352  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0052404403686523  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2743, 128])
m.shape torch.Size([2583, 8, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0137858390808105  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0137858390808105  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2583, 128]), torch.Size([1, 2583, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.0163135528564453  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1570935249328613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2583, 128])
m.shape torch.Size([2445, 9, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1663546562194824  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1663546562194824  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2445, 128]), torch.Size([1, 2445, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.1687941551208496  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.3243165016174316  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2445, 128])
m.shape torch.Size([40043, 10, 128])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.5132131576538086  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.5132131576538086  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 40043, 128]), torch.Size([1, 40043, 128])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 1.5522756576538086  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.273241996765137  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 40043, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.030913352966309  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.097115516662598  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.163317680358887  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.096604347229004  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

torch.Size([68577, 256])
first layer input nodes number: 93505
first layer output nodes number: 68577
edges number: 531152
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.1640167236328125  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.230218887329102  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.245767116546631  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.245767116546631  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

m.shape torch.Size([2534, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.498837471008301  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.498837471008301  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2534, 256]), torch.Size([1, 2534, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.503807067871094  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.544143199920654  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2534, 256])
m.shape torch.Size([2171, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.545899868011475  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.545899868011475  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 2171, 256]), torch.Size([1, 2171, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.551340579986572  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.616145610809326  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 2171, 256])
m.shape torch.Size([1709, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.6190032958984375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.6190032958984375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1709, 256]), torch.Size([1, 1709, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.622479438781738  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.695145606994629  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1709, 256])
m.shape torch.Size([1369, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.698659896850586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.698659896850586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1369, 256]), torch.Size([1, 1369, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.701329708099365  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.781070709228516  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1369, 256])
m.shape torch.Size([1218, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.785175323486328  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.785175323486328  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 1218, 256]), torch.Size([1, 1218, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.78767728805542  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.879109859466553  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 1218, 256])
m.shape torch.Size([962, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.883496284484863  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.883496284484863  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.885331153869629  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.966046333312988  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 962, 256])
m.shape torch.Size([805, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.970545291900635  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.970545291900635  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 4.972080707550049  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.048851490020752  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([672, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.053250789642334  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.053250789642334  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 672, 256]), torch.Size([1, 672, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.054532527923584  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.127591609954834  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 672, 256])
m.shape torch.Size([660, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.132659912109375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.132659912109375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.133918762207031  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.214485168457031  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 660, 256])
m.shape torch.Size([600, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.219622611999512  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.219622611999512  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.220767021179199  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.302096366882324  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([526, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.3070855140686035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.3070855140686035  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.308088779449463  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.386507511138916  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([505, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.3918304443359375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.3918304443359375  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.392793655395508  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.475515365600586  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([425, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.480344295501709  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.480344295501709  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.481154918670654  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.556834697723389  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([361, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.561407089233398  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.561407089233398  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.562095642089844  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.631722450256348  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([353, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.636467456817627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.636467456817627  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.63714075088501  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.711349010467529  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([325, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.716010570526123  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.716010570526123  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.716630458831787  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.789607524871826  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([304, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.794264793395996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.794264793395996  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.794844627380371  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.866833686828613  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([322, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.872114658355713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.872114658355713  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.8727288246154785  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.951700687408447  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([289, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.956671237945557  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.956671237945557  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 5.9572224617004395  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.033143997192383  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([282, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.038289546966553  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.038289546966553  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.038827419281006  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.115170955657959  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([265, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.120250701904297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.120250701904297  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.120756149291992  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.197353363037109  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([201, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.201351165771484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.201351165771484  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.20173454284668  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.261157989501953  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([197, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.265321254730225  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.265321254730225  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.265697002410889  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes
[04:26:42] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 4 parts and get 1986736 edge cuts

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.326568126678467  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([204, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.331086158752441  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.331086158752441  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.331475257873535  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.397233009338379  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([5326, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.525019645690918  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.525019645690918  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

 h.shape torch.Size([1, 5326, 256]), torch.Size([1, 5326, 256])
----------------------------------------3
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 6.535178184509277  GigaBytes
Max Memory Allocated: 8.385430335998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.330899238586426  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 5326, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.097814559936523  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.102108001708984  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.106401443481445  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.101939678192139  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([22585, 40])
input nodes number: 68577
output nodes number: 22585
edges number: 259871
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.103540897369385  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.9490966796875 GB
    Memory Allocated: 8.103541374206543  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07708072662353516  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07708072662353516  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07708072662353516  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03921186923980713 |0.0032126307487487793 |0.1319948434829712 |0.0001036524772644043 |0.09444856643676758 |0.0047414302825927734 |
----------------------------------------------------------pseudo_mini_loss sum 4.566486358642578
Total (block generation + training)time/epoch 23.981725692749023
Training time/epoch 1.1191740036010742
Training time without block to device /epoch 1.106323480606079
Training time without total dataloading part /epoch 0.9109296798706055
load block tensor time/epoch 0.15684747695922852
block to device time/epoch 0.012850522994995117
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  496676
Number of first layer input nodes during this epoch:  298783
Number of first layer output nodes during this epoch:  197893
----------------------------------------before generate dataloader block 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07708024978637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020450592041015625
global_2_local spend time (sec) 0.04341936111450195
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004151344299316406
A = g.adjacency_matrix() spent  0.012223958969116211
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08277368545532227
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3047528266906738
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1713011264801025

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.336 seconds
Metis partitioning: 4.985 seconds
Split the graph: 3.419 seconds
Construct subgraphs: 0.038 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.79240608215332
22532
22445
23260
22704
total k batches seeds list generation spend  19.81146812438965
after graph partition
graph partition algorithm spend time 19.904525756835938
22532
22445
23260
22704
partition_len_list
[68309, 50885, 40401, 35523]
shared_neighbor_graph_partition_s0 selection method  spend 20.001201629638672
time for parepare:  0.017026424407958984
local_output_nid generation:  0.003163576126098633
local_in_edges_tensor generation:  0.003950595855712891
mini_batch_src_global generation:  0.009010553359985352
r_  generation:  0.08364057540893555
local_output_nid generation:  0.0042934417724609375
local_in_edges_tensor generation:  0.0037713050842285156
mini_batch_src_global generation:  0.0067598819732666016
r_  generation:  0.05705070495605469
local_output_nid generation:  0.004434347152709961
local_in_edges_tensor generation:  0.004194021224975586
mini_batch_src_global generation:  0.005392789840698242
r_  generation:  0.0614774227142334
local_output_nid generation:  0.004354238510131836
local_in_edges_tensor generation:  0.0036792755126953125
mini_batch_src_global generation:  0.0065937042236328125
r_  generation:  0.06428647041320801
----------------------check_connections_block total spend ----------------------------- 0.4118483066558838
generate_one_block  0.13130760192871094
generate_one_block  0.071319580078125
generate_one_block  0.07404899597167969
generate_one_block  0.08044934272766113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03586983680725098
gen group dst list time:  0.005585432052612305
time for parepare:  0.02382683753967285
local_output_nid generation:  0.009496927261352539
local_in_edges_tensor generation:  0.02021336555480957
mini_batch_src_global generation:  0.03405451774597168
r_  generation:  0.1903543472290039
local_output_nid generation:  0.011789321899414062
local_in_edges_tensor generation:  0.009909868240356445
mini_batch_src_global generation:  0.015916824340820312
r_  generation:  0.13164496421813965
local_output_nid generation:  0.00928807258605957
local_in_edges_tensor generation:  0.008735895156860352
mini_batch_src_global generation:  0.010046005249023438
r_  generation:  0.09523773193359375
local_output_nid generation:  0.008971691131591797
local_in_edges_tensor generation:  0.006125926971435547
mini_batch_src_global generation:  0.009369850158691406
r_  generation:  0.08028149604797363
----------------------check_connections_block total spend ----------------------------- 0.8039226531982422
generate_one_block  0.23966193199157715
generate_one_block  0.1562809944152832
generate_one_block  0.11094784736633301
generate_one_block  0.09727621078491211
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07708024978637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

connection checking time:  0.8039226531982422
block generation total time  0.6041669845581055
average batch blocks generation time:  0.15104174613952637
block dataloader generation time/epoch 22.5908203125
pseudo mini batch 0 input nodes size: 93017
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06015157699584961  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06015157699584961  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.10450553894042969  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.10467386245727539  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.059918880462646484  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06631278991699219  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06631278991699219  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06631278991699219  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([93017, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06631278991699219  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([3814, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3268733024597168  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3268733024597168  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3814, 128]), torch.Size([1, 3814, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.33051061630249023  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3610239028930664  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3814, 128])
m.shape torch.Size([4040, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3628425598144531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3628425598144531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4040, 128]), torch.Size([1, 4040, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.36739444732666016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4262056350708008  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4040, 128])
m.shape torch.Size([3633, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.42961788177490234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.42961788177490234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3633, 128]), torch.Size([1, 3633, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.43354368209838867  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5113730430603027  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3633, 128])
m.shape torch.Size([3273, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5154080390930176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5154080390930176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3273, 128]), torch.Size([1, 3273, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5193042755126953  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6139712333679199  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3273, 128])
m.shape torch.Size([3078, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6189460754394531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6189460754394531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3078, 128]), torch.Size([1, 3078, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6227774620056152  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7310795783996582  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3078, 128])
m.shape torch.Size([2864, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7384181022644043  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7384181022644043  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2864, 128]), torch.Size([1, 2864, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7412376403808594  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8607444763183594  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2864, 128])
m.shape torch.Size([2726, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8684778213500977  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8684778213500977  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2726, 128]), torch.Size([1, 2726, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8711433410644531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0019054412841797  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2726, 128])
m.shape torch.Size([2516, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0102033615112305  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0102033615112305  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2516, 128]), torch.Size([1, 2516, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0128364562988281  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.1519527435302734  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2516, 128])
m.shape torch.Size([2417, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.161125659942627  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.161125659942627  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2417, 128]), torch.Size([1, 2417, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.163477897644043  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.3115243911743164  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2417, 128])
m.shape torch.Size([39948, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.5008587837219238  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.5008587837219238  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 39948, 128]), torch.Size([1, 39948, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.5399212837219238  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.255451679229736  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 39948, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.015114784240723  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.080259323120117  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.145403861999512  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.079750061035156  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([68309, 256])
first layer input nodes number: 93017
first layer output nodes number: 68309
edges number: 528902
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.146099090576172  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.211243629455566  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.227530002593994  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.227530002593994  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([2601, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.478541851043701  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.478541851043701  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2601, 256]), torch.Size([1, 2601, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.484659194946289  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.524385452270508  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2601, 256])
m.shape torch.Size([2254, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.526899814605713  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.526899814605713  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2254, 256]), torch.Size([1, 2254, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.531487941741943  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.596530437469482  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2254, 256])
m.shape torch.Size([1736, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.599201679229736  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.599201679229736  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1736, 256]), torch.Size([1, 1736, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.602601051330566  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.677528381347656  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1736, 256])
m.shape torch.Size([1322, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.680680751800537  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.680680751800537  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1322, 256]), torch.Size([1, 1322, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.683346271514893  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.762332916259766  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1322, 256])
m.shape torch.Size([1181, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.766078472137451  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.766078472137451  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1181, 256]), torch.Size([1, 1181, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.768413066864014  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.854451656341553  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1181, 256])
m.shape torch.Size([957, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.858580112457275  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.858580112457275  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.860405445098877  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.941047191619873  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([788, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.945436477661133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.945436477661133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 788, 256]), torch.Size([1, 788, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.946939468383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.022089004516602  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 788, 256])
m.shape torch.Size([640, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.02625846862793  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.02625846862793  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.02747917175293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.097623825073242  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([643, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.102575778961182  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.102575778961182  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.10380220413208  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.18229341506958  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([596, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.187408924102783  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.187408924102783  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.1885457038879395  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.269882678985596  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([518, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.274791240692139  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.274791240692139  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 518, 256]), torch.Size([1, 518, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.2757792472839355  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.353114604949951  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 518, 256])
m.shape torch.Size([497, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.358353137969971  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.358353137969971  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.3593010902404785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.441517353057861  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([436, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.447345733642578  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.447345733642578  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.448177337646484  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.525021553039551  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([359, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.5294365882873535  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.5294365882873535  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.530121326446533  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.599335193634033  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([356, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.604125499725342  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.604125499725342  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.604804515838623  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.678630352020264  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([332, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.683396339416504  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.683396339416504  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.684029579162598  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.758156776428223  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([304, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.762807369232178  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.762807369232178  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.763387203216553  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.835835933685303  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([322, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.841116905212402  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.841116905212402  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.841731071472168  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.920496940612793  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([290, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.925486087799072  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.925486087799072  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 5.926039218902588  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.002365589141846  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([264, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.007164001464844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.007164001464844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.007667541503906  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.0806474685668945  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([263, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.085704326629639  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.085704326629639  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.086205959320068  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.16204309463501  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([198, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.165979385375977  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.165979385375977  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.166357040405273  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.224893569946289  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([198, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.229082107543945  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.229082107543945  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.229459762573242  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.290639877319336  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([197, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.294995307922363  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.294995307922363  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.295371055603027  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.358872413635254  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([5280, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.485559940338135  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.485559940338135  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 5280, 256]), torch.Size([1, 5280, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 6.495630741119385  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.28863000869751  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 5280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.057267189025879  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.06119155883789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.064549446105957  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.0604567527771  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([22532, 40])
input nodes number: 68309
output nodes number: 22532
edges number: 257558
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.060765266418457  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 8.060766220092773  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.07619953155517578  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

pseudo mini batch 1 input nodes size: 88993
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05955076217651367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05955076217651367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.10198593139648438  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.10215330123901367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05763101577758789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.061040401458740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.061040401458740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.061040401458740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([88993, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.061040401458740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([5692, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2187180519104004  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2187180519104004  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 5692, 128]), torch.Size([1, 5692, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.22414636611938477  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.271883487701416  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 5692, 128])
m.shape torch.Size([5602, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2745976448059082  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2745976448059082  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 5602, 128]), torch.Size([1, 5602, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.279940128326416  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.36257505416870117  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 5602, 128])
m.shape torch.Size([4711, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3658103942871094  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3658103942871094  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4711, 128]), torch.Size([1, 4711, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3703031539916992  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4691438674926758  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4711, 128])
m.shape torch.Size([3877, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4742922782897949  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4742922782897949  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3877, 128]), torch.Size([1, 3877, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.47850656509399414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5866360664367676  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3877, 128])
m.shape torch.Size([3354, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5927839279174805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5927839279174805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3354, 128]), torch.Size([1, 3354, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5961480140686035  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7133355140686035  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3354, 128])
m.shape torch.Size([2705, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.719393253326416  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.719393253326416  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2705, 128]), torch.Size([1, 2705, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7219805717468262  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.835453987121582  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2705, 128])
m.shape torch.Size([2311, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8417196273803711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8417196273803711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2311, 128]), torch.Size([1, 2311, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8442950248718262  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9610905647277832  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2311, 128])
m.shape torch.Size([2098, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9685001373291016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9685001373291016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2098, 128]), torch.Size([1, 2098, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9705886840820312  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0885887145996094  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2098, 128])
m.shape torch.Size([1800, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0953130722045898  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.0953130722045898  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1800, 128]), torch.Size([1, 1800, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.097029685974121  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.206892967224121  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1800, 128])
m.shape torch.Size([18735, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.295370101928711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.295370101928711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 18735, 128]), torch.Size([1, 18735, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.313237190246582  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5818004608154297  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 18735, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.444451332092285  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.492979049682617  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.541506767272949  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.4925994873046875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([50885, 256])
first layer input nodes number: 88993
first layer output nodes number: 50885
edges number: 316048
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5421719551086426  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5906996726989746  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6028318405151367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6028318405151367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([4259, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7437729835510254  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7437729835510254  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4259, 256]), torch.Size([1, 4259, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.751896381378174  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.8168835639953613  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4259, 256])
m.shape torch.Size([3503, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.8202733993530273  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.8202733993530273  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3503, 256]), torch.Size([1, 3503, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.8275809288024902  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.927802562713623  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3503, 256])
m.shape torch.Size([2592, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9322590827941895  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9322590827941895  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2592, 256]), torch.Size([1, 2592, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9377331733703613  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.050320625305176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2592, 256])
m.shape torch.Size([2022, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0552849769592285  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0552849769592285  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2022, 256]), torch.Size([1, 2022, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0591559410095215  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1710495948791504  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2022, 256])
m.shape torch.Size([1719, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.177370071411133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.177370071411133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1719, 256]), torch.Size([1, 1719, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1806983947753906  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.301447868347168  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1719, 256])
m.shape torch.Size([1210, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3061795234680176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3061795234680176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1210, 256]), torch.Size([1, 1210, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3086190223693848  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4163198471069336  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1210, 256])
m.shape torch.Size([996, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.421421527862549  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.421421527862549  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 996, 256]), torch.Size([1, 996, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.42332124710083  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.520519733428955  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 996, 256])
m.shape torch.Size([861, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5261902809143066  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5261902809143066  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.527832508087158  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.6217761039733887  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([708, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.627079486846924  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.627079486846924  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.628429889678955  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.717957019805908  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([569, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.722750663757324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.722750663757324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7238359451293945  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.802168369293213  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([453, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.80641508102417  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.80641508102417  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.807279109954834  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8785386085510254  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([391, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8826165199279785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8826165199279785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.883362293243408  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9475932121276855  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([327, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9513063430786133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9513063430786133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.951930046081543  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.011722564697266  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([281, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.015192031860352  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.015192031860352  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.015727996826172  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.0695905685424805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([225, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.072566509246826  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.072566509246826  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.072995662689209  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.118485927581787  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([203, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.121393203735352  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.121393203735352  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.1217803955078125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.165533065795898  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([174, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.168929576873779  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.168929576873779  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.169261455535889  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.209086894989014  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([174, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.211931228637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.211931228637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.212263107299805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.254411697387695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([150, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.256985187530518  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.256985187530518  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.2572712898254395  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.295608997344971  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([146, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.298272609710693  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.298272609710693  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.298551082611084  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.337815761566162  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.33979606628418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.33979606628418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.339996337890625  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.369636535644531  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([87, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.371376037597656  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.371376037597656  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.371541976928711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.3972625732421875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.3987274169921875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.3987274169921875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.398860931396484  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.420490264892578  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([89, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.422476768493652  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.422476768493652  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.422646522521973  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.4513349533081055  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([1131, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.478425979614258  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.478425979614258  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.481058120727539  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.863718032836914  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.746908664703369  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.750894069671631  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.754239082336426  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.750086307525635  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([22445, 40])
input nodes number: 50885
output nodes number: 22445
edges number: 141389
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.750694274902344  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.750694751739502  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06761789321899414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

pseudo mini batch 2 input nodes size: 63311
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05769205093383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05769205093383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.08788108825683594  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.08805465698242188  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.045452117919921875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04840660095214844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04840660095214844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04840660095214844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([63311, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04840660095214844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([4851, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.16530990600585938  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.16530990600585938  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4851, 128]), torch.Size([1, 4851, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.17027711868286133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2077465057373047  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4851, 128])
m.shape torch.Size([4903, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.21021270751953125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.21021270751953125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4903, 128]), torch.Size([1, 4903, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2148885726928711  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2867112159729004  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4903, 128])
m.shape torch.Size([4248, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.28962230682373047  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.28962230682373047  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 4248, 128]), torch.Size([1, 4248, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.29393625259399414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.38368749618530273  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 4248, 128])
m.shape torch.Size([3543, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.38841962814331055  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.38841962814331055  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3543, 128]), torch.Size([1, 3543, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.39208364486694336  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.49291324615478516  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3543, 128])
m.shape torch.Size([3020, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.49842405319213867  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.49842405319213867  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3020, 128]), torch.Size([1, 3020, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5016980171203613  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6096401214599609  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3020, 128])
m.shape torch.Size([2466, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6152553558349609  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6152553558349609  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2466, 128]), torch.Size([1, 2466, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6178092956542969  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7231540679931641  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2466, 128])
m.shape torch.Size([2122, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7290611267089844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7290611267089844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2122, 128]), torch.Size([1, 2122, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7313413619995117  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.834254264831543  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2122, 128])
m.shape torch.Size([1889, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8404483795166016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8404483795166016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1889, 128]), torch.Size([1, 1889, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.842249870300293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9455623626708984  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1889, 128])
m.shape torch.Size([1537, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9512577056884766  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9512577056884766  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1537, 128]), torch.Size([1, 1537, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.952723503112793  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.046534538269043  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1537, 128])
m.shape torch.Size([11822, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.1021733283996582  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.1021733283996582  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 11822, 128]), torch.Size([1, 11822, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.113447666168213  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9148144721984863  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 11822, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.8156251907348633  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.8541545867919922  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.892683982849121  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.8538532257080078  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([40401, 256])
first layer input nodes number: 63311
first layer output nodes number: 40401
edges number: 233488
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.893157958984375  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.931687355041504  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9413199424743652  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9413199424743652  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([3604, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.1029586791992188  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.1029586791992188  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3604, 256]), torch.Size([1, 3604, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.109832763671875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.164825439453125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3604, 256])
m.shape torch.Size([3235, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.167898654937744  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.167898654937744  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3235, 256]), torch.Size([1, 3235, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.1740689277648926  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.26729154586792  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3235, 256])
m.shape torch.Size([2577, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.271636962890625  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.271636962890625  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2577, 256]), torch.Size([1, 2577, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.276609420776367  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.3859081268310547  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2577, 256])
m.shape torch.Size([2062, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.3912158012390137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.3912158012390137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2062, 256]), torch.Size([1, 2062, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.3953676223754883  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5145559310913086  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2062, 256])
m.shape torch.Size([1740, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5202198028564453  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5202198028564453  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1740, 256]), torch.Size([1, 1740, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.523716926574707  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6466569900512695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1740, 256])
m.shape torch.Size([1364, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.652581214904785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.652581214904785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1364, 256]), torch.Size([1, 1364, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6555376052856445  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7698965072631836  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1364, 256])
m.shape torch.Size([1156, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7763733863830566  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7763733863830566  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1156, 256]), torch.Size([1, 1156, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.7788500785827637  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.896754741668701  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1156, 256])
m.shape torch.Size([1020, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9034953117370605  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9034953117370605  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1020, 256]), torch.Size([1, 1020, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9054408073425293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.016761302947998  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1020, 256])
m.shape torch.Size([775, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0224924087524414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0224924087524414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.023970603942871  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.120840072631836  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([696, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1267905235290527  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1267905235290527  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1281180381774902  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.2267699241638184  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([563, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.232058525085449  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.232058525085449  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.2331323623657227  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3178558349609375  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([506, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.323154926300049  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.323154926300049  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.324120044708252  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.40684175491333  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([426, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.41168212890625  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.41168212890625  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.412494659423828  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4883460998535156  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([374, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4929723739624023  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4929723739624023  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.493685722351074  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.56430721282959  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([350, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5692543983459473  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5692543983459473  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5699219703674316  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.643202304840088  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([268, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.6469898223876953  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.6469898223876953  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.647500991821289  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.706178665161133  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([234, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.709746837615967  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.709746837615967  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.710193157196045  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.76375150680542  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([201, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7670059204101562  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7670059204101562  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7673892974853516  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8160781860351562  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([178, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8191370964050293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8191370964050293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.81947660446167  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8649706840515137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([164, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8679537773132324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8679537773132324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8682665824890137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.91237211227417  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([138, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.915001392364502  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.915001392364502  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.91526460647583  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9542202949523926  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([131, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9568591117858887  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9568591117858887  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.957108974456787  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.995837688446045  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([102, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9979677200317383  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9979677200317383  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.998162269592285  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.029679298400879  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.031980991363525  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.031980991363525  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.032179355621338  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.06570291519165  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([1292, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.096648216247559  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.096648216247559  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1292, 256]), torch.Size([1, 1292, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.099785804748535  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.533968925476074  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1292, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.397215843200684  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.4013214111328125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.404787540435791  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.400508403778076  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([23260, 40])
input nodes number: 40401
output nodes number: 23260
edges number: 162881
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.401103496551514  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 4.401103973388672  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.05433177947998047  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

pseudo mini batch 3 input nodes size: 50121
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04557228088378906  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.04557228088378906  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06947183609008789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.06964111328125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.039278507232666016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.0422358512878418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.0422358512878418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.0422358512878418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([50121, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.0422358512878418  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([3859, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.14918231964111328  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.14918231964111328  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3859, 128]), torch.Size([1, 3859, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.152862548828125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.18366050720214844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3859, 128])
m.shape torch.Size([3922, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.1855607032775879  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.1855607032775879  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3922, 128]), torch.Size([1, 3922, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.18994903564453125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.24834346771240234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3922, 128])
m.shape torch.Size([3522, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.25101375579833984  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.25101375579833984  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3522, 128]), torch.Size([1, 3522, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.2545332908630371  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.32853174209594727  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3522, 128])
m.shape torch.Size([3033, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3329482078552246  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.3329482078552246  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 3033, 128]), torch.Size([1, 3033, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.33600473403930664  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4228849411010742  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 3033, 128])
m.shape torch.Size([2566, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.42755651473999023  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.42755651473999023  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2566, 128]), torch.Size([1, 2566, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.4300708770751953  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5181674957275391  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2566, 128])
m.shape torch.Size([2232, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5233297348022461  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5233297348022461  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2232, 128]), torch.Size([1, 2232, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.5254650115966797  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6196303367614746  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2232, 128])
m.shape torch.Size([1836, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6243205070495605  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6243205070495605  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1836, 128]), torch.Size([1, 1836, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.6260714530944824  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7136187553405762  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1836, 128])
m.shape torch.Size([1651, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7190413475036621  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7190413475036621  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1651, 128]), torch.Size([1, 1651, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.7206158638000488  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8129115104675293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1651, 128])
m.shape torch.Size([1424, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8182353973388672  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8182353973388672  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.8195934295654297  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9080638885498047  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
m.shape torch.Size([11478, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9621162414550781  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9621162414550781  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 11478, 128]), torch.Size([1, 11478, 128])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 0.9734048843383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7513694763183594  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 11478, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.658968448638916  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.6928458213806152  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7267231941223145  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.6925806999206543  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([35523, 256])
first layer input nodes number: 50121
first layer output nodes number: 35523
edges number: 214279
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7270989418029785  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7609763145446777  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7694458961486816  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.7694458961486816  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

m.shape torch.Size([2964, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9487757682800293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9487757682800293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2964, 256]), torch.Size([1, 2964, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 1.9549994468688965  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.002267360687256  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2964, 256])
m.shape torch.Size([2714, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.0045394897460938  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.0045394897460938  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2714, 256]), torch.Size([1, 2714, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.0097246170043945  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.092304229736328  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2714, 256])
m.shape torch.Size([2372, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.0959978103637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.0959978103637695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 2372, 256]), torch.Size([1, 2372, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.100890636444092  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.201201915740967  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 2372, 256])
m.shape torch.Size([1914, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.207221508026123  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.207221508026123  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1914, 256]), torch.Size([1, 1914, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.211113452911377  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.318912982940674  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1914, 256])
m.shape torch.Size([1582, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.324690341949463  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.324690341949463  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1582, 256]), torch.Size([1, 1582, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.3279080390930176  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.4391207695007324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1582, 256])
m.shape torch.Size([1337, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.4453225135803223  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.4453225135803223  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1337, 256]), torch.Size([1, 1337, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.4479575157165527  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5633888244628906  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1337, 256])
m.shape torch.Size([1105, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5695481300354004  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.5695481300354004  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 1105, 256]), torch.Size([1, 1105, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.571709156036377  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.684256076812744  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1105, 256])
m.shape torch.Size([951, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6899518966674805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.6899518966674805  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.691765785217285  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.795374870300293  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([850, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.801820755004883  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.801820755004883  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.8034420013427734  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.908964157104492  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([738, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9152469635009766  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.9152469635009766  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 738, 256]), torch.Size([1, 738, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 2.916654586791992  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0165958404541016  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 738, 256])
m.shape torch.Size([669, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0229649543762207  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0229649543762207  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.0242409706115723  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.124422550201416  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([543, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.13004732131958  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.13004732131958  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 543, 256]), torch.Size([1, 543, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.1310830116271973  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.2223896980285645  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 543, 256])
m.shape torch.Size([467, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.2277069091796875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.2277069091796875  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.228597640991211  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3108739852905273  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([420, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.316080093383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.316080093383789  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3168811798095703  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.3975610733032227  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([358, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4023218154907227  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4023218154907227  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4030046463012695  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4765424728393555  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([308, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4809374809265137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.4809374809265137  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.48152494430542  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5510764122009277  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([318, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.555978775024414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.555978775024414  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.5565853118896484  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.6296138763427734  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([251, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.633653163909912  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.633653163909912  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.634131908416748  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.694932460784912  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([218, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.699028968811035  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.699028968811035  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.6994447708129883  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.755162239074707  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([233, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7594332695007324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7594332695007324  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.7598776817321777  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.822539806365967  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([211, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8265767097473145  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8265767097473145  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.826979160308838  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.8865418434143066  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([140, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.889301300048828  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.889301300048828  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.889568328857422  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.930957794189453  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([149, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9341182708740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9341182708740234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9344024658203125  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9804420471191406  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([135, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9834141731262207  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9834141731262207  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 11.4451904296875 GB
    Memory Allocated: 3.9836716651916504  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.027187824249268  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([1757, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.069276809692383  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.069276809692383  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 1757, 256]), torch.Size([1, 1757, 256])
----------------------------------------3
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.072628021240234  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.662676811218262  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

rst.shape  torch.Size([1, 1757, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.5052313804626465  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.508729457855225  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.512467861175537  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.508800506591797  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

torch.Size([22704, 40])
input nodes number: 35523
output nodes number: 22704
edges number: 182422
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.508627414703369  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4490966796875 GB
    Memory Allocated: 4.508627891540527  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.4530029296875 GB
    Memory Allocated: 0.04736900329589844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 11.4530029296875 GB
    Memory Allocated: 0.04736900329589844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 11.4530029296875 GB
    Memory Allocated: 0.04736900329589844  GigaBytes
Max Memory Allocated: 8.457880973815918  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04628157615661621 |0.002831101417541504 |0.13271987438201904 |9.781122207641602e-05 |0.08675771951675415 |0.004680156707763672 |
----------------------------------------------------------pseudo_mini_loss sum 3.683570384979248
Total (block generation + training)time/epoch 23.714163661003113
Training time/epoch 1.1267297267913818
Training time without block to device /epoch 1.1154053211212158
Training time without total dataloading part /epoch 0.8829817771911621
load block tensor time/epoch 0.18512630462646484
block to device time/epoch 0.011324405670166016
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  490560
Number of first layer input nodes during this epoch:  295442
Number of first layer output nodes during this epoch:  195118
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
