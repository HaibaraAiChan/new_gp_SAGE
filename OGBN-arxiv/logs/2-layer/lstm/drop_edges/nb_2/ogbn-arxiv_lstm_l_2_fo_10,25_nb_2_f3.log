[17:40:04] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 2 parts and get 219704 edge cuts
main start at this time 1651599584.7444446
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02598404884338379
global_2_local spend time (sec) 0.03607344627380371
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003970146179199219
A = g.adjacency_matrix() spent  0.007983207702636719
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07888054847717285
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.289194107055664
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.166428565979004

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.199 seconds
Metis partitioning: 4.712 seconds
Split the graph: 3.896 seconds
Construct subgraphs: 0.035 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.855424642562866
46436
44505
total k batches seeds list generation spend  19.57844638824463
after graph partition
graph partition algorithm spend time 19.679768323898315
46436
44505
partition_len_list
[71115, 101830]
shared_neighbor_graph_partition_s0 selection method  spend 19.763935804367065
time for parepare:  0.01677083969116211
local_output_nid generation:  0.004622459411621094
local_in_edges_tensor generation:  0.00638270378112793
mini_batch_src_global generation:  0.011688470840454102
r_  generation:  0.12042546272277832
local_output_nid generation:  0.005915641784667969
local_in_edges_tensor generation:  0.010554075241088867
mini_batch_src_global generation:  0.015015602111816406
r_  generation:  0.155029296875
----------------------check_connections_block total spend ----------------------------- 0.4148399829864502
generate_one_block  0.15299105644226074
generate_one_block  0.19200801849365234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.034409284591674805
gen group dst list time:  0.004975795745849609
time for parepare:  0.019666194915771484
local_output_nid generation:  0.008417606353759766
local_in_edges_tensor generation:  0.029045820236206055
mini_batch_src_global generation:  0.012372970581054688
r_  generation:  0.1837904453277588
local_output_nid generation:  0.014210700988769531
local_in_edges_tensor generation:  0.02126622200012207
mini_batch_src_global generation:  0.02626514434814453
r_  generation:  0.25273847579956055
----------------------check_connections_block total spend ----------------------------- 0.6631853580474854
generate_one_block  0.18340563774108887
generate_one_block  0.31981539726257324
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.6631853580474854
block generation total time  0.5032210350036621
average batch blocks generation time:  0.25161051750183105
pseudo mini batch 0 input nodes size: 91142
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04623746871948242  GigaBytes
Max Memory Allocated: 0.04623746871948242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04658365249633789  GigaBytes
Max Memory Allocated: 0.04658365249633789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04658365249633789  GigaBytes
Max Memory Allocated: 0.04658365249633789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

torch.Size([91142, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

m.shape torch.Size([8824, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25603199005126953  GigaBytes
Max Memory Allocated: 0.2575240135192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25603199005126953  GigaBytes
Max Memory Allocated: 0.2575240135192871  GigaBytes

 h.shape torch.Size([1, 8824, 128]), torch.Size([1, 8824, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2644472122192383  GigaBytes
Max Memory Allocated: 0.2644472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3340120315551758  GigaBytes
Max Memory Allocated: 0.33821964263916016  GigaBytes

rst.shape  torch.Size([1, 8824, 128])
m.shape torch.Size([8749, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3381481170654297  GigaBytes
Max Memory Allocated: 0.33834409713745117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3381481170654297  GigaBytes
Max Memory Allocated: 0.33834409713745117  GigaBytes

 h.shape torch.Size([1, 8749, 128]), torch.Size([1, 8749, 128])
----------------------------------------3
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34649181365966797  GigaBytes
Max Memory Allocated: 0.34649181365966797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4769916534423828  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

rst.shape  torch.Size([1, 8749, 128])
m.shape torch.Size([7617, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.48453855514526367  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.48453855514526367  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

 h.shape torch.Size([1, 7617, 128]), torch.Size([1, 7617, 128])
----------------------------------------3
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4918026924133301  GigaBytes
Max Memory Allocated: 0.4918026924133301  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.651613712310791  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

rst.shape  torch.Size([1, 7617, 128])
m.shape torch.Size([6383, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.66015625  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.66015625  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

 h.shape torch.Size([1, 6383, 128]), torch.Size([1, 6383, 128])
----------------------------------------3
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6669235229492188  GigaBytes
Max Memory Allocated: 0.6669235229492188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8441362380981445  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

rst.shape  torch.Size([1, 6383, 128])
m.shape torch.Size([5289, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

 h.shape torch.Size([1, 5289, 128]), torch.Size([1, 5289, 128])
----------------------------------------3
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.859062671661377  GigaBytes
Max Memory Allocated: 0.859062671661377  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0409321784973145  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

rst.shape  torch.Size([1, 5289, 128])
m.shape torch.Size([4360, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0508842468261719  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0508842468261719  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

 h.shape torch.Size([1, 4360, 128]), torch.Size([1, 4360, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0554852485656738  GigaBytes
Max Memory Allocated: 1.0554852485656738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.241661548614502  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

rst.shape  torch.Size([1, 4360, 128])
m.shape torch.Size([3700, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2519326210021973  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2519326210021973  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

 h.shape torch.Size([1, 3700, 128]), torch.Size([1, 3700, 128])
----------------------------------------3
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2556872367858887  GigaBytes
Max Memory Allocated: 1.2556872367858887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4333715438842773  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

rst.shape  torch.Size([1, 3700, 128])
m.shape torch.Size([3225, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

 h.shape torch.Size([1, 3225, 128]), torch.Size([1, 3225, 128])
----------------------------------------3
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.447218894958496  GigaBytes
Max Memory Allocated: 1.447218894958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6251888275146484  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

rst.shape  torch.Size([1, 3225, 128])
m.shape torch.Size([2740, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6354098320007324  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6354098320007324  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

 h.shape torch.Size([1, 2740, 128]), torch.Size([1, 2740, 128])
----------------------------------------3
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.638087272644043  GigaBytes
Max Memory Allocated: 1.638087272644043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.8094873428344727  GigaBytes
Max Memory Allocated: 1.8212461471557617  GigaBytes

rst.shape  torch.Size([1, 2740, 128])
m.shape torch.Size([20228, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1600341796875 GB
    Memory Allocated: 1.9040288925170898  GigaBytes
Max Memory Allocated: 1.906290054321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1600341796875 GB
    Memory Allocated: 1.9040288925170898  GigaBytes
Max Memory Allocated: 1.906290054321289  GigaBytes

 h.shape torch.Size([1, 20228, 128]), torch.Size([1, 20228, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.9233198165893555  GigaBytes
Max Memory Allocated: 1.9233198165893555  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6639404296875 GB
    Memory Allocated: 3.3100385665893555  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

rst.shape  torch.Size([1, 20228, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.138339042663574  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.2061595916748047  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.2745189666748047  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.2061681747436523  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

torch.Size([71115, 256])
first layer input nodes number: 91142
first layer output nodes number: 71115
edges number: 405950
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.275200366973877  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.3430209159851074  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 3.3605151176452637  GigaBytes
Max Memory Allocated: 3.428335666656494  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 3.3605151176452637  GigaBytes
Max Memory Allocated: 3.428335666656494  GigaBytes

m.shape torch.Size([6798, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.6982717514038086  GigaBytes
Max Memory Allocated: 3.6982975006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.6982717514038086  GigaBytes
Max Memory Allocated: 3.6982975006103516  GigaBytes

 h.shape torch.Size([1, 6798, 256]), torch.Size([1, 6798, 256])
----------------------------------------3
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.711237907409668  GigaBytes
Max Memory Allocated: 3.711237907409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.814967155456543  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

rst.shape  torch.Size([1, 6798, 256])
m.shape torch.Size([6155, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.8204574584960938  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.8204574584960938  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

 h.shape torch.Size([1, 6155, 256]), torch.Size([1, 6155, 256])
----------------------------------------3
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.832810401916504  GigaBytes
Max Memory Allocated: 3.832810401916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3162841796875 GB
    Memory Allocated: 4.008906364440918  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

rst.shape  torch.Size([1, 6155, 256])
m.shape torch.Size([5092, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.01771879196167  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.01771879196167  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

 h.shape torch.Size([1, 5092, 256]), torch.Size([1, 5092, 256])
----------------------------------------3
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.027826309204102  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.242563247680664  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

rst.shape  torch.Size([1, 5092, 256])
m.shape torch.Size([4086, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.253347396850586  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.253347396850586  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

 h.shape torch.Size([1, 4086, 256]), torch.Size([1, 4086, 256])
----------------------------------------3
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.261333465576172  GigaBytes
Max Memory Allocated: 4.261333465576172  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.488121032714844  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

rst.shape  torch.Size([1, 4086, 256])
m.shape torch.Size([3379, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.500462532043457  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.500462532043457  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

 h.shape torch.Size([1, 3379, 256]), torch.Size([1, 3379, 256])
----------------------------------------3
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.507497310638428  GigaBytes
Max Memory Allocated: 4.507497310638428  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.755641460418701  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

rst.shape  torch.Size([1, 3379, 256])
m.shape torch.Size([2709, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.768041133880615  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.768041133880615  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

 h.shape torch.Size([1, 2709, 256]), torch.Size([1, 2709, 256])
----------------------------------------3
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.773675441741943  GigaBytes
Max Memory Allocated: 4.773675441741943  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 4.997709274291992  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

rst.shape  torch.Size([1, 2709, 256])
m.shape torch.Size([2282, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.010869979858398  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.010869979858398  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

 h.shape torch.Size([1, 2282, 256]), torch.Size([1, 2282, 256])
----------------------------------------3
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.015614032745361  GigaBytes
Max Memory Allocated: 5.015614032745361  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.234419345855713  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

rst.shape  torch.Size([1, 2282, 256])
m.shape torch.Size([1950, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.247538089752197  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.247538089752197  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

 h.shape torch.Size([1, 1950, 256]), torch.Size([1, 1950, 256])
----------------------------------------3
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.2513604164123535  GigaBytes
Max Memory Allocated: 5.2513604164123535  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.467553615570068  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

rst.shape  torch.Size([1, 1950, 256])
m.shape torch.Size([1653, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.479374885559082  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.479374885559082  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

 h.shape torch.Size([1, 1653, 256]), torch.Size([1, 1653, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.483428955078125  GigaBytes
Max Memory Allocated: 5.483428955078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.690738677978516  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

rst.shape  torch.Size([1, 1653, 256])
m.shape torch.Size([1427, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.702877521514893  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.702877521514893  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

 h.shape torch.Size([1, 1427, 256]), torch.Size([1, 1427, 256])
----------------------------------------3
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.705646991729736  GigaBytes
Max Memory Allocated: 5.705646991729736  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9001145362854  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

rst.shape  torch.Size([1, 1427, 256])
m.shape torch.Size([1208, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9113850593566895  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9113850593566895  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.913784503936768  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.101688385009766  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([1031, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.112404823303223  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.112404823303223  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

 h.shape torch.Size([1, 1031, 256]), torch.Size([1, 1031, 256])
----------------------------------------3
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.114418029785156  GigaBytes
Max Memory Allocated: 6.114418029785156  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.284245491027832  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

rst.shape  torch.Size([1, 1031, 256])
m.shape torch.Size([873, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.294054985046387  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.294054985046387  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

 h.shape torch.Size([1, 873, 256]), torch.Size([1, 873, 256])
----------------------------------------3
 Nvidia-smi: 7.5487060546875 GB
    Memory Allocated: 6.295720100402832  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.453133583068848  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

rst.shape  torch.Size([1, 873, 256])
m.shape torch.Size([783, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.462837219238281  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.462837219238281  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.464330673217773  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.61346435546875  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([699, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.622795104980469  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.622795104980469  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 7.8651123046875 GB
    Memory Allocated: 6.624128341674805  GigaBytes
Max Memory Allocated: 6.624128341674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.771245002746582  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([562, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.779221057891846  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.779221057891846  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.780292987823486  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.903416156768799  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([540, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.911703586578369  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.911703586578369  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.912733554840088  GigaBytes
Max Memory Allocated: 6.912733554840088  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.0366387367248535  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([451, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.043926239013672  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.043926239013672  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.04478645324707  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.157236099243164  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([384, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.163818359375  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.163818359375  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.16455078125  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.266070365905762  GigaBytes
Max Memory Allocated: 7.273028373718262  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([385, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.273105144500732  GigaBytes
Max Memory Allocated: 7.273134231567383  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.273105144500732  GigaBytes
Max Memory Allocated: 7.273134231567383  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 7.273839473724365  GigaBytes
Max Memory Allocated: 7.273839473724365  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.379611492156982  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([340, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386106967926025  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386106967926025  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386755466461182  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.48391580581665  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([271, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.489322185516357  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.489322185516357  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.48983907699585  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.574192523956299  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([242, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579283714294434  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579283714294434  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579745292663574  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.6545209884643555  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([237, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.659757137298584  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.659757137298584  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.6602091789245605  GigaBytes
Max Memory Allocated: 7.6602091789245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9549560546875 GB
    Memory Allocated: 7.7366042137146  GigaBytes
Max Memory Allocated: 7.742028713226318  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([2899, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.806035995483398  GigaBytes
Max Memory Allocated: 7.8063063621521  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.806035995483398  GigaBytes
Max Memory Allocated: 7.8063063621521  GigaBytes

 h.shape torch.Size([1, 2899, 256]), torch.Size([1, 2899, 256])
----------------------------------------3
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.811565399169922  GigaBytes
Max Memory Allocated: 7.811565399169922  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1209716796875 GB
    Memory Allocated: 8.827034950256348  GigaBytes
Max Memory Allocated: 8.89615249633789  GigaBytes

rst.shape  torch.Size([1, 2899, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.541881561279297  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.54880142211914  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.555721282958984  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.548455238342285  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([46436, 40])
input nodes number: 71115
output nodes number: 46436
edges number: 341171
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.556251525878906  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.556252479553223  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.07392501831054688  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

pseudo mini batch 1 input nodes size: 126400
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.056279659271240234  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.056279659271240234  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.11655187606811523  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.11688375473022461  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.07307767868041992  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([126400, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

m.shape torch.Size([8847, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4310579299926758  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4310579299926758  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 8847, 128]), torch.Size([1, 8847, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4394950866699219  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5091037750244141  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 8847, 128])
m.shape torch.Size([8774, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5132527351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5132527351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 8774, 128]), torch.Size([1, 8774, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5216202735900879  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6521916389465332  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 8774, 128])
m.shape torch.Size([7464, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6586852073669434  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6586852073669434  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 7464, 128]), torch.Size([1, 7464, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6662201881408691  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8232378959655762  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 7464, 128])
m.shape torch.Size([6440, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8319621086120605  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8319621086120605  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 6440, 128]), torch.Size([1, 6440, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8385252952575684  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0182085037231445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 6440, 128])
m.shape torch.Size([5763, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0288777351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0288777351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 5763, 128]), torch.Size([1, 5763, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0346965789794922  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2449884414672852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 5763, 128])
m.shape torch.Size([4879, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2561993598937988  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2561993598937988  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4879, 128]), torch.Size([1, 4879, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.261164665222168  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.4624509811401367  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4879, 128])
m.shape torch.Size([4451, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.475663185119629  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.475663185119629  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4451, 128]), torch.Size([1, 4451, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.4804887771606445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.694225788116455  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4451, 128])
m.shape torch.Size([4008, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.707728385925293  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.707728385925293  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4008, 128]), torch.Size([1, 4008, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.7115507125854492  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.9304304122924805  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4008, 128])
m.shape torch.Size([3600, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.943892478942871  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.943892478942871  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.9479403495788574  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.1734766960144043  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 3600, 128])
m.shape torch.Size([47604, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.3987536430358887  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.3987536430358887  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 47604, 128]), torch.Size([1, 47604, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.444152355194092  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.667460918426514  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 47604, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.354747772216797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.451860427856445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.548973083496094  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.451101303100586  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([101830, 256])
first layer input nodes number: 126400
first layer output nodes number: 101830
edges number: 704297
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.549916744232178  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.647029399871826  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.671307563781738  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.671307563781738  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

m.shape torch.Size([6630, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.067834854125977  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.067834854125977  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 6630, 256]), torch.Size([1, 6630, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.081445693969727  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.184541702270508  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 6630, 256])
m.shape torch.Size([5551, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.188406944274902  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.188406944274902  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 5551, 256]), torch.Size([1, 5551, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.200461387634277  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.360010147094727  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 5551, 256])
m.shape torch.Size([4185, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.366783618927002  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.366783618927002  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4185, 256]), torch.Size([1, 4185, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.374931812286377  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.554792881011963  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4185, 256])
m.shape torch.Size([3234, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.563152313232422  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.563152313232422  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 3234, 256]), torch.Size([1, 3234, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.569465637207031  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.752399444580078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 3234, 256])
m.shape torch.Size([2843, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.762035846710205  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.762035846710205  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 2843, 256]), torch.Size([1, 2843, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.767590522766113  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.963449478149414  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 2843, 256])
m.shape torch.Size([2159, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.973188877105713  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.973188877105713  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 2159, 256]), torch.Size([1, 2159, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.978113651275635  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.161391735076904  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 2159, 256])
m.shape torch.Size([1763, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.170638084411621  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.170638084411621  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1763, 256]), torch.Size([1, 1763, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.174158573150635  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.346950054168701  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1763, 256])
m.shape torch.Size([1522, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.356971740722656  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.356971740722656  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1522, 256]), torch.Size([1, 1522, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.35999059677124  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.530980587005615  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1522, 256])
m.shape torch.Size([1323, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.540973663330078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.540973663330078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1323, 256]), torch.Size([1, 1323, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.543551445007324  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.706734657287598  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1323, 256])
m.shape torch.Size([1172, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.716610908508301  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.716610908508301  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1172, 256]), torch.Size([1, 1172, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.719012260437012  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.884860038757324  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1172, 256])
m.shape torch.Size([995, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.893732070922852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.893732070922852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.8956298828125  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.052142143249512  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 995, 256])
m.shape torch.Size([906, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.06164264678955  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.06164264678955  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.063370704650879  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.21036434173584  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([783, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.219284057617188  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.219284057617188  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.22077751159668  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.359038352966309  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([651, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.367051601409912  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.367051601409912  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.368293285369873  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.492125988006592  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([590, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.500011444091797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.500011444091797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.501136779785156  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.62042236328125  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([549, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.628302574157715  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.628302574157715  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.629349708557129  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.7506742477417  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([490, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.75815725326538  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.75815725326538  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.759091854095459  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.876006603240967  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([497, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.884137630462646  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.884137630462646  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.885085582733154  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.008336544036865  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([452, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016117095947266  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016117095947266  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016979217529297  GigaBytes
Max Memory Allocated: 9.016979217529297  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.135414123535156  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([422, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143095016479492  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143095016479492  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143899917602539  GigaBytes
Max Memory Allocated: 9.143899917602539  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.259289741516113  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([377, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.266496658325195  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.266496658325195  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.267215728759766  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.377626419067383  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([285, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.383293151855469  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.383293151855469  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.38383674621582  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.469635963439941  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([277, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.47548770904541  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.47548770904541  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.4760160446167  GigaBytes
Max Memory Allocated: 9.4760160446167  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.563610076904297  GigaBytes
Max Memory Allocated: 9.569685935974121  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([288, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.569989204406738  GigaBytes
Max Memory Allocated: 9.570014953613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.569989204406738  GigaBytes
Max Memory Allocated: 9.570014953613281  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.570538520812988  GigaBytes
Max Memory Allocated: 9.570538520812988  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.667092323303223  GigaBytes
Max Memory Allocated: 9.673684120178223  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([6561, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.824466228485107  GigaBytes
Max Memory Allocated: 9.825077533721924  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.824466228485107  GigaBytes
Max Memory Allocated: 9.825077533721924  GigaBytes

 h.shape torch.Size([1, 6561, 256]), torch.Size([1, 6561, 256])
----------------------------------------3
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.837282180786133  GigaBytes
Max Memory Allocated: 9.837282180786133  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 12.069976806640625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6561, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.717529773712158  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.724335193634033  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.730977535247803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.723840236663818  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
[17:40:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 2 parts and get 200820 edge cuts

torch.Size([44505, 40])
input nodes number: 101830
output nodes number: 44505
edges number: 403079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.724643230438232  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.72464370727539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0977010726928711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325145721435547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325145721435547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05773723125457764 |0.17093563079833984 |0.43611204624176025 |0.00018894672393798828 |0.1609553098678589 |0.005694866180419922 |
----------------------------------------------------------pseudo_mini_loss sum 5.317046165466309
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  390487
Number of first layer input nodes during this epoch:  217542
Number of first layer output nodes during this epoch:  172945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325098037719727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016620874404907227
global_2_local spend time (sec) 0.03946518898010254
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004290103912353516
A = g.adjacency_matrix() spent  0.007770538330078125
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07820701599121094
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3168089389801025
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3289508819580078

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.288 seconds
Metis partitioning: 4.893 seconds
Split the graph: 4.210 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.48108458518982
46517
44424
total k batches seeds list generation spend  20.90396022796631
after graph partition
graph partition algorithm spend time 21.03709650039673
46517
44424
partition_len_list
[71124, 100920]
shared_neighbor_graph_partition_s0 selection method  spend 21.12932848930359
time for parepare:  0.018142223358154297
local_output_nid generation:  0.0048334598541259766
local_in_edges_tensor generation:  0.006108283996582031
mini_batch_src_global generation:  0.013548135757446289
r_  generation:  0.12369871139526367
local_output_nid generation:  0.006702899932861328
local_in_edges_tensor generation:  0.013099193572998047
mini_batch_src_global generation:  0.016246795654296875
r_  generation:  0.14222335815429688
----------------------check_connections_block total spend ----------------------------- 0.40998220443725586
generate_one_block  0.16730618476867676
generate_one_block  0.1861715316772461
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.038453102111816406
gen group dst list time:  0.005082368850708008
time for parepare:  0.020687103271484375
local_output_nid generation:  0.008305549621582031
local_in_edges_tensor generation:  0.020273447036743164
mini_batch_src_global generation:  0.013736724853515625
r_  generation:  0.1526966094970703
local_output_nid generation:  0.014623641967773438
local_in_edges_tensor generation:  0.018392086029052734
mini_batch_src_global generation:  0.024228572845458984
r_  generation:  0.2493283748626709
----------------------check_connections_block total spend ----------------------------- 0.6154060363769531
generate_one_block  0.1881265640258789
generate_one_block  0.31563591957092285
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325098037719727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

connection checking time:  0.6154060363769531
block generation total time  0.5037624835968018
average batch blocks generation time:  0.2518812417984009
block dataloader generation time/epoch 23.170586347579956
pseudo mini batch 0 input nodes size: 91317
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0783390998840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0783390998840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.12188243865966797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.12222909927368164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.061625003814697266  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06734943389892578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06734943389892578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06734943389892578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([91317, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06734943389892578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8679, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.27289390563964844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.27289390563964844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8679, 128]), torch.Size([1, 8679, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.2811708450317383  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.34738636016845703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8679, 128])
m.shape torch.Size([8686, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.3515315055847168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.3515315055847168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8686, 128]), torch.Size([1, 8686, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.3598151206970215  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.4840693473815918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8686, 128])
m.shape torch.Size([7514, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.49164628982543945  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.49164628982543945  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7514, 128]), torch.Size([1, 7514, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.4992232322692871  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6592240333557129  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7514, 128])
m.shape torch.Size([6244, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6675505638122559  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6675505638122559  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6244, 128]), torch.Size([1, 6244, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6744208335876465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8495616912841797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6244, 128])
m.shape torch.Size([5268, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8591442108154297  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8591442108154297  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5268, 128]), torch.Size([1, 5268, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8649082183837891  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.0465106964111328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5268, 128])
m.shape torch.Size([4374, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.0565128326416016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.0565128326416016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4374, 128]), torch.Size([1, 4374, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.061110496520996  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2404794692993164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4374, 128])
m.shape torch.Size([3734, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2508573532104492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2508573532104492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3734, 128]), torch.Size([1, 3734, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2544183731079102  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.432469367980957  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3734, 128])
m.shape torch.Size([3254, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.4431018829345703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.4431018829345703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3254, 128]), torch.Size([1, 3254, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.4462928771972656  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6250982284545898  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3254, 128])
m.shape torch.Size([2744, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6352033615112305  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6352033615112305  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2744, 128]), torch.Size([1, 2744, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.638545036315918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.8204345703125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2744, 128])
m.shape torch.Size([20627, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.916895866394043  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.916895866394043  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 20627, 128]), torch.Size([1, 20627, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.9365673065185547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3332395553588867  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 20627, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.1595849990844727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.227414131164551  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.295243263244629  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.226883888244629  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([71124, 256])
first layer input nodes number: 91317
first layer output nodes number: 71124
edges number: 409289
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.2959256172180176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3637547492980957  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3813328742980957  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3813328742980957  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6733, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.7249083518981934  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.7249083518981934  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6733, 256]), torch.Size([1, 6733, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.73775053024292  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.8404879570007324  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6733, 256])
m.shape torch.Size([6106, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.845804214477539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.845804214477539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6106, 256]), torch.Size([1, 6106, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.857450485229492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.034170150756836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6106, 256])
m.shape torch.Size([5014, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.042804718017578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.042804718017578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5014, 256]), torch.Size([1, 5014, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.0532379150390625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.269344329833984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5014, 256])
m.shape torch.Size([3982, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.280306339263916  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.280306339263916  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3982, 256]), torch.Size([1, 3982, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.287978649139404  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.511223793029785  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3982, 256])
m.shape torch.Size([3355, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.5233683586120605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.5233683586120605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3355, 256]), torch.Size([1, 3355, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.529848098754883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.7612409591674805  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3355, 256])
m.shape torch.Size([2694, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.773444652557373  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.773444652557373  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2694, 256]), torch.Size([1, 2694, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.77901029586792  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.0037150382995605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2694, 256])
m.shape torch.Size([2294, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.016579627990723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.016579627990723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2294, 256]), torch.Size([1, 2294, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.021479606628418  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.250378608703613  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2294, 256])
m.shape torch.Size([1969, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.263330936431885  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.263330936431885  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1969, 256]), torch.Size([1, 1969, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.2673773765563965  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.486629009246826  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1969, 256])
m.shape torch.Size([1653, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.498296737670898  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.498296737670898  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1653, 256]), torch.Size([1, 1653, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.501666069030762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.712090492248535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1653, 256])
m.shape torch.Size([1444, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.724392890930176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.724392890930176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1444, 256]), torch.Size([1, 1444, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.727193832397461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.926072597503662  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1444, 256])
m.shape torch.Size([1228, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.937678813934326  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.937678813934326  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1228, 256]), torch.Size([1, 1228, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.940128803253174  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.131946086883545  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1228, 256])
m.shape torch.Size([1046, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.142717361450195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.142717361450195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1046, 256]), torch.Size([1, 1046, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.144732475280762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.323878288269043  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1046, 256])
m.shape torch.Size([915, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.333954811096191  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.333954811096191  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.335700035095215  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.497321128845215  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([800, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.507213115692139  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.507213115692139  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.508738994598389  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.659801006317139  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([710, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.669493675231934  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.669493675231934  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 710, 256]), torch.Size([1, 710, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.6708478927612305  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.818163871765137  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 710, 256])
m.shape torch.Size([577, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.82636022567749  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.82636022567749  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.827460765838623  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.952138423919678  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([557, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.960689067840576  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.960689067840576  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.961751461029053  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.091336727142334  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([460, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.098763942718506  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.098763942718506  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.0996413230896  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.214425563812256  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([402, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.221328258514404  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.221328258514404  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.222095012664795  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.325453281402588  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([398, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.332720756530762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.332720756530762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.333479881286621  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.440516471862793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([348, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.4471611976623535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.4471611976623535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.447824954986572  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.549278736114502  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([279, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.554846286773682  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.554846286773682  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.555378437042236  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.642240047454834  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([254, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.647589206695557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.647589206695557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.648073673248291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.72655725479126  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([241, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.731874465942383  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.731874465942383  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.732334136962891  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0369873046875 GB
    Memory Allocated: 7.810018539428711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([3058, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.883266925811768  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.883266925811768  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3058, 256]), torch.Size([1, 3058, 256])
----------------------------------------3
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.889099597930908  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.915649890899658  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3058, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.62315320968628  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.631019115447998  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.638885021209717  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.630672454833984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([46517, 40])
input nodes number: 71124
output nodes number: 46517
edges number: 347887
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.63278341293335  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.632784366607666  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08159542083740234  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

pseudo mini batch 1 input nodes size: 125018
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06286001205444336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06286001205444336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12247323989868164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12280464172363281  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07891464233398438  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0876607894897461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0876607894897461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0876607894897461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([125018, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0876607894897461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8975, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.43253564834594727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.43253564834594727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8975, 128]), torch.Size([1, 8975, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4419841766357422  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5118370056152344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8975, 128])
m.shape torch.Size([8844, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5159916877746582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5159916877746582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8844, 128]), torch.Size([1, 8844, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5244884490966797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6552600860595703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8844, 128])
m.shape torch.Size([7507, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6617817878723145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6617817878723145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7507, 128]), torch.Size([1, 7507, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6695785522460938  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8270816802978516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7507, 128])
m.shape torch.Size([6464, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8358311653137207  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8358311653137207  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6464, 128]), torch.Size([1, 6464, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8420968055725098  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0223145484924316  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6464, 128])
m.shape torch.Size([5706, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0329041481018066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0329041481018066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5706, 128]), torch.Size([1, 5706, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0384583473205566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2490344047546387  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5706, 128])
m.shape torch.Size([4853, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2593626976013184  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2593626976013184  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4853, 128]), torch.Size([1, 4853, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.263990879058838  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4650788307189941  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4853, 128])
m.shape torch.Size([4424, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4782414436340332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4782414436340332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4424, 128]), torch.Size([1, 4424, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.483166217803955  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6951775550842285  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4424, 128])
m.shape torch.Size([3920, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.708693027496338  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.708693027496338  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3920, 128]), torch.Size([1, 3920, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7124314308166504  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9280381202697754  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3920, 128])
m.shape torch.Size([3559, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9412903785705566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9412903785705566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3559, 128]), torch.Size([1, 3559, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9454035758972168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.172173500061035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3559, 128])
m.shape torch.Size([46668, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3921589851379395  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3921589851379395  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 46668, 128]), torch.Size([1, 46668, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.4366650581359863  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.5965962409973145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 46668, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.2896342277526855  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.385879039764404  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.482123851776123  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.385127067565918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([100920, 256])
first layer input nodes number: 125018
first layer output nodes number: 100920
edges number: 693727
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.483057498931885  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.5793023109436035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.603363513946533  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.603363513946533  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6695, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.993119716644287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.993119716644287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6695, 256]), torch.Size([1, 6695, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.006767749786377  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1089253425598145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6695, 256])
m.shape torch.Size([5600, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1136369705200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1136369705200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5600, 256]), torch.Size([1, 5600, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.12581729888916  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.28774356842041  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5600, 256])
m.shape torch.Size([4263, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.294694900512695  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.294694900512695  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4263, 256]), torch.Size([1, 4263, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.303153991699219  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.483837604522705  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4263, 256])
m.shape torch.Size([3338, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.492391109466553  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.492391109466553  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3338, 256]), torch.Size([1, 3338, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.498929500579834  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.688230037689209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3338, 256])
m.shape torch.Size([2867, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.69797945022583  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.69797945022583  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2867, 256]), torch.Size([1, 2867, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.703548908233643  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.901016712188721  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2867, 256])
m.shape torch.Size([2174, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.910768985748291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.910768985748291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2174, 256]), torch.Size([1, 2174, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.915287494659424  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.108407974243164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2174, 256])
m.shape torch.Size([1751, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.117297172546387  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.117297172546387  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1751, 256]), torch.Size([1, 1751, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.12076473236084  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.288165092468262  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1751, 256])
m.shape torch.Size([1503, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.298051834106445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.298051834106445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1503, 256]), torch.Size([1, 1503, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.300987243652344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.475037574768066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1503, 256])
m.shape torch.Size([1323, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.484151363372803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.484151363372803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1323, 256]), torch.Size([1, 1323, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.4867329597473145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.649752140045166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1323, 256])
m.shape torch.Size([1155, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.659510612487793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.659510612487793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1155, 256]), torch.Size([1, 1155, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.661844253540039  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.821556568145752  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1155, 256])
m.shape torch.Size([975, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.831013202667236  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.831013202667236  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.8328728675842285  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.988605499267578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([891, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.997952461242676  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.997952461242676  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.999651908874512  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.144104957580566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([741, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.152513980865479  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.152513980865479  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 741, 256]), torch.Size([1, 741, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.153927326202393  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.287685871124268  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 741, 256])
m.shape torch.Size([634, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.295510292053223  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.295510292053223  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.296719551086426  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.418447494506836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([579, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.426190376281738  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.426190376281738  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 579, 256]), torch.Size([1, 579, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.427294731140137  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.544363975524902  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 579, 256])
m.shape torch.Size([534, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.552023887634277  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.552023887634277  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.5530424118042  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.668990135192871  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([473, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.676209449768066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.676209449768066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.677111625671387  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.786526679992676  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([488, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.79451847076416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.79451847076416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.795449256896973  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.918335914611816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([434, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.925796031951904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.925796031951904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.926623821258545  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.03767442703247  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([409, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.045122623443604  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.045122623443604  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.045902729034424  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.159464359283447  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([369, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.16652250289917  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.16652250289917  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.167226314544678  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.272550106048584  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([277, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.278055667877197  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.278055667877197  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.278584003448486  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.366108417510986  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([265, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.371702671051025  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.371702671051025  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.37220811843872  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.45591402053833  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([284, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.462212562561035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.462212562561035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.462754249572754  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.554455757141113  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([6402, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.70801305770874  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.70801305770874  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6402, 256]), torch.Size([1, 6402, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.720223903656006  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
[17:40:53] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 2 parts and get 179081 edge cuts

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.89743185043335  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6402, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.552314758300781  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.558934688568115  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.56555461883545  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.558603286743164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([44424, 40])
input nodes number: 100920
output nodes number: 44424
edges number: 396363
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.558440685272217  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.558441162109375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10156869888305664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10156869888305664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10156869888305664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05522918701171875 |0.004786849021911621 |0.16745460033416748 |0.0001138448715209961 |0.14540362358093262 |0.0075609683990478516 |
----------------------------------------------------------pseudo_mini_loss sum 4.279323577880859
Total (block generation + training)time/epoch 24.00093936920166
Training time/epoch 0.8298718929290771
Training time without block to device /epoch 0.8202981948852539
Training time without total dataloading part /epoch 0.63350510597229
load block tensor time/epoch 0.1104583740234375
block to device time/epoch 0.009573698043823242
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  388379
Number of first layer input nodes during this epoch:  216335
Number of first layer output nodes during this epoch:  172044
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10156822204589844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016559600830078125
global_2_local spend time (sec) 0.039643049240112305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004418373107910156
A = g.adjacency_matrix() spent  0.009327411651611328
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09070682525634766
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.2910993099212646
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1776611804962158

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.219 seconds
Metis partitioning: 4.924 seconds
Split the graph: 4.475 seconds
Construct subgraphs: 0.099 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.732087135314941
46528
44413
total k batches seeds list generation spend  20.9817214012146
after graph partition
graph partition algorithm spend time 21.097213745117188
46528
44413
partition_len_list
[70949, 99322]
shared_neighbor_graph_partition_s0 selection method  spend 21.18763566017151
time for parepare:  0.017032861709594727
local_output_nid generation:  0.004892110824584961
local_in_edges_tensor generation:  0.006156444549560547
mini_batch_src_global generation:  0.012247562408447266
r_  generation:  0.12181782722473145
local_output_nid generation:  0.005742549896240234
local_in_edges_tensor generation:  0.009828329086303711
mini_batch_src_global generation:  0.014883041381835938
r_  generation:  0.1440269947052002
----------------------check_connections_block total spend ----------------------------- 0.4024484157562256
generate_one_block  0.17386150360107422
generate_one_block  0.18799901008605957
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0470273494720459
gen group dst list time:  0.004962921142578125
time for parepare:  0.020148754119873047
local_output_nid generation:  0.009167671203613281
local_in_edges_tensor generation:  0.025966644287109375
mini_batch_src_global generation:  0.012744665145874023
r_  generation:  0.1744840145111084
local_output_nid generation:  0.014396905899047852
local_in_edges_tensor generation:  0.020697832107543945
mini_batch_src_global generation:  0.03318142890930176
r_  generation:  0.24970078468322754
----------------------check_connections_block total spend ----------------------------- 0.6547248363494873
generate_one_block  0.19333791732788086
generate_one_block  0.3236429691314697
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10156822204589844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

connection checking time:  0.6547248363494873
block generation total time  0.5169808864593506
average batch blocks generation time:  0.2584904432296753
block dataloader generation time/epoch 23.223810076713562
pseudo mini batch 0 input nodes size: 91507
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0776677131652832  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.0776677131652832  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12130165100097656  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12164831161499023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06170368194580078  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.067352294921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.067352294921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.067352294921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([91507, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.067352294921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8560, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.273348331451416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.273348331451416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8560, 128]), torch.Size([1, 8560, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.2815117835998535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3468194007873535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8560, 128])
m.shape torch.Size([8624, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35096216201782227  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35096216201782227  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8624, 128]), torch.Size([1, 8624, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.35918664932250977  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.48255395889282227  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8624, 128])
m.shape torch.Size([7464, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4891190528869629  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4891190528869629  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7464, 128]), torch.Size([1, 7464, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.49675989151000977  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6543374061584473  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7464, 128])
m.shape torch.Size([6221, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6626439094543457  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6626439094543457  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6221, 128]), torch.Size([1, 6221, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6696324348449707  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8445405960083008  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6221, 128])
m.shape torch.Size([5266, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8541293144226074  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8541293144226074  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5266, 128]), torch.Size([1, 5266, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8599152565002441  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0407090187072754  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5266, 128])
m.shape torch.Size([4385, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.050743579864502  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.050743579864502  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4385, 128]), torch.Size([1, 4385, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.054929256439209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.235593318939209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4385, 128])
m.shape torch.Size([3708, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2458791732788086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2458791732788086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3708, 128]), torch.Size([1, 3708, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2494916915893555  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.426722526550293  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3708, 128])
m.shape torch.Size([3231, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4372797012329102  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4372797012329102  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3231, 128]), torch.Size([1, 3231, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4404535293579102  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6183724403381348  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3231, 128])
m.shape torch.Size([2719, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.628366470336914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.628366470336914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2719, 128]), torch.Size([1, 2719, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6310596466064453  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8091583251953125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2719, 128])
m.shape torch.Size([20771, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9061989784240723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9061989784240723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 20771, 128]), torch.Size([1, 20771, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9260077476501465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.332430362701416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 20771, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.159529685974121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.227191925048828  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.294854164123535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.226663112640381  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([70949, 256])
first layer input nodes number: 91507
first layer output nodes number: 70949
edges number: 409709
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.2955379486083984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3632001876831055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3807783126831055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3807783126831055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6652, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7241811752319336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7241811752319336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6652, 256]), torch.Size([1, 6652, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7368688583374023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.83841609954834  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6652, 256])
m.shape torch.Size([6073, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8437461853027344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8437461853027344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6073, 256]), torch.Size([1, 6073, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8553295135498047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.031983375549316  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6073, 256])
m.shape torch.Size([5035, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.040709972381592  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.040709972381592  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5035, 256]), torch.Size([1, 5035, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.05124568939209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.268240928649902  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5035, 256])
m.shape torch.Size([4029, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.27895450592041  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.27895450592041  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4029, 256]), torch.Size([1, 4029, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.2870378494262695  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.513861656188965  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4029, 256])
m.shape torch.Size([3353, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.525813102722168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.525813102722168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3353, 256]), torch.Size([1, 3353, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.532467842102051  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.768514156341553  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3353, 256])
m.shape torch.Size([2725, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.780685901641846  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.780685901641846  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2725, 256]), torch.Size([1, 2725, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.786000728607178  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.011495113372803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2725, 256])
m.shape torch.Size([2300, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.0243706703186035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.0243706703186035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2300, 256]), torch.Size([1, 2300, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.02880334854126  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.25569486618042  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2300, 256])
m.shape torch.Size([1963, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.268595218658447  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.268595218658447  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1963, 256]), torch.Size([1, 1963, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.272547245025635  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.492710590362549  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1963, 256])
m.shape torch.Size([1654, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.505146026611328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.505146026611328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1654, 256]), torch.Size([1, 1654, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.508659362792969  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.719735145568848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1654, 256])
m.shape torch.Size([1475, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.732334613800049  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.732334613800049  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1475, 256]), torch.Size([1, 1475, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.735317707061768  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.936595916748047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1475, 256])
m.shape torch.Size([1226, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.94772481918335  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.94772481918335  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1226, 256]), torch.Size([1, 1226, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.950163841247559  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.142162322998047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1226, 256])
m.shape torch.Size([1056, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153077602386475  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.153077602386475  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.1551384925842285  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.337756156921387  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
m.shape torch.Size([904, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.348044395446777  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.348044395446777  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 904, 256]), torch.Size([1, 904, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.34976863861084  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.50839900970459  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 904, 256])
m.shape torch.Size([796, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.518248081207275  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.518248081207275  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.519766330718994  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.672946453094482  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([721, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.682581901550293  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.682581901550293  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.683957099914551  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.832086563110352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([578, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.840287685394287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.840287685394287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.841390132904053  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.966554164886475  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([554, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.97505521774292  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.97505521774292  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.976111888885498  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.105468273162842  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([460, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.112898349761963  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.112898349761963  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.113775730133057  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.227253437042236  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([398, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.23408317565918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.23408317565918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.234842300415039  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.336565017700195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([400, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.343874454498291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.343874454498291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.344637393951416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.452211856842041  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([347, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.458834171295166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.458834171295166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.459496021270752  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.558770656585693  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([275, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.5642547607421875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.5642547607421875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.564779281616211  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.651397705078125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([250, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.6566619873046875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.6566619873046875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.657138824462891  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.734386444091797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([240, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.739684104919434  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.739684104919434  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.740141868591309  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.817503929138184  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([3064, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.890897274017334  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.890897274017334  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3064, 256]), torch.Size([1, 3064, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.8967413902282715  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.925305843353271  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3064, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.631063461303711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.638870239257812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.646713256835938  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.638559818267822  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([46528, 40])
input nodes number: 70949
output nodes number: 46528
edges number: 348398
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.64062213897705  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.640623092651367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08135509490966797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

pseudo mini batch 1 input nodes size: 121799
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06289148330688477  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06289148330688477  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12096977233886719  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12130069732666016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07732009887695312  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08535003662109375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08535003662109375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08535003662109375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([121799, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08535003662109375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8966, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4235200881958008  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4235200881958008  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8966, 128]), torch.Size([1, 8966, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.43269872665405273  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5025343894958496  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8966, 128])
m.shape torch.Size([8721, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5065760612487793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5065760612487793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8721, 128]), torch.Size([1, 8721, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5148930549621582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6453127861022949  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8721, 128])
m.shape torch.Size([7440, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6517972946166992  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6517972946166992  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7440, 128]), torch.Size([1, 7440, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6593575477600098  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8159198760986328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7440, 128])
m.shape torch.Size([6334, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8244533538818359  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8244533538818359  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6334, 128]), torch.Size([1, 6334, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8309063911437988  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0080795288085938  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6334, 128])
m.shape torch.Size([5588, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0187311172485352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0187311172485352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5588, 128]), torch.Size([1, 5588, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0244159698486328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.21661376953125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5588, 128])
m.shape torch.Size([4752, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.227621078491211  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.227621078491211  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4752, 128]), torch.Size([1, 4752, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2329435348510742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4332609176635742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4752, 128])
m.shape torch.Size([4261, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4448285102844238  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4448285102844238  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4261, 128]), torch.Size([1, 4261, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4497346878051758  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6554079055786133  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4261, 128])
m.shape torch.Size([3830, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6679863929748535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6679863929748535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3830, 128]), torch.Size([1, 3830, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6716389656066895  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8829522132873535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3830, 128])
m.shape torch.Size([3485, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8967509269714355  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8967509269714355  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3485, 128]), torch.Size([1, 3485, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9002814292907715  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.1188907623291016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3485, 128])
m.shape torch.Size([45945, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3363118171691895  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3363118171691895  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 45945, 128]), torch.Size([1, 45945, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3801283836364746  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.491104602813721  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 45945, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.188442230224609  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.283163070678711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.3778839111328125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.28242301940918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([99322, 256])
first layer input nodes number: 121799
first layer output nodes number: 99322
edges number: 681798
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.378793716430664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.473514556884766  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.497194766998291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.497194766998291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6776, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.886799335479736  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.886799335479736  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6776, 256]), torch.Size([1, 6776, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.899723529815674  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.003407001495361  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6776, 256])
m.shape torch.Size([5633, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.007773399353027  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.007773399353027  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5633, 256]), torch.Size([1, 5633, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.01851749420166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.179678916931152  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5633, 256])
m.shape torch.Size([4242, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.186538219451904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.186538219451904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4242, 256]), torch.Size([1, 4242, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.194860458374023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.373807907104492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4242, 256])
m.shape torch.Size([3291, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.382296562194824  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.382296562194824  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3291, 256]), torch.Size([1, 3291, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.388995170593262  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.573678970336914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3291, 256])
m.shape torch.Size([2869, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.583984375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.583984375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2869, 256]), torch.Size([1, 2869, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.5895819664001465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.790446758270264  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2869, 256])
m.shape torch.Size([2143, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.799734115600586  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.799734115600586  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2143, 256]), torch.Size([1, 2143, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.804719924926758  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.988435745239258  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2143, 256])
m.shape torch.Size([1745, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.998132228851318  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.998132228851318  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1745, 256]), torch.Size([1, 1745, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.001506805419922  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.170087814331055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1745, 256])
m.shape torch.Size([1509, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.179872512817383  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.179872512817383  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1509, 256]), torch.Size([1, 1509, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.182991981506348  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.353348255157471  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1509, 256])
m.shape torch.Size([1322, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.363193035125732  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.363193035125732  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1322, 256]), torch.Size([1, 1322, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.365951061248779  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.53140115737915  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1322, 256])
m.shape torch.Size([1124, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.540613651275635  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.540613651275635  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1124, 256]), torch.Size([1, 1124, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.542765140533447  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.7024149894714355  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1124, 256])
m.shape torch.Size([977, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.711554050445557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.711554050445557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 977, 256]), torch.Size([1, 977, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.7134175300598145  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.866572856903076  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 977, 256])
m.shape torch.Size([881, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.875802516937256  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.875802516937256  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.877482891082764  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.021238327026367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([752, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.029794216156006  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.029794216156006  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 752, 256]), torch.Size([1, 752, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.03122854232788  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.16353178024292  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 752, 256])
m.shape torch.Size([638, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.171399593353271  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.171399593353271  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.172616481781006  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.295789241790771  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 638, 256])
m.shape torch.Size([568, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.303369998931885  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.303369998931885  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.304453372955322  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.421579837799072  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([533, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.429799556732178  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.429799556732178  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.430816173553467  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.54569387435913  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([476, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.552963256835938  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.552963256835938  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.553871154785156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.663277626037598  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([488, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.671525955200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.671525955200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.672456741333008  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.795244216918945  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([438, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.802777767181396  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.802777767181396  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.803613185882568  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.91636610031128  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([407, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.92377233505249  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.92377233505249  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.924548625946045  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.038556575775146  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([370, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.045636653900146  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.045636653900146  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.046342372894287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.15105390548706  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([281, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.15664291381836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.15664291381836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.15717887878418  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.24467658996582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([269, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.250355243682861  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.250355243682861  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.250868320465088  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.334657192230225  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([285, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.340974807739258  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.340974807739258  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.34151840209961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.433652877807617  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([6396, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.58706521987915  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.58706521987915  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6396, 256]), torch.Size([1, 6396, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.59926462173462  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.74635934829712  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6396, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.402689933776855  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.409441947937012  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.416060447692871  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.408977508544922  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([44413, 40])
input nodes number: 99322
output nodes number: 44413
edges number: 395852
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.4089937210083  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.408994197845459  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09923744201660156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09923744201660156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.09923744201660156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05608320236206055 |0.005596041679382324 |0.16547656059265137 |0.00011026859283447266 |0.1410386562347412 |0.007879495620727539 |
----------------------------------------------------------pseudo_mini_loss sum 3.355257987976074
Total (block generation + training)time/epoch 24.049681901931763
Training time/epoch 0.8211147785186768
Training time without block to device /epoch 0.8099226951599121
Training time without total dataloading part /epoch 0.6211304664611816
load block tensor time/epoch 0.1121664047241211
block to device time/epoch 0.011192083358764648
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  383577
Number of first layer input nodes during this epoch:  213306
Number of first layer output nodes during this epoch:  170271
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
