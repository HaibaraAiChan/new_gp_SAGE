[17:36:24] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 2 parts and get 0 edge cuts
main start at this time 1651599369.5162303
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027009248733520508
global_2_local spend time (sec) 0.03558468818664551
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042111873626708984
A = g.adjacency_matrix() spent  0.007918119430541992
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08558082580566406
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.29052734375
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1939077377319336

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.009 seconds
Metis partitioning: 0.027 seconds
Split the graph: 0.037 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.07411623001098633
45470
45471
total k batches seeds list generation spend  10.184159994125366
after graph partition
graph partition algorithm spend time 10.335474014282227
45470
45471
partition_len_list
[129696, 129957]
shared_neighbor_graph_partition_s0 selection method  spend 10.418424606323242
time for parepare:  0.017203330993652344
local_output_nid generation:  0.004543781280517578
local_in_edges_tensor generation:  0.007450103759765625
mini_batch_src_global generation:  0.012608528137207031
r_  generation:  0.13173937797546387
local_output_nid generation:  0.00589299201965332
local_in_edges_tensor generation:  0.008310079574584961
mini_batch_src_global generation:  0.0207974910736084
r_  generation:  0.14955568313598633
----------------------check_connections_block total spend ----------------------------- 0.4308474063873291
generate_one_block  0.18446898460388184
generate_one_block  0.1895458698272705
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.040148019790649414
gen group dst list time:  0.007215976715087891
time for parepare:  0.020355701446533203
local_output_nid generation:  0.018854141235351562
local_in_edges_tensor generation:  0.04706406593322754
mini_batch_src_global generation:  0.02570962905883789
r_  generation:  0.3112454414367676
local_output_nid generation:  0.02277088165283203
local_in_edges_tensor generation:  0.0304257869720459
mini_batch_src_global generation:  0.03240466117858887
r_  generation:  0.3206794261932373
----------------------check_connections_block total spend ----------------------------- 0.9730498790740967
generate_one_block  0.3822946548461914
generate_one_block  0.3873577117919922
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9730498790740967
block generation total time  0.7696523666381836
average batch blocks generation time:  0.3848261833190918
pseudo mini batch 0 input nodes size: 156617
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07745838165283203  GigaBytes
Max Memory Allocated: 0.07745838165283203  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07779741287231445  GigaBytes
Max Memory Allocated: 0.07779741287231445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07779741287231445  GigaBytes
Max Memory Allocated: 0.07779741287231445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08713674545288086  GigaBytes
Max Memory Allocated: 0.08713674545288086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08713674545288086  GigaBytes
Max Memory Allocated: 0.08713674545288086  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08713674545288086  GigaBytes
Max Memory Allocated: 0.08713674545288086  GigaBytes

torch.Size([156617, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08713674545288086  GigaBytes
Max Memory Allocated: 0.08713674545288086  GigaBytes

m.shape torch.Size([10811, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5177211761474609  GigaBytes
Max Memory Allocated: 0.5252556800842285  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5177211761474609  GigaBytes
Max Memory Allocated: 0.5252556800842285  GigaBytes

 h.shape torch.Size([1, 10811, 128]), torch.Size([1, 10811, 128])
----------------------------------------3
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5280313491821289  GigaBytes
Max Memory Allocated: 0.5280313491821289  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6131048202514648  GigaBytes
Max Memory Allocated: 0.6182599067687988  GigaBytes

rst.shape  torch.Size([1, 10811, 128])
m.shape torch.Size([11907, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6193051338195801  GigaBytes
Max Memory Allocated: 0.6195721626281738  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6193051338195801  GigaBytes
Max Memory Allocated: 0.6195721626281738  GigaBytes

 h.shape torch.Size([1, 11907, 128]), torch.Size([1, 11907, 128])
----------------------------------------3
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6306605339050293  GigaBytes
Max Memory Allocated: 0.6306605339050293  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.805351734161377  GigaBytes
Max Memory Allocated: 0.8167071342468262  GigaBytes

rst.shape  torch.Size([1, 11907, 128])
m.shape torch.Size([10788, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.8152990341186523  GigaBytes
Max Memory Allocated: 0.8167071342468262  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.8152990341186523  GigaBytes
Max Memory Allocated: 0.8167071342468262  GigaBytes

 h.shape torch.Size([1, 10788, 128]), torch.Size([1, 10788, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.8261208534240723  GigaBytes
Max Memory Allocated: 0.8261208534240723  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 1.0606331825256348  GigaBytes
Max Memory Allocated: 1.0762581825256348  GigaBytes

rst.shape  torch.Size([1, 10788, 128])
m.shape torch.Size([9510, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0736279487609863  GigaBytes
Max Memory Allocated: 1.0762581825256348  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0736279487609863  GigaBytes
Max Memory Allocated: 1.0762581825256348  GigaBytes

 h.shape torch.Size([1, 9510, 128]), torch.Size([1, 9510, 128])
----------------------------------------3
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0833067893981934  GigaBytes
Max Memory Allocated: 1.0833067893981934  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 1.346320629119873  GigaBytes
Max Memory Allocated: 1.36445951461792  GigaBytes

rst.shape  torch.Size([1, 9510, 128])
m.shape torch.Size([8368, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.36173677444458  GigaBytes
Max Memory Allocated: 1.36445951461792  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.36173677444458  GigaBytes
Max Memory Allocated: 1.36445951461792  GigaBytes

 h.shape torch.Size([1, 8368, 128]), torch.Size([1, 8368, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3699016571044922  GigaBytes
Max Memory Allocated: 1.3699016571044922  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6578474044799805  GigaBytes
Max Memory Allocated: 1.6777982711791992  GigaBytes

rst.shape  torch.Size([1, 8368, 128])
m.shape torch.Size([7094, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6741533279418945  GigaBytes
Max Memory Allocated: 1.6777982711791992  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6741533279418945  GigaBytes
Max Memory Allocated: 1.6777982711791992  GigaBytes

 h.shape torch.Size([1, 7094, 128]), torch.Size([1, 7094, 128])
----------------------------------------3
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6812891960144043  GigaBytes
Max Memory Allocated: 1.6812891960144043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9757237434387207  GigaBytes
Max Memory Allocated: 1.9960198402404785  GigaBytes

rst.shape  torch.Size([1, 7094, 128])
m.shape torch.Size([6263, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9938254356384277  GigaBytes
Max Memory Allocated: 1.9960198402404785  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9938254356384277  GigaBytes
Max Memory Allocated: 1.9960198402404785  GigaBytes

 h.shape torch.Size([1, 6263, 128]), torch.Size([1, 6263, 128])
----------------------------------------3
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9998669624328613  GigaBytes
Max Memory Allocated: 1.9998669624328613  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.299375534057617  GigaBytes
Max Memory Allocated: 2.320859909057617  GigaBytes

rst.shape  torch.Size([1, 6263, 128])
m.shape torch.Size([5555, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.317873477935791  GigaBytes
Max Memory Allocated: 2.320859909057617  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.317873477935791  GigaBytes
Max Memory Allocated: 2.320859909057617  GigaBytes

 h.shape torch.Size([1, 5555, 128]), torch.Size([1, 5555, 128])
----------------------------------------3
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.3235087394714355  GigaBytes
Max Memory Allocated: 2.3235087394714355  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.6254754066467285  GigaBytes
Max Memory Allocated: 2.6469597816467285  GigaBytes

rst.shape  torch.Size([1, 5555, 128])
m.shape torch.Size([4897, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.64431095123291  GigaBytes
Max Memory Allocated: 2.6469597816467285  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.64431095123291  GigaBytes
Max Memory Allocated: 2.6469597816467285  GigaBytes

 h.shape torch.Size([1, 4897, 128]), torch.Size([1, 4897, 128])
----------------------------------------3
 Nvidia-smi: 3.9705810546875 GB
    Memory Allocated: 2.6494269371032715  GigaBytes
Max Memory Allocated: 2.6494269371032715  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3045654296875 GB
    Memory Allocated: 2.9616804122924805  GigaBytes
Max Memory Allocated: 2.9831647872924805  GigaBytes

rst.shape  torch.Size([1, 4897, 128])
m.shape torch.Size([54503, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.219235897064209  GigaBytes
Max Memory Allocated: 3.2256321907043457  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.219235897064209  GigaBytes
Max Memory Allocated: 3.2256321907043457  GigaBytes

 h.shape torch.Size([1, 54503, 128]), torch.Size([1, 54503, 128])
----------------------------------------3
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.271214008331299  GigaBytes
Max Memory Allocated: 3.271214008331299  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.961659908294678  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

rst.shape  torch.Size([1, 54503, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.581029891967773  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.704717636108398  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.828405380249023  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.703751087188721  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

torch.Size([129696, 256])
first layer input nodes number: 156617
first layer output nodes number: 129696
edges number: 866817
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.829595565795898  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6483154296875 GB
    Memory Allocated: 6.953283309936523  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7733154296875 GB
    Memory Allocated: 6.98420524597168  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7733154296875 GB
    Memory Allocated: 6.98420524597168  GigaBytes
Max Memory Allocated: 7.221550464630127  GigaBytes

m.shape torch.Size([6663, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.350619316101074  GigaBytes
Max Memory Allocated: 7.350770950317383  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.350619316101074  GigaBytes
Max Memory Allocated: 7.350770950317383  GigaBytes

 h.shape torch.Size([1, 6663, 256]), torch.Size([1, 6663, 256])
----------------------------------------3
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.363327980041504  GigaBytes
Max Memory Allocated: 7.363327980041504  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.464997291564941  GigaBytes
Max Memory Allocated: 7.471351623535156  GigaBytes

rst.shape  torch.Size([1, 6663, 256])
m.shape torch.Size([5873, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.469932556152344  GigaBytes
Max Memory Allocated: 7.471351623535156  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.469932556152344  GigaBytes
Max Memory Allocated: 7.471351623535156  GigaBytes

 h.shape torch.Size([1, 5873, 256]), torch.Size([1, 5873, 256])
----------------------------------------3
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.481333255767822  GigaBytes
Max Memory Allocated: 7.481333255767822  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.650440692901611  GigaBytes
Max Memory Allocated: 7.661642551422119  GigaBytes

rst.shape  torch.Size([1, 5873, 256])
m.shape torch.Size([4590, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.658074855804443  GigaBytes
Max Memory Allocated: 7.661642551422119  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.658074855804443  GigaBytes
Max Memory Allocated: 7.661642551422119  GigaBytes

 h.shape torch.Size([1, 4590, 256]), torch.Size([1, 4590, 256])
----------------------------------------3
 Nvidia-smi: 9.1307373046875 GB
    Memory Allocated: 7.667706489562988  GigaBytes
Max Memory Allocated: 7.667706489562988  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3045654296875 GB
    Memory Allocated: 7.861637592315674  GigaBytes
Max Memory Allocated: 7.875309467315674  GigaBytes

rst.shape  torch.Size([1, 4590, 256])
m.shape torch.Size([3682, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.3045654296875 GB
    Memory Allocated: 7.871416091918945  GigaBytes
Max Memory Allocated: 7.875309467315674  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3045654296875 GB
    Memory Allocated: 7.871416091918945  GigaBytes
Max Memory Allocated: 7.875309467315674  GigaBytes

 h.shape torch.Size([1, 3682, 256]), torch.Size([1, 3682, 256])
----------------------------------------3
 Nvidia-smi: 9.3045654296875 GB
    Memory Allocated: 7.879167556762695  GigaBytes
Max Memory Allocated: 7.879167556762695  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5467529296875 GB
    Memory Allocated: 8.082830429077148  GigaBytes
Max Memory Allocated: 8.09687614440918  GigaBytes

rst.shape  torch.Size([1, 3682, 256])
m.shape torch.Size([3077, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.5467529296875 GB
    Memory Allocated: 8.095058917999268  GigaBytes
Max Memory Allocated: 8.09687614440918  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5467529296875 GB
    Memory Allocated: 8.095058917999268  GigaBytes
Max Memory Allocated: 8.09687614440918  GigaBytes

 h.shape torch.Size([1, 3077, 256]), torch.Size([1, 3077, 256])
----------------------------------------3
 Nvidia-smi: 9.5467529296875 GB
    Memory Allocated: 8.10118293762207  GigaBytes
Max Memory Allocated: 8.10118293762207  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 8.313592910766602  GigaBytes
Max Memory Allocated: 8.328265190124512  GigaBytes

rst.shape  torch.Size([1, 3077, 256])
m.shape torch.Size([2431, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 8.324677467346191  GigaBytes
Max Memory Allocated: 8.328265190124512  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 8.324677467346191  GigaBytes
Max Memory Allocated: 8.328265190124512  GigaBytes

 h.shape torch.Size([1, 2431, 256]), torch.Size([1, 2431, 256])
----------------------------------------3
 Nvidia-smi: 9.7889404296875 GB
    Memory Allocated: 8.329595565795898  GigaBytes
Max Memory Allocated: 8.329595565795898  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9998779296875 GB
    Memory Allocated: 8.530291080474854  GigaBytes
Max Memory Allocated: 8.544201374053955  GigaBytes

rst.shape  torch.Size([1, 2431, 256])
m.shape torch.Size([2035, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.9998779296875 GB
    Memory Allocated: 8.541664123535156  GigaBytes
Max Memory Allocated: 8.544201374053955  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9998779296875 GB
    Memory Allocated: 8.541664123535156  GigaBytes
Max Memory Allocated: 8.544201374053955  GigaBytes

 h.shape torch.Size([1, 2035, 256]), torch.Size([1, 2035, 256])
----------------------------------------3
 Nvidia-smi: 9.9998779296875 GB
    Memory Allocated: 8.545724868774414  GigaBytes
Max Memory Allocated: 8.545724868774414  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2283935546875 GB
    Memory Allocated: 8.741172790527344  GigaBytes
Max Memory Allocated: 8.754844665527344  GigaBytes

rst.shape  torch.Size([1, 2035, 256])
m.shape torch.Size([1757, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.2283935546875 GB
    Memory Allocated: 8.753008842468262  GigaBytes
Max Memory Allocated: 8.754844665527344  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2283935546875 GB
    Memory Allocated: 8.753008842468262  GigaBytes
Max Memory Allocated: 8.754844665527344  GigaBytes

 h.shape torch.Size([1, 1757, 256]), torch.Size([1, 1757, 256])
----------------------------------------3
 Nvidia-smi: 10.2283935546875 GB
    Memory Allocated: 8.756461143493652  GigaBytes
Max Memory Allocated: 8.756461143493652  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 8.948875427246094  GigaBytes
Max Memory Allocated: 8.962547302246094  GigaBytes

rst.shape  torch.Size([1, 1757, 256])
m.shape torch.Size([1497, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 8.960736751556396  GigaBytes
Max Memory Allocated: 8.962547302246094  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 8.960736751556396  GigaBytes
Max Memory Allocated: 8.962547302246094  GigaBytes

 h.shape torch.Size([1, 1497, 256]), torch.Size([1, 1497, 256])
----------------------------------------3
 Nvidia-smi: 10.4764404296875 GB
    Memory Allocated: 8.963761806488037  GigaBytes
Max Memory Allocated: 8.963761806488037  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 9.152772426605225  GigaBytes
Max Memory Allocated: 9.166444301605225  GigaBytes

rst.shape  torch.Size([1, 1497, 256])
m.shape torch.Size([1314, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 9.163889408111572  GigaBytes
Max Memory Allocated: 9.166444301605225  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 9.163889408111572  GigaBytes
Max Memory Allocated: 9.166444301605225  GigaBytes

 h.shape torch.Size([1, 1314, 256]), torch.Size([1, 1314, 256])
----------------------------------------3
 Nvidia-smi: 10.5877685546875 GB
    Memory Allocated: 9.16654920578003  GigaBytes
Max Memory Allocated: 9.16654920578003  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7772216796875 GB
    Memory Allocated: 9.347389698028564  GigaBytes
Max Memory Allocated: 9.359920978546143  GigaBytes

rst.shape  torch.Size([1, 1314, 256])
m.shape torch.Size([1069, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7772216796875 GB
    Memory Allocated: 9.35733699798584  GigaBytes
Max Memory Allocated: 9.359920978546143  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7772216796875 GB
    Memory Allocated: 9.35733699798584  GigaBytes
Max Memory Allocated: 9.359920978546143  GigaBytes

 h.shape torch.Size([1, 1069, 256]), torch.Size([1, 1069, 256])
----------------------------------------3
 Nvidia-smi: 10.7772216796875 GB
    Memory Allocated: 9.35956859588623  GigaBytes
Max Memory Allocated: 9.359920978546143  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 9.525730609893799  GigaBytes
Max Memory Allocated: 9.537449359893799  GigaBytes

rst.shape  torch.Size([1, 1069, 256])
m.shape torch.Size([982, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 9.536145210266113  GigaBytes
Max Memory Allocated: 9.537449359893799  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 9.536145210266113  GigaBytes
Max Memory Allocated: 9.537449359893799  GigaBytes

 h.shape torch.Size([1, 982, 256]), torch.Size([1, 982, 256])
----------------------------------------3
 Nvidia-smi: 10.9080810546875 GB
    Memory Allocated: 9.538018226623535  GigaBytes
Max Memory Allocated: 9.538018226623535  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 9.70280933380127  GigaBytes
Max Memory Allocated: 9.71452808380127  GigaBytes

rst.shape  torch.Size([1, 982, 256])
m.shape torch.Size([850, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 9.712493419647217  GigaBytes
Max Memory Allocated: 9.71452808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 9.712493419647217  GigaBytes
Max Memory Allocated: 9.71452808380127  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 9.714114665985107  GigaBytes
Max Memory Allocated: 9.71452808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2459716796875 GB
    Memory Allocated: 9.86372709274292  GigaBytes
Max Memory Allocated: 9.874265193939209  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([738, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.2459716796875 GB
    Memory Allocated: 9.872847080230713  GigaBytes
Max Memory Allocated: 9.874265193939209  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2459716796875 GB
    Memory Allocated: 9.872847080230713  GigaBytes
Max Memory Allocated: 9.874265193939209  GigaBytes

 h.shape torch.Size([1, 738, 256]), torch.Size([1, 738, 256])
----------------------------------------3
 Nvidia-smi: 11.2479248046875 GB
    Memory Allocated: 9.874254703521729  GigaBytes
Max Memory Allocated: 9.874265193939209  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 10.017122745513916  GigaBytes
Max Memory Allocated: 10.026976108551025  GigaBytes

rst.shape  torch.Size([1, 738, 256])
m.shape torch.Size([658, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 10.02590560913086  GigaBytes
Max Memory Allocated: 10.026976108551025  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 10.02590560913086  GigaBytes
Max Memory Allocated: 10.026976108551025  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 10.02716064453125  GigaBytes
Max Memory Allocated: 10.02716064453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5526123046875 GB
    Memory Allocated: 10.160842895507812  GigaBytes
Max Memory Allocated: 10.170255661010742  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([559, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.5526123046875 GB
    Memory Allocated: 10.168811798095703  GigaBytes
Max Memory Allocated: 10.170255661010742  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5526123046875 GB
    Memory Allocated: 10.168811798095703  GigaBytes
Max Memory Allocated: 10.170255661010742  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 11.5526123046875 GB
    Memory Allocated: 10.169878005981445  GigaBytes
Max Memory Allocated: 10.170255661010742  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6619873046875 GB
    Memory Allocated: 10.293694496154785  GigaBytes
Max Memory Allocated: 10.302224159240723  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([538, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.6619873046875 GB
    Memory Allocated: 10.301951885223389  GigaBytes
Max Memory Allocated: 10.302224159240723  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6619873046875 GB
    Memory Allocated: 10.301951885223389  GigaBytes
Max Memory Allocated: 10.302224159240723  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 11.6639404296875 GB
    Memory Allocated: 10.302978038787842  GigaBytes
Max Memory Allocated: 10.302978038787842  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8045654296875 GB
    Memory Allocated: 10.427083492279053  GigaBytes
Max Memory Allocated: 10.435805797576904  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([466, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.8045654296875 GB
    Memory Allocated: 10.434632778167725  GigaBytes
Max Memory Allocated: 10.435805797576904  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.8045654296875 GB
    Memory Allocated: 10.434632778167725  GigaBytes
Max Memory Allocated: 10.435805797576904  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 11.8045654296875 GB
    Memory Allocated: 10.435521602630615  GigaBytes
Max Memory Allocated: 10.435805797576904  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.552985191345215  GigaBytes
Max Memory Allocated: 10.56098461151123  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([413, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.560082912445068  GigaBytes
Max Memory Allocated: 10.56098461151123  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.560082912445068  GigaBytes
Max Memory Allocated: 10.56098461151123  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.56087064743042  GigaBytes
Max Memory Allocated: 10.56098461151123  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9549560546875 GB
    Memory Allocated: 10.668501377105713  GigaBytes
Max Memory Allocated: 10.675984859466553  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([420, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.9549560546875 GB
    Memory Allocated: 10.676181316375732  GigaBytes
Max Memory Allocated: 10.676212787628174  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9549560546875 GB
    Memory Allocated: 10.676181316375732  GigaBytes
Max Memory Allocated: 10.676212787628174  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 11.9549560546875 GB
    Memory Allocated: 10.676982402801514  GigaBytes
Max Memory Allocated: 10.676982402801514  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 10.792006969451904  GigaBytes
Max Memory Allocated: 10.800017833709717  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([334, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 10.79834794998169  GigaBytes
Max Memory Allocated: 10.800017833709717  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 10.79834794998169  GigaBytes
Max Memory Allocated: 10.800017833709717  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 12.0721435546875 GB
    Memory Allocated: 10.798985004425049  GigaBytes
Max Memory Allocated: 10.800017833709717  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1346435546875 GB
    Memory Allocated: 10.89879560470581  GigaBytes
Max Memory Allocated: 10.905484676361084  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([287, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.1346435546875 GB
    Memory Allocated: 10.904545783996582  GigaBytes
Max Memory Allocated: 10.905484676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1346435546875 GB
    Memory Allocated: 10.904545783996582  GigaBytes
Max Memory Allocated: 10.905484676361084  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 12.1346435546875 GB
    Memory Allocated: 10.9050931930542  GigaBytes
Max Memory Allocated: 10.905484676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2244873046875 GB
    Memory Allocated: 10.993714332580566  GigaBytes
Max Memory Allocated: 10.999735832214355  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([261, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.2244873046875 GB
    Memory Allocated: 10.999210357666016  GigaBytes
Max Memory Allocated: 10.999735832214355  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2244873046875 GB
    Memory Allocated: 10.999210357666016  GigaBytes
Max Memory Allocated: 10.999735832214355  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 12.2244873046875 GB
    Memory Allocated: 10.99970817565918  GigaBytes
Max Memory Allocated: 10.999735832214355  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3162841796875 GB
    Memory Allocated: 11.082789421081543  GigaBytes
Max Memory Allocated: 11.08851432800293  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([263, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.3162841796875 GB
    Memory Allocated: 11.08860731124878  GigaBytes
Max Memory Allocated: 11.08863115310669  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3162841796875 GB
    Memory Allocated: 11.08860731124878  GigaBytes
Max Memory Allocated: 11.08863115310669  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 11.089108943939209  GigaBytes
Max Memory Allocated: 11.089108943939209  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4100341796875 GB
    Memory Allocated: 11.175761699676514  GigaBytes
Max Memory Allocated: 11.18178129196167  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([4713, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 11.289670467376709  GigaBytes
Max Memory Allocated: 11.290109634399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 11.289670467376709  GigaBytes
Max Memory Allocated: 11.290109634399414  GigaBytes

 h.shape torch.Size([1, 4713, 256]), torch.Size([1, 4713, 256])
----------------------------------------3
 Nvidia-smi: 12.5252685546875 GB
    Memory Allocated: 11.298659801483154  GigaBytes
Max Memory Allocated: 11.298659801483154  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3572998046875 GB
    Memory Allocated: 12.88078260421753  GigaBytes
Max Memory Allocated: 12.99406385421753  GigaBytes

rst.shape  torch.Size([1, 4713, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.562342166900635  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.569118022918701  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.575893878936768  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.568778991699219  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

torch.Size([45470, 40])
input nodes number: 129696
output nodes number: 45470
edges number: 372780
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.576860427856445  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.576861381530762  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11331462860107422  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

pseudo mini batch 1 input nodes size: 156689
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.08734941482543945  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.08734941482543945  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1620645523071289  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.16240358352661133  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.08738374710083008  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09661054611206055  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09661054611206055  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09661054611206055  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

torch.Size([156689, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09661054611206055  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

m.shape torch.Size([10912, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5272412300109863  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5272412300109863  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 10912, 128]), torch.Size([1, 10912, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5376477241516113  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6229138374328613  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 10912, 128])
m.shape torch.Size([11934, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6294293403625488  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6294293403625488  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 11934, 128]), torch.Size([1, 11934, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6416354179382324  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8174166679382324  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 11934, 128])
m.shape torch.Size([11002, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8271269798278809  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8271269798278809  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 11002, 128]), torch.Size([1, 11002, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8391833305358887  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.074512004852295  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 11002, 128])
m.shape torch.Size([9509, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.0874028205871582  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.0874028205871582  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 9509, 128]), torch.Size([1, 9509, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.0971832275390625  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3601694107055664  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 9509, 128])
m.shape torch.Size([8391, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.375640869140625  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.375640869140625  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 8391, 128]), torch.Size([1, 8391, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3836431503295898  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.6717252731323242  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 8391, 128])
m.shape torch.Size([7077, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.687971591949463  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.687971591949463  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 7077, 128]), torch.Size([1, 7077, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.6954045295715332  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.9902315139770508  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 7077, 128])
m.shape torch.Size([6254, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.0083413124084473  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.0083413124084473  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 6254, 128]), torch.Size([1, 6254, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.0147080421447754  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.313314437866211  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 6254, 128])
m.shape torch.Size([5557, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.3318166732788086  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.3318166732788086  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 5557, 128]), torch.Size([1, 5557, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.3371171951293945  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.6412177085876465  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 5557, 128])
m.shape torch.Size([4913, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.6600522994995117  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.6600522994995117  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 4913, 128]), torch.Size([1, 4913, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.664804458618164  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.9764223098754883  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 4913, 128])
m.shape torch.Size([54408, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.2331767082214355  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.2331767082214355  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 54408, 128]), torch.Size([1, 54408, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.285064220428467  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.9690775871276855  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 54408, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.588438034057617  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.712374687194824  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.836311340332031  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.711406230926514  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

torch.Size([129957, 256])
first layer input nodes number: 156689
first layer output nodes number: 129957
edges number: 866770
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.8375396728515625  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.9614763259887695  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.99246072769165  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.99246072769165  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

m.shape torch.Size([6765, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.357748508453369  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.357748508453369  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 6765, 256]), torch.Size([1, 6765, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.371706485748291  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.475986957550049  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 6765, 256])
m.shape torch.Size([5833, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.480748176574707  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.480748176574707  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 5833, 256]), torch.Size([1, 5833, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.492108345031738  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.658991813659668  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 5833, 256])
m.shape torch.Size([4687, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.6677374839782715  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.6677374839782715  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 4687, 256]), torch.Size([1, 4687, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.6768693923950195  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.87531042098999  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 4687, 256])
m.shape torch.Size([3638, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.884827136993408  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.884827136993408  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 3638, 256]), torch.Size([1, 3638, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.892280101776123  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.094066619873047  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 3638, 256])
m.shape torch.Size([3145, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.105710983276367  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.105710983276367  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 3145, 256]), torch.Size([1, 3145, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.111926078796387  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.327876091003418  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 3145, 256])
m.shape torch.Size([2437, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.338930606842041  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.338930606842041  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 2437, 256]), torch.Size([1, 2437, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.34421968460083  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.5570969581604  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 2437, 256])
m.shape torch.Size([2010, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.568295955657959  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.568295955657959  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 2010, 256]), torch.Size([1, 2010, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.572555541992188  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.768775939941406  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 2010, 256])
m.shape torch.Size([1715, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.779683589935303  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.779683589935303  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 1715, 256]), torch.Size([1, 1715, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.782987117767334  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.970168113708496  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 1715, 256])
m.shape torch.Size([1479, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.981267929077148  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.981267929077148  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 1479, 256]), torch.Size([1, 1479, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.98428201675415  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.173532962799072  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 1479, 256])
m.shape torch.Size([1285, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.184309959411621  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.184309959411621  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 1285, 256]), torch.Size([1, 1285, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.186762809753418  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.364502906799316  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 1285, 256])
m.shape torch.Size([1134, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.375092029571533  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.375092029571533  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 1134, 256]), torch.Size([1, 1134, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.37747049331665  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.560492038726807  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 1134, 256])
m.shape torch.Size([955, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.569813251495361  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.569813251495361  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.571634769439697  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.730968952178955  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([806, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.740128993988037  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.740128993988037  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 806, 256]), torch.Size([1, 806, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.741666316986084  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.883649349212646  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 806, 256])
m.shape torch.Size([696, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.89224624633789  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.89224624633789  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.893573760986328  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.03067398071289  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([631, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.039107322692871  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.039107322692871  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.040310859680176  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.171096801757812  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([552, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.178983688354492  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.178983688354492  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.180036544799805  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.302286148071289  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([492, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.30979871749878  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.30979871749878  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.310737133026123  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.426604747772217  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([482, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.434474468231201  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.434474468231201  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.435393810272217  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.553215503692627  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([423, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.56048059463501  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.56048059463501  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.56128740310669  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.673882007598877  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([387, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.680917739868164  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.680917739868164  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.681655883789062  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.787099838256836  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([383, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.794461250305176  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.794461250305176  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.795191764831543  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.905555725097656  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([269, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.910878658294678  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.910878658294678  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.911391735076904  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.993554592132568  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([258, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.999001502990723  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.999001502990723  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.999493598937988  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.081732749938965  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([262, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.087530612945557  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.087530612945557  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.088030338287354  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.174864292144775  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([4747, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.288780212402344  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.288780212402344  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

 h.shape torch.Size([1, 4747, 256]), torch.Size([1, 4747, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.297834396362305  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.89137077331543  GigaBytes
Max Memory Allocated: 13.006577491760254  GigaBytes

rst.shape  torch.Size([1, 4747, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.57313346862793  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.579909324645996  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.586685180664062  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.579570293426514  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes
[17:36:39] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 2 parts and get 0 edge cuts

torch.Size([45471, 40])
input nodes number: 129957
output nodes number: 45471
edges number: 371470
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.580877780914307  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 12.580878257751465  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11328697204589844  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11883735656738281  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11883735656738281  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07313227653503418 |0.17153894901275635 |0.46286332607269287 |0.0001513957977294922 |0.14076554775238037 |0.009806632995605469 |
----------------------------------------------------------pseudo_mini_loss sum 5.3241682052612305
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  572959
Number of first layer input nodes during this epoch:  313306
Number of first layer output nodes during this epoch:  259653
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11883687973022461  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01901721954345703
global_2_local spend time (sec) 0.039020538330078125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004563331604003906
A = g.adjacency_matrix() spent  0.007658243179321289
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08319282531738281
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.4763596057891846
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1861624717712402

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.035 seconds
Split the graph: 0.035 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0736238956451416
45470
45471
total k batches seeds list generation spend  10.238085269927979
after graph partition
graph partition algorithm spend time 10.372578382492065
45470
45471
partition_len_list
[129797, 129625]
shared_neighbor_graph_partition_s0 selection method  spend 10.463120698928833
time for parepare:  0.018984079360961914
local_output_nid generation:  0.0046846866607666016
local_in_edges_tensor generation:  0.0067136287689208984
mini_batch_src_global generation:  0.011787652969360352
r_  generation:  0.13620615005493164
local_output_nid generation:  0.006602764129638672
local_in_edges_tensor generation:  0.008890151977539062
mini_batch_src_global generation:  0.02416539192199707
r_  generation:  0.17159700393676758
----------------------check_connections_block total spend ----------------------------- 0.477583646774292
generate_one_block  0.1974964141845703
generate_one_block  0.21782135963439941
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06202507019042969
gen group dst list time:  0.007555723190307617
time for parepare:  0.02015542984008789
local_output_nid generation:  0.01983189582824707
local_in_edges_tensor generation:  0.04121661186218262
mini_batch_src_global generation:  0.048903703689575195
r_  generation:  0.32174158096313477
local_output_nid generation:  0.03149533271789551
local_in_edges_tensor generation:  0.03387641906738281
mini_batch_src_global generation:  0.035420894622802734
r_  generation:  0.33750081062316895
----------------------check_connections_block total spend ----------------------------- 1.0403997898101807
generate_one_block  0.3946666717529297
generate_one_block  0.40017080307006836
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.11883687973022461  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

connection checking time:  1.0403997898101807
block generation total time  0.794837474822998
average batch blocks generation time:  0.397418737411499
block dataloader generation time/epoch 13.392837762832642
pseudo mini batch 0 input nodes size: 156615
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09293317794799805  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09293317794799805  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.16761302947998047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1679520606994629  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.09289789199829102  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1022186279296875  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1022186279296875  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1022186279296875  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

torch.Size([156615, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.1022186279296875  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

m.shape torch.Size([11048, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5320224761962891  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 11048, 128]), torch.Size([1, 11048, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.5425586700439453  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6280841827392578  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 11048, 128])
m.shape torch.Size([11933, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6345348358154297  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6345348358154297  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 11933, 128]), torch.Size([1, 11933, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.6466755867004395  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8224568367004395  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 11933, 128])
m.shape torch.Size([10822, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8320531845092773  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8320531845092773  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 10822, 128]), torch.Size([1, 10822, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 0.8441104888916016  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.0787525177001953  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 10822, 128])
m.shape torch.Size([9531, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.091771125793457  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.091771125793457  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 9531, 128]), torch.Size([1, 9531, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.1014761924743652  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3650708198547363  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 9531, 128])
m.shape torch.Size([8406, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3805675506591797  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3805675506591797  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 8406, 128]), torch.Size([1, 8406, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.3885841369628906  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.6771812438964844  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 8406, 128])
m.shape torch.Size([7057, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.6933631896972656  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.6933631896972656  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 7057, 128]), torch.Size([1, 7057, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.7007675170898438  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 1.9952502250671387  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 7057, 128])
m.shape torch.Size([6233, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.013369560241699  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.013369560241699  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 6233, 128]), torch.Size([1, 6233, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.0197010040283203  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.317561626434326  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 6233, 128])
m.shape torch.Size([5521, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.336073875427246  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.336073875427246  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 5521, 128]), torch.Size([1, 5521, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.3416786193847656  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.6433234214782715  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 5521, 128])
m.shape torch.Size([4899, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.662175178527832  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.662175178527832  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4899, 128]), torch.Size([1, 4899, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.6670989990234375  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 2.9805989265441895  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 4899, 128])
m.shape torch.Size([54347, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.2374095916748047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.2374095916748047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 54347, 128]), torch.Size([1, 54347, 128])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 3.289238929748535  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.969121932983398  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 54347, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.589461326599121  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.713245391845703  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.837029457092285  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.712277889251709  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

torch.Size([129797, 256])
first layer input nodes number: 156615
first layer output nodes number: 129797
edges number: 865236
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.838213920593262  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.961997985839844  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.992944240570068  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 6.992944240570068  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

m.shape torch.Size([6781, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.357816696166992  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.357816696166992  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 6781, 256]), torch.Size([1, 6781, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.371912002563477  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.477124214172363  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 6781, 256])
m.shape torch.Size([5856, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.481333255767822  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.481333255767822  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 5856, 256]), torch.Size([1, 5856, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.492608070373535  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.660149574279785  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 5856, 256])
m.shape torch.Size([4636, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.667932510375977  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.667932510375977  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4636, 256]), torch.Size([1, 4636, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.677572250366211  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.872953414916992  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 4636, 256])
m.shape torch.Size([3674, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.882657051086426  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.882657051086426  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 3674, 256]), torch.Size([1, 3674, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 7.8899006843566895  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.094542980194092  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 3674, 256])
m.shape torch.Size([3084, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.105859756469727  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.105859756469727  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 3084, 256]), torch.Size([1, 3084, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.111773014068604  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.323534488677979  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 3084, 256])
m.shape torch.Size([2416, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.335407257080078  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.335407257080078  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 2416, 256]), torch.Size([1, 2416, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.340306282043457  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.541747093200684  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 2416, 256])
m.shape torch.Size([1982, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.552777767181396  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.552777767181396  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1982, 256]), torch.Size([1, 1982, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.55680227279663  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.752259254455566  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1982, 256])
m.shape torch.Size([1762, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.763288021087646  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.763288021087646  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1762, 256]), torch.Size([1, 1762, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.766838550567627  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.960255146026611  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1762, 256])
m.shape torch.Size([1502, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.97146463394165  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.97146463394165  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1502, 256]), torch.Size([1, 1502, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 8.97437047958374  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.16499376296997  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1502, 256])
m.shape torch.Size([1316, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.176097393035889  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.176097393035889  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1316, 256]), torch.Size([1, 1316, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.178741931915283  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.359985828399658  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1316, 256])
m.shape torch.Size([1085, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.370028018951416  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.370028018951416  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1085, 256]), torch.Size([1, 1085, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.37222146987915  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.542718887329102  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1085, 256])
m.shape torch.Size([982, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.552616119384766  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.552616119384766  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 982, 256]), torch.Size([1, 982, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.554489135742188  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.719303131103516  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 982, 256])
m.shape torch.Size([823, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.728650093078613  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.728650093078613  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 823, 256]), torch.Size([1, 823, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.730219841003418  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.878802299499512  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 823, 256])
m.shape torch.Size([725, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.887773036956787  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.887773036956787  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 9.889155864715576  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.028647899627686  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([634, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.037096977233887  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.037096977233887  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.03830623626709  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.16760540008545  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([550, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.175458908081055  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.175458908081055  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.176507949829102  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.298686981201172  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([521, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.306675434112549  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.306675434112549  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.307669162750244  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.426916599273682  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([466, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.434482097625732  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.434482097625732  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.435370922088623  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.550563335418701  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([423, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.557843685150146  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.557843685150146  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.558650493621826  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.66867971420288  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([416, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.676272869110107  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.676272869110107  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.677066326141357  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.791358470916748  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([358, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.798187732696533  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.798187732696533  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.79887056350708  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.901874542236328  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([288, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.907622814178467  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.907622814178467  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.908172130584717  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 10.996912479400635  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([268, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.002562522888184  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.002562522888184  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.003073692321777  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.0864896774292  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([270, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.092462539672852  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.092462539672852  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 15.1268310546875 GB
    Memory Allocated: 11.092977523803711  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 11.180009841918945  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([4652, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 11.291531562805176  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 11.291531562805176  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4652, 256]), torch.Size([1, 4652, 256])
----------------------------------------3
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 11.30040454864502  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.862092018127441  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 4652, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.54551362991333  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.552289485931396  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.559065341949463  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.551950454711914  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

torch.Size([45470, 40])
input nodes number: 129797
output nodes number: 45470
edges number: 370939
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.55325698852539  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 12.553257942199707  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.11955070495605469  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

pseudo mini batch 1 input nodes size: 156498
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.09289884567260742  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.09289884567260742  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.16752290725708008  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.1678619384765625  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.09284305572509766  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

torch.Size([156498, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.102081298828125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

m.shape torch.Size([10790, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.5327010154724121  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.5327010154724121  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 10790, 128]), torch.Size([1, 10790, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.5429911613464355  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.6280245780944824  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 10790, 128])
m.shape torch.Size([11877, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.6345982551574707  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.6345982551574707  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 11877, 128]), torch.Size([1, 11877, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.6468353271484375  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.8226165771484375  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 11877, 128])
m.shape torch.Size([10835, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.832186222076416  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.832186222076416  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 10835, 128]), torch.Size([1, 10835, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 0.844296932220459  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.0789885520935059  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 10835, 128])
m.shape torch.Size([9474, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.0918922424316406  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.0918922424316406  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 9474, 128]), torch.Size([1, 9474, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.101576328277588  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.3635945320129395  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 9474, 128])
m.shape torch.Size([8398, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.3790993690490723  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.3790993690490723  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 8398, 128]), torch.Size([1, 8398, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.387108325958252  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.6754307746887207  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 8398, 128])
m.shape torch.Size([7055, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.6916108131408691  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.6916108131408691  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 7055, 128]), torch.Size([1, 7055, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.6990303993225098  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 1.9935083389282227  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 7055, 128])
m.shape torch.Size([6250, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.0116286277770996  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.0116286277770996  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 6250, 128]), torch.Size([1, 6250, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.018022060394287  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.3164291381835938  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 6250, 128])
m.shape torch.Size([5572, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.334933280944824  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.334933280944824  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 5572, 128]), torch.Size([1, 5572, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.3403005599975586  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.6447296142578125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 5572, 128])
m.shape torch.Size([4888, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.6635570526123047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.6635570526123047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4888, 128]), torch.Size([1, 4888, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.6682376861572266  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 2.979987144470215  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 4888, 128])
m.shape torch.Size([54486, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 3.2371301651000977  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 3.2371301651000977  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 54486, 128]), torch.Size([1, 54486, 128])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 3.2890920639038086  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.978386878967285  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 54486, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.597514629364014  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.721134662628174  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.844754695892334  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.720168590545654  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

torch.Size([129625, 256])
first layer input nodes number: 156498
first layer output nodes number: 129625
edges number: 866443
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.8460564613342285  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 6.969676494598389  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.000581741333008  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.000581741333008  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

m.shape torch.Size([6647, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.367748260498047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.367748260498047  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 6647, 256]), torch.Size([1, 6647, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.381649017333984  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.484908103942871  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 6647, 256])
m.shape torch.Size([5850, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.489202976226807  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.489202976226807  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 5850, 256]), torch.Size([1, 5850, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.500445365905762  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.668105125427246  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 5850, 256])
m.shape torch.Size([4641, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.676582336425781  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.676582336425781  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4641, 256]), torch.Size([1, 4641, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.686244964599609  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.882729530334473  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 4641, 256])
m.shape torch.Size([3646, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.89232063293457  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.89232063293457  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 3646, 256]), torch.Size([1, 3646, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 7.899678707122803  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.101877689361572  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 3646, 256])
m.shape torch.Size([3138, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.113481044769287  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.113481044769287  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 3138, 256]), torch.Size([1, 3138, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.12000560760498  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.335474967956543  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 3138, 256])
m.shape torch.Size([2452, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.347555160522461  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.347555160522461  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 2452, 256]), torch.Size([1, 2452, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.352815628051758  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.5651216506958  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 2452, 256])
m.shape torch.Size([2063, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.57666301727295  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.57666301727295  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 2063, 256]), torch.Size([1, 2063, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.58063793182373  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.780137538909912  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 2063, 256])
m.shape torch.Size([1710, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.791318416595459  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.791318416595459  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1710, 256]), torch.Size([1, 1710, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.79463529586792  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.982707500457764  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1710, 256])
m.shape torch.Size([1474, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.99406385421753  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.99406385421753  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1474, 256]), torch.Size([1, 1474, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 8.99695348739624  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.184614658355713  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1474, 256])
m.shape torch.Size([1283, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.195401191711426  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.195401191711426  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1283, 256]), torch.Size([1, 1283, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.198126792907715  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.375197410583496  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1283, 256])
m.shape torch.Size([1118, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.385646343231201  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.385646343231201  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 1118, 256]), torch.Size([1, 1118, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.388214588165283  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.570807933807373  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 1118, 256])
m.shape torch.Size([955, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.580277919769287  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.580277919769287  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.582099437713623  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.737969875335693  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([833, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.747467517852783  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.747467517852783  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 833, 256]), torch.Size([1, 833, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.749056339263916  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.898594379425049  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 833, 256])
m.shape torch.Size([709, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.90734052658081  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.90734052658081  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 9.908692836761475  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.045955181121826  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([655, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.054722309112549  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.054722309112549  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 655, 256]), torch.Size([1, 655, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.055971622467041  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.189383029937744  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 655, 256])
m.shape torch.Size([561, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.198362350463867  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.198362350463867  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.199432373046875  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.323592185974121  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([509, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.331953048706055  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.331953048706055  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 509, 256]), torch.Size([1, 509, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.332923889160156  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.450493812561035  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 509, 256])
m.shape torch.Size([482, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.45834732055664  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.45834732055664  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 482, 256]), torch.Size([1, 482, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.459266662597656  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.576170921325684  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 482, 256])
m.shape torch.Size([413, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.583253383636475  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.583253383636475  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.584041118621826  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.695922374725342  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([391, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.703044891357422  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.703044891357422  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.703790664672852  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.810417175292969  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([359, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.817290306091309  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.817290306091309  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.817975044250488  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.920682907104492  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([268, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.926221370697021  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.926221370697021  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 10.926732540130615  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 11.008742809295654  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([251, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 11.014036178588867  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 11.014036178588867  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 15.1346435546875 GB
    Memory Allocated: 11.014514923095703  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 11.092071533203125  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([255, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 11.0977144241333  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 11.0977144241333  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 11.098200798034668  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2596435546875 GB
    Memory Allocated: 11.180397987365723  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([4808, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 11.295682430267334  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 11.295682430267334  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes

 h.shape torch.Size([1, 4808, 256]), torch.Size([1, 4808, 256])
----------------------------------------3
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 11.304852962493896  GigaBytes
Max Memory Allocated: 13.017136573791504  GigaBytes
[17:36:53] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 2 parts and get 0 edge cuts

----------------------------------------4
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.918866634368896  GigaBytes
Max Memory Allocated: 13.033498287200928  GigaBytes

rst.shape  torch.Size([1, 4808, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.599052429199219  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.605828285217285  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.612604141235352  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.605489253997803  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([45471, 40])
input nodes number: 129625
output nodes number: 45471
edges number: 373311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.606794357299805  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2615966796875 GB
    Memory Allocated: 12.606794834136963  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1189112663269043  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1189112663269043  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1189112663269043  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07159340381622314 |0.007294654846191406 |0.19649410247802734 |0.0001125335693359375 |0.1585167646408081 |0.00454401969909668 |
----------------------------------------------------------pseudo_mini_loss sum 4.129924774169922
Total (block generation + training)time/epoch 14.32106351852417
Training time/epoch 0.9279768466949463
Training time without block to device /epoch 0.9133875370025635
Training time without total dataloading part /epoch 0.7147908210754395
load block tensor time/epoch 0.1431868076324463
block to device time/epoch 0.014589309692382812
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  572535
Number of first layer input nodes during this epoch:  313113
Number of first layer output nodes during this epoch:  259422
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1189107894897461  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02234506607055664
global_2_local spend time (sec) 0.041568756103515625
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0044023990631103516
A = g.adjacency_matrix() spent  0.010423898696899414
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08932137489318848
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.295508623123169
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.182464599609375

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.002 seconds
Metis partitioning: 0.032 seconds
Split the graph: 0.031 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.06700468063354492
45470
45471
total k batches seeds list generation spend  10.191560745239258
after graph partition
graph partition algorithm spend time 10.348747491836548
45470
45471
partition_len_list
[129643, 129913]
shared_neighbor_graph_partition_s0 selection method  spend 10.441421747207642
time for parepare:  0.020534276962280273
local_output_nid generation:  0.004777193069458008
local_in_edges_tensor generation:  0.006112575531005859
mini_batch_src_global generation:  0.023703336715698242
r_  generation:  0.15278005599975586
local_output_nid generation:  0.007012605667114258
local_in_edges_tensor generation:  0.012445449829101562
mini_batch_src_global generation:  0.020412683486938477
r_  generation:  0.15601515769958496
----------------------check_connections_block total spend ----------------------------- 0.4772634506225586
generate_one_block  0.19551396369934082
generate_one_block  0.1905074119567871
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036283254623413086
gen group dst list time:  0.007567882537841797
time for parepare:  0.02040863037109375
local_output_nid generation:  0.01815629005432129
local_in_edges_tensor generation:  0.04559803009033203
mini_batch_src_global generation:  0.029630184173583984
r_  generation:  0.34642958641052246
local_output_nid generation:  0.025165319442749023
local_in_edges_tensor generation:  0.035173892974853516
mini_batch_src_global generation:  0.03840827941894531
r_  generation:  0.3364906311035156
----------------------check_connections_block total spend ----------------------------- 1.0864183902740479
generate_one_block  0.4048318862915039
generate_one_block  0.4141988754272461
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1189107894897461  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

connection checking time:  1.0864183902740479
block generation total time  0.81903076171875
average batch blocks generation time:  0.409515380859375
block dataloader generation time/epoch 13.374920725822449
pseudo mini batch 0 input nodes size: 156543
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.09284210205078125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.09284210205078125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.16748762130737305  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.16782665252685547  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.09286355972290039  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1022329330444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1022329330444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1022329330444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([156543, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1022329330444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

m.shape torch.Size([10733, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5320439338684082  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5320439338684082  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 10733, 128]), torch.Size([1, 10733, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5422797203063965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6241660118103027  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 10733, 128])
m.shape torch.Size([12015, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6307668685913086  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6307668685913086  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 12015, 128]), torch.Size([1, 12015, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.643096923828125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.818878173828125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 12015, 128])
m.shape torch.Size([10853, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.8285136222839355  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.8285136222839355  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 10853, 128]), torch.Size([1, 10853, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.8404927253723145  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.0752530097961426  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 10853, 128])
m.shape torch.Size([9444, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.0880908966064453  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.0880908966064453  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 9444, 128]), torch.Size([1, 9444, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.0977692604064941  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.3589577674865723  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 9444, 128])
m.shape torch.Size([8383, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.374441146850586  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.374441146850586  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 8383, 128]), torch.Size([1, 8383, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.3824357986450195  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.670243263244629  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 8383, 128])
m.shape torch.Size([7058, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.686439037322998  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.686439037322998  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 7058, 128]), torch.Size([1, 7058, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.6935367584228516  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.9885163307189941  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 7058, 128])
m.shape torch.Size([6194, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.0066351890563965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.0066351890563965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 6194, 128]), torch.Size([1, 6194, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.0130715370178223  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.3094582557678223  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 6194, 128])
m.shape torch.Size([5580, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.327989101409912  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.327989101409912  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 5580, 128]), torch.Size([1, 5580, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.333413600921631  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.6386075019836426  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 5580, 128])
m.shape torch.Size([4895, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.657431125640869  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.657431125640869  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4895, 128]), torch.Size([1, 4895, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.6624131202697754  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.9727349281311035  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4895, 128])
m.shape torch.Size([54488, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.230219841003418  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.230219841003418  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 54488, 128]), torch.Size([1, 54488, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.2821836471557617  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.971613883972168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 54488, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.591948509216309  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.715585708618164  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.8392229080200195  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.7146196365356445  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([129643, 256])
first layer input nodes number: 156543
first layer output nodes number: 129643
edges number: 866294
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.840516090393066  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.964153289794922  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.995062828063965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.995062828063965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

m.shape torch.Size([6713, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.3616862297058105  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.3616862297058105  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 6713, 256]), torch.Size([1, 6713, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.374490261077881  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.476922512054443  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 6713, 256])
m.shape torch.Size([5899, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.481860160827637  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.481860160827637  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 5899, 256]), torch.Size([1, 5899, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.493266582489014  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.662038326263428  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 5899, 256])
m.shape torch.Size([4690, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.6704230308532715  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.6704230308532715  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4690, 256]), torch.Size([1, 4690, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.679908275604248  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.877353668212891  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4690, 256])
m.shape torch.Size([3586, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.886667728424072  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.886667728424072  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 3586, 256]), torch.Size([1, 3586, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.894776821136475  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.093129634857178  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 3586, 256])
m.shape torch.Size([3109, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.104650497436523  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.104650497436523  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 3109, 256]), torch.Size([1, 3109, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.11136770248413  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.324845790863037  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 3109, 256])
m.shape torch.Size([2386, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.33564043045044  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.33564043045044  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 2386, 256]), torch.Size([1, 2386, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.340282917022705  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.537373065948486  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 2386, 256])
m.shape torch.Size([2005, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.548430919647217  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.548430919647217  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 2005, 256]), torch.Size([1, 2005, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.552770137786865  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.753261089324951  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 2005, 256])
m.shape torch.Size([1778, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.764610290527344  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.764610290527344  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1778, 256]), torch.Size([1, 1778, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.768081665039062  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.963800430297852  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1778, 256])
m.shape torch.Size([1511, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.975013256072998  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.975013256072998  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1511, 256]), torch.Size([1, 1511, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.977994918823242  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.167957305908203  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1511, 256])
m.shape torch.Size([1251, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.17844009399414  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.17844009399414  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1251, 256]), torch.Size([1, 1251, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.181066036224365  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.357049465179443  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1251, 256])
m.shape torch.Size([1086, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.367169380187988  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.367169380187988  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1086, 256]), torch.Size([1, 1086, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.369394302368164  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.541547775268555  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1086, 256])
m.shape torch.Size([922, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.551334857940674  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.551334857940674  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 922, 256]), torch.Size([1, 922, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.553093433380127  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.702572345733643  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 922, 256])
m.shape torch.Size([840, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.712188720703125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.712188720703125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.713790893554688  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.863183975219727  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([709, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.871923446655273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.871923446655273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.873275756835938  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.011463165283203  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([681, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.020605087280273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.020605087280273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.021903991699219  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.160507202148438  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([584, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.1690673828125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.1690673828125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.170181274414062  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.296453475952148  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([501, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.304082870483398  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.304082870483398  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 501, 256]), torch.Size([1, 501, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.305038452148438  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.421292304992676  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 501, 256])
m.shape torch.Size([491, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.429309368133545  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.429309368133545  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.430245876312256  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.552871227264404  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([403, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.559762477874756  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.559762477874756  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.56053113937378  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.670113563537598  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([403, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.677475929260254  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.677475929260254  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.678244590759277  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.787537574768066  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([358, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.794379234313965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.794379234313965  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.795062065124512  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.898877143859863  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([286, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.90458345413208  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.90458345413208  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.905128955841064  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.991398334503174  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([256, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.996784687042236  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.996784687042236  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.997272968292236  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.076374530792236  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([278, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.08254337310791  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.08254337310791  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.083073616027832  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.174233436584473  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([4744, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.28813362121582  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.28813362121582  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4744, 256]), torch.Size([1, 4744, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.297182083129883  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.89036750793457  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4744, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.571897983551025  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.578673839569092  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.585449695587158  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.57833480834961  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([45470, 40])
input nodes number: 129643
output nodes number: 45470
edges number: 372611
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.579639911651611  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.579640865325928  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.11968994140625  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

pseudo mini batch 1 input nodes size: 156473
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.0928645133972168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.0928645133972168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.16747665405273438  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.1678156852722168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.09283113479614258  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.10237646102905273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.10237646102905273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.10237646102905273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([156473, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.10237646102905273  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

m.shape torch.Size([10974, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5329818725585938  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5329818725585938  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 10974, 128]), torch.Size([1, 10974, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.5434474945068359  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6288318634033203  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 10974, 128])
m.shape torch.Size([11847, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6353178024291992  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6353178024291992  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 11847, 128]), torch.Size([1, 11847, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.6474528312683105  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.8232340812683105  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 11847, 128])
m.shape torch.Size([10840, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.832789421081543  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.832789421081543  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 10840, 128]), torch.Size([1, 10840, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.8449287414550781  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.0796394348144531  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 10840, 128])
m.shape torch.Size([9527, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.092641830444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.092641830444336  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 9527, 128]), torch.Size([1, 9527, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.102353572845459  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.365837574005127  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 9527, 128])
m.shape torch.Size([8413, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.3813529014587402  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.3813529014587402  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 8413, 128]), torch.Size([1, 8413, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.389376163482666  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.6782135963439941  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 8413, 128])
m.shape torch.Size([7139, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.694626808166504  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.694626808166504  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 7139, 128]), torch.Size([1, 7139, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.7020177841186523  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 1.9968342781066895  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 7139, 128])
m.shape torch.Size([6197, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.0149145126342773  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.0149145126342773  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 6197, 128]), torch.Size([1, 6197, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.021243095397949  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.3174877166748047  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 6197, 128])
m.shape torch.Size([5512, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.33601713180542  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.33601713180542  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 5512, 128]), torch.Size([1, 5512, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.3412833213806152  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.643369674682617  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 5512, 128])
m.shape torch.Size([4907, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.6622257232666016  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.6622257232666016  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4907, 128]), torch.Size([1, 4907, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.6671924591064453  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 2.979750633239746  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4907, 128])
m.shape torch.Size([54557, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.2375588417053223  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.2375588417053223  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 54557, 128]), torch.Size([1, 54557, 128])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 3.289588451385498  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.9836907386779785  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 54557, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.603078365325928  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.726973056793213  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.850867748260498  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.7260050773620605  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([129913, 256])
first layer input nodes number: 156473
first layer output nodes number: 129913
edges number: 867403
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.852122783660889  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 6.976017475128174  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.006991386413574  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.006991386413574  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

m.shape torch.Size([6715, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.37254524230957  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.37254524230957  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 6715, 256]), torch.Size([1, 6715, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.386674880981445  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.490459442138672  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 6715, 256])
m.shape torch.Size([5807, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.495218276977539  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.495218276977539  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 5807, 256]), torch.Size([1, 5807, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.506515979766846  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.6726555824279785  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 5807, 256])
m.shape torch.Size([4587, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.681168556213379  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.681168556213379  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4587, 256]), torch.Size([1, 4587, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.690345287322998  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.884548187255859  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4587, 256])
m.shape torch.Size([3734, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.895442008972168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.895442008972168  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 3734, 256]), torch.Size([1, 3734, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 7.903438091278076  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.110790729522705  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 3734, 256])
m.shape torch.Size([3113, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.122189998626709  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.122189998626709  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 3113, 256]), torch.Size([1, 3113, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.12864875793457  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.342401504516602  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 3113, 256])
m.shape torch.Size([2482, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.354387760162354  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.354387760162354  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 2482, 256]), torch.Size([1, 2482, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.359696865081787  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.570727825164795  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 2482, 256])
m.shape torch.Size([2040, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.582086086273193  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.582086086273193  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 2040, 256]), torch.Size([1, 2040, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.586087226867676  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.783950805664062  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 2040, 256])
m.shape torch.Size([1694, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.79503059387207  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.79503059387207  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1694, 256]), torch.Size([1, 1694, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.798386096954346  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.985990047454834  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1694, 256])
m.shape torch.Size([1465, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.996810913085938  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.996810913085938  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1465, 256]), torch.Size([1, 1465, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 8.999629974365234  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.179035186767578  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1465, 256])
m.shape torch.Size([1348, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.190581798553467  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.190581798553467  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1348, 256]), torch.Size([1, 1348, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.193224906921387  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.376759052276611  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1348, 256])
m.shape torch.Size([1117, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.387239456176758  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.387239456176758  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1117, 256]), torch.Size([1, 1117, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.389520645141602  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.561393737792969  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1117, 256])
m.shape torch.Size([1015, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.57173204421997  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.57173204421997  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.573668003082275  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.742096424102783  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
m.shape torch.Size([816, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.75132417678833  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.75132417678833  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 816, 256]), torch.Size([1, 816, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.752880573272705  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.90085744857788  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 816, 256])
m.shape torch.Size([725, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.909834861755371  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.909834861755371  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 9.91121768951416  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.04880428314209  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([608, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.056878566741943  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.056878566741943  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.058038234710693  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.186875820159912  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([527, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.194400310516357  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.194400310516357  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.19540548324585  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.30950117111206  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([529, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.317642211914062  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.317642211914062  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.31865119934082  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.44060230255127  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([457, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.448004245758057  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.448004245758057  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.448875904083252  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.563636779785156  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([433, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.571108341217041  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.571108341217041  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.571934223175049  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.682602405548096  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([404, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.689955711364746  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.689955711364746  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.690726280212402  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.800346374511719  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([359, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.807207107543945  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.807207107543945  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.807891845703125  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.913543224334717  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([270, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.919081687927246  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.919081687927246  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 10.919596672058105  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.001935958862305  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([263, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.007492542266846  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.007492542266846  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.007994174957275  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.090932369232178  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([247, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.096379280090332  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.096379280090332  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.096850395202637  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.176468849182129  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([4716, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.290393352508545  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.290393352508545  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

 h.shape torch.Size([1, 4716, 256]), torch.Size([1, 4716, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 11.299388408660889  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.882903575897217  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

rst.shape  torch.Size([1, 4716, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.565213203430176  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.571989059448242  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.578764915466309  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.57165002822876  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

torch.Size([45471, 40])
input nodes number: 129913
output nodes number: 45471
edges number: 371639
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.572957038879395  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.572957515716553  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.044574737548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0756990909576416 |0.009445548057556152 |0.18788361549377441 |0.00011050701141357422 |0.1362541913986206 |0.005642414093017578 |
----------------------------------------------------------pseudo_mini_loss sum 3.0257439613342285
Total (block generation + training)time/epoch 14.298651099205017
Training time/epoch 0.9189558029174805
Training time without block to device /epoch 0.9000647068023682
Training time without total dataloading part /epoch 0.6541390419006348
load block tensor time/epoch 0.1513981819152832
block to device time/epoch 0.018891096115112305
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  572572
Number of first layer input nodes during this epoch:  313016
Number of first layer output nodes during this epoch:  259556
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
