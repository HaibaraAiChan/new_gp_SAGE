[17:37:24] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27741370 edges into 2 parts and get 172629 edge cuts
main start at this time 1651599421.9257855
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029441356658935547
global_2_local spend time (sec) 0.035675048828125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004251956939697266
A = g.adjacency_matrix() spent  0.00835871696472168
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07792258262634277
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2974560260772705
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1997523307800293

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18687042, 2.0: 3216437, 3.0: 806435, 4.0: 243588, 5.0: 87963, 6.0: 38056, 7.0: 17712, 8.0: 9211, 9.0: 5018, 10.0: 2773, 11.0: 1603, 12.0: 931, 13.0: 552, 14.0: 368, 15.0: 239, 16.0: 157, 17.0: 127, 18.0: 78, 19.0: 42, 20.0: 15, 21.0: 7})
Convert a graph into a bidirected graph: 1.135 seconds
Metis partitioning: 4.682 seconds
Split the graph: 3.331 seconds
Construct subgraphs: 0.050 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.211517333984375
46505
44436
total k batches seeds list generation spend  21.320228099822998
after graph partition
graph partition algorithm spend time 21.409460067749023
46505
44436
partition_len_list
[71142, 99647]
shared_neighbor_graph_partition_s0 selection method  spend 21.49370002746582
time for parepare:  0.016762495040893555
local_output_nid generation:  0.004716634750366211
local_in_edges_tensor generation:  0.0061969757080078125
mini_batch_src_global generation:  0.01347970962524414
r_  generation:  0.12957000732421875
local_output_nid generation:  0.00626063346862793
local_in_edges_tensor generation:  0.01079416275024414
mini_batch_src_global generation:  0.01706552505493164
r_  generation:  0.14909982681274414
----------------------check_connections_block total spend ----------------------------- 0.41673755645751953
generate_one_block  0.16051340103149414
generate_one_block  0.19232511520385742
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024979591369628906
gen group dst list time:  0.005589485168457031
time for parepare:  0.021964550018310547
local_output_nid generation:  0.009052515029907227
local_in_edges_tensor generation:  0.01573634147644043
mini_batch_src_global generation:  0.01255655288696289
r_  generation:  0.15891337394714355
local_output_nid generation:  0.013794660568237305
local_in_edges_tensor generation:  0.02043914794921875
mini_batch_src_global generation:  0.023110151290893555
r_  generation:  0.24767303466796875
----------------------check_connections_block total spend ----------------------------- 0.6147842407226562
generate_one_block  0.1958916187286377
generate_one_block  0.3143630027770996
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.6147842407226562
block generation total time  0.5102546215057373
average batch blocks generation time:  0.25512731075286865
pseudo mini batch 0 input nodes size: 92589
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.0476994514465332  GigaBytes
Max Memory Allocated: 0.0476994514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.048046112060546875  GigaBytes
Max Memory Allocated: 0.048046112060546875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.048046112060546875  GigaBytes
Max Memory Allocated: 0.048046112060546875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370616912841797  GigaBytes
Max Memory Allocated: 0.05370616912841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370616912841797  GigaBytes
Max Memory Allocated: 0.05370616912841797  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370616912841797  GigaBytes
Max Memory Allocated: 0.05370616912841797  GigaBytes

torch.Size([92589, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370616912841797  GigaBytes
Max Memory Allocated: 0.05370616912841797  GigaBytes

m.shape torch.Size([8647, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.25946998596191406  GigaBytes
Max Memory Allocated: 0.2610340118408203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.25946998596191406  GigaBytes
Max Memory Allocated: 0.2610340118408203  GigaBytes

 h.shape torch.Size([1, 8647, 128]), torch.Size([1, 8647, 128])
----------------------------------------3
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.2677164077758789  GigaBytes
Max Memory Allocated: 0.2677164077758789  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33368778228759766  GigaBytes
Max Memory Allocated: 0.3378109931945801  GigaBytes

rst.shape  torch.Size([1, 8647, 128])
m.shape torch.Size([8570, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3377375602722168  GigaBytes
Max Memory Allocated: 0.33792924880981445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3377375602722168  GigaBytes
Max Memory Allocated: 0.33792924880981445  GigaBytes

 h.shape torch.Size([1, 8570, 128]), torch.Size([1, 8570, 128])
----------------------------------------3
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.345947265625  GigaBytes
Max Memory Allocated: 0.345947265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.46854209899902344  GigaBytes
Max Memory Allocated: 0.476715087890625  GigaBytes

rst.shape  torch.Size([1, 8570, 128])
m.shape torch.Size([7496, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.47517871856689453  GigaBytes
Max Memory Allocated: 0.476715087890625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6932373046875 GB
    Memory Allocated: 0.47517871856689453  GigaBytes
Max Memory Allocated: 0.476715087890625  GigaBytes

 h.shape torch.Size([1, 7496, 128]), torch.Size([1, 7496, 128])
----------------------------------------3
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4823274612426758  GigaBytes
Max Memory Allocated: 0.4823274612426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.6395998001098633  GigaBytes
Max Memory Allocated: 0.6503229141235352  GigaBytes

rst.shape  torch.Size([1, 7496, 128])
m.shape torch.Size([6261, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.6484079360961914  GigaBytes
Max Memory Allocated: 0.6503229141235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.6484079360961914  GigaBytes
Max Memory Allocated: 0.6503229141235352  GigaBytes

 h.shape torch.Size([1, 6261, 128]), torch.Size([1, 6261, 128])
----------------------------------------3
 Nvidia-smi: 1.8963623046875 GB
    Memory Allocated: 0.654594898223877  GigaBytes
Max Memory Allocated: 0.654594898223877  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.8291816711425781  GigaBytes
Max Memory Allocated: 0.8411235809326172  GigaBytes

rst.shape  torch.Size([1, 6261, 128])
m.shape torch.Size([5271, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.8387632369995117  GigaBytes
Max Memory Allocated: 0.8411235809326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.8387632369995117  GigaBytes
Max Memory Allocated: 0.8411235809326172  GigaBytes

 h.shape torch.Size([1, 5271, 128]), torch.Size([1, 5271, 128])
----------------------------------------3
 Nvidia-smi: 2.0975341796875 GB
    Memory Allocated: 0.8437900543212891  GigaBytes
Max Memory Allocated: 0.8437900543212891  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0247554779052734  GigaBytes
Max Memory Allocated: 1.0373225212097168  GigaBytes

rst.shape  torch.Size([1, 5271, 128])
m.shape torch.Size([4370, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0347447395324707  GigaBytes
Max Memory Allocated: 1.0373225212097168  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0347447395324707  GigaBytes
Max Memory Allocated: 1.0373225212097168  GigaBytes

 h.shape torch.Size([1, 4370, 128]), torch.Size([1, 4370, 128])
----------------------------------------3
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.039721965789795  GigaBytes
Max Memory Allocated: 1.039721965789795  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.225144863128662  GigaBytes
Max Memory Allocated: 1.237647533416748  GigaBytes

rst.shape  torch.Size([1, 4370, 128])
m.shape torch.Size([3746, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.2355647087097168  GigaBytes
Max Memory Allocated: 1.237647533416748  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.2355647087097168  GigaBytes
Max Memory Allocated: 1.237647533416748  GigaBytes

 h.shape torch.Size([1, 3746, 128]), torch.Size([1, 3746, 128])
----------------------------------------3
 Nvidia-smi: 2.5076904296875 GB
    Memory Allocated: 1.2394394874572754  GigaBytes
Max Memory Allocated: 1.2394394874572754  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.418726921081543  GigaBytes
Max Memory Allocated: 1.4312305450439453  GigaBytes

rst.shape  torch.Size([1, 3746, 128])
m.shape torch.Size([3264, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.429391860961914  GigaBytes
Max Memory Allocated: 1.4312305450439453  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.429391860961914  GigaBytes
Max Memory Allocated: 1.4312305450439453  GigaBytes

 h.shape torch.Size([1, 3264, 128]), torch.Size([1, 3264, 128])
----------------------------------------3
 Nvidia-smi: 2.7362060546875 GB
    Memory Allocated: 1.4326286315917969  GigaBytes
Max Memory Allocated: 1.4326286315917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6180038452148438  GigaBytes
Max Memory Allocated: 1.6304550170898438  GigaBytes

rst.shape  torch.Size([1, 3264, 128])
m.shape torch.Size([2729, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6280465126037598  GigaBytes
Max Memory Allocated: 1.6304550170898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6280465126037598  GigaBytes
Max Memory Allocated: 1.6304550170898438  GigaBytes

 h.shape torch.Size([1, 2729, 128]), torch.Size([1, 2729, 128])
----------------------------------------3
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6307015419006348  GigaBytes
Max Memory Allocated: 1.6307015419006348  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 1.8033943176269531  GigaBytes
Max Memory Allocated: 1.8151130676269531  GigaBytes

rst.shape  torch.Size([1, 2729, 128])
m.shape torch.Size([20788, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1561279296875 GB
    Memory Allocated: 1.9012737274169922  GigaBytes
Max Memory Allocated: 1.9037785530090332  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1561279296875 GB
    Memory Allocated: 1.9012737274169922  GigaBytes
Max Memory Allocated: 1.9037785530090332  GigaBytes

 h.shape torch.Size([1, 20788, 128]), torch.Size([1, 20788, 128])
----------------------------------------3
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.9210987091064453  GigaBytes
Max Memory Allocated: 1.9210987091064453  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7557373046875 GB
    Memory Allocated: 3.328672409057617  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

rst.shape  torch.Size([1, 20788, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7908935546875 GB
    Memory Allocated: 3.1549878120422363  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7908935546875 GB
    Memory Allocated: 3.2228341102600098  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2911934852600098  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2228169441223145  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

torch.Size([71142, 256])
first layer input nodes number: 92589
first layer output nodes number: 71142
edges number: 410669
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2918853759765625  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.359731674194336  GigaBytes
Max Memory Allocated: 3.428281784057617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9276123046875 GB
    Memory Allocated: 3.377206325531006  GigaBytes
Max Memory Allocated: 3.4450526237487793  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9276123046875 GB
    Memory Allocated: 3.377206325531006  GigaBytes
Max Memory Allocated: 3.4450526237487793  GigaBytes

m.shape torch.Size([6698, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.7208218574523926  GigaBytes
Max Memory Allocated: 3.7210745811462402  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.7208218574523926  GigaBytes
Max Memory Allocated: 3.7210745811462402  GigaBytes

 h.shape torch.Size([1, 6698, 256]), torch.Size([1, 6698, 256])
----------------------------------------3
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.7335972785949707  GigaBytes
Max Memory Allocated: 3.7335972785949707  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.8358006477355957  GigaBytes
Max Memory Allocated: 3.8421883583068848  GigaBytes

rst.shape  torch.Size([1, 6698, 256])
m.shape torch.Size([6020, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.8409852981567383  GigaBytes
Max Memory Allocated: 3.8421883583068848  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.8409852981567383  GigaBytes
Max Memory Allocated: 3.8421883583068848  GigaBytes

 h.shape torch.Size([1, 6020, 256]), torch.Size([1, 6020, 256])
----------------------------------------3
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.853114128112793  GigaBytes
Max Memory Allocated: 3.853114128112793  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.027712821960449  GigaBytes
Max Memory Allocated: 4.0391950607299805  GigaBytes

rst.shape  torch.Size([1, 6020, 256])
m.shape torch.Size([4995, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.036374568939209  GigaBytes
Max Memory Allocated: 4.0391950607299805  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.036374568939209  GigaBytes
Max Memory Allocated: 4.0391950607299805  GigaBytes

 h.shape torch.Size([1, 4995, 256]), torch.Size([1, 4995, 256])
----------------------------------------3
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.0465474128723145  GigaBytes
Max Memory Allocated: 4.0465474128723145  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6483154296875 GB
    Memory Allocated: 4.26100492477417  GigaBytes
Max Memory Allocated: 4.275772571563721  GigaBytes

rst.shape  torch.Size([1, 4995, 256])
m.shape torch.Size([4012, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.27198600769043  GigaBytes
Max Memory Allocated: 4.275772571563721  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.27198600769043  GigaBytes
Max Memory Allocated: 4.275772571563721  GigaBytes

 h.shape torch.Size([1, 4012, 256]), torch.Size([1, 4012, 256])
----------------------------------------3
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.279817581176758  GigaBytes
Max Memory Allocated: 4.279817581176758  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8670654296875 GB
    Memory Allocated: 4.507958889007568  GigaBytes
Max Memory Allocated: 4.523583889007568  GigaBytes

rst.shape  torch.Size([1, 4012, 256])
m.shape torch.Size([3356, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.519323348999023  GigaBytes
Max Memory Allocated: 4.523583889007568  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.519323348999023  GigaBytes
Max Memory Allocated: 4.523583889007568  GigaBytes

 h.shape torch.Size([1, 3356, 256]), torch.Size([1, 3356, 256])
----------------------------------------3
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.526009559631348  GigaBytes
Max Memory Allocated: 4.526009559631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1112060546875 GB
    Memory Allocated: 4.767416954040527  GigaBytes
Max Memory Allocated: 4.783419609069824  GigaBytes

rst.shape  torch.Size([1, 3356, 256])
m.shape torch.Size([2710, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1112060546875 GB
    Memory Allocated: 4.779844760894775  GigaBytes
Max Memory Allocated: 4.783419609069824  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1112060546875 GB
    Memory Allocated: 4.779844760894775  GigaBytes
Max Memory Allocated: 4.783419609069824  GigaBytes

 h.shape torch.Size([1, 2710, 256]), torch.Size([1, 2710, 256])
----------------------------------------3
 Nvidia-smi: 6.1112060546875 GB
    Memory Allocated: 4.785645008087158  GigaBytes
Max Memory Allocated: 4.785645008087158  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3729248046875 GB
    Memory Allocated: 5.008925437927246  GigaBytes
Max Memory Allocated: 5.024550437927246  GigaBytes

rst.shape  torch.Size([1, 2710, 256])
m.shape torch.Size([2309, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.3729248046875 GB
    Memory Allocated: 5.0220866203308105  GigaBytes
Max Memory Allocated: 5.024550437927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3729248046875 GB
    Memory Allocated: 5.0220866203308105  GigaBytes
Max Memory Allocated: 5.024550437927246  GigaBytes

 h.shape torch.Size([1, 2309, 256]), torch.Size([1, 2309, 256])
----------------------------------------3
 Nvidia-smi: 6.3729248046875 GB
    Memory Allocated: 5.027055740356445  GigaBytes
Max Memory Allocated: 5.027055740356445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 5.2480268478393555  GigaBytes
Max Memory Allocated: 5.2636518478393555  GigaBytes

rst.shape  torch.Size([1, 2309, 256])
m.shape torch.Size([1982, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 5.261568069458008  GigaBytes
Max Memory Allocated: 5.2636518478393555  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 5.261568069458008  GigaBytes
Max Memory Allocated: 5.2636518478393555  GigaBytes

 h.shape torch.Size([1, 1982, 256]), torch.Size([1, 1982, 256])
----------------------------------------3
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 5.265398025512695  GigaBytes
Max Memory Allocated: 5.265398025512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8729248046875 GB
    Memory Allocated: 5.482900142669678  GigaBytes
Max Memory Allocated: 5.498525142669678  GigaBytes

rst.shape  torch.Size([1, 1982, 256])
m.shape torch.Size([1649, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8729248046875 GB
    Memory Allocated: 5.495274066925049  GigaBytes
Max Memory Allocated: 5.498525142669678  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8729248046875 GB
    Memory Allocated: 5.495274066925049  GigaBytes
Max Memory Allocated: 5.498525142669678  GigaBytes

 h.shape torch.Size([1, 1649, 256]), torch.Size([1, 1649, 256])
----------------------------------------3
 Nvidia-smi: 6.8729248046875 GB
    Memory Allocated: 5.498518466949463  GigaBytes
Max Memory Allocated: 5.498525142669678  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.710196018218994  GigaBytes
Max Memory Allocated: 5.724349498748779  GigaBytes

rst.shape  torch.Size([1, 1649, 256])
m.shape torch.Size([1445, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.722278118133545  GigaBytes
Max Memory Allocated: 5.724349498748779  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.722278118133545  GigaBytes
Max Memory Allocated: 5.724349498748779  GigaBytes

 h.shape torch.Size([1, 1445, 256]), torch.Size([1, 1445, 256])
----------------------------------------3
 Nvidia-smi: 7.0643310546875 GB
    Memory Allocated: 5.725039958953857  GigaBytes
Max Memory Allocated: 5.725039958953857  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2752685546875 GB
    Memory Allocated: 5.922633647918701  GigaBytes
Max Memory Allocated: 5.9364142417907715  GigaBytes

rst.shape  torch.Size([1, 1445, 256])
m.shape torch.Size([1239, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2752685546875 GB
    Memory Allocated: 5.933926582336426  GigaBytes
Max Memory Allocated: 5.9364142417907715  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2752685546875 GB
    Memory Allocated: 5.933926582336426  GigaBytes
Max Memory Allocated: 5.9364142417907715  GigaBytes

 h.shape torch.Size([1, 1239, 256]), torch.Size([1, 1239, 256])
----------------------------------------3
 Nvidia-smi: 7.2752685546875 GB
    Memory Allocated: 5.936379432678223  GigaBytes
Max Memory Allocated: 5.9364142417907715  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4510498046875 GB
    Memory Allocated: 6.129225730895996  GigaBytes
Max Memory Allocated: 6.142223358154297  GigaBytes

rst.shape  torch.Size([1, 1239, 256])
m.shape torch.Size([1055, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4510498046875 GB
    Memory Allocated: 6.14002799987793  GigaBytes
Max Memory Allocated: 6.142223358154297  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4510498046875 GB
    Memory Allocated: 6.14002799987793  GigaBytes
Max Memory Allocated: 6.142223358154297  GigaBytes

 h.shape torch.Size([1, 1055, 256]), torch.Size([1, 1055, 256])
----------------------------------------3
 Nvidia-smi: 7.4510498046875 GB
    Memory Allocated: 6.14218807220459  GigaBytes
Max Memory Allocated: 6.142223358154297  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.329031944274902  GigaBytes
Max Memory Allocated: 6.3411054611206055  GigaBytes

rst.shape  torch.Size([1, 1055, 256])
m.shape torch.Size([920, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.3395209312438965  GigaBytes
Max Memory Allocated: 6.3411054611206055  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.3395209312438965  GigaBytes
Max Memory Allocated: 6.3411054611206055  GigaBytes

 h.shape torch.Size([1, 920, 256]), torch.Size([1, 920, 256])
----------------------------------------3
 Nvidia-smi: 7.5897216796875 GB
    Memory Allocated: 6.341275691986084  GigaBytes
Max Memory Allocated: 6.341275691986084  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.503304958343506  GigaBytes
Max Memory Allocated: 6.515023708343506  GigaBytes

rst.shape  torch.Size([1, 920, 256])
m.shape torch.Size([811, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.514231204986572  GigaBytes
Max Memory Allocated: 6.515023708343506  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.514231204986572  GigaBytes
Max Memory Allocated: 6.515023708343506  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.515778064727783  GigaBytes
Max Memory Allocated: 6.515778064727783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 6.6757988929748535  GigaBytes
Max Memory Allocated: 6.6875176429748535  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([714, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 6.685319423675537  GigaBytes
Max Memory Allocated: 6.6875176429748535  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9432373046875 GB
    Memory Allocated: 6.685319423675537  GigaBytes
Max Memory Allocated: 6.6875176429748535  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 7.9451904296875 GB
    Memory Allocated: 6.686681270599365  GigaBytes
Max Memory Allocated: 6.6875176429748535  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 6.8357062339782715  GigaBytes
Max Memory Allocated: 6.845920085906982  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([590, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 6.8440985679626465  GigaBytes
Max Memory Allocated: 6.845920085906982  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 6.8440985679626465  GigaBytes
Max Memory Allocated: 6.845920085906982  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 6.845223903656006  GigaBytes
Max Memory Allocated: 6.845920085906982  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2225341796875 GB
    Memory Allocated: 6.972493648529053  GigaBytes
Max Memory Allocated: 6.981496334075928  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([556, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.2225341796875 GB
    Memory Allocated: 6.981015682220459  GigaBytes
Max Memory Allocated: 6.981496334075928  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2225341796875 GB
    Memory Allocated: 6.981015682220459  GigaBytes
Max Memory Allocated: 6.981496334075928  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 8.2225341796875 GB
    Memory Allocated: 6.982076168060303  GigaBytes
Max Memory Allocated: 6.982076168060303  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3631591796875 GB
    Memory Allocated: 7.111546993255615  GigaBytes
Max Memory Allocated: 7.120561122894287  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([457, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3631591796875 GB
    Memory Allocated: 7.118923187255859  GigaBytes
Max Memory Allocated: 7.120561122894287  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3631591796875 GB
    Memory Allocated: 7.118923187255859  GigaBytes
Max Memory Allocated: 7.120561122894287  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 8.3651123046875 GB
    Memory Allocated: 7.119794845581055  GigaBytes
Max Memory Allocated: 7.120561122894287  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 7.234380722045898  GigaBytes
Max Memory Allocated: 7.242225646972656  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([395, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 7.241158485412598  GigaBytes
Max Memory Allocated: 7.242225646972656  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 7.241158485412598  GigaBytes
Max Memory Allocated: 7.242225646972656  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 8.4803466796875 GB
    Memory Allocated: 7.241911888122559  GigaBytes
Max Memory Allocated: 7.242225646972656  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5682373046875 GB
    Memory Allocated: 7.343633651733398  GigaBytes
Max Memory Allocated: 7.350790977478027  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([408, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5682373046875 GB
    Memory Allocated: 7.351099967956543  GigaBytes
Max Memory Allocated: 7.351130485534668  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5682373046875 GB
    Memory Allocated: 7.351099967956543  GigaBytes
Max Memory Allocated: 7.351130485534668  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 8.5701904296875 GB
    Memory Allocated: 7.3518781661987305  GigaBytes
Max Memory Allocated: 7.3518781661987305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7030029296875 GB
    Memory Allocated: 7.465022087097168  GigaBytes
Max Memory Allocated: 7.472804069519043  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([346, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.7030029296875 GB
    Memory Allocated: 7.471767425537109  GigaBytes
Max Memory Allocated: 7.472804069519043  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7030029296875 GB
    Memory Allocated: 7.471767425537109  GigaBytes
Max Memory Allocated: 7.472804069519043  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 8.7030029296875 GB
    Memory Allocated: 7.4724273681640625  GigaBytes
Max Memory Allocated: 7.472804069519043  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.570672988891602  GigaBytes
Max Memory Allocated: 7.577602386474609  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([279, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.576242446899414  GigaBytes
Max Memory Allocated: 7.577602386474609  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.576242446899414  GigaBytes
Max Memory Allocated: 7.577602386474609  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.576774597167969  GigaBytes
Max Memory Allocated: 7.577602386474609  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8826904296875 GB
    Memory Allocated: 7.660518646240234  GigaBytes
Max Memory Allocated: 7.666372299194336  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([251, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8826904296875 GB
    Memory Allocated: 7.665801525115967  GigaBytes
Max Memory Allocated: 7.666372299194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8826904296875 GB
    Memory Allocated: 7.665801525115967  GigaBytes
Max Memory Allocated: 7.666372299194336  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 8.8826904296875 GB
    Memory Allocated: 7.666280269622803  GigaBytes
Max Memory Allocated: 7.666372299194336  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9608154296875 GB
    Memory Allocated: 7.743836879730225  GigaBytes
Max Memory Allocated: 7.749342441558838  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([240, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.9608154296875 GB
    Memory Allocated: 7.749133586883545  GigaBytes
Max Memory Allocated: 7.749342441558838  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9608154296875 GB
    Memory Allocated: 7.749133586883545  GigaBytes
Max Memory Allocated: 7.749342441558838  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.9608154296875 GB
    Memory Allocated: 7.74959135055542  GigaBytes
Max Memory Allocated: 7.74959135055542  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0428466796875 GB
    Memory Allocated: 7.826953411102295  GigaBytes
Max Memory Allocated: 7.833357334136963  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([3068, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.1190185546875 GB
    Memory Allocated: 7.900443077087402  GigaBytes
Max Memory Allocated: 7.900729179382324  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1190185546875 GB
    Memory Allocated: 7.900443077087402  GigaBytes
Max Memory Allocated: 7.900729179382324  GigaBytes

 h.shape torch.Size([1, 3068, 256]), torch.Size([1, 3068, 256])
----------------------------------------3
 Nvidia-smi: 9.1190185546875 GB
    Memory Allocated: 7.90684700012207  GigaBytes
Max Memory Allocated: 7.90684700012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2791748046875 GB
    Memory Allocated: 8.937532424926758  GigaBytes
Max Memory Allocated: 9.010679244995117  GigaBytes

rst.shape  torch.Size([1, 3068, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.643858432769775  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.650788307189941  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.657718181610107  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.650441646575928  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

torch.Size([46505, 40])
input nodes number: 71142
output nodes number: 46505
edges number: 348854
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.65824842453003  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 8.658249378204346  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.07483673095703125  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

pseudo mini batch 1 input nodes size: 122900
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.057752132415771484  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.057752132415771484  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.11635541915893555  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.11668682098388672  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.07141828536987305  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.0801992416381836  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.0801992416381836  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.0801992416381836  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

torch.Size([122900, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0447998046875 GB
    Memory Allocated: 0.0801992416381836  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

m.shape torch.Size([8923, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.41887378692626953  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.41887378692626953  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 8923, 128]), torch.Size([1, 8923, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.4273834228515625  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.49713706970214844  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 8923, 128])
m.shape torch.Size([8873, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5013442039489746  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5013442039489746  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 8873, 128]), torch.Size([1, 8873, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.5098061561584473  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6406607627868652  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 8873, 128])
m.shape torch.Size([7482, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6471328735351562  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6471328735351562  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 7482, 128]), torch.Size([1, 7482, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.6546206474304199  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8119516372680664  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 7482, 128])
m.shape torch.Size([6395, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8205814361572266  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8205814361572266  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 6395, 128]), torch.Size([1, 6395, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 0.8270235061645508  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0050277709960938  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 6395, 128])
m.shape torch.Size([5643, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0156502723693848  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.0156502723693848  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 5643, 128]), torch.Size([1, 5643, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.021390438079834  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.232327938079834  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 5643, 128])
m.shape torch.Size([4787, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.2423772811889648  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.2423772811889648  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 4787, 128]), torch.Size([1, 4787, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.247518539428711  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.4481029510498047  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 4787, 128])
m.shape torch.Size([4342, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.460007667541504  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.460007667541504  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 4342, 128]), torch.Size([1, 4342, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.465184211730957  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.6745266914367676  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 4342, 128])
m.shape torch.Size([3849, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.6880812644958496  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.6880812644958496  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 3849, 128]), torch.Size([1, 3849, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.6918458938598633  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.9046087265014648  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 3849, 128])
m.shape torch.Size([3489, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.918398380279541  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.918398380279541  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 3489, 128]), torch.Size([1, 3489, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 1.9220447540283203  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.1378955841064453  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 3489, 128])
m.shape torch.Size([45864, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.354928493499756  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.354928493499756  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 45864, 128]), torch.Size([1, 45864, 128])
----------------------------------------3
 Nvidia-smi: 11.0487060546875 GB
    Memory Allocated: 2.398667812347412  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.513661861419678  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 45864, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.210819721221924  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.305850505828857  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.400881290435791  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.305108070373535  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

torch.Size([99647, 256])
first layer input nodes number: 122900
first layer output nodes number: 99647
edges number: 682859
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.401799201965332  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.496829986572266  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.520587921142578  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.2010498046875 GB
    Memory Allocated: 5.520587921142578  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

m.shape torch.Size([6730, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 5.908758163452148  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 5.908758163452148  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 6730, 256]), torch.Size([1, 6730, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 5.921594619750977  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.025571823120117  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 6730, 256])
m.shape torch.Size([5686, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.030083656311035  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.030083656311035  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 5686, 256]), torch.Size([1, 5686, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.041508674621582  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.204703330993652  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 5686, 256])
m.shape torch.Size([4282, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.21162748336792  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.21162748336792  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 4282, 256]), torch.Size([1, 4282, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.220113277435303  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.4021430015563965  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 4282, 256])
m.shape torch.Size([3308, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.410483360290527  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.410483360290527  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 3308, 256]), torch.Size([1, 3308, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.417075157165527  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.600050926208496  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 3308, 256])
m.shape torch.Size([2866, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.610669136047363  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.610669136047363  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 2866, 256]), torch.Size([1, 2866, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.6162919998168945  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.815324306488037  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 2866, 256])
m.shape torch.Size([2158, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.824763298034668  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.824763298034668  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 2158, 256]), torch.Size([1, 2158, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 6.829893589019775  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.016794204711914  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 2158, 256])
m.shape torch.Size([1736, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.026415824890137  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.026415824890137  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 1736, 256]), torch.Size([1, 1736, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.02993106842041  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.198306083679199  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 1736, 256])
m.shape torch.Size([1490, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.2081074714660645  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.2081074714660645  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 1490, 256]), torch.Size([1, 1490, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.210972309112549  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.378223419189453  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 1490, 256])
m.shape torch.Size([1327, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.388129234313965  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.388129234313965  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 1327, 256]), torch.Size([1, 1327, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.390725612640381  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.554606914520264  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 1327, 256])
m.shape torch.Size([1154, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.564332008361816  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.564332008361816  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 1154, 256]), torch.Size([1, 1154, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.566686630249023  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.7314043045043945  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 1154, 256])
m.shape torch.Size([964, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.739994525909424  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.739994525909424  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 964, 256]), torch.Size([1, 964, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.741833209991455  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.890369892120361  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 964, 256])
m.shape torch.Size([882, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.899623394012451  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.899623394012451  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 7.901305675506592  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.044299602508545  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([736, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.052967548370361  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.052967548370361  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 736, 256]), torch.Size([1, 736, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.054371356964111  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.18408727645874  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 736, 256])
m.shape torch.Size([623, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.191768646240234  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.191768646240234  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 623, 256]), torch.Size([1, 623, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.192956924438477  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.316429138183594  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 623, 256])
m.shape torch.Size([575, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.324124813079834  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.324124813079834  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.325221538543701  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.441474437713623  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([521, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.449552536010742  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.449552536010742  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.450546264648438  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.562837600708008  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([474, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.570085525512695  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.570085525512695  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.570989608764648  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.681617736816406  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([491, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.689914226531982  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.689914226531982  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.690850734710693  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.813792705535889  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([441, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.821377754211426  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.821377754211426  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.822218894958496  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.9357328414917  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([399, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.942982196807861  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.942982196807861  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 8.943743228912354  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.051951885223389  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([371, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.059059619903564  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.059059619903564  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.059767246246338  GigaBytes
Max Memory Allocated: 9.06899118423462  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.165698528289795  GigaBytes
Max Memory Allocated: 9.173128604888916  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([277, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.171202182769775  GigaBytes
Max Memory Allocated: 9.173128604888916  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.171202182769775  GigaBytes
Max Memory Allocated: 9.173128604888916  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.171730518341064  GigaBytes
Max Memory Allocated: 9.173128604888916  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.257338047027588  GigaBytes
Max Memory Allocated: 9.263149738311768  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([268, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.262998580932617  GigaBytes
Max Memory Allocated: 9.263149738311768  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.262998580932617  GigaBytes
Max Memory Allocated: 9.263149738311768  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.263509750366211  GigaBytes
Max Memory Allocated: 9.263509750366211  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.3478422164917  GigaBytes
Max Memory Allocated: 9.353720664978027  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([285, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.354160785675049  GigaBytes
Max Memory Allocated: 9.354186534881592  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.354160785675049  GigaBytes
Max Memory Allocated: 9.354186534881592  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.3547043800354  GigaBytes
Max Memory Allocated: 9.3547043800354  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5799560546875 GB
    Memory Allocated: 9.446571826934814  GigaBytes
Max Memory Allocated: 9.453094959259033  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([6392, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7342529296875 GB
    Memory Allocated: 9.59988784790039  GigaBytes
Max Memory Allocated: 9.600483417510986  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7342529296875 GB
    Memory Allocated: 9.59988784790039  GigaBytes
Max Memory Allocated: 9.600483417510986  GigaBytes

 h.shape torch.Size([1, 6392, 256]), torch.Size([1, 6392, 256])
----------------------------------------3
 Nvidia-smi: 13.7342529296875 GB
    Memory Allocated: 9.612079620361328  GigaBytes
Max Memory Allocated: 9.612079620361328  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.757831573486328  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6392, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.413918018341064  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.421257495880127  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.427879333496094  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.42020845413208  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes
[17:37:50] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27802158 edges into 2 parts and get 194026 edge cuts

torch.Size([44436, 40])
input nodes number: 99647
output nodes number: 44436
edges number: 395396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.42169189453125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 11.421692371368408  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.09523534774780273  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.10078573226928711  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.10078573226928711  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054820895195007324 |0.1751396656036377 |0.43717241287231445 |0.00018215179443359375 |0.16448140144348145 |0.005948781967163086 |
----------------------------------------------------------pseudo_mini_loss sum 5.3186140060424805
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  386278
Number of first layer input nodes during this epoch:  215489
Number of first layer output nodes during this epoch:  170789
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.1007852554321289  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02940082550048828
global_2_local spend time (sec) 0.0440981388092041
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0043239593505859375
A = g.adjacency_matrix() spent  0.008951663970947266
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08050727844238281
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.306128740310669
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1818718910217285

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18720996, 2.0: 3229533, 3.0: 807748, 4.0: 243722, 5.0: 89337, 6.0: 38108, 7.0: 18016, 8.0: 9112, 9.0: 4890, 10.0: 2746, 11.0: 1644, 12.0: 893, 13.0: 552, 14.0: 337, 15.0: 196, 16.0: 180, 17.0: 140, 18.0: 67, 19.0: 54, 20.0: 11, 21.0: 10})
Convert a graph into a bidirected graph: 1.201 seconds
Metis partitioning: 4.707 seconds
Split the graph: 3.337 seconds
Construct subgraphs: 0.051 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.31031084060669
46503
44438
total k batches seeds list generation spend  21.854397535324097
after graph partition
graph partition algorithm spend time 21.975305318832397
46503
44438
partition_len_list
[70431, 100178]
shared_neighbor_graph_partition_s0 selection method  spend 22.069856643676758
time for parepare:  0.017310619354248047
local_output_nid generation:  0.004588603973388672
local_in_edges_tensor generation:  0.006242275238037109
mini_batch_src_global generation:  0.011528491973876953
r_  generation:  0.12387728691101074
local_output_nid generation:  0.005820751190185547
local_in_edges_tensor generation:  0.009464502334594727
mini_batch_src_global generation:  0.015013933181762695
r_  generation:  0.14313411712646484
----------------------check_connections_block total spend ----------------------------- 0.39987611770629883
generate_one_block  0.17099332809448242
generate_one_block  0.18755578994750977
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04187345504760742
gen group dst list time:  0.0045528411865234375
time for parepare:  0.01959824562072754
local_output_nid generation:  0.00832819938659668
local_in_edges_tensor generation:  0.028229713439941406
mini_batch_src_global generation:  0.012384891510009766
r_  generation:  0.15106630325317383
local_output_nid generation:  0.013524055480957031
local_in_edges_tensor generation:  0.018591880798339844
mini_batch_src_global generation:  0.025426864624023438
r_  generation:  0.24800562858581543
----------------------check_connections_block total spend ----------------------------- 0.6177830696105957
generate_one_block  0.1860640048980713
generate_one_block  0.3161303997039795
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.1007852554321289  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

connection checking time:  0.6177830696105957
block generation total time  0.5021944046020508
average batch blocks generation time:  0.2510972023010254
block dataloader generation time/epoch 24.127921104431152
pseudo mini batch 0 input nodes size: 90771
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.0773773193359375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.0773773193359375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.12066030502319336  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.12100696563720703  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.0620722770690918  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.06781435012817383  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.06781435012817383  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.06781435012817383  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

torch.Size([90771, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.06781435012817383  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

m.shape torch.Size([8600, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.27181243896484375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.27181243896484375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 8600, 128]), torch.Size([1, 8600, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.2800140380859375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.3456268310546875  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 8600, 128])
m.shape torch.Size([8544, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.3496742248535156  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.3496742248535156  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 8544, 128]), torch.Size([1, 8544, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.3578224182128906  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.4800453186035156  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 8544, 128])
m.shape torch.Size([7414, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.48657703399658203  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.48657703399658203  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 7414, 128]), torch.Size([1, 7414, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.49369144439697266  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.6504621505737305  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 7414, 128])
m.shape torch.Size([6194, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.65911865234375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.65911865234375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 6194, 128]), torch.Size([1, 6194, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.6661505699157715  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.8386006355285645  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6194, 128])
m.shape torch.Size([5241, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.8481426239013672  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.8481426239013672  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 5241, 128]), torch.Size([1, 5241, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 0.8534998893737793  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.0342488288879395  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 5241, 128])
m.shape torch.Size([4358, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.0442180633544922  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.0442180633544922  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4358, 128]), torch.Size([1, 4358, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.048795223236084  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.2275080680847168  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4358, 128])
m.shape torch.Size([3677, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.2377033233642578  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.2377033233642578  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3677, 128]), torch.Size([1, 3677, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.2414188385009766  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.4177961349487305  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3677, 128])
m.shape torch.Size([3244, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.428417682647705  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.428417682647705  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3244, 128]), torch.Size([1, 3244, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.4317240715026855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.6110587120056152  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3244, 128])
m.shape torch.Size([2717, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.6210551261901855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.6210551261901855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 2717, 128]), torch.Size([1, 2717, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.623680591583252  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.7994213104248047  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 2717, 128])
m.shape torch.Size([20442, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.8954124450683594  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.8954124450683594  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 20442, 128]), torch.Size([1, 20442, 128])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 1.914907455444336  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.299053192138672  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 20442, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.127790927886963  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.1949591636657715  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.26212739944458  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.19443416595459  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

torch.Size([70431, 256])
first layer input nodes number: 90771
first layer output nodes number: 70431
edges number: 405623
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.262805938720703  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.3299741744995117  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.3475522994995117  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.3475522994995117  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

m.shape torch.Size([6676, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.6905646324157715  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.6905646324157715  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 6676, 256]), torch.Size([1, 6676, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.7046656608581543  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.8065333366394043  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6676, 256])
m.shape torch.Size([6061, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.8118176460266113  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.8118176460266113  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 6061, 256]), torch.Size([1, 6061, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.8235726356506348  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 3.9996352195739746  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6061, 256])
m.shape torch.Size([4988, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.0081400871276855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.0081400871276855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4988, 256]), torch.Size([1, 4988, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.0178680419921875  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.23162841796875  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4988, 256])
m.shape torch.Size([4007, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.242616176605225  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.242616176605225  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4007, 256]), torch.Size([1, 4007, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.250464916229248  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.475255966186523  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4007, 256])
m.shape torch.Size([3389, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.487441539764404  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.487441539764404  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3389, 256]), torch.Size([1, 3389, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.494348049163818  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.728060245513916  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3389, 256])
m.shape torch.Size([2719, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.740368843078613  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.740368843078613  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 2719, 256]), torch.Size([1, 2719, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.746213912963867  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.9697113037109375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 2719, 256])
m.shape torch.Size([2292, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.98253870010376  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.98253870010376  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 2292, 256]), torch.Size([1, 2292, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 4.987086772918701  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.214847087860107  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 2292, 256])
m.shape torch.Size([1990, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.227962493896484  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.227962493896484  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1990, 256]), torch.Size([1, 1990, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.231904983520508  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.450284004211426  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1990, 256])
m.shape torch.Size([1669, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.462695598602295  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.462695598602295  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1669, 256]), torch.Size([1, 1669, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.466140270233154  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.683541774749756  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1669, 256])
m.shape torch.Size([1461, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.695558547973633  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.695558547973633  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1461, 256]), torch.Size([1, 1461, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.698505401611328  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.9082512855529785  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1461, 256])
m.shape torch.Size([1246, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.919312477111816  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.919312477111816  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 5.9217071533203125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.117488384246826  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([1040, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.127860069274902  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.127860069274902  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1040, 256]), torch.Size([1, 1040, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.129887580871582  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.309864521026611  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1040, 256])
m.shape torch.Size([912, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.3196120262146  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.3196120262146  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.321351528167725  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.482747554779053  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([799, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.492629051208496  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.492629051208496  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.494153022766113  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.645026206970215  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([717, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.654601573944092  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.654601573944092  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.655969142913818  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.802857875823975  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([576, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.811031818389893  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.811031818389893  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.812130451202393  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.937811374664307  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([554, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.946314334869385  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.946314334869385  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 6.947371006011963  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.076353549957275  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([457, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.083731651306152  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.083731651306152  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.084603309631348  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.1978960037231445  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([402, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.204801559448242  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.204801559448242  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.205568313598633  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.309001922607422  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([410, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.316500186920166  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.316500186920166  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.317282199859619  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.431482791900635  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([347, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.438095569610596  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.438095569610596  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.438757419586182  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.537539958953857  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([274, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.543003082275391  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.543003082275391  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.543525695800781  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.627974510192871  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([252, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.633284091949463  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.633284091949463  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.633764743804932  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.711630344390869  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([242, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.716972351074219  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.716972351074219  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 7.717433929443359  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 7.795440673828125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([3023, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 7.867846965789795  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 7.867846965789795  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3023, 256]), torch.Size([1, 3023, 256])
----------------------------------------3
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 7.873612880706787  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.888413906097412  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3023, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.595002174377441  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.601932048797607  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.608861923217773  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.601585388183594  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

torch.Size([46503, 40])
input nodes number: 70431
output nodes number: 46503
edges number: 347819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.602047443389893  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.9217529296875 GB
    Memory Allocated: 8.602048397064209  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.07996320724487305  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

pseudo mini batch 1 input nodes size: 123258
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.06166362762451172  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.06166362762451172  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.1204376220703125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.12076902389526367  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.07713937759399414  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.08521127700805664  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.08521127700805664  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.08521127700805664  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

torch.Size([123258, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.08521127700805664  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

m.shape torch.Size([8997, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.4266972541809082  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.4266972541809082  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 8997, 128]), torch.Size([1, 8997, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.43527746200561523  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.5051722526550293  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 8997, 128])
m.shape torch.Size([8874, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.5093450546264648  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.5093450546264648  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 8874, 128]), torch.Size([1, 8874, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.5178666114807129  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.6487240791320801  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 8874, 128])
m.shape torch.Size([7515, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.6562113761901855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.6562113761901855  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 7515, 128]), torch.Size([1, 7515, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.6640262603759766  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.8246026039123535  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 7515, 128])
m.shape torch.Size([6439, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.8333005905151367  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.8333005905151367  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 6439, 128]), torch.Size([1, 6439, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 0.8395776748657227  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.0190401077270508  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6439, 128])
m.shape torch.Size([5664, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.0296416282653809  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.0296416282653809  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 5664, 128]), torch.Size([1, 5664, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.035219669342041  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.2457876205444336  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 5664, 128])
m.shape torch.Size([4779, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.2558441162109375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.2558441162109375  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4779, 128]), torch.Size([1, 4779, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.260401725769043  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.4609251022338867  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4779, 128])
m.shape torch.Size([4370, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.4729080200195312  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.4729080200195312  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4370, 128]), torch.Size([1, 4370, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.4776949882507324  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.6881518363952637  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4370, 128])
m.shape torch.Size([3841, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.701693058013916  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.701693058013916  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3841, 128]), torch.Size([1, 3841, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.7054767608642578  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.917189598083496  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3841, 128])
m.shape torch.Size([3508, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.930253505706787  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.930253505706787  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3508, 128]), torch.Size([1, 3508, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 1.935375690460205  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 2.1518545150756836  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3508, 128])
m.shape torch.Size([46191, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 2.3704376220703125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 2.3704376220703125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 46191, 128]), torch.Size([1, 46191, 128])
----------------------------------------3
 Nvidia-smi: 15.9237060546875 GB
    Memory Allocated: 2.4144887924194336  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.542121887207031  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 46191, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.237187385559082  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.332724571228027  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.428261756896973  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.331977844238281  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

torch.Size([100178, 256])
first layer input nodes number: 123258
first layer output nodes number: 100178
edges number: 686840
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.429182052612305  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.52471923828125  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.548603534698486  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.6834716796875 GB
    Memory Allocated: 5.548603534698486  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

m.shape torch.Size([6752, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 5.938694477081299  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 5.938694477081299  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 6752, 256]), torch.Size([1, 6752, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 5.951572895050049  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.057613849639893  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 6752, 256])
m.shape torch.Size([5645, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.062026023864746  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.062026023864746  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 5645, 256]), torch.Size([1, 5645, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.072793006896973  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.234297752380371  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 5645, 256])
m.shape torch.Size([4289, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.241281509399414  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.241281509399414  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 4289, 256]), torch.Size([1, 4289, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.249803066253662  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.43219518661499  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 4289, 256])
m.shape torch.Size([3313, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.440539836883545  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.440539836883545  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 3313, 256]), torch.Size([1, 3313, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.446879863739014  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.631396293640137  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 3313, 256])
m.shape torch.Size([2833, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.641645908355713  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.641645908355713  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 2833, 256]), torch.Size([1, 2833, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.647379398345947  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.846545696258545  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 2833, 256])
m.shape torch.Size([2149, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.855573654174805  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.855573654174805  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 2149, 256]), torch.Size([1, 2149, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 6.860241889953613  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.045042037963867  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 2149, 256])
m.shape torch.Size([1753, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.054786682128906  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.054786682128906  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1753, 256]), torch.Size([1, 1753, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.058269500732422  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.229509353637695  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1753, 256])
m.shape torch.Size([1482, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.239233016967773  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.239233016967773  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1482, 256]), torch.Size([1, 1482, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.242337226867676  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.408720970153809  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1482, 256])
m.shape torch.Size([1307, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.418613433837891  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.418613433837891  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1307, 256]), torch.Size([1, 1307, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.421195983886719  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.582759857177734  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1307, 256])
m.shape torch.Size([1138, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.592381954193115  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.592381954193115  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 1138, 256]), torch.Size([1, 1138, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.59460973739624  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.756576061248779  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 1138, 256])
m.shape torch.Size([957, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.765303611755371  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.765303611755371  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 957, 256]), torch.Size([1, 957, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.767128944396973  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.909546852111816  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 957, 256])
m.shape torch.Size([897, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.918980121612549  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.918980121612549  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 897, 256]), torch.Size([1, 897, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 7.920691013336182  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.06611680984497  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 897, 256])
m.shape torch.Size([744, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.074557781219482  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.074557781219482  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.075976848602295  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.207020282745361  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([635, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.214855194091797  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.214855194091797  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 635, 256]), torch.Size([1, 635, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.216066360473633  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.337215423583984  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 635, 256])
m.shape torch.Size([572, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.34485673904419  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.34485673904419  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.345947742462158  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.462677478790283  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([535, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.47081708908081  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.47081708908081  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.471837520599365  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.58778715133667  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([476, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.595054626464844  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.595054626464844  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.595962524414062  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.70492935180664  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([491, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.71297025680542  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.71297025680542  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.71390676498413  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.836047649383545  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([434, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.843504905700684  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.843504905700684  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.844332695007324  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.955554008483887  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([397, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.962771892547607  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.962771892547607  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 8.963529109954834  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.07029676437378  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([370, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.077386379241943  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.077386379241943  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.078092098236084  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.182738304138184  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([282, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.188348293304443  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.188348293304443  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.188886165618896  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.282300472259521  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([267, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.287933826446533  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.287933826446533  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.288443088531494  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.372101783752441  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([283, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.37837553024292  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.37837553024292  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.378915309906006  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 9.470901012420654  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([6437, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.2166748046875 GB
    Memory Allocated: 9.626127243041992  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2166748046875 GB
    Memory Allocated: 9.626127243041992  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes
[17:38:14] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27803442 edges into 2 parts and get 192130 edge cuts

 h.shape torch.Size([1, 6437, 256]), torch.Size([1, 6437, 256])
----------------------------------------3
 Nvidia-smi: 17.2166748046875 GB
    Memory Allocated: 9.638404846191406  GigaBytes
Max Memory Allocated: 11.910228729248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.822090148925781  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6437, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.476519584655762  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.483141422271729  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.489763259887695  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.482810020446777  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([44438, 40])
input nodes number: 100178
output nodes number: 44438
edges number: 396431
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.483580112457275  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3709716796875 GB
    Memory Allocated: 11.483580589294434  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.09980058670043945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.09980058670043945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.09980058670043945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06166684627532959 |0.005533814430236816 |0.16689419746398926 |0.00011432170867919922 |0.15720009803771973 |0.004712343215942383 |
----------------------------------------------------------pseudo_mini_loss sum 4.2895002365112305
Total (block generation + training)time/epoch 24.95718550682068
Training time/epoch 0.8286843299865723
Training time without block to device /epoch 0.8176167011260986
Training time without total dataloading part /epoch 0.6531295776367188
load block tensor time/epoch 0.12333369255065918
block to device time/epoch 0.011067628860473633
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  384638
Number of first layer input nodes during this epoch:  214029
Number of first layer output nodes during this epoch:  170609
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.09980010986328125  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01706242561340332
global_2_local spend time (sec) 0.03901362419128418
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004712104797363281
A = g.adjacency_matrix() spent  0.009508848190307617
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08028864860534668
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.2943971157073975
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.179642677307129

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18726793, 2.0: 3227048, 3.0: 807585, 4.0: 243406, 5.0: 88339, 6.0: 38420, 7.0: 17657, 8.0: 9197, 9.0: 4921, 10.0: 2773, 11.0: 1643, 12.0: 917, 13.0: 542, 14.0: 332, 15.0: 191, 16.0: 175, 17.0: 133, 18.0: 67, 19.0: 35, 20.0: 12, 21.0: 6})
Convert a graph into a bidirected graph: 1.106 seconds
Metis partitioning: 4.655 seconds
Split the graph: 3.282 seconds
Construct subgraphs: 0.044 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.099517345428467
46496
44445
total k batches seeds list generation spend  21.010639429092407
after graph partition
graph partition algorithm spend time 21.121137619018555
46496
44445
partition_len_list
[71597, 100791]
shared_neighbor_graph_partition_s0 selection method  spend 21.211296558380127
time for parepare:  0.017512083053588867
local_output_nid generation:  0.004874229431152344
local_in_edges_tensor generation:  0.0060749053955078125
mini_batch_src_global generation:  0.011183500289916992
r_  generation:  0.12285017967224121
local_output_nid generation:  0.0059850215911865234
local_in_edges_tensor generation:  0.007188320159912109
mini_batch_src_global generation:  0.0171506404876709
r_  generation:  0.14838147163391113
----------------------check_connections_block total spend ----------------------------- 0.41051220893859863
generate_one_block  0.1802973747253418
generate_one_block  0.18593811988830566
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06285953521728516
gen group dst list time:  0.00473332405090332
time for parepare:  0.02060985565185547
local_output_nid generation:  0.00917673110961914
local_in_edges_tensor generation:  0.034000396728515625
mini_batch_src_global generation:  0.013885736465454102
r_  generation:  0.15973877906799316
local_output_nid generation:  0.014241456985473633
local_in_edges_tensor generation:  0.023859262466430664
mini_batch_src_global generation:  0.036414146423339844
r_  generation:  0.25157928466796875
----------------------check_connections_block total spend ----------------------------- 0.6582884788513184
generate_one_block  0.1899261474609375
generate_one_block  0.3183302879333496
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.09980010986328125  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

connection checking time:  0.6582884788513184
block generation total time  0.5082564353942871
average batch blocks generation time:  0.25412821769714355
block dataloader generation time/epoch 23.72898530960083
pseudo mini batch 0 input nodes size: 92445
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.07683038711547852  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.07683038711547852  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.12175226211547852  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.12209892272949219  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.06299352645874023  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.06880521774291992  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.06880521774291992  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.06880521774291992  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([92445, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.06880521774291992  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

m.shape torch.Size([8626, 1, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.27593374252319336  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.27593374252319336  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 8626, 128]), torch.Size([1, 8626, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.28416013717651367  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.34997129440307617  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 8626, 128])
m.shape torch.Size([8764, 2, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.3542160987854004  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.3542160987854004  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 8764, 128]), torch.Size([1, 8764, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.36257410049438477  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.4931168556213379  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 8764, 128])
m.shape torch.Size([7564, 3, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5006566047668457  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5006566047668457  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 7564, 128]), torch.Size([1, 7564, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5081963539123535  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.6690182685852051  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 7564, 128])
m.shape torch.Size([6329, 4, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.677483081817627  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.677483081817627  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6329, 128]), torch.Size([1, 6329, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.6842045783996582  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8615322113037109  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6329, 128])
m.shape torch.Size([5325, 5, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8721861839294434  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8721861839294434  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 5325, 128]), torch.Size([1, 5325, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8778691291809082  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.061293125152588  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 5325, 128])
m.shape torch.Size([4417, 6, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0713911056518555  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0713911056518555  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 4417, 128]), torch.Size([1, 4417, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0760364532470703  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2571687698364258  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 4417, 128])
m.shape torch.Size([3750, 7, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2675795555114746  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2675795555114746  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3750, 128]), torch.Size([1, 3750, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2713046073913574  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4510765075683594  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3750, 128])
m.shape torch.Size([3267, 8, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4617509841918945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4617509841918945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3267, 128]), torch.Size([1, 3267, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4648752212524414  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.6426591873168945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3267, 128])
m.shape torch.Size([2756, 9, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.6528863906860352  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.6528863906860352  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 2756, 128]), torch.Size([1, 2756, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.655898094177246  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.8355302810668945  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 2756, 128])
m.shape torch.Size([20799, 10, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9332952499389648  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9332952499389648  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 20799, 128]), torch.Size([1, 20799, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9531307220458984  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.3614492416381836  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 20799, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.185499668121338  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.253859043121338  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.322139263153076  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.253246307373047  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([71597, 256])
first layer input nodes number: 92445
first layer output nodes number: 71597
edges number: 412469
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.3228302001953125  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.391110420227051  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.408688545227051  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.408688545227051  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

m.shape torch.Size([6681, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.7517733573913574  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.7517733573913574  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6681, 256]), torch.Size([1, 6681, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.7645163536071777  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.8664603233337402  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6681, 256])
m.shape torch.Size([6066, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.8717494010925293  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.8717494010925293  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6066, 256]), torch.Size([1, 6066, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 3.884059429168701  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.059096813201904  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6066, 256])
m.shape torch.Size([5017, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.06777811050415  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.06777811050415  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 5017, 256]), torch.Size([1, 5017, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.0787200927734375  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.3000640869140625  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 5017, 256])
m.shape torch.Size([4012, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.310101509094238  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.310101509094238  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 4012, 256]), torch.Size([1, 4012, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.318211555480957  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.544292449951172  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 4012, 256])
m.shape torch.Size([3355, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.556189060211182  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.556189060211182  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3355, 256]), torch.Size([1, 3355, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.562951564788818  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.797316074371338  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3355, 256])
m.shape torch.Size([2707, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.809393405914307  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.809393405914307  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 2707, 256]), torch.Size([1, 2707, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 4.815053462982178  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.037807464599609  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 2707, 256])
m.shape torch.Size([2301, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.05070686340332  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.05070686340332  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 2301, 256]), torch.Size([1, 2301, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.055231094360352  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.283761024475098  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 2301, 256])
m.shape torch.Size([1962, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.29704475402832  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.29704475402832  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1962, 256]), torch.Size([1, 1962, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.300958633422852  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.517145156860352  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1962, 256])
m.shape torch.Size([1652, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.528744220733643  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.528744220733643  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1652, 256]), torch.Size([1, 1652, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.531986236572266  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.743846416473389  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1652, 256])
m.shape torch.Size([1474, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.756438255310059  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.756438255310059  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1474, 256]), torch.Size([1, 1474, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.759261131286621  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.960011005401611  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1474, 256])
m.shape torch.Size([1226, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.971567153930664  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.971567153930664  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1226, 256]), torch.Size([1, 1226, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.973942756652832  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.164361953735352  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1226, 256])
m.shape torch.Size([1058, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.175307750701904  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.175307750701904  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.177350997924805  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.354024887084961  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
m.shape torch.Size([898, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.363900661468506  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.363900661468506  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.3656134605407715  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.52412748336792  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([796, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.533982276916504  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.533982276916504  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.535500526428223  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.68911075592041  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([712, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.6986165046691895  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.6986165046691895  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.699974536895752  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.846634387969971  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([577, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.854828834533691  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.854828834533691  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.855929374694824  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.981705665588379  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([557, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.990256309509277  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.990256309509277  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.991318702697754  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.120846748352051  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([465, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.128360271453857  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.128360271453857  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.129247188568115  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.2437825202941895  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([398, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.250607490539551  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.250607490539551  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.25136661529541  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.3537702560424805  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([397, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.361022472381592  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.361022472381592  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.361779689788818  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.468547344207764  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([343, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.475091934204102  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.475091934204102  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.475746154785156  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.573935508728027  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([279, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.579507827758789  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.579507827758789  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.580039978027344  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.664644241333008  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([252, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.669949054718018  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.669949054718018  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.670429706573486  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.748295307159424  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([241, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.75361442565918  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.75361442565918  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.7540740966796875  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.831758499145508  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([3070, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.905295372009277  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.905295372009277  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3070, 256]), torch.Size([1, 3070, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.911150932312012  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.941729545593262  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3070, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.648380756378174  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.656200885772705  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.664021015167236  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.655854225158691  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([46496, 40])
input nodes number: 71597
output nodes number: 46496
edges number: 348264
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.657932758331299  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.657933712005615  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0812673568725586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

pseudo mini batch 1 input nodes size: 124941
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0641927719116211  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0641927719116211  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.12376928329467773  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.1241006851196289  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.07883214950561523  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0876150131225586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0876150131225586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0876150131225586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([124941, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.0876150131225586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

m.shape torch.Size([8993, 1, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.4331073760986328  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.4331073760986328  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 8993, 128]), torch.Size([1, 8993, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.4416837692260742  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.511570930480957  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 8993, 128])
m.shape torch.Size([8788, 2, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5156636238098145  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5156636238098145  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 8788, 128]), torch.Size([1, 8788, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.5240445137023926  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.654655933380127  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 8788, 128])
m.shape torch.Size([7555, 3, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.6621842384338379  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.6621842384338379  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 7555, 128]), torch.Size([1, 7555, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.6697592735290527  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8298273086547852  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 7555, 128])
m.shape torch.Size([6428, 4, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8384852409362793  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8384852409362793  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6428, 128]), torch.Size([1, 6428, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.8447623252868652  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0240693092346191  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6428, 128])
m.shape torch.Size([5680, 5, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0346760749816895  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.0346760749816895  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 5680, 128]), torch.Size([1, 5680, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.04026460647583  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2508454322814941  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 5680, 128])
m.shape torch.Size([4857, 6, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2611479759216309  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.2611479759216309  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 4857, 128]), torch.Size([1, 4857, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.265779972076416  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4668984413146973  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 4857, 128])
m.shape torch.Size([4341, 7, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.478933334350586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.478933334350586  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 4341, 128]), torch.Size([1, 4341, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.4838428497314453  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.6919922828674316  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 4341, 128])
m.shape torch.Size([3872, 8, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.7055473327636719  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.7055473327636719  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3872, 128]), torch.Size([1, 3872, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.7092399597167969  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9229240417480469  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3872, 128])
m.shape torch.Size([3564, 9, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9360618591308594  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9360618591308594  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3564, 128]), torch.Size([1, 3564, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 1.9402780532836914  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 2.167616844177246  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3564, 128])
m.shape torch.Size([46713, 10, 128])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 2.387727737426758  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 2.387727737426758  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 46713, 128]), torch.Size([1, 46713, 128])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 2.432276725769043  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.6002092361450195  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 46713, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.293497562408447  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.38961935043335  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.485741138458252  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.38886833190918  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

torch.Size([100791, 256])
first layer input nodes number: 124941
first layer output nodes number: 100791
edges number: 693057
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.4866743087768555  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.582796096801758  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.6068267822265625  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.6068267822265625  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

m.shape torch.Size([6747, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.996071815490723  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 5.996071815490723  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6747, 256]), torch.Size([1, 6747, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.009380340576172  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.113134384155273  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 6747, 256])
m.shape torch.Size([5640, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.116738796234131  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.116738796234131  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 5640, 256]), torch.Size([1, 5640, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.127496242523193  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.28948450088501  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 5640, 256])
m.shape torch.Size([4260, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.296389102935791  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.296389102935791  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 4260, 256]), torch.Size([1, 4260, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.3045430183410645  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.487052917480469  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 4260, 256])
m.shape torch.Size([3308, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.495437145233154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.495437145233154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 3308, 256]), torch.Size([1, 3308, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.501998424530029  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.689845085144043  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 3308, 256])
m.shape torch.Size([2867, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.699747085571289  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.699747085571289  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 2867, 256]), torch.Size([1, 2867, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.705480575561523  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.90557861328125  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 2867, 256])
m.shape torch.Size([2161, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.915034770965576  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.915034770965576  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 2161, 256]), torch.Size([1, 2161, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 6.92012357711792  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.105162143707275  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 2161, 256])
m.shape torch.Size([1744, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.114834785461426  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.114834785461426  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1744, 256]), torch.Size([1, 1744, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.118683815002441  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.286925315856934  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1744, 256])
m.shape torch.Size([1510, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.296872615814209  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.296872615814209  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1510, 256]), torch.Size([1, 1510, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.299774169921875  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.4729485511779785  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1510, 256])
m.shape torch.Size([1324, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.482151031494141  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.482151031494141  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1324, 256]), torch.Size([1, 1324, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.4846930503845215  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.648603439331055  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1324, 256])
m.shape torch.Size([1125, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.6580047607421875  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.6580047607421875  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.660303115844727  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.825126647949219  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([977, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.834044456481934  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.834044456481934  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 977, 256]), torch.Size([1, 977, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.835907936096191  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.986662864685059  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 977, 256])
m.shape torch.Size([879, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.995869159698486  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.995869159698486  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 879, 256]), torch.Size([1, 879, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 7.9975457191467285  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.140053272247314  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 879, 256])
m.shape torch.Size([758, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.148685932159424  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.148685932159424  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.150131702423096  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.283436298370361  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([638, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.291298389434814  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.291298389434814  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.292515277862549  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.416393756866455  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 638, 256])
m.shape torch.Size([577, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.4241042137146  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.4241042137146  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.425204753875732  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.542430400848389  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([534, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.550092220306396  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.550092220306396  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 534, 256]), torch.Size([1, 534, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.551110744476318  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.666928768157959  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 534, 256])
m.shape torch.Size([473, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.674148082733154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.674148082733154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.675050258636475  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.784473896026611  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([483, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.792378902435303  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.792378902435303  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.793300151824951  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.910560131072998  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([438, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.918098449707031  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.918098449707031  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 8.918933868408203  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.030983924865723  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([410, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.038447856903076  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.038447856903076  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.03922986984253  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.152673244476318  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([374, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.159831047058105  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.159831047058105  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.160544395446777  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.267024040222168  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([277, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.273404121398926  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.273404121398926  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.273932456970215  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.359319686889648  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([267, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.364957809448242  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.364957809448242  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.365467071533203  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.448854923248291  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([284, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.455151557922363  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.455151557922363  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.455693244934082  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.547490119934082  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([6390, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.700759410858154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.700759410858154  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

 h.shape torch.Size([1, 6390, 256]), torch.Size([1, 6390, 256])
----------------------------------------3
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 9.712947368621826  GigaBytes
Max Memory Allocated: 11.976387023925781  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.858027935028076  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

rst.shape  torch.Size([1, 6390, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.514082908630371  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.521539688110352  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.528162956237793  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.520374774932861  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

torch.Size([44445, 40])
input nodes number: 100791
output nodes number: 44445
edges number: 395986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.520260334014893  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 11.52026081085205  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.10256195068359375  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.10256195068359375  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.1287841796875 GB
    Memory Allocated: 0.10256195068359375  GigaBytes
Max Memory Allocated: 12.010377407073975  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05659055709838867 |0.004512310028076172 |0.1673346757888794 |0.00011456012725830078 |0.14437782764434814 |0.006662130355834961 |
----------------------------------------------------------pseudo_mini_loss sum 3.294407606124878
Total (block generation + training)time/epoch 24.55892062187195
Training time/epoch 0.8303487300872803
Training time without block to device /epoch 0.8213241100311279
Training time without total dataloading part /epoch 0.6303162574768066
load block tensor time/epoch 0.11318111419677734
block to device time/epoch 0.009024620056152344
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  389774
Number of first layer input nodes during this epoch:  217386
Number of first layer output nodes during this epoch:  172388
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
