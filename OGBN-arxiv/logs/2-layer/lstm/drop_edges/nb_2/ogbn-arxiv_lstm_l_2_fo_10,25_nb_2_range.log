main start at this time 1651599983.7853854
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03598499298095703
number of batches is  2
batch size is  45471
range selection method spend 0.013713359832763672
time for parepare:  0.017743825912475586
local_output_nid generation:  0.010654211044311523
local_in_edges_tensor generation:  0.008747339248657227
mini_batch_src_global generation:  0.011409759521484375
r_  generation:  0.15549111366271973
local_output_nid generation:  0.011684656143188477
local_in_edges_tensor generation:  0.01036381721496582
mini_batch_src_global generation:  0.015008211135864258
r_  generation:  0.16463899612426758
----------------------check_connections_block total spend ----------------------------- 0.46874570846557617
generate_one_block  0.18284368515014648
generate_one_block  0.18461346626281738
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02509593963623047
gen group dst list time:  0.0070133209228515625
time for parepare:  0.018962860107421875
local_output_nid generation:  0.015035152435302734
local_in_edges_tensor generation:  0.0314483642578125
mini_batch_src_global generation:  0.024755001068115234
r_  generation:  0.3081238269805908
local_output_nid generation:  0.024096012115478516
local_in_edges_tensor generation:  0.03258633613586426
mini_batch_src_global generation:  0.03164100646972656
r_  generation:  0.31888365745544434
----------------------check_connections_block total spend ----------------------------- 0.9450798034667969
generate_one_block  0.3892366886138916
generate_one_block  0.4182407855987549
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9450798034667969
block generation total time  0.8074774742126465
average batch blocks generation time:  0.40373873710632324
pseudo mini batch 0 input nodes size: 156576
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.0774388313293457  GigaBytes
Max Memory Allocated: 0.0774388313293457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07777786254882812  GigaBytes
Max Memory Allocated: 0.07777786254882812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07777786254882812  GigaBytes
Max Memory Allocated: 0.07777786254882812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08711767196655273  GigaBytes
Max Memory Allocated: 0.08711767196655273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08711767196655273  GigaBytes
Max Memory Allocated: 0.08711767196655273  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08711767196655273  GigaBytes
Max Memory Allocated: 0.08711767196655273  GigaBytes

torch.Size([156576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08711767196655273  GigaBytes
Max Memory Allocated: 0.08711767196655273  GigaBytes

m.shape torch.Size([10839, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5159292221069336  GigaBytes
Max Memory Allocated: 0.5233869552612305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5159292221069336  GigaBytes
Max Memory Allocated: 0.5233869552612305  GigaBytes

 h.shape torch.Size([1, 10839, 128]), torch.Size([1, 10839, 128])
----------------------------------------3
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5262660980224609  GigaBytes
Max Memory Allocated: 0.5262660980224609  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6113929748535156  GigaBytes
Max Memory Allocated: 0.6165614128112793  GigaBytes

rst.shape  torch.Size([1, 10839, 128])
m.shape torch.Size([11948, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6176190376281738  GigaBytes
Max Memory Allocated: 0.6178865432739258  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6176190376281738  GigaBytes
Max Memory Allocated: 0.6178865432739258  GigaBytes

 h.shape torch.Size([1, 11948, 128]), torch.Size([1, 11948, 128])
----------------------------------------3
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6290135383605957  GigaBytes
Max Memory Allocated: 0.6290135383605957  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8038220405578613  GigaBytes
Max Memory Allocated: 0.8152165412902832  GigaBytes

rst.shape  torch.Size([1, 11948, 128])
m.shape torch.Size([10898, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.8137497901916504  GigaBytes
Max Memory Allocated: 0.8152165412902832  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.8137497901916504  GigaBytes
Max Memory Allocated: 0.8152165412902832  GigaBytes

 h.shape torch.Size([1, 10898, 128]), torch.Size([1, 10898, 128])
----------------------------------------3
 Nvidia-smi: 2.0506591796875 GB
    Memory Allocated: 0.824643611907959  GigaBytes
Max Memory Allocated: 0.824643611907959  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2987060546875 GB
    Memory Allocated: 1.0595755577087402  GigaBytes
Max Memory Allocated: 1.0752005577087402  GigaBytes

rst.shape  torch.Size([1, 10898, 128])
m.shape torch.Size([9435, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0723748207092285  GigaBytes
Max Memory Allocated: 1.0752005577087402  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0723748207092285  GigaBytes
Max Memory Allocated: 1.0752005577087402  GigaBytes

 h.shape torch.Size([1, 9435, 128]), torch.Size([1, 9435, 128])
----------------------------------------3
 Nvidia-smi: 2.3182373046875 GB
    Memory Allocated: 1.0820703506469727  GigaBytes
Max Memory Allocated: 1.0820703506469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 1.3430099487304688  GigaBytes
Max Memory Allocated: 1.3610057830810547  GigaBytes

rst.shape  torch.Size([1, 9435, 128])
m.shape torch.Size([8372, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.358471393585205  GigaBytes
Max Memory Allocated: 1.3610057830810547  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.358471393585205  GigaBytes
Max Memory Allocated: 1.3610057830810547  GigaBytes

 h.shape torch.Size([1, 8372, 128]), torch.Size([1, 8372, 128])
----------------------------------------3
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 1.3669962882995605  GigaBytes
Max Memory Allocated: 1.3669962882995605  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.654426097869873  GigaBytes
Max Memory Allocated: 1.6743865013122559  GigaBytes

rst.shape  torch.Size([1, 8372, 128])
m.shape torch.Size([7067, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6706528663635254  GigaBytes
Max Memory Allocated: 1.6743865013122559  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.6706528663635254  GigaBytes
Max Memory Allocated: 1.6743865013122559  GigaBytes

 h.shape torch.Size([1, 7067, 128]), torch.Size([1, 7067, 128])
----------------------------------------3
 Nvidia-smi: 2.9588623046875 GB
    Memory Allocated: 1.677656650543213  GigaBytes
Max Memory Allocated: 1.677656650543213  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9732728004455566  GigaBytes
Max Memory Allocated: 1.9934916496276855  GigaBytes

rst.shape  torch.Size([1, 7067, 128])
m.shape torch.Size([6251, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9913873672485352  GigaBytes
Max Memory Allocated: 1.9934916496276855  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9913873672485352  GigaBytes
Max Memory Allocated: 1.9934916496276855  GigaBytes

 h.shape torch.Size([1, 6251, 128]), torch.Size([1, 6251, 128])
----------------------------------------3
 Nvidia-smi: 3.2655029296875 GB
    Memory Allocated: 1.9977378845214844  GigaBytes
Max Memory Allocated: 1.9977378845214844  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.29628849029541  GigaBytes
Max Memory Allocated: 2.31777286529541  GigaBytes

rst.shape  torch.Size([1, 6251, 128])
m.shape torch.Size([5583, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.3147921562194824  GigaBytes
Max Memory Allocated: 2.31777286529541  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.3147921562194824  GigaBytes
Max Memory Allocated: 2.31777286529541  GigaBytes

 h.shape torch.Size([1, 5583, 128]), torch.Size([1, 5583, 128])
----------------------------------------3
 Nvidia-smi: 3.6229248046875 GB
    Memory Allocated: 2.3204145431518555  GigaBytes
Max Memory Allocated: 2.3204145431518555  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.6275219917297363  GigaBytes
Max Memory Allocated: 2.6490063667297363  GigaBytes

rst.shape  torch.Size([1, 5583, 128])
m.shape torch.Size([4872, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.6463441848754883  GigaBytes
Max Memory Allocated: 2.6490063667297363  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.6463441848754883  GigaBytes
Max Memory Allocated: 2.6490063667297363  GigaBytes

 h.shape torch.Size([1, 4872, 128]), torch.Size([1, 4872, 128])
----------------------------------------3
 Nvidia-smi: 3.9686279296875 GB
    Memory Allocated: 2.6514458656311035  GigaBytes
Max Memory Allocated: 2.6514458656311035  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3026123046875 GB
    Memory Allocated: 2.9629998207092285  GigaBytes
Max Memory Allocated: 2.9844841957092285  GigaBytes

rst.shape  torch.Size([1, 4872, 128])
m.shape torch.Size([54290, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.219496250152588  GigaBytes
Max Memory Allocated: 3.2256693840026855  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5623779296875 GB
    Memory Allocated: 3.219496250152588  GigaBytes
Max Memory Allocated: 3.2256693840026855  GigaBytes

 h.shape torch.Size([1, 54290, 128]), torch.Size([1, 54290, 128])
----------------------------------------3
 Nvidia-smi: 4.6170654296875 GB
    Memory Allocated: 3.271271228790283  GigaBytes
Max Memory Allocated: 3.271271228790283  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.94729471206665  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

rst.shape  torch.Size([1, 54290, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.568488597869873  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.692041873931885  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.8155951499938965  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.691076278686523  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

torch.Size([129555, 256])
first layer input nodes number: 156576
first layer output nodes number: 129555
edges number: 864600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.8168625831604  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6424560546875 GB
    Memory Allocated: 6.940415859222412  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 6.971304416656494  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 6.971304416656494  GigaBytes
Max Memory Allocated: 7.20706033706665  GigaBytes

m.shape torch.Size([6695, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.337821960449219  GigaBytes
Max Memory Allocated: 7.337891101837158  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.337821960449219  GigaBytes
Max Memory Allocated: 7.337891101837158  GigaBytes

 h.shape torch.Size([1, 6695, 256]), torch.Size([1, 6695, 256])
----------------------------------------3
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.350591659545898  GigaBytes
Max Memory Allocated: 7.350591659545898  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.452749252319336  GigaBytes
Max Memory Allocated: 7.459134101867676  GigaBytes

rst.shape  torch.Size([1, 6695, 256])
m.shape torch.Size([5785, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.457484722137451  GigaBytes
Max Memory Allocated: 7.459134101867676  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.457484722137451  GigaBytes
Max Memory Allocated: 7.459134101867676  GigaBytes

 h.shape torch.Size([1, 5785, 256]), torch.Size([1, 5785, 256])
----------------------------------------3
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.469216346740723  GigaBytes
Max Memory Allocated: 7.469216346740723  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.635870456695557  GigaBytes
Max Memory Allocated: 7.646904468536377  GigaBytes

rst.shape  torch.Size([1, 5785, 256])
m.shape torch.Size([4654, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.6432414054870605  GigaBytes
Max Memory Allocated: 7.646904468536377  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.6432414054870605  GigaBytes
Max Memory Allocated: 7.646904468536377  GigaBytes

 h.shape torch.Size([1, 4654, 256]), torch.Size([1, 4654, 256])
----------------------------------------3
 Nvidia-smi: 9.1229248046875 GB
    Memory Allocated: 7.653606414794922  GigaBytes
Max Memory Allocated: 7.653606414794922  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 7.849748611450195  GigaBytes
Max Memory Allocated: 7.863063812255859  GigaBytes

rst.shape  torch.Size([1, 4654, 256])
m.shape torch.Size([3697, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 7.859523773193359  GigaBytes
Max Memory Allocated: 7.863063812255859  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 7.859523773193359  GigaBytes
Max Memory Allocated: 7.863063812255859  GigaBytes

 h.shape torch.Size([1, 3697, 256]), torch.Size([1, 3697, 256])
----------------------------------------3
 Nvidia-smi: 9.3182373046875 GB
    Memory Allocated: 7.867369651794434  GigaBytes
Max Memory Allocated: 7.867369651794434  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5604248046875 GB
    Memory Allocated: 8.07285213470459  GigaBytes
Max Memory Allocated: 8.086955070495605  GigaBytes

rst.shape  torch.Size([1, 3697, 256])
m.shape torch.Size([3148, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.5604248046875 GB
    Memory Allocated: 8.085068702697754  GigaBytes
Max Memory Allocated: 8.086955070495605  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5604248046875 GB
    Memory Allocated: 8.085068702697754  GigaBytes
Max Memory Allocated: 8.086955070495605  GigaBytes

 h.shape torch.Size([1, 3148, 256]), torch.Size([1, 3148, 256])
----------------------------------------3
 Nvidia-smi: 9.5604248046875 GB
    Memory Allocated: 8.091707706451416  GigaBytes
Max Memory Allocated: 8.091707706451416  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8045654296875 GB
    Memory Allocated: 8.307863712310791  GigaBytes
Max Memory Allocated: 8.323488712310791  GigaBytes

rst.shape  torch.Size([1, 3148, 256])
m.shape torch.Size([2384, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.8045654296875 GB
    Memory Allocated: 8.318609714508057  GigaBytes
Max Memory Allocated: 8.323488712310791  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.8045654296875 GB
    Memory Allocated: 8.318609714508057  GigaBytes
Max Memory Allocated: 8.323488712310791  GigaBytes

 h.shape torch.Size([1, 2384, 256]), torch.Size([1, 2384, 256])
----------------------------------------3
 Nvidia-smi: 9.8045654296875 GB
    Memory Allocated: 8.32322359085083  GigaBytes
Max Memory Allocated: 8.323488712310791  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0135498046875 GB
    Memory Allocated: 8.521869659423828  GigaBytes
Max Memory Allocated: 8.535541534423828  GigaBytes

rst.shape  torch.Size([1, 2384, 256])
m.shape torch.Size([2050, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.533388614654541  GigaBytes
Max Memory Allocated: 8.535541534423828  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.533388614654541  GigaBytes
Max Memory Allocated: 8.535541534423828  GigaBytes

 h.shape torch.Size([1, 2050, 256]), torch.Size([1, 2050, 256])
----------------------------------------3
 Nvidia-smi: 10.0291748046875 GB
    Memory Allocated: 8.537500381469727  GigaBytes
Max Memory Allocated: 8.537500381469727  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2401123046875 GB
    Memory Allocated: 8.733524322509766  GigaBytes
Max Memory Allocated: 8.747209548950195  GigaBytes

rst.shape  torch.Size([1, 2050, 256])
m.shape torch.Size([1715, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.2401123046875 GB
    Memory Allocated: 8.74475622177124  GigaBytes
Max Memory Allocated: 8.747209548950195  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2401123046875 GB
    Memory Allocated: 8.74475622177124  GigaBytes
Max Memory Allocated: 8.747209548950195  GigaBytes

 h.shape torch.Size([1, 1715, 256]), torch.Size([1, 1715, 256])
----------------------------------------3
 Nvidia-smi: 10.2401123046875 GB
    Memory Allocated: 8.748050212860107  GigaBytes
Max Memory Allocated: 8.748050212860107  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 8.935282230377197  GigaBytes
Max Memory Allocated: 8.948954105377197  GigaBytes

rst.shape  torch.Size([1, 1715, 256])
m.shape torch.Size([1524, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 8.947307586669922  GigaBytes
Max Memory Allocated: 8.948954105377197  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 8.947307586669922  GigaBytes
Max Memory Allocated: 8.948954105377197  GigaBytes

 h.shape torch.Size([1, 1524, 256]), torch.Size([1, 1524, 256])
----------------------------------------3
 Nvidia-smi: 10.4881591796875 GB
    Memory Allocated: 8.950220108032227  GigaBytes
Max Memory Allocated: 8.950220108032227  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5994873046875 GB
    Memory Allocated: 9.143973350524902  GigaBytes
Max Memory Allocated: 9.157645225524902  GigaBytes

rst.shape  torch.Size([1, 1524, 256])
m.shape torch.Size([1328, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5994873046875 GB
    Memory Allocated: 9.155281066894531  GigaBytes
Max Memory Allocated: 9.157645225524902  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5994873046875 GB
    Memory Allocated: 9.155281066894531  GigaBytes
Max Memory Allocated: 9.157645225524902  GigaBytes

 h.shape torch.Size([1, 1328, 256]), torch.Size([1, 1328, 256])
----------------------------------------3
 Nvidia-smi: 10.5994873046875 GB
    Memory Allocated: 9.157966613769531  GigaBytes
Max Memory Allocated: 9.157966613769531  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8084716796875 GB
    Memory Allocated: 9.342101097106934  GigaBytes
Max Memory Allocated: 9.354765892028809  GigaBytes

rst.shape  torch.Size([1, 1328, 256])
m.shape torch.Size([1126, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.8084716796875 GB
    Memory Allocated: 9.352483749389648  GigaBytes
Max Memory Allocated: 9.354765892028809  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.8084716796875 GB
    Memory Allocated: 9.352483749389648  GigaBytes
Max Memory Allocated: 9.354765892028809  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 10.8084716796875 GB
    Memory Allocated: 9.35552978515625  GigaBytes
Max Memory Allocated: 9.35552978515625  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.53525161743164  GigaBytes
Max Memory Allocated: 9.547063827514648  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([965, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.544771671295166  GigaBytes
Max Memory Allocated: 9.547063827514648  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.544771671295166  GigaBytes
Max Memory Allocated: 9.547063827514648  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 10.9412841796875 GB
    Memory Allocated: 9.54661226272583  GigaBytes
Max Memory Allocated: 9.547063827514648  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1151123046875 GB
    Memory Allocated: 9.703062534332275  GigaBytes
Max Memory Allocated: 9.714781284332275  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([815, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.1151123046875 GB
    Memory Allocated: 9.71232557296753  GigaBytes
Max Memory Allocated: 9.714781284332275  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1151123046875 GB
    Memory Allocated: 9.71232557296753  GigaBytes
Max Memory Allocated: 9.714781284332275  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 11.1151123046875 GB
    Memory Allocated: 9.713880062103271  GigaBytes
Max Memory Allocated: 9.714781284332275  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2791748046875 GB
    Memory Allocated: 9.862157344818115  GigaBytes
Max Memory Allocated: 9.872361660003662  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([681, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.2791748046875 GB
    Memory Allocated: 9.870543479919434  GigaBytes
Max Memory Allocated: 9.872361660003662  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2791748046875 GB
    Memory Allocated: 9.870543479919434  GigaBytes
Max Memory Allocated: 9.872361660003662  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 11.2811279296875 GB
    Memory Allocated: 9.871842384338379  GigaBytes
Max Memory Allocated: 9.872361660003662  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4373779296875 GB
    Memory Allocated: 10.00083065032959  GigaBytes
Max Memory Allocated: 10.009922981262207  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([639, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4373779296875 GB
    Memory Allocated: 10.009393692016602  GigaBytes
Max Memory Allocated: 10.009922981262207  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4373779296875 GB
    Memory Allocated: 10.009393692016602  GigaBytes
Max Memory Allocated: 10.009922981262207  GigaBytes

 h.shape torch.Size([1, 639, 256]), torch.Size([1, 639, 256])
----------------------------------------3
 Nvidia-smi: 11.4373779296875 GB
    Memory Allocated: 10.010612487792969  GigaBytes
Max Memory Allocated: 10.010612487792969  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5760498046875 GB
    Memory Allocated: 10.140669822692871  GigaBytes
Max Memory Allocated: 10.149810791015625  GigaBytes

rst.shape  torch.Size([1, 639, 256])
m.shape torch.Size([562, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.5760498046875 GB
    Memory Allocated: 10.14870309829712  GigaBytes
Max Memory Allocated: 10.149810791015625  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5760498046875 GB
    Memory Allocated: 10.14870309829712  GigaBytes
Max Memory Allocated: 10.149810791015625  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 11.5760498046875 GB
    Memory Allocated: 10.14977502822876  GigaBytes
Max Memory Allocated: 10.149810791015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6951904296875 GB
    Memory Allocated: 10.273733615875244  GigaBytes
Max Memory Allocated: 10.28230905532837  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([502, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.6951904296875 GB
    Memory Allocated: 10.281400203704834  GigaBytes
Max Memory Allocated: 10.28230905532837  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6951904296875 GB
    Memory Allocated: 10.281400203704834  GigaBytes
Max Memory Allocated: 10.28230905532837  GigaBytes

 h.shape torch.Size([1, 502, 256]), torch.Size([1, 502, 256])
----------------------------------------3
 Nvidia-smi: 11.6971435546875 GB
    Memory Allocated: 10.282357692718506  GigaBytes
Max Memory Allocated: 10.282357692718506  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 10.398614406585693  GigaBytes
Max Memory Allocated: 10.406753063201904  GigaBytes

rst.shape  torch.Size([1, 502, 256])
m.shape torch.Size([488, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 10.406578540802002  GigaBytes
Max Memory Allocated: 10.406753063201904  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 10.406578540802002  GigaBytes
Max Memory Allocated: 10.406753063201904  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 11.7342529296875 GB
    Memory Allocated: 10.407509326934814  GigaBytes
Max Memory Allocated: 10.407509326934814  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8494873046875 GB
    Memory Allocated: 10.52954912185669  GigaBytes
Max Memory Allocated: 10.537926197052002  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([422, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.8494873046875 GB
    Memory Allocated: 10.536790370941162  GigaBytes
Max Memory Allocated: 10.537926197052002  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.8494873046875 GB
    Memory Allocated: 10.536790370941162  GigaBytes
Max Memory Allocated: 10.537926197052002  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 11.8514404296875 GB
    Memory Allocated: 10.537595272064209  GigaBytes
Max Memory Allocated: 10.537926197052002  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9295654296875 GB
    Memory Allocated: 10.649895668029785  GigaBytes
Max Memory Allocated: 10.65754222869873  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([403, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.9295654296875 GB
    Memory Allocated: 10.65723991394043  GigaBytes
Max Memory Allocated: 10.65754222869873  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9295654296875 GB
    Memory Allocated: 10.65723991394043  GigaBytes
Max Memory Allocated: 10.65754222869873  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 11.9295654296875 GB
    Memory Allocated: 10.658008575439453  GigaBytes
Max Memory Allocated: 10.658008575439453  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0369873046875 GB
    Memory Allocated: 10.766820907592773  GigaBytes
Max Memory Allocated: 10.774507522583008  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([377, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.0369873046875 GB
    Memory Allocated: 10.774045944213867  GigaBytes
Max Memory Allocated: 10.774507522583008  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0369873046875 GB
    Memory Allocated: 10.774045944213867  GigaBytes
Max Memory Allocated: 10.774507522583008  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 12.0369873046875 GB
    Memory Allocated: 10.774765014648438  GigaBytes
Max Memory Allocated: 10.774765014648438  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1522216796875 GB
    Memory Allocated: 10.884806632995605  GigaBytes
Max Memory Allocated: 10.892356872558594  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([275, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.1522216796875 GB
    Memory Allocated: 10.890262126922607  GigaBytes
Max Memory Allocated: 10.892356872558594  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1522216796875 GB
    Memory Allocated: 10.890262126922607  GigaBytes
Max Memory Allocated: 10.892356872558594  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 12.1522216796875 GB
    Memory Allocated: 10.89078664779663  GigaBytes
Max Memory Allocated: 10.892356872558594  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1990966796875 GB
    Memory Allocated: 10.975879192352295  GigaBytes
Max Memory Allocated: 10.981648921966553  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([250, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.1990966796875 GB
    Memory Allocated: 10.981143474578857  GigaBytes
Max Memory Allocated: 10.981648921966553  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1990966796875 GB
    Memory Allocated: 10.981143474578857  GigaBytes
Max Memory Allocated: 10.981648921966553  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 12.1990966796875 GB
    Memory Allocated: 10.98162031173706  GigaBytes
Max Memory Allocated: 10.981648921966553  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2772216796875 GB
    Memory Allocated: 11.058867931365967  GigaBytes
Max Memory Allocated: 11.064351558685303  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([261, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.2772216796875 GB
    Memory Allocated: 11.064650058746338  GigaBytes
Max Memory Allocated: 11.06467342376709  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2772216796875 GB
    Memory Allocated: 11.064650058746338  GigaBytes
Max Memory Allocated: 11.06467342376709  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 12.2791748046875 GB
    Memory Allocated: 11.065147876739502  GigaBytes
Max Memory Allocated: 11.065147876739502  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3709716796875 GB
    Memory Allocated: 11.151134967803955  GigaBytes
Max Memory Allocated: 11.157108783721924  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([4725, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.4862060546875 GB
    Memory Allocated: 11.265047550201416  GigaBytes
Max Memory Allocated: 11.265487670898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4862060546875 GB
    Memory Allocated: 11.265047550201416  GigaBytes
Max Memory Allocated: 11.265487670898438  GigaBytes

 h.shape torch.Size([1, 4725, 256]), torch.Size([1, 4725, 256])
----------------------------------------3
 Nvidia-smi: 12.4862060546875 GB
    Memory Allocated: 11.274059772491455  GigaBytes
Max Memory Allocated: 11.274059772491455  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3182373046875 GB
    Memory Allocated: 12.86021089553833  GigaBytes
Max Memory Allocated: 12.97349214553833  GigaBytes

rst.shape  torch.Size([1, 4725, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.541767597198486  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.548543453216553  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.55531930923462  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.54820442199707  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

torch.Size([45471, 40])
input nodes number: 129555
output nodes number: 45471
edges number: 372299
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.55628490447998  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.3631591796875 GB
    Memory Allocated: 12.556285858154297  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.11359882354736328  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

pseudo mini batch 1 input nodes size: 156630
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.08732986450195312  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.08732986450195312  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.1620168685913086  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.16235589981079102  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.0873556137084961  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.09658241271972656  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.09658241271972656  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.09658241271972656  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

torch.Size([156630, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.09658241271972656  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

m.shape torch.Size([10843, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.5272068977355957  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.5272068977355957  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 10843, 128]), torch.Size([1, 10843, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.5375475883483887  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.6226820945739746  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 10843, 128])
m.shape torch.Size([11925, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.6292304992675781  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.6292304992675781  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 11925, 128]), torch.Size([1, 11925, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.6414651870727539  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.8172464370727539  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 11925, 128])
m.shape torch.Size([10837, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.8268389701843262  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.8268389701843262  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 10837, 128]), torch.Size([1, 10837, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 0.8389039039611816  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.0736031532287598  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 10837, 128])
m.shape torch.Size([9555, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.086660385131836  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.086660385131836  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 9555, 128]), torch.Size([1, 9555, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.096384048461914  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.360642433166504  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 9555, 128])
m.shape torch.Size([8414, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.3761467933654785  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.3761467933654785  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 8414, 128]), torch.Size([1, 8414, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.3841710090637207  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.6730427742004395  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 8414, 128])
m.shape torch.Size([7108, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.6893668174743652  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.6893668174743652  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 7108, 128]), torch.Size([1, 7108, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.6965441703796387  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 1.9912457466125488  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 7108, 128])
m.shape torch.Size([6214, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.009340763092041  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.009340763092041  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 6214, 128]), torch.Size([1, 6214, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.015641689300537  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.312915325164795  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 6214, 128])
m.shape torch.Size([5529, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.3314366340637207  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.3314366340637207  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 5529, 128]), torch.Size([1, 5529, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.3370361328125  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.6380791664123535  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 5529, 128])
m.shape torch.Size([4891, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.6569271087646484  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.6569271087646484  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 4891, 128]), torch.Size([1, 4891, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.6618127822875977  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 2.9744973182678223  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 4891, 128])
m.shape torch.Size([54443, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 3.231656551361084  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 3.231656551361084  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 54443, 128]), torch.Size([1, 54443, 128])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 3.2835774421691895  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.969960689544678  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 54443, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.589385986328125  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.713133811950684  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.836881637573242  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.712166786193848  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

torch.Size([129759, 256])
first layer input nodes number: 156630
first layer output nodes number: 129759
edges number: 866321
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.838150501251221  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.961898326873779  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.992835521697998  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 6.992835521697998  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

m.shape torch.Size([6733, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.3595757484436035  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.3595757484436035  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 6733, 256]), torch.Size([1, 6733, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.37241792678833  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.475155353546143  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 6733, 256])
m.shape torch.Size([5921, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.481092929840088  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.481092929840088  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 5921, 256]), torch.Size([1, 5921, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.492425918579102  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.661827087402344  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 5921, 256])
m.shape torch.Size([4623, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.669510364532471  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.669510364532471  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 4623, 256]), torch.Size([1, 4623, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.678622245788574  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.875749111175537  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 4623, 256])
m.shape torch.Size([3623, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.8852691650390625  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.8852691650390625  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 3623, 256]), torch.Size([1, 3623, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 7.89369010925293  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.09408950805664  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 3623, 256])
m.shape torch.Size([3074, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.105407238006592  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.105407238006592  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 3074, 256]), torch.Size([1, 3074, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.111388683319092  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.32373571395874  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 3074, 256])
m.shape torch.Size([2484, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.335573196411133  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.335573196411133  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 2484, 256]), torch.Size([1, 2484, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.340702056884766  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.55242395401001  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 2484, 256])
m.shape torch.Size([1995, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.563674926757812  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.563674926757812  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 1995, 256]), torch.Size([1, 1995, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.567558288574219  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.764769554138184  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 1995, 256])
m.shape torch.Size([1757, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.776376724243164  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.776376724243164  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 1757, 256]), torch.Size([1, 1757, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.78001594543457  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.973627090454102  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 1757, 256])
m.shape torch.Size([1452, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.984367847442627  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.984367847442627  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 1452, 256]), torch.Size([1, 1452, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 8.987427234649658  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.175890445709229  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 1452, 256])
m.shape torch.Size([1271, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.186576843261719  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.186576843261719  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 1271, 256]), torch.Size([1, 1271, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.189116477966309  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.364956378936768  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 1271, 256])
m.shape torch.Size([1077, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.374959945678711  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.374959945678711  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.377140045166016  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.546809196472168  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([972, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.556583881378174  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.556583881378174  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.558437824249268  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.716022968292236  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([841, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.725604057312012  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.725604057312012  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.727208137512207  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.876477241516113  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 841, 256])
m.shape torch.Size([753, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.885807514190674  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.885807514190674  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 753, 256]), torch.Size([1, 753, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 9.887243747711182  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.031137943267822  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 753, 256])
m.shape torch.Size([650, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.039791107177734  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.039791107177734  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.041030883789062  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.172447204589844  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 650, 256])
m.shape torch.Size([549, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.180270195007324  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.180270195007324  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.181317329406738  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.303882598876953  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([528, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.311986446380615  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.311986446380615  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.31299352645874  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.434422969818115  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([460, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.441877841949463  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.441877841949463  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.442755222320557  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.556727886199951  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([414, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.563849449157715  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.563849449157715  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.5646390914917  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.672982215881348  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([404, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.68035364151001  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.68035364151001  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.681124210357666  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.790606021881104  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([340, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.797083377838135  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.797083377838135  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.797731876373291  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.894701480865479  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([281, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.90031909942627  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.90031909942627  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.90085506439209  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.985186576843262  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([269, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.990865230560303  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.990865230560303  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 10.99137830734253  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.074879169464111  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([264, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.08071231842041  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.08071231842041  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.081215858459473  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.167634010314941  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([4735, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.281155586242676  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.281155586242676  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

 h.shape torch.Size([1, 4735, 256]), torch.Size([1, 4735, 256])
----------------------------------------3
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 11.290186882019043  GigaBytes
Max Memory Allocated: 12.985998630523682  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.879694938659668  GigaBytes
Max Memory Allocated: 12.992586135864258  GigaBytes

rst.shape  torch.Size([1, 4735, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.560543060302734  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.5673189163208  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.574094772338867  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.566979885101318  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([45470, 40])
input nodes number: 129759
output nodes number: 45470
edges number: 371951
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.568285942077637  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0838623046875 GB
    Memory Allocated: 12.568286418914795  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.11372756958007812  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.1192779541015625  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.1192779541015625  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07341086864471436 |0.17043519020080566 |0.46594369411468506 |0.00015914440155029297 |0.14073753356933594 |0.009612560272216797 |
----------------------------------------------------------pseudo_mini_loss sum 5.325464248657227
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  572520
Number of first layer input nodes during this epoch:  313206
Number of first layer output nodes during this epoch:  259314
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.1192774772644043  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030121803283691406
number of batches is  2
batch size is  45471
range selection method spend 0.013895034790039062
time for parepare:  0.0192263126373291
local_output_nid generation:  0.010808706283569336
local_in_edges_tensor generation:  0.013160228729248047
mini_batch_src_global generation:  0.011234521865844727
r_  generation:  0.14952683448791504
local_output_nid generation:  0.011623144149780273
local_in_edges_tensor generation:  0.0072591304779052734
mini_batch_src_global generation:  0.019362211227416992
r_  generation:  0.16290998458862305
----------------------check_connections_block total spend ----------------------------- 0.4663519859313965
generate_one_block  0.18925023078918457
generate_one_block  0.18848967552185059
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025769948959350586
gen group dst list time:  0.007078886032104492
time for parepare:  0.018952369689941406
local_output_nid generation:  0.01623702049255371
local_in_edges_tensor generation:  0.03884553909301758
mini_batch_src_global generation:  0.027274131774902344
r_  generation:  0.3101775646209717
local_output_nid generation:  0.02569413185119629
local_in_edges_tensor generation:  0.03107142448425293
mini_batch_src_global generation:  0.03144216537475586
r_  generation:  0.3229331970214844
----------------------check_connections_block total spend ----------------------------- 0.961198091506958
generate_one_block  0.4028339385986328
generate_one_block  0.3985581398010254
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.1192774772644043  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

connection checking time:  0.961198091506958
block generation total time  0.8013920783996582
average batch blocks generation time:  0.4006960391998291
block dataloader generation time/epoch 2.7862350940704346
pseudo mini batch 0 input nodes size: 156600
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.09290504455566406  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.09290504455566406  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.16757774353027344  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.16791677474975586  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.09289073944091797  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.10222673416137695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.10222673416137695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.10222673416137695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([156600, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.10222673416137695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

m.shape torch.Size([10901, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.5322442054748535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.5322442054748535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 10901, 128]), torch.Size([1, 10901, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.542640209197998  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.6278853416442871  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 10901, 128])
m.shape torch.Size([11908, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.6344060897827148  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.6344060897827148  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 11908, 128]), torch.Size([1, 11908, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.6466050148010254  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.8223862648010254  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 11908, 128])
m.shape torch.Size([10894, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.8319706916809082  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.8319706916809082  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 10894, 128]), torch.Size([1, 10894, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 0.8440518379211426  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.0789685249328613  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 10894, 128])
m.shape torch.Size([9511, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.0919146537780762  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.0919146537780762  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 9511, 128]), torch.Size([1, 9511, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.101644515991211  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.3646860122680664  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 9511, 128])
m.shape torch.Size([8379, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.3801279067993164  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.3801279067993164  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 8379, 128]), torch.Size([1, 8379, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.3881187438964844  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.6757888793945312  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 8379, 128])
m.shape torch.Size([7059, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.6919894218444824  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.6919894218444824  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 7059, 128]), torch.Size([1, 7059, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.6992669105529785  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 1.993891716003418  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 7059, 128])
m.shape torch.Size([6210, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.012010097503662  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.012010097503662  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 6210, 128]), torch.Size([1, 6210, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.0183863639831543  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.3158535957336426  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 6210, 128])
m.shape torch.Size([5557, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.334376811981201  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.334376811981201  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 5557, 128]), torch.Size([1, 5557, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.3396763801574707  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.64217472076416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 5557, 128])
m.shape torch.Size([4917, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.6610093116760254  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.6610093116760254  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4917, 128]), torch.Size([1, 4917, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.6657614707946777  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 2.9779305458068848  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4917, 128])
m.shape torch.Size([54398, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 3.2353515625  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 3.2353515625  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 54398, 128]), torch.Size([1, 54398, 128])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 3.287229537963867  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.9705657958984375  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 54398, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.590857982635498  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.7145819664001465  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.838305950164795  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.7136149406433105  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([129734, 256])
first layer input nodes number: 156600
first layer output nodes number: 129734
edges number: 865851
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.839596271514893  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.963320255279541  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.994251251220703  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 6.994251251220703  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

m.shape torch.Size([6672, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.360788822174072  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.360788822174072  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 6672, 256]), torch.Size([1, 6672, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.373514652252197  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.475321292877197  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 6672, 256])
m.shape torch.Size([5897, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.480294227600098  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.480294227600098  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 5897, 256]), torch.Size([1, 5897, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.491596221923828  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.660310745239258  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 5897, 256])
m.shape torch.Size([4663, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.6687822341918945  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.6687822341918945  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4663, 256]), torch.Size([1, 4663, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.677846431732178  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.874843597412109  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4663, 256])
m.shape torch.Size([3701, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.884625434875488  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.884625434875488  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 3701, 256]), torch.Size([1, 3701, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 7.892150402069092  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.096864223480225  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 3701, 256])
m.shape torch.Size([3066, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.108068943023682  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.108068943023682  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 3066, 256]), torch.Size([1, 3066, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.114338397979736  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.326581001281738  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 3066, 256])
m.shape torch.Size([2416, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.338385105133057  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.338385105133057  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 2416, 256]), torch.Size([1, 2416, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.34315299987793  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.544783115386963  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 2416, 256])
m.shape torch.Size([2111, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.556681632995605  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.556681632995605  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 2111, 256]), torch.Size([1, 2111, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.561124324798584  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.762444972991943  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 2111, 256])
m.shape torch.Size([1703, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.773526191711426  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.773526191711426  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1703, 256]), torch.Size([1, 1703, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.776897430419922  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.96375322341919  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1703, 256])
m.shape torch.Size([1458, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.974652767181396  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.974652767181396  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1458, 256]), torch.Size([1, 1458, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 8.977433681488037  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.156546115875244  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1458, 256])
m.shape torch.Size([1306, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.167694091796875  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.167694091796875  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1306, 256]), torch.Size([1, 1306, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.170339584350586  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.349688529968262  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1306, 256])
m.shape torch.Size([1107, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.359987735748291  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.359987735748291  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1107, 256]), torch.Size([1, 1107, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.362156391143799  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.535274982452393  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1107, 256])
m.shape torch.Size([968, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.545027256011963  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.545027256011963  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 968, 256]), torch.Size([1, 968, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.546873569488525  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.704467296600342  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 968, 256])
m.shape torch.Size([816, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.71373987197876  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.71373987197876  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 816, 256]), torch.Size([1, 816, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.715296268463135  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.863146305084229  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 816, 256])
m.shape torch.Size([709, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.87263536453247  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.87263536453247  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 9.873987674713135  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.011391162872314  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([632, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.019826889038086  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.019826889038086  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.021032333374023  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.152669906616211  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([539, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.160356044769287  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.160356044769287  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.161384105682373  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.277726650238037  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([532, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.285905361175537  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.285905361175537  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.286920070648193  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.409417629241943  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([464, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.416937828063965  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.416937828063965  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.41782283782959  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.534085273742676  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([403, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.54100227355957  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.54100227355957  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.541770935058594  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.649909973144531  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([408, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.657368659973145  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.657368659973145  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.658146858215332  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.772183418273926  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([342, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.778697490692139  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.778697490692139  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.77934980392456  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.877476692199707  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([287, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.883219242095947  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.883219242095947  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.883766651153564  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.972930431365967  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([249, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.978161334991455  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.978161334991455  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 10.978636264801025  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 11.055574893951416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([274, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 11.061657905578613  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 11.061657905578613  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 11.062180519104004  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4393310546875 GB
    Memory Allocated: 11.152914047241211  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([4748, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 11.266818523406982  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 11.266818523406982  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4748, 256]), torch.Size([1, 4748, 256])
----------------------------------------3
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 11.275874614715576  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.869746685028076  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4748, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.550706386566162  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.557482242584229  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.564258098602295  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.557143211364746  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([45471, 40])
input nodes number: 129734
output nodes number: 45471
edges number: 371811
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.558449268341064  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.4412841796875 GB
    Memory Allocated: 12.55845022201538  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.11959552764892578  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

pseudo mini batch 1 input nodes size: 156528
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.09289169311523438  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.09289169311523438  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.16753005981445312  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.16786909103393555  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.09285736083984375  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.1020822525024414  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.1020822525024414  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.1020822525024414  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([156528, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.1020822525024414  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

m.shape torch.Size([10804, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.5313730239868164  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.5313730239868164  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 10804, 128]), torch.Size([1, 10804, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.5416765213012695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.6267366409301758  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 10804, 128])
m.shape torch.Size([11977, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.6333036422729492  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.6333036422729492  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 11977, 128]), torch.Size([1, 11977, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.6455817222595215  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.8213629722595215  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 11977, 128])
m.shape torch.Size([10833, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.8309803009033203  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.8309803009033203  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 10833, 128]), torch.Size([1, 10833, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 0.8429956436157227  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.0776796340942383  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 10833, 128])
m.shape torch.Size([9486, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.0906071662902832  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.0906071662902832  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 9486, 128]), torch.Size([1, 9486, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.1002960205078125  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.3626461029052734  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 9486, 128])
m.shape torch.Size([8380, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.3781023025512695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.3781023025512695  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 8380, 128]), torch.Size([1, 8380, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.386094093322754  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.6737985610961914  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 8380, 128])
m.shape torch.Size([7061, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.6900043487548828  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.6900043487548828  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 7061, 128]), torch.Size([1, 7061, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.6972789764404297  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 1.9919071197509766  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 7061, 128])
m.shape torch.Size([6283, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.0100245475769043  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.0100245475769043  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 6283, 128]), torch.Size([1, 6283, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.0164237022399902  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.3169665336608887  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 6283, 128])
m.shape torch.Size([5524, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.3354549407958984  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.3354549407958984  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 5524, 128]), torch.Size([1, 5524, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.340799331665039  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.6420207023620605  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 5524, 128])
m.shape torch.Size([4884, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.6608710289001465  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.6608710289001465  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4884, 128]), torch.Size([1, 4884, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.665780544281006  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 2.978853702545166  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4884, 128])
m.shape torch.Size([54397, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 3.236290454864502  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 3.236290454864502  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 54397, 128]), torch.Size([1, 54397, 128])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 3.2881674766540527  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.971436023712158  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 54397, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.591721534729004  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.71534538269043  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.8389692306518555  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.71437931060791  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

torch.Size([129629, 256])
first layer input nodes number: 156528
first layer output nodes number: 129629
edges number: 865566
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.840253829956055  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.9638776779174805  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.994783878326416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 6.994783878326416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

m.shape torch.Size([6756, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.3613457679748535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.3613457679748535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 6756, 256]), torch.Size([1, 6756, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.374231815338135  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.477320194244385  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 6756, 256])
m.shape torch.Size([5809, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.482043743133545  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.482043743133545  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 5809, 256]), torch.Size([1, 5809, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.493294715881348  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.659491539001465  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 5809, 256])
m.shape torch.Size([4614, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.667255878448486  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.667255878448486  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4614, 256]), torch.Size([1, 4614, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.676455020904541  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.872900009155273  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4614, 256])
m.shape torch.Size([3619, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.882413387298584  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.882413387298584  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 3619, 256]), torch.Size([1, 3619, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 7.889323711395264  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.092438697814941  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 3619, 256])
m.shape torch.Size([3156, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.104154109954834  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.104154109954834  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 3156, 256]), torch.Size([1, 3156, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.110605239868164  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.327310562133789  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 3156, 256])
m.shape torch.Size([2452, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.338440895080566  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.338440895080566  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 2452, 256]), torch.Size([1, 2452, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.343544960021973  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.556027889251709  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 2452, 256])
m.shape torch.Size([1934, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.566701412200928  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.566701412200928  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1934, 256]), torch.Size([1, 1934, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.57056188583374  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.760589599609375  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1934, 256])
m.shape torch.Size([1769, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.771878719329834  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.771878719329834  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1769, 256]), torch.Size([1, 1769, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.775254726409912  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.96759557723999  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1769, 256])
m.shape torch.Size([1518, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.979038715362549  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.979038715362549  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1518, 256]), torch.Size([1, 1518, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 8.981983661651611  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.17475414276123  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1518, 256])
m.shape torch.Size([1293, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.185497760772705  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.185497760772705  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1293, 256]), torch.Size([1, 1293, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.188199520111084  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.36751413345337  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1293, 256])
m.shape torch.Size([1096, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.377696514129639  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.377696514129639  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 1096, 256]), torch.Size([1, 1096, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.380303382873535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.561212539672852  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 1096, 256])
m.shape torch.Size([969, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.570700645446777  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.570700645446777  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.572548866271973  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.729804039001465  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([840, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.739375591278076  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.739375591278076  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.740977764129639  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.889903545379639  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([725, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.898858070373535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.898858070373535  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 9.900240898132324  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.039067268371582  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([657, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.047847747802734  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.047847747802734  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.049100875854492  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.182134628295898  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([572, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.190304279327393  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.190304279327393  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.191395282745361  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.314895629882812  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([498, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.322487354278564  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.322487354278564  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.323437213897705  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.44216775894165  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([484, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.450066566467285  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.450066566467285  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.450989723205566  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.568230628967285  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([433, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.575676441192627  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.575676441192627  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 433, 256]), torch.Size([1, 433, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.576502323150635  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.689225673675537  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 433, 256])
m.shape torch.Size([399, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.69648265838623  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.69648265838623  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.697243690490723  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.804581642150879  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([375, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.81177043914795  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.81177043914795  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.812485694885254  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.922109603881836  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([269, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.927440166473389  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.927440166473389  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 10.927953243255615  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.009952068328857  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([270, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.01566457748413  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.01566457748413  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.01617956161499  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.099860668182373  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([251, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.105393409729004  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.105393409729004  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 15.4451904296875 GB
    Memory Allocated: 11.10587215423584  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4471435546875 GB
    Memory Allocated: 11.186779975891113  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([4712, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 11.299761295318604  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 11.299761295318604  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

 h.shape torch.Size([1, 4712, 256]), torch.Size([1, 4712, 256])
----------------------------------------3
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 11.308748722076416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.890535831451416  GigaBytes
Max Memory Allocated: 13.005468368530273  GigaBytes

rst.shape  torch.Size([1, 4712, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.57067346572876  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.577449321746826  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.584225177764893  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.577110290527344  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

torch.Size([45470, 40])
input nodes number: 129629
output nodes number: 45470
edges number: 372439
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.578415393829346  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.4490966796875 GB
    Memory Allocated: 12.578415870666504  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.1187896728515625  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.1187896728515625  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.1187896728515625  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08331716060638428 |0.006154775619506836 |0.18638598918914795 |0.0001093149185180664 |0.14130926132202148 |0.00611567497253418 |
----------------------------------------------------------pseudo_mini_loss sum 4.164255142211914
Total (block generation + training)time/epoch 3.7190208435058594
Training time/epoch 0.9324753284454346
Training time without block to device /epoch 0.9201657772064209
Training time without total dataloading part /epoch 0.6617248058319092
load block tensor time/epoch 0.16663432121276855
block to device time/epoch 0.012309551239013672
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  572491
Number of first layer input nodes during this epoch:  313128
Number of first layer output nodes during this epoch:  259363
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.1187891960144043  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016158103942871094
number of batches is  2
batch size is  45471
range selection method spend 0.012897253036499023
time for parepare:  0.01720881462097168
local_output_nid generation:  0.010513544082641602
local_in_edges_tensor generation:  0.00924825668334961
mini_batch_src_global generation:  0.011557340621948242
r_  generation:  0.1529858112335205
local_output_nid generation:  0.011848688125610352
local_in_edges_tensor generation:  0.005651950836181641
mini_batch_src_global generation:  0.015071630477905273
r_  generation:  0.16402697563171387
----------------------check_connections_block total spend ----------------------------- 0.46119165420532227
generate_one_block  0.18661046028137207
generate_one_block  0.18645262718200684
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018313884735107422
gen group dst list time:  0.007047176361083984
time for parepare:  0.01942300796508789
local_output_nid generation:  0.017078161239624023
local_in_edges_tensor generation:  0.023717880249023438
mini_batch_src_global generation:  0.02518320083618164
r_  generation:  0.3123664855957031
local_output_nid generation:  0.02418994903564453
local_in_edges_tensor generation:  0.022068023681640625
mini_batch_src_global generation:  0.04413270950317383
r_  generation:  0.32035183906555176
----------------------check_connections_block total spend ----------------------------- 0.9483790397644043
generate_one_block  0.39206981658935547
generate_one_block  0.3996763229370117
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.1187891960144043  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

connection checking time:  0.9483790397644043
block generation total time  0.7917461395263672
average batch blocks generation time:  0.3958730697631836
block dataloader generation time/epoch 2.745055079460144
pseudo mini batch 0 input nodes size: 156421
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09285640716552734  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09285640716552734  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.16744375228881836  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.16778278350830078  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09280538558959961  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10223102569580078  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10223102569580078  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10223102569580078  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

torch.Size([156421, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10223102569580078  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

m.shape torch.Size([10886, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.5334296226501465  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.5334296226501465  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 10886, 128]), torch.Size([1, 10886, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.5438113212585449  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6290278434753418  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 10886, 128])
m.shape torch.Size([11941, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6355557441711426  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6355557441711426  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 11941, 128]), torch.Size([1, 11941, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6477775573730469  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8235588073730469  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 11941, 128])
m.shape torch.Size([10796, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8331589698791504  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8331589698791504  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 10796, 128]), torch.Size([1, 10796, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8452086448669434  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0797514915466309  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 10796, 128])
m.shape torch.Size([9444, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0926165580749512  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0926165580749512  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 9444, 128]), torch.Size([1, 9444, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.1022677421569824  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3634562492370605  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 9444, 128])
m.shape torch.Size([8378, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3789277076721191  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3789277076721191  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 8378, 128]), torch.Size([1, 8378, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3869175910949707  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.674553394317627  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 8378, 128])
m.shape torch.Size([7115, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.6909146308898926  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.6909146308898926  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 7115, 128]), torch.Size([1, 7115, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.698194980621338  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.992927074432373  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 7115, 128])
m.shape torch.Size([6244, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.011018753051758  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.011018753051758  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 6244, 128]), torch.Size([1, 6244, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.0174598693847656  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.3164515495300293  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 6244, 128])
m.shape torch.Size([5552, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.334958553314209  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.334958553314209  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 5552, 128]), torch.Size([1, 5552, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.3403830528259277  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6428561210632324  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 5552, 128])
m.shape torch.Size([4916, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6616930961608887  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6616930961608887  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 4916, 128]), torch.Size([1, 4916, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.666469097137451  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.9785056114196777  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 4916, 128])
m.shape torch.Size([54454, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.2355799674987793  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.2355799674987793  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 54454, 128]), torch.Size([1, 54454, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.288480281829834  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.9756083488464355  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 54454, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.595015048980713  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.71873140335083  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.842447757720947  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.717764854431152  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

torch.Size([129726, 256])
first layer input nodes number: 156421
first layer output nodes number: 129726
edges number: 866420
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.843786716461182  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.967503070831299  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.998432159423828  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.998432159423828  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

m.shape torch.Size([6772, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.365081310272217  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.365081310272217  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 6772, 256]), torch.Size([1, 6772, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.377997875213623  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.481330394744873  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 6772, 256])
m.shape torch.Size([5849, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.486115455627441  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.486115455627441  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 5849, 256]), torch.Size([1, 5849, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.497684001922607  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.665025234222412  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 5849, 256])
m.shape torch.Size([4653, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.672863960266113  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.672863960266113  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 4653, 256]), torch.Size([1, 4653, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.681943893432617  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.8779449462890625  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 4653, 256])
m.shape torch.Size([3636, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.887486457824707  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.887486457824707  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 3636, 256]), torch.Size([1, 3636, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.895419120788574  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.097134590148926  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 3636, 256])
m.shape torch.Size([3076, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.108449459075928  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.108449459075928  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 3076, 256]), torch.Size([1, 3076, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.114790439605713  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.326461791992188  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 3076, 256])
m.shape torch.Size([2480, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.337830066680908  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.337830066680908  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 2480, 256]), torch.Size([1, 2480, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.342796802520752  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.55519962310791  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 2480, 256])
m.shape torch.Size([1979, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.565538883209229  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.565538883209229  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 1979, 256]), torch.Size([1, 1979, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.569399356842041  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.764863967895508  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 1979, 256])
m.shape torch.Size([1716, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.775513172149658  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.775513172149658  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 1716, 256]), torch.Size([1, 1716, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.778887271881104  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.967714786529541  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 1716, 256])
m.shape torch.Size([1490, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.979037761688232  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.979037761688232  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 1490, 256]), torch.Size([1, 1490, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.981970310211182  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.175161838531494  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 1490, 256])
m.shape torch.Size([1274, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.185808658599854  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.185808658599854  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 1274, 256]), torch.Size([1, 1274, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.188252925872803  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.365543842315674  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 1274, 256])
m.shape torch.Size([1103, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.375827312469482  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.375827312469482  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 1103, 256]), torch.Size([1, 1103, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.378003597259521  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.554593563079834  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 1103, 256])
m.shape torch.Size([973, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.564209938049316  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.564209938049316  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 973, 256]), torch.Size([1, 973, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.566065788269043  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.730663299560547  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 973, 256])
m.shape torch.Size([845, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.740293502807617  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.740293502807617  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 845, 256]), torch.Size([1, 845, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.741905212402344  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.891796112060547  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 845, 256])
m.shape torch.Size([733, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.900853633880615  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.900853633880615  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.902251720428467  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.041591167449951  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([621, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.049845218658447  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.049845218658447  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.051029682159424  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.183435916900635  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([569, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.191594123840332  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.191594123840332  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.192679405212402  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.315316200256348  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([523, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.3235182762146  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.3235182762146  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.32451581954956  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.445204257965088  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([473, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.45288896560669  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.45288896560669  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.45379114151001  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.569117069244385  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([415, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.576244831085205  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.576244831085205  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.577036380767822  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.6881422996521  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([410, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.69562816619873  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.69562816619873  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.696410179138184  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.81037425994873  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([361, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.817269802093506  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.817269802093506  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.817958354949951  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.921061992645264  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([271, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.926448345184326  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.926448345184326  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.926965236663818  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.011151790618896  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([270, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.016862392425537  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.016862392425537  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.017377376556396  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.101012706756592  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([269, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.10696029663086  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.10696029663086  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.107473373413086  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.19430160522461  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([4710, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.307217597961426  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.307217597961426  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

 h.shape torch.Size([1, 4710, 256]), torch.Size([1, 4710, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.316201210021973  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.897316932678223  GigaBytes
Max Memory Allocated: 13.016331672668457  GigaBytes

rst.shape  torch.Size([1, 4710, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.578835010528564  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.58561086654663  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.592386722564697  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.585271835327148  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

torch.Size([45471, 40])
input nodes number: 129726
output nodes number: 45471
edges number: 371888
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.586577415466309  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 12.586578369140625  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.11986160278320312  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

pseudo mini batch 1 input nodes size: 156620
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09280633926391602  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09280633926391602  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.16748857498168945  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.16782760620117188  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.09290122985839844  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10212516784667969  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10212516784667969  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10212516784667969  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

torch.Size([156620, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.10212516784667969  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

m.shape torch.Size([10898, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.5313549041748047  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.5313549041748047  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 10898, 128]), torch.Size([1, 10898, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.541748046875  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6269874572753906  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 10898, 128])
m.shape torch.Size([11879, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.633509635925293  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.633509635925293  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 11879, 128]), torch.Size([1, 11879, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.6456961631774902  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8214774131774902  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 11879, 128])
m.shape torch.Size([10872, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8310480117797852  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8310480117797852  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 10872, 128]), torch.Size([1, 10872, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 0.8431568145751953  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0779895782470703  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 10872, 128])
m.shape torch.Size([9459, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0908470153808594  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.0908470153808594  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 9459, 128]), torch.Size([1, 9459, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.100541591644287  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.362144947052002  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 9459, 128])
m.shape torch.Size([8401, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3776640892028809  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3776640892028809  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 8401, 128]), torch.Size([1, 8401, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.3856759071350098  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.6741013526916504  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 8401, 128])
m.shape torch.Size([7034, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.6902198791503906  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.6902198791503906  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 7034, 128]), torch.Size([1, 7034, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.697434425354004  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 1.9920010566711426  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 7034, 128])
m.shape torch.Size([6167, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.010131359100342  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.010131359100342  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 6167, 128]), torch.Size([1, 6167, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.016536235809326  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.3116841316223145  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 6167, 128])
m.shape torch.Size([5537, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.330227851867676  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.330227851867676  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 5537, 128]), torch.Size([1, 5537, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.3356237411499023  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.637498378753662  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 5537, 128])
m.shape torch.Size([4880, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6563425064086914  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6563425064086914  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 4880, 128]), torch.Size([1, 4880, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.6611900329589844  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 2.973816394805908  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 4880, 128])
m.shape torch.Size([54474, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.231255054473877  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.231255054473877  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 54474, 128]), torch.Size([1, 54474, 128])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 3.283205509185791  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.9716877937316895  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 54474, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.592005252838135  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.715602397918701  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.839199542999268  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.714636325836182  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

torch.Size([129601, 256])
first layer input nodes number: 156620
first layer output nodes number: 129601
edges number: 865442
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.840527057647705  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.9641242027282715  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.995023727416992  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 6.995023727416992  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

m.shape torch.Size([6656, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.361647129058838  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.361647129058838  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 6656, 256]), torch.Size([1, 6656, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.374342441558838  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.475904941558838  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 6656, 256])
m.shape torch.Size([5857, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.48081636428833  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.48081636428833  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 5857, 256]), torch.Size([1, 5857, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.492066383361816  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.659636497497559  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 5857, 256])
m.shape torch.Size([4624, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.667383670806885  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.667383670806885  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 4624, 256]), torch.Size([1, 4624, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.676958084106445  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.872511386871338  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 4624, 256])
m.shape torch.Size([3684, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.882265090942383  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.882265090942383  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 3684, 256]), torch.Size([1, 3684, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 7.890043258666992  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.094309329986572  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 3684, 256])
m.shape torch.Size([3146, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.10591459274292  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.10591459274292  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 3146, 256]), torch.Size([1, 3146, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.112470626831055  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.329559326171875  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 3146, 256])
m.shape torch.Size([2388, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.340330123901367  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.340330123901367  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 2388, 256]), torch.Size([1, 2388, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.345113754272461  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.544086456298828  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 2388, 256])
m.shape torch.Size([2066, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.555708885192871  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.555708885192871  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 2066, 256]), torch.Size([1, 2066, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.559931755065918  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.75696086883545  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 2066, 256])
m.shape torch.Size([1756, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.768887519836426  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.768887519836426  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 1756, 256]), torch.Size([1, 1756, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.77248477935791  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.978110313415527  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 1756, 256])
m.shape torch.Size([1486, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.989072322845459  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.989072322845459  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 1486, 256]), torch.Size([1, 1486, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 8.992051601409912  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.177783489227295  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 1486, 256])
m.shape torch.Size([1325, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.188964366912842  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.188964366912842  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 1325, 256]), torch.Size([1, 1325, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.191541194915771  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.372726917266846  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 1325, 256])
m.shape torch.Size([1100, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.382988452911377  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.382988452911377  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 1100, 256]), torch.Size([1, 1100, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.385308265686035  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.560070991516113  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 1100, 256])
m.shape torch.Size([964, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.569621562957764  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.569621562957764  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 964, 256]), torch.Size([1, 964, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.571460247039795  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.728719234466553  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 964, 256])
m.shape torch.Size([811, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.737933158874512  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.737933158874512  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 811, 256]), torch.Size([1, 811, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.739480018615723  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.887604713439941  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 811, 256])
m.shape torch.Size([701, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.897154808044434  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.897154808044434  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 9.898491859436035  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.035284996032715  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([668, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.044247150421143  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.044247150421143  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.045521259307861  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.180576801300049  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([542, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.18827486038208  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.18827486038208  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.189308643341064  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.31308889389038  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([507, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.320856094360352  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.320856094360352  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.321823120117188  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.43881607055664  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([475, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.446550369262695  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.446550369262695  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.447456359863281  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.566144943237305  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([421, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.57337999343872  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.57337999343872  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.574182987213135  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.68409013748169  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([397, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.691320419311523  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.691320419311523  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.69207763671875  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.800287246704102  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([356, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.807094097137451  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.807094097137451  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.807773113250732  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.910027027130127  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([285, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.915713787078857  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.915713787078857  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 10.916257381439209  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.001542568206787  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([249, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.006775379180908  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.006775379180908  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.007250308990479  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.08418893814087  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([256, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.089856624603271  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.089856624603271  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 15.4510498046875 GB
    Memory Allocated: 11.090344905853271  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5076904296875 GB
    Memory Allocated: 11.172864437103271  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([4750, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 11.286786556243896  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 11.286786556243896  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

 h.shape torch.Size([1, 4750, 256]), torch.Size([1, 4750, 256])
----------------------------------------3
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 11.295846462249756  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.890471935272217  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

rst.shape  torch.Size([1, 4750, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.571993350982666  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.578769207000732  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.585545063018799  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.57843017578125  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

torch.Size([45470, 40])
input nodes number: 129601
output nodes number: 45470
edges number: 372362
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.579735279083252  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 12.57973575592041  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5115966796875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.5115966796875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.5115966796875 GB
    Memory Allocated: 0.11914348602294922  GigaBytes
Max Memory Allocated: 13.023118019104004  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07060742378234863 |0.005774497985839844 |0.19053411483764648 |9.40561294555664e-05 |0.14169049263000488 |0.005582094192504883 |
----------------------------------------------------------pseudo_mini_loss sum 3.047762632369995
Total (block generation + training)time/epoch 3.6694533824920654
Training time/epoch 0.9158425331115723
Training time without block to device /epoch 0.9042935371398926
Training time without total dataloading part /epoch 0.6702194213867188
load block tensor time/epoch 0.14121484756469727
block to device time/epoch 0.011548995971679688
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  572368
Number of first layer input nodes during this epoch:  313041
Number of first layer output nodes during this epoch:  259327
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)Using backend: pytorch

total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
