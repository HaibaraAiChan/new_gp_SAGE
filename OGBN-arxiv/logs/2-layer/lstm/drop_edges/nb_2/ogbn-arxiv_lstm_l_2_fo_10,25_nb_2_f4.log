[17:41:26] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28387380 edges into 2 parts and get 187366 edge cuts
main start at this time 1651599665.4037585
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02971959114074707
global_2_local spend time (sec) 0.035359859466552734
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005045175552368164
A = g.adjacency_matrix() spent  0.007754802703857422
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08130073547363281
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2949695587158203
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1904480457305908

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366})
Convert a graph into a bidirected graph: 1.210 seconds
Metis partitioning: 4.740 seconds
Split the graph: 3.934 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.940492153167725
44466
46475
total k batches seeds list generation spend  20.569039344787598
after graph partition
graph partition algorithm spend time 20.673213958740234
44466
46475
partition_len_list
[100135, 71416]
shared_neighbor_graph_partition_s0 selection method  spend 20.756948947906494
time for parepare:  0.017110109329223633
local_output_nid generation:  0.004446744918823242
local_in_edges_tensor generation:  0.008804798126220703
mini_batch_src_global generation:  0.02254962921142578
r_  generation:  0.14278149604797363
local_output_nid generation:  0.006191730499267578
local_in_edges_tensor generation:  0.008556365966796875
mini_batch_src_global generation:  0.01931023597717285
r_  generation:  0.13689088821411133
----------------------check_connections_block total spend ----------------------------- 0.4335043430328369
generate_one_block  0.1854846477508545
generate_one_block  0.16379737854003906
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0711212158203125
gen group dst list time:  0.004583835601806641
time for parepare:  0.018970489501953125
local_output_nid generation:  0.011066675186157227
local_in_edges_tensor generation:  0.03586435317993164
mini_batch_src_global generation:  0.02823638916015625
r_  generation:  0.24601340293884277
local_output_nid generation:  0.011613607406616211
local_in_edges_tensor generation:  0.01336526870727539
mini_batch_src_global generation:  0.01723456382751465
r_  generation:  0.15896892547607422
----------------------check_connections_block total spend ----------------------------- 0.6294808387756348
generate_one_block  0.31292152404785156
generate_one_block  0.18418407440185547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.6294808387756348
block generation total time  0.49710559844970703
average batch blocks generation time:  0.24855279922485352
pseudo mini batch 0 input nodes size: 123138
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06149435043334961  GigaBytes
Max Memory Allocated: 0.06149435043334961  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06182575225830078  GigaBytes
Max Memory Allocated: 0.06182575225830078  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06182575225830078  GigaBytes
Max Memory Allocated: 0.06182575225830078  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 0.07029294967651367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 0.07029294967651367  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 0.07029294967651367  GigaBytes

torch.Size([123138, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 0.07029294967651367  GigaBytes

m.shape torch.Size([8769, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4134340286254883  GigaBytes
Max Memory Allocated: 0.4195284843444824  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4134340286254883  GigaBytes
Max Memory Allocated: 0.4195284843444824  GigaBytes

 h.shape torch.Size([1, 8769, 128]), torch.Size([1, 8769, 128])
----------------------------------------3
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.4217967987060547  GigaBytes
Max Memory Allocated: 0.4217967987060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.4912567138671875  GigaBytes
Max Memory Allocated: 0.4954380989074707  GigaBytes

rst.shape  torch.Size([1, 8769, 128])
m.shape torch.Size([8702, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.4954380989074707  GigaBytes
Max Memory Allocated: 0.4956326484680176  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.4954380989074707  GigaBytes
Max Memory Allocated: 0.4956326484680176  GigaBytes

 h.shape torch.Size([1, 8702, 128]), torch.Size([1, 8702, 128])
----------------------------------------3
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5037369728088379  GigaBytes
Max Memory Allocated: 0.5037369728088379  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6282200813293457  GigaBytes
Max Memory Allocated: 0.6365189552307129  GigaBytes

rst.shape  torch.Size([1, 8702, 128])
m.shape torch.Size([7423, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6346893310546875  GigaBytes
Max Memory Allocated: 0.6365189552307129  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6346893310546875  GigaBytes
Max Memory Allocated: 0.6365189552307129  GigaBytes

 h.shape torch.Size([1, 7423, 128]), torch.Size([1, 7423, 128])
----------------------------------------3
 Nvidia-smi: 1.8651123046875 GB
    Memory Allocated: 0.6417975425720215  GigaBytes
Max Memory Allocated: 0.6417975425720215  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.7975382804870605  GigaBytes
Max Memory Allocated: 0.8081569671630859  GigaBytes

rst.shape  torch.Size([1, 7423, 128])
m.shape torch.Size([6373, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.8061542510986328  GigaBytes
Max Memory Allocated: 0.8081569671630859  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.8061542510986328  GigaBytes
Max Memory Allocated: 0.8081569671630859  GigaBytes

 h.shape torch.Size([1, 6373, 128]), torch.Size([1, 6373, 128])
----------------------------------------3
 Nvidia-smi: 2.0487060546875 GB
    Memory Allocated: 0.8130292892456055  GigaBytes
Max Memory Allocated: 0.8130292892456055  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 0.990081787109375  GigaBytes
Max Memory Allocated: 1.002237319946289  GigaBytes

rst.shape  torch.Size([1, 6373, 128])
m.shape torch.Size([5694, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.0007147789001465  GigaBytes
Max Memory Allocated: 1.002237319946289  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.0007147789001465  GigaBytes
Max Memory Allocated: 1.002237319946289  GigaBytes

 h.shape torch.Size([1, 5694, 128]), torch.Size([1, 5694, 128])
----------------------------------------3
 Nvidia-smi: 2.2694091796875 GB
    Memory Allocated: 1.0063581466674805  GigaBytes
Max Memory Allocated: 1.0063581466674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 1.2128806114196777  GigaBytes
Max Memory Allocated: 1.2269816398620605  GigaBytes

rst.shape  torch.Size([1, 5694, 128])
m.shape torch.Size([4811, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 1.224266529083252  GigaBytes
Max Memory Allocated: 1.2269816398620605  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 1.224266529083252  GigaBytes
Max Memory Allocated: 1.2269816398620605  GigaBytes

 h.shape torch.Size([1, 4811, 128]), torch.Size([1, 4811, 128])
----------------------------------------3
 Nvidia-smi: 2.4764404296875 GB
    Memory Allocated: 1.2294526100158691  GigaBytes
Max Memory Allocated: 1.2294526100158691  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.427499771118164  GigaBytes
Max Memory Allocated: 1.4412641525268555  GigaBytes

rst.shape  torch.Size([1, 4811, 128])
m.shape torch.Size([4368, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.4397854804992676  GigaBytes
Max Memory Allocated: 1.4412641525268555  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.4397854804992676  GigaBytes
Max Memory Allocated: 1.4412641525268555  GigaBytes

 h.shape torch.Size([1, 4368, 128]), torch.Size([1, 4368, 128])
----------------------------------------3
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.444162368774414  GigaBytes
Max Memory Allocated: 1.444162368774414  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9373779296875 GB
    Memory Allocated: 1.6610889434814453  GigaBytes
Max Memory Allocated: 1.675668716430664  GigaBytes

rst.shape  torch.Size([1, 4368, 128])
m.shape torch.Size([3961, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.9373779296875 GB
    Memory Allocated: 1.6738452911376953  GigaBytes
Max Memory Allocated: 1.675668716430664  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9373779296875 GB
    Memory Allocated: 1.6738452911376953  GigaBytes
Max Memory Allocated: 1.675668716430664  GigaBytes

 h.shape torch.Size([1, 3961, 128]), torch.Size([1, 3961, 128])
----------------------------------------3
 Nvidia-smi: 2.9373779296875 GB
    Memory Allocated: 1.6776227951049805  GigaBytes
Max Memory Allocated: 1.6776227951049805  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.899183750152588  GigaBytes
Max Memory Allocated: 1.914808750152588  GigaBytes

rst.shape  torch.Size([1, 3961, 128])
m.shape torch.Size([3541, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.9129199981689453  GigaBytes
Max Memory Allocated: 1.914808750152588  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.9129199981689453  GigaBytes
Max Memory Allocated: 1.914808750152588  GigaBytes

 h.shape torch.Size([1, 3541, 128]), torch.Size([1, 3541, 128])
----------------------------------------3
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.916642189025879  GigaBytes
Max Memory Allocated: 1.916642189025879  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4569091796875 GB
    Memory Allocated: 2.1375575065612793  GigaBytes
Max Memory Allocated: 2.1531825065612793  GigaBytes

rst.shape  torch.Size([1, 3541, 128])
m.shape torch.Size([46493, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 2.357567310333252  GigaBytes
Max Memory Allocated: 2.364548683166504  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6795654296875 GB
    Memory Allocated: 2.357567310333252  GigaBytes
Max Memory Allocated: 2.364548683166504  GigaBytes

 h.shape torch.Size([1, 46493, 128]), torch.Size([1, 46493, 128])
----------------------------------------3
 Nvidia-smi: 3.7264404296875 GB
    Memory Allocated: 2.4019064903259277  GigaBytes
Max Memory Allocated: 2.4019064903259277  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.549988269805908  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

rst.shape  torch.Size([1, 46493, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.242973327636719  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.338469505310059  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.433965682983398  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.337723255157471  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

torch.Size([100135, 256])
first layer input nodes number: 123138
first layer output nodes number: 100135
edges number: 690333
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.434885501861572  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.1600341796875 GB
    Memory Allocated: 5.530381679534912  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 5.554462909698486  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 5.554462909698486  GigaBytes
Max Memory Allocated: 5.772644519805908  GigaBytes

m.shape torch.Size([6596, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 5.948326110839844  GigaBytes
Max Memory Allocated: 5.94890022277832  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 5.948326110839844  GigaBytes
Max Memory Allocated: 5.94890022277832  GigaBytes

 h.shape torch.Size([1, 6596, 256]), torch.Size([1, 6596, 256])
----------------------------------------3
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 5.961103439331055  GigaBytes
Max Memory Allocated: 5.961103439331055  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.062594413757324  GigaBytes
Max Memory Allocated: 6.06888484954834  GigaBytes

rst.shape  torch.Size([1, 6596, 256])
m.shape torch.Size([5562, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.0661516189575195  GigaBytes
Max Memory Allocated: 6.06888484954834  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.0661516189575195  GigaBytes
Max Memory Allocated: 6.06888484954834  GigaBytes

 h.shape torch.Size([1, 5562, 256]), torch.Size([1, 5562, 256])
----------------------------------------3
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.078198432922363  GigaBytes
Max Memory Allocated: 6.078198432922363  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.241306781768799  GigaBytes
Max Memory Allocated: 6.251915454864502  GigaBytes

rst.shape  torch.Size([1, 5562, 256])
m.shape torch.Size([4214, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.247770309448242  GigaBytes
Max Memory Allocated: 6.251915454864502  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.247770309448242  GigaBytes
Max Memory Allocated: 6.251915454864502  GigaBytes

 h.shape torch.Size([1, 4214, 256]), torch.Size([1, 4214, 256])
----------------------------------------3
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.256101131439209  GigaBytes
Max Memory Allocated: 6.256101131439209  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.433148384094238  GigaBytes
Max Memory Allocated: 6.445204734802246  GigaBytes

rst.shape  torch.Size([1, 4214, 256])
m.shape torch.Size([3277, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.441728115081787  GigaBytes
Max Memory Allocated: 6.445204734802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.441728115081787  GigaBytes
Max Memory Allocated: 6.445204734802246  GigaBytes

 h.shape torch.Size([1, 3277, 256]), torch.Size([1, 3277, 256])
----------------------------------------3
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.448980331420898  GigaBytes
Max Memory Allocated: 6.448980331420898  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0233154296875 GB
    Memory Allocated: 6.633422374725342  GigaBytes
Max Memory Allocated: 6.645923137664795  GigaBytes

rst.shape  torch.Size([1, 3277, 256])
m.shape torch.Size([2860, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0233154296875 GB
    Memory Allocated: 6.643261432647705  GigaBytes
Max Memory Allocated: 6.645923137664795  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0233154296875 GB
    Memory Allocated: 6.643261432647705  GigaBytes
Max Memory Allocated: 6.645923137664795  GigaBytes

 h.shape torch.Size([1, 2860, 256]), torch.Size([1, 2860, 256])
----------------------------------------3
 Nvidia-smi: 8.0233154296875 GB
    Memory Allocated: 6.64884614944458  GigaBytes
Max Memory Allocated: 6.64884614944458  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 6.856477737426758  GigaBytes
Max Memory Allocated: 6.870149612426758  GigaBytes

rst.shape  torch.Size([1, 2860, 256])
m.shape torch.Size([2155, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 6.866178035736084  GigaBytes
Max Memory Allocated: 6.870149612426758  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 6.866178035736084  GigaBytes
Max Memory Allocated: 6.870149612426758  GigaBytes

 h.shape torch.Size([1, 2155, 256]), torch.Size([1, 2155, 256])
----------------------------------------3
 Nvidia-smi: 8.2362060546875 GB
    Memory Allocated: 6.8703789710998535  GigaBytes
Max Memory Allocated: 6.8703789710998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.050093173980713  GigaBytes
Max Memory Allocated: 7.062424182891846  GigaBytes

rst.shape  torch.Size([1, 2155, 256])
m.shape torch.Size([1753, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.0598320960998535  GigaBytes
Max Memory Allocated: 7.062424182891846  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.0598320960998535  GigaBytes
Max Memory Allocated: 7.062424182891846  GigaBytes

 h.shape torch.Size([1, 1753, 256]), torch.Size([1, 1753, 256])
----------------------------------------3
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.063806056976318  GigaBytes
Max Memory Allocated: 7.063806056976318  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 7.231825351715088  GigaBytes
Max Memory Allocated: 7.243544101715088  GigaBytes

rst.shape  torch.Size([1, 1753, 256])
m.shape torch.Size([1560, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.6463623046875 GB
    Memory Allocated: 7.242148399353027  GigaBytes
Max Memory Allocated: 7.243544101715088  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6463623046875 GB
    Memory Allocated: 7.242148399353027  GigaBytes
Max Memory Allocated: 7.243544101715088  GigaBytes

 h.shape torch.Size([1, 1560, 256]), torch.Size([1, 1560, 256])
----------------------------------------3
 Nvidia-smi: 8.6463623046875 GB
    Memory Allocated: 7.24515438079834  GigaBytes
Max Memory Allocated: 7.24515438079834  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7635498046875 GB
    Memory Allocated: 7.417598724365234  GigaBytes
Max Memory Allocated: 7.429500579833984  GigaBytes

rst.shape  torch.Size([1, 1560, 256])
m.shape torch.Size([1335, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.7635498046875 GB
    Memory Allocated: 7.427468299865723  GigaBytes
Max Memory Allocated: 7.429500579833984  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7635498046875 GB
    Memory Allocated: 7.427468299865723  GigaBytes
Max Memory Allocated: 7.429500579833984  GigaBytes

 h.shape torch.Size([1, 1335, 256]), torch.Size([1, 1335, 256])
----------------------------------------3
 Nvidia-smi: 8.7635498046875 GB
    Memory Allocated: 7.430046081542969  GigaBytes
Max Memory Allocated: 7.430046081542969  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 7.59794282913208  GigaBytes
Max Memory Allocated: 7.60966157913208  GigaBytes

rst.shape  torch.Size([1, 1335, 256])
m.shape torch.Size([1163, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 7.608475208282471  GigaBytes
Max Memory Allocated: 7.60966157913208  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 7.608475208282471  GigaBytes
Max Memory Allocated: 7.60966157913208  GigaBytes

 h.shape torch.Size([1, 1163, 256]), torch.Size([1, 1163, 256])
----------------------------------------3
 Nvidia-smi: 8.9510498046875 GB
    Memory Allocated: 7.610758304595947  GigaBytes
Max Memory Allocated: 7.610758304595947  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0994873046875 GB
    Memory Allocated: 7.7699408531188965  GigaBytes
Max Memory Allocated: 7.7816596031188965  GigaBytes

rst.shape  torch.Size([1, 1163, 256])
m.shape torch.Size([1001, 11, 256])
----------------------------------------1
 Nvidia-smi: 9.0994873046875 GB
    Memory Allocated: 7.779358863830566  GigaBytes
Max Memory Allocated: 7.7816596031188965  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0994873046875 GB
    Memory Allocated: 7.779358863830566  GigaBytes
Max Memory Allocated: 7.7816596031188965  GigaBytes

 h.shape torch.Size([1, 1001, 256]), torch.Size([1, 1001, 256])
----------------------------------------3
 Nvidia-smi: 9.1014404296875 GB
    Memory Allocated: 7.781268119812012  GigaBytes
Max Memory Allocated: 7.7816596031188965  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2420654296875 GB
    Memory Allocated: 7.935427665710449  GigaBytes
Max Memory Allocated: 7.945928573608398  GigaBytes

rst.shape  torch.Size([1, 1001, 256])
m.shape torch.Size([902, 12, 256])
----------------------------------------1
 Nvidia-smi: 9.2420654296875 GB
    Memory Allocated: 7.944876670837402  GigaBytes
Max Memory Allocated: 7.945928573608398  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2420654296875 GB
    Memory Allocated: 7.944876670837402  GigaBytes
Max Memory Allocated: 7.945928573608398  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 9.2420654296875 GB
    Memory Allocated: 7.946597099304199  GigaBytes
Max Memory Allocated: 7.946597099304199  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4158935546875 GB
    Memory Allocated: 8.092833518981934  GigaBytes
Max Memory Allocated: 8.103156089782715  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([775, 13, 256])
----------------------------------------1
 Nvidia-smi: 9.4158935546875 GB
    Memory Allocated: 8.101656913757324  GigaBytes
Max Memory Allocated: 8.103156089782715  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4158935546875 GB
    Memory Allocated: 8.101656913757324  GigaBytes
Max Memory Allocated: 8.103156089782715  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 9.4178466796875 GB
    Memory Allocated: 8.103135108947754  GigaBytes
Max Memory Allocated: 8.103156089782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5819091796875 GB
    Memory Allocated: 8.239129066467285  GigaBytes
Max Memory Allocated: 8.248737335205078  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([643, 14, 256])
----------------------------------------1
 Nvidia-smi: 9.5819091796875 GB
    Memory Allocated: 8.247042179107666  GigaBytes
Max Memory Allocated: 8.248737335205078  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5819091796875 GB
    Memory Allocated: 8.247042179107666  GigaBytes
Max Memory Allocated: 8.248737335205078  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 9.5819091796875 GB
    Memory Allocated: 8.248268604278564  GigaBytes
Max Memory Allocated: 8.248737335205078  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7381591796875 GB
    Memory Allocated: 8.36968469619751  GigaBytes
Max Memory Allocated: 8.378269672393799  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([585, 15, 256])
----------------------------------------1
 Nvidia-smi: 9.7381591796875 GB
    Memory Allocated: 8.377505779266357  GigaBytes
Max Memory Allocated: 8.378269672393799  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7381591796875 GB
    Memory Allocated: 8.377505779266357  GigaBytes
Max Memory Allocated: 8.378269672393799  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 9.7381591796875 GB
    Memory Allocated: 8.378621578216553  GigaBytes
Max Memory Allocated: 8.378621578216553  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8377685546875 GB
    Memory Allocated: 8.49834680557251  GigaBytes
Max Memory Allocated: 8.506715297698975  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([544, 16, 256])
----------------------------------------1
 Nvidia-smi: 9.8377685546875 GB
    Memory Allocated: 8.506154537200928  GigaBytes
Max Memory Allocated: 8.506715297698975  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.8377685546875 GB
    Memory Allocated: 8.506154537200928  GigaBytes
Max Memory Allocated: 8.506715297698975  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 9.8377685546875 GB
    Memory Allocated: 8.507192134857178  GigaBytes
Max Memory Allocated: 8.507192134857178  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9764404296875 GB
    Memory Allocated: 8.628281116485596  GigaBytes
Max Memory Allocated: 8.636581897735596  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([476, 17, 256])
----------------------------------------1
 Nvidia-smi: 9.9764404296875 GB
    Memory Allocated: 8.635540008544922  GigaBytes
Max Memory Allocated: 8.636581897735596  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9764404296875 GB
    Memory Allocated: 8.635540008544922  GigaBytes
Max Memory Allocated: 8.636581897735596  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 9.9764404296875 GB
    Memory Allocated: 8.63644790649414  GigaBytes
Max Memory Allocated: 8.636581897735596  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0858154296875 GB
    Memory Allocated: 8.746448516845703  GigaBytes
Max Memory Allocated: 8.754165649414062  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([494, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.0858154296875 GB
    Memory Allocated: 8.754540920257568  GigaBytes
Max Memory Allocated: 8.754574298858643  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.0858154296875 GB
    Memory Allocated: 8.754540920257568  GigaBytes
Max Memory Allocated: 8.754574298858643  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 10.0877685546875 GB
    Memory Allocated: 8.755483150482178  GigaBytes
Max Memory Allocated: 8.755483150482178  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2225341796875 GB
    Memory Allocated: 8.87857961654663  GigaBytes
Max Memory Allocated: 8.887059688568115  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([446, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.2225341796875 GB
    Memory Allocated: 8.886253356933594  GigaBytes
Max Memory Allocated: 8.887059688568115  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2225341796875 GB
    Memory Allocated: 8.886253356933594  GigaBytes
Max Memory Allocated: 8.887059688568115  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 10.2225341796875 GB
    Memory Allocated: 8.887104034423828  GigaBytes
Max Memory Allocated: 8.887104034423828  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.3201904296875 GB
    Memory Allocated: 9.00568962097168  GigaBytes
Max Memory Allocated: 9.013771057128906  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([416, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.3201904296875 GB
    Memory Allocated: 9.013260841369629  GigaBytes
Max Memory Allocated: 9.013771057128906  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.3201904296875 GB
    Memory Allocated: 9.013260841369629  GigaBytes
Max Memory Allocated: 9.013771057128906  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 10.3201904296875 GB
    Memory Allocated: 9.014054298400879  GigaBytes
Max Memory Allocated: 9.014054298400879  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4530029296875 GB
    Memory Allocated: 9.128159523010254  GigaBytes
Max Memory Allocated: 9.136094093322754  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([388, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.4530029296875 GB
    Memory Allocated: 9.135594367980957  GigaBytes
Max Memory Allocated: 9.136094093322754  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4530029296875 GB
    Memory Allocated: 9.135594367980957  GigaBytes
Max Memory Allocated: 9.136094093322754  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 10.4549560546875 GB
    Memory Allocated: 9.136334419250488  GigaBytes
Max Memory Allocated: 9.136334419250488  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5682373046875 GB
    Memory Allocated: 9.247830390930176  GigaBytes
Max Memory Allocated: 9.255600929260254  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([288, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.5682373046875 GB
    Memory Allocated: 9.253550052642822  GigaBytes
Max Memory Allocated: 9.255600929260254  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5682373046875 GB
    Memory Allocated: 9.253550052642822  GigaBytes
Max Memory Allocated: 9.255600929260254  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 10.5682373046875 GB
    Memory Allocated: 9.254099369049072  GigaBytes
Max Memory Allocated: 9.255600929260254  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5760498046875 GB
    Memory Allocated: 9.347474575042725  GigaBytes
Max Memory Allocated: 9.353517055511475  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([272, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.5760498046875 GB
    Memory Allocated: 9.353212833404541  GigaBytes
Max Memory Allocated: 9.353517055511475  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5760498046875 GB
    Memory Allocated: 9.353212833404541  GigaBytes
Max Memory Allocated: 9.353517055511475  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 10.5780029296875 GB
    Memory Allocated: 9.353731632232666  GigaBytes
Max Memory Allocated: 9.353731632232666  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6678466796875 GB
    Memory Allocated: 9.441093921661377  GigaBytes
Max Memory Allocated: 9.447060108184814  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([287, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6678466796875 GB
    Memory Allocated: 9.447454929351807  GigaBytes
Max Memory Allocated: 9.44748067855835  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6678466796875 GB
    Memory Allocated: 9.447454929351807  GigaBytes
Max Memory Allocated: 9.44748067855835  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 10.6697998046875 GB
    Memory Allocated: 9.448002338409424  GigaBytes
Max Memory Allocated: 9.448002338409424  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7811279296875 GB
    Memory Allocated: 9.544531345367432  GigaBytes
Max Memory Allocated: 9.551100254058838  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([6474, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.69981575012207  GigaBytes
Max Memory Allocated: 9.700418949127197  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.69981575012207  GigaBytes
Max Memory Allocated: 9.700418949127197  GigaBytes

 h.shape torch.Size([1, 6474, 256]), torch.Size([1, 6474, 256])
----------------------------------------3
 Nvidia-smi: 10.9393310546875 GB
    Memory Allocated: 9.712163925170898  GigaBytes
Max Memory Allocated: 9.712163925170898  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.93751335144043  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6474, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.588683605194092  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.595866680145264  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.602492809295654  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.594978332519531  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([44466, 40])
input nodes number: 100135
output nodes number: 44466
edges number: 400743
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.602682113647461  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3514404296875 GB
    Memory Allocated: 11.602683067321777  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.0945591926574707  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

pseudo mini batch 1 input nodes size: 92620
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.07122802734375  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.07122802734375  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.11539268493652344  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.11573934555053711  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.05669116973876953  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([92620, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.06229877471923828  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([8803, 1, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.2672586441040039  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.2672586441040039  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8803, 128]), torch.Size([1, 8803, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.2756538391113281  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.34517860412597656  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8803, 128])
m.shape torch.Size([8788, 2, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.3493618965148926  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.3493618965148926  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8788, 128]), torch.Size([1, 8788, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.35774993896484375  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.4883613586425781  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8788, 128])
m.shape torch.Size([7582, 3, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.49588966369628906  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.49588966369628906  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 7582, 128]), torch.Size([1, 7582, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.5036954879760742  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.6653900146484375  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 7582, 128])
m.shape torch.Size([6328, 4, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.6746797561645508  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.6746797561645508  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6328, 128]), torch.Size([1, 6328, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.6810665130615234  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.8588824272155762  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6328, 128])
m.shape torch.Size([5308, 5, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.8685202598571777  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.8685202598571777  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5308, 128]), torch.Size([1, 5308, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 0.8740687370300293  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.0569262504577637  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5308, 128])
m.shape torch.Size([4401, 6, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.0669865608215332  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.0669865608215332  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4401, 128]), torch.Size([1, 4401, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.071183681488037  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.255608081817627  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4401, 128])
m.shape torch.Size([3750, 7, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.266026496887207  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.266026496887207  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3750, 128]), torch.Size([1, 3750, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.2702264785766602  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.4495182037353516  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3750, 128])
m.shape torch.Size([3208, 8, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.4599676132202148  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.4599676132202148  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3208, 128]), torch.Size([1, 3208, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.4631567001342773  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.6387701034545898  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3208, 128])
m.shape torch.Size([2734, 9, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.6489009857177734  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.6489009857177734  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2734, 128]), torch.Size([1, 2734, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.6518349647521973  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.8238768577575684  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2734, 128])
m.shape torch.Size([20514, 10, 128])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.92039155960083  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.92039155960083  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 20514, 128]), torch.Size([1, 20514, 128])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 1.939955234527588  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.3289761543273926  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 20514, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.1551294326782227  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.2232370376586914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.29134464263916  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.2227048873901367  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([71416, 256])
first layer input nodes number: 92620
first layer output nodes number: 71416
edges number: 409043
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.292037010192871  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.36014461517334  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.377171516418457  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.377171516418457  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([6832, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.7156782150268555  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.7156782150268555  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6832, 256]), torch.Size([1, 6832, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.7287092208862305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.8329572677612305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6832, 256])
m.shape torch.Size([6144, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.838252067565918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.838252067565918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6144, 256]), torch.Size([1, 6144, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 3.849970817565918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.025752067565918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6144, 256])
m.shape torch.Size([5063, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.034491539001465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.034491539001465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5063, 256]), torch.Size([1, 5063, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.04448127746582  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.25932502746582  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5063, 256])
m.shape torch.Size([4043, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.269822597503662  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.269822597503662  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4043, 256]), torch.Size([1, 4043, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.277596950531006  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.501687526702881  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4043, 256])
m.shape torch.Size([3362, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.513954162597656  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.513954162597656  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3362, 256]), torch.Size([1, 3362, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.520421981811523  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.760663032531738  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3362, 256])
m.shape torch.Size([2713, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.77280855178833  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.77280855178833  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2713, 256]), torch.Size([1, 2713, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 4.778703689575195  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.001643180847168  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2713, 256])
m.shape torch.Size([2292, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.014476299285889  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.014476299285889  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2292, 256]), torch.Size([1, 2292, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.01946496963501  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.247533321380615  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2292, 256])
m.shape torch.Size([1912, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.260048866271973  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.260048866271973  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1912, 256]), torch.Size([1, 1912, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.263827323913574  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.472651481628418  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1912, 256])
m.shape torch.Size([1641, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.485023021697998  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.485023021697998  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1641, 256]), torch.Size([1, 1641, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.4882283210754395  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.700655937194824  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1641, 256])
m.shape torch.Size([1436, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.712893009185791  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.712893009185791  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1436, 256]), torch.Size([1, 1436, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.715789318084717  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.914749622344971  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1436, 256])
m.shape torch.Size([1202, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.925729751586914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.925729751586914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 5.928056716918945  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.110135078430176  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([1035, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.1207756996154785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.1207756996154785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1035, 256]), torch.Size([1, 1035, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.122808933258057  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.2960333824157715  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1035, 256])
m.shape torch.Size([881, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.30605411529541  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.30605411529541  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.307734489440918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.465937614440918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([791, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.475741386413574  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.475741386413574  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.477250099182129  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.627009391784668  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([704, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.636404514312744  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.636404514312744  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.637747287750244  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.784203052520752  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([567, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.792251110076904  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.792251110076904  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.793332576751709  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.915862560272217  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([554, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.924374103546143  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.924374103546143  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 6.925430774688721  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.0547871589660645  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([454, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.062113285064697  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.062113285064697  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.062979221343994  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.1755805015563965  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([390, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.18226957321167  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.18226957321167  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.183013439178467  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.283454418182373  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([391, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.2905988693237305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.2905988693237305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.29134464263916  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.397212028503418  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([329, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.40347957611084  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.40347957611084  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.404107093811035  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.500126838684082  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([268, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.5054802894592285  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.5054802894592285  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.505991458892822  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.5863261222839355  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([247, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.591530799865723  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.591530799865723  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 14.1248779296875 GB
    Memory Allocated: 7.592001914978027  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1287841796875 GB
    Memory Allocated: 7.668322563171387  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([238, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.1287841796875 GB
    Memory Allocated: 7.673577308654785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1287841796875 GB
    Memory Allocated: 7.673577308654785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 14.1287841796875 GB
    Memory Allocated: 7.6740312576293945  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2108154296875 GB
    Memory Allocated: 7.750748634338379  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([2986, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 7.822269916534424  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 7.822269916534424  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2986, 256]), torch.Size([1, 2986, 256])
----------------------------------------3
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 7.827965259552002  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.842278957366943  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2986, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.553814888000488  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.56074047088623  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.567666053771973  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.560393810272217  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes
[17:41:52] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28447620 edges into 2 parts and get 180353 edge cuts

torch.Size([46475, 40])
input nodes number: 71416
output nodes number: 46475
edges number: 343507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.561572074890137  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2127685546875 GB
    Memory Allocated: 8.561572551727295  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.07440328598022461  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.07995367050170898  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.07995367050170898  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07489025592803955 |0.17029011249542236 |0.4427151679992676 |0.00018548965454101562 |0.13902509212493896 |0.01022195816040039 |
----------------------------------------------------------pseudo_mini_loss sum 5.307546615600586
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  387309
Number of first layer input nodes during this epoch:  215758
Number of first layer output nodes during this epoch:  171551
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.07995319366455078  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01609516143798828
global_2_local spend time (sec) 0.04146575927734375
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004580974578857422
A = g.adjacency_matrix() spent  0.0076122283935546875
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07708382606506348
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3515653610229492
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1892099380493164

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432})
Convert a graph into a bidirected graph: 1.330 seconds
Metis partitioning: 5.070 seconds
Split the graph: 4.642 seconds
Construct subgraphs: 0.054 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  11.109737634658813
45471
45470
total k batches seeds list generation spend  22.39153814315796
after graph partition
graph partition algorithm spend time 22.51327657699585
45471
45470
partition_len_list
[68870, 101284]
shared_neighbor_graph_partition_s0 selection method  spend 22.614459991455078
time for parepare:  0.01833367347717285
local_output_nid generation:  0.004643917083740234
local_in_edges_tensor generation:  0.006012439727783203
mini_batch_src_global generation:  0.011305809020996094
r_  generation:  0.12088537216186523
local_output_nid generation:  0.008165836334228516
local_in_edges_tensor generation:  0.012073278427124023
mini_batch_src_global generation:  0.01799154281616211
r_  generation:  0.16589999198913574
----------------------check_connections_block total spend ----------------------------- 0.44553613662719727
generate_one_block  0.16908764839172363
generate_one_block  0.22696590423583984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04535484313964844
gen group dst list time:  0.0056304931640625
time for parepare:  0.023346900939941406
local_output_nid generation:  0.008444547653198242
local_in_edges_tensor generation:  0.025664091110229492
mini_batch_src_global generation:  0.022154569625854492
r_  generation:  0.15456056594848633
local_output_nid generation:  0.01780867576599121
local_in_edges_tensor generation:  0.020255088806152344
mini_batch_src_global generation:  0.028789758682250977
r_  generation:  0.26903676986694336
----------------------check_connections_block total spend ----------------------------- 0.6669113636016846
generate_one_block  0.18922877311706543
generate_one_block  0.3350090980529785
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.07995319366455078  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

connection checking time:  0.6669113636016846
block generation total time  0.524237871170044
average batch blocks generation time:  0.262118935585022
block dataloader generation time/epoch 24.816843032836914
pseudo mini batch 0 input nodes size: 87494
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06254005432128906  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06254005432128906  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.10426044464111328  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.1045994758605957  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.060088157653808594  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06543540954589844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06543540954589844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06543540954589844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([87494, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.06543540954589844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([8759, 1, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.2611966133117676  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.2611966133117676  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8759, 128]), torch.Size([1, 8759, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.2695498466491699  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.3389906883239746  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8759, 128])
m.shape torch.Size([8659, 2, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.34307193756103516  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.34307193756103516  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8659, 128]), torch.Size([1, 8659, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.3513298034667969  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.47519779205322266  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8659, 128])
m.shape torch.Size([7440, 3, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.48171186447143555  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.48171186447143555  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 7440, 128]), torch.Size([1, 7440, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.4893016815185547  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.6458935737609863  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 7440, 128])
m.shape torch.Size([6167, 4, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.6541085243225098  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.6541085243225098  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6167, 128]), torch.Size([1, 6167, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.6608395576477051  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.8340377807617188  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6167, 128])
m.shape torch.Size([5189, 5, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.8434686660766602  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.8434686660766602  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5189, 128]), torch.Size([1, 5189, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 0.8493061065673828  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.0283451080322266  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5189, 128])
m.shape torch.Size([4213, 6, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.0379242897033691  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.0379242897033691  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4213, 128]), torch.Size([1, 4213, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.0419421195983887  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.2149310111999512  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4213, 128])
m.shape torch.Size([3589, 7, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.2249016761779785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.2249016761779785  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3589, 128]), torch.Size([1, 3589, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.2284889221191406  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.403970718383789  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3589, 128])
m.shape torch.Size([3120, 8, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.4139633178710938  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.4139633178710938  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3120, 128]), torch.Size([1, 3120, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.4169769287109375  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.5889077186584473  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3120, 128])
m.shape torch.Size([2611, 9, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.5984344482421875  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.5984344482421875  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2611, 128]), torch.Size([1, 2611, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.6010351181030273  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.7734990119934082  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2611, 128])
m.shape torch.Size([19123, 10, 128])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.8627753257751465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.8627753257751465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 19123, 128]), torch.Size([1, 19123, 128])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 1.8810124397277832  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.176492214202881  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 19123, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.0123324394226074  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.078011989593506  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.1436915397644043  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.077498435974121  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([68870, 256])
first layer input nodes number: 87494
first layer output nodes number: 68870
edges number: 389100
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.144345760345459  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.2100253105163574  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.226445198059082  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.226445198059082  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([6845, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.550602436065674  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.550602436065674  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6845, 256]), torch.Size([1, 6845, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.5636582374572754  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.668304920196533  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6845, 256])
m.shape torch.Size([6147, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.673593521118164  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.673593521118164  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6147, 256]), torch.Size([1, 6147, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.6853179931640625  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.8646697998046875  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6147, 256])
m.shape torch.Size([5024, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.873293876647949  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.873293876647949  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5024, 256]), torch.Size([1, 5024, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 3.883525848388672  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.099010944366455  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5024, 256])
m.shape torch.Size([3978, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.109147071838379  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.109147071838379  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3978, 256]), torch.Size([1, 3978, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.116921424865723  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.341911792755127  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3978, 256])
m.shape torch.Size([3306, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.353443145751953  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.353443145751953  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3306, 256]), torch.Size([1, 3306, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.360556125640869  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.588175296783447  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3306, 256])
m.shape torch.Size([2653, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.59970760345459  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.59970760345459  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2653, 256]), torch.Size([1, 2653, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.605297565460205  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.824475288391113  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2653, 256])
m.shape torch.Size([2233, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.836968898773193  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.836968898773193  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2233, 256]), torch.Size([1, 2233, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 4.841687202453613  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.073565483093262  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2233, 256])
m.shape torch.Size([1888, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.08592414855957  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.08592414855957  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1888, 256]), torch.Size([1, 1888, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.089604377746582  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.298116207122803  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1888, 256])
m.shape torch.Size([1599, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.309854507446289  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.309854507446289  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1599, 256]), torch.Size([1, 1599, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.313295364379883  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.520087242126465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1599, 256])
m.shape torch.Size([1401, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.531546115875244  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.531546115875244  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1401, 256]), torch.Size([1, 1401, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.534348964691162  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.73291540145874  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1401, 256])
m.shape torch.Size([1176, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.743186950683594  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.743186950683594  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1176, 256]), torch.Size([1, 1176, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.745485305786133  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.9284210205078125  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1176, 256])
m.shape torch.Size([987, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.938218116760254  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.938218116760254  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 987, 256]), torch.Size([1, 987, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 5.94010066986084  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.105648994445801  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 987, 256])
m.shape torch.Size([855, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.115390777587891  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.115390777587891  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.117021560668945  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.267053604125977  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([750, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.276330471038818  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.276330471038818  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 750, 256]), torch.Size([1, 750, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.277760982513428  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.423020839691162  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 750, 256])
m.shape torch.Size([665, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.4318928718566895  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.4318928718566895  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 665, 256]), torch.Size([1, 665, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.43316125869751  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.568258762359619  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 665, 256])
m.shape torch.Size([524, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.575682640075684  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.575682640075684  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.576682090759277  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.691924095153809  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([515, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.699839115142822  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.699839115142822  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.700821399688721  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.818695545196533  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([435, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.825730323791504  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.825730323791504  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.826560020446777  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.934551239013672  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([372, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.940929889678955  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.940929889678955  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 6.941639423370361  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.0379719734191895  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([366, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.044652938842773  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.044652938842773  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.045351028442383  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.143781661987305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([319, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.149871349334717  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.149871349334717  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.150479793548584  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.24263334274292  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([256, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.247742176055908  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.247742176055908  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.248230457305908  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.323914051055908  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([236, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.328886985778809  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.328886985778809  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.329337120056152  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.40225887298584  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([221, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.407131671905518  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.407131671905518  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 14.2166748046875 GB
    Memory Allocated: 7.407553195953369  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2889404296875 GB
    Memory Allocated: 7.478790760040283  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([2720, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 7.543936729431152  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 7.543936729431152  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2720, 256]), torch.Size([1, 2720, 256])
----------------------------------------3
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 7.549124717712402  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.464407920837402  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2720, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.188947677612305  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.195723533630371  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.202499389648438  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.195384502410889  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([45471, 40])
input nodes number: 68870
output nodes number: 45471
edges number: 328497
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.19608736038208  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 8.196088314056396  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.07663774490356445  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

pseudo mini batch 1 input nodes size: 124472
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.05993938446044922  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.05993938446044922  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.1192922592163086  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.11963129043579102  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.07757186889648438  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.08672380447387695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.08672380447387695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.08672380447387695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([124472, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.08672380447387695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([8778, 1, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.4341750144958496  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.4341750144958496  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8778, 128]), torch.Size([1, 8778, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.44254636764526367  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.5120234489440918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8778, 128])
m.shape torch.Size([8718, 2, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.5161519050598145  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.5161519050598145  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 8718, 128]), torch.Size([1, 8718, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.5244660377502441  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.6548771858215332  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 8718, 128])
m.shape torch.Size([7429, 3, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.6613473892211914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.6613473892211914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 7429, 128]), torch.Size([1, 7429, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.6687736511230469  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.8255939483642578  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 7429, 128])
m.shape torch.Size([6393, 4, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.8342452049255371  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.8342452049255371  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6393, 128]), torch.Size([1, 6393, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 0.840939998626709  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.0196385383605957  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6393, 128])
m.shape torch.Size([5713, 5, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.0302619934082031  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.0302619934082031  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5713, 128]), torch.Size([1, 5713, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.035883903503418  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.2433619499206543  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5713, 128])
m.shape torch.Size([4871, 6, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.2545738220214844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.2545738220214844  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4871, 128]), torch.Size([1, 4871, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.2596206665039062  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.4612703323364258  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4871, 128])
m.shape torch.Size([4386, 7, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.4735875129699707  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.4735875129699707  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4386, 128]), torch.Size([1, 4386, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.4777703285217285  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.6947054862976074  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4386, 128])
m.shape torch.Size([3960, 8, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.7077202796936035  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.7077202796936035  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3960, 128]), torch.Size([1, 3960, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.7117466926574707  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.9356799125671387  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3960, 128])
m.shape torch.Size([3612, 9, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.9486441612243652  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.9486441612243652  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3612, 128]), torch.Size([1, 3612, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 1.9529051780700684  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 2.1771063804626465  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3612, 128])
m.shape torch.Size([47424, 10, 128])
----------------------------------------1
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 2.401519298553467  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 2.401519298553467  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 47424, 128]), torch.Size([1, 47424, 128])
----------------------------------------3
 Nvidia-smi: 14.2947998046875 GB
    Memory Allocated: 2.448394298553467  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.677642345428467  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 47424, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.363534450531006  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.4601263999938965  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.556718349456787  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.459371566772461  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

torch.Size([101284, 256])
first layer input nodes number: 124472
first layer output nodes number: 101284
edges number: 700994
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.557647705078125  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.654239654541016  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.678387641906738  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.8065185546875 GB
    Memory Allocated: 5.678387641906738  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

m.shape torch.Size([6583, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.086152076721191  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.086152076721191  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 6583, 256]), torch.Size([1, 6583, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.099640846252441  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.201622009277344  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 6583, 256])
m.shape torch.Size([5559, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.2053327560424805  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.2053327560424805  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 5559, 256]), torch.Size([1, 5559, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.2168378829956055  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.378588676452637  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 5559, 256])
m.shape torch.Size([4253, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.385099411010742  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.385099411010742  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 4253, 256]), torch.Size([1, 4253, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.393441200256348  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.574512481689453  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 4253, 256])
m.shape torch.Size([3342, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.582417011260986  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.582417011260986  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 3342, 256]), torch.Size([1, 3342, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.58903169631958  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.775084495544434  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 3342, 256])
m.shape torch.Size([2916, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.785910606384277  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.785910606384277  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2916, 256]), torch.Size([1, 2916, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.7917399406433105  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 6.992476940155029  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2916, 256])
m.shape torch.Size([2215, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.002469539642334  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.002469539642334  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 2215, 256]), torch.Size([1, 2215, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.006864070892334  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.194929122924805  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 2215, 256])
m.shape torch.Size([1812, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.2043962478637695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.2043962478637695  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1812, 256]), torch.Size([1, 1812, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.208183288574219  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.382250785827637  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1812, 256])
m.shape torch.Size([1584, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.39323616027832  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.39323616027832  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1584, 256]), torch.Size([1, 1584, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.396432876586914  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.576144218444824  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1584, 256])
m.shape torch.Size([1377, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.586544990539551  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.586544990539551  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1377, 256]), torch.Size([1, 1377, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.589230537414551  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.758452415466309  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1377, 256])
m.shape torch.Size([1198, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.768563270568848  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.768563270568848  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1198, 256]), torch.Size([1, 1198, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.7709503173828125  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.937751293182373  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1198, 256])
m.shape torch.Size([1027, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.947131156921387  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.947131156921387  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 1027, 256]), torch.Size([1, 1027, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 7.949091911315918  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.111649990081787  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 1027, 256])
m.shape torch.Size([950, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.121111869812012  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.121111869812012  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.122923851013184  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.280173301696777  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([801, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.289275646209717  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.289275646209717  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 801, 256]), torch.Size([1, 801, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.2908034324646  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.431840419769287  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 801, 256])
m.shape torch.Size([684, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.440280437469482  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.440280437469482  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.441585063934326  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.570743083953857  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([624, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.579087257385254  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.579087257385254  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.580277442932129  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.708878517150879  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([587, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.717310428619385  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.717310428619385  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.718430042266846  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.845059871673584  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([515, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.852914810180664  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.852914810180664  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.853897094726562  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.972306251525879  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([513, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.980690479278564  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.980690479278564  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 8.981668949127197  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.106844425201416  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([464, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.11482858657837  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.11482858657837  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.115713596343994  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.236478328704834  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([441, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.244513034820557  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.244513034820557  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.245354175567627  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.364542484283447  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([398, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.37215518951416  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.37215518951416  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.37291431427002  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.486296653747559  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([300, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.492260932922363  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.492260932922363  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.492833137512207  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.58813190460205  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([283, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.594101905822754  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.594101905822754  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.59464168548584  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.682962417602539  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([304, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.689704895019531  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.689704895019531  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.690284729003906  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2049560546875 GB
    Memory Allocated: 9.792182922363281  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([6740, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 9.953842639923096  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 9.953842639923096  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes
[17:42:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28452268 edges into 2 parts and get 222580 edge cuts

 h.shape torch.Size([1, 6740, 256]), torch.Size([1, 6740, 256])
----------------------------------------3
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 9.966698169708252  GigaBytes
Max Memory Allocated: 12.091865539550781  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 12.231255054473877  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6740, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.869073390960693  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.87584924697876  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.883293628692627  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.876178741455078  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([45470, 40])
input nodes number: 101284
output nodes number: 45470
edges number: 415753
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.877272605895996  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.5291748046875 GB
    Memory Allocated: 11.877273082733154  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10225582122802734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10225582122802734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10225582122802734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04810929298400879 |0.004821896553039551 |0.1722015142440796 |0.00011265277862548828 |0.16167867183685303 |0.004652738571166992 |
----------------------------------------------------------pseudo_mini_loss sum 4.274306297302246
Total (block generation + training)time/epoch 25.636720418930054
Training time/epoch 0.819584846496582
Training time without block to device /epoch 0.8099410533905029
Training time without total dataloading part /epoch 0.6726384162902832
load block tensor time/epoch 0.09621858596801758
block to device time/epoch 0.009643793106079102
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  382120
Number of first layer input nodes during this epoch:  211966
Number of first layer output nodes during this epoch:  170154
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10225534439086914  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.020123720169067383
global_2_local spend time (sec) 0.0433809757232666
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004526615142822266
A = g.adjacency_matrix() spent  0.011617422103881836
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0794064998626709
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3859989643096924
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1824097633361816

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f4

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096})
Convert a graph into a bidirected graph: 1.286 seconds
Metis partitioning: 5.025 seconds
Split the graph: 4.107 seconds
Construct subgraphs: 0.064 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.496436595916748
46473
44468
total k batches seeds list generation spend  21.833271741867065
after graph partition
graph partition algorithm spend time 21.937705755233765
46473
44468
partition_len_list
[71476, 102641]
shared_neighbor_graph_partition_s0 selection method  spend 22.03421926498413
time for parepare:  0.017706871032714844
local_output_nid generation:  0.004935741424560547
local_in_edges_tensor generation:  0.006000518798828125
mini_batch_src_global generation:  0.01100778579711914
r_  generation:  0.12174606323242188
local_output_nid generation:  0.006144046783447266
local_in_edges_tensor generation:  0.009706497192382812
mini_batch_src_global generation:  0.01504373550415039
r_  generation:  0.14548349380493164
----------------------check_connections_block total spend ----------------------------- 0.40173935890197754
generate_one_block  0.16899943351745605
generate_one_block  0.18773198127746582
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05305624008178711
gen group dst list time:  0.005365610122680664
time for parepare:  0.02282238006591797
local_output_nid generation:  0.00896906852722168
local_in_edges_tensor generation:  0.019138574600219727
mini_batch_src_global generation:  0.01574850082397461
r_  generation:  0.15907716751098633
local_output_nid generation:  0.015348434448242188
local_in_edges_tensor generation:  0.023879528045654297
mini_batch_src_global generation:  0.024562835693359375
r_  generation:  0.27258896827697754
----------------------check_connections_block total spend ----------------------------- 0.6566615104675293
generate_one_block  0.1970057487487793
generate_one_block  0.3323638439178467
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10225534439086914  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

connection checking time:  0.6566615104675293
block generation total time  0.529369592666626
average batch blocks generation time:  0.264684796333313
block dataloader generation time/epoch 24.48196804523468
pseudo mini batch 0 input nodes size: 91452
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.07757091522216797  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.07757091522216797  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.12117862701416016  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.12152528762817383  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.06183338165283203  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.06745147705078125  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.06745147705078125  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.06745147705078125  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([91452, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.06745147705078125  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

m.shape torch.Size([8824, 1, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.27261924743652344  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.27261924743652344  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 8824, 128]), torch.Size([1, 8824, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.2810344696044922  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.3505992889404297  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 8824, 128])
m.shape torch.Size([8813, 2, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.3547964096069336  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.3547964096069336  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 8813, 128]), torch.Size([1, 8813, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.3632063865661621  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.49388933181762695  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 8813, 128])
m.shape torch.Size([7539, 3, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5014057159423828  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5014057159423828  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 7539, 128]), torch.Size([1, 7539, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5092029571533203  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6701798439025879  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 7539, 128])
m.shape torch.Size([6348, 4, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6786928176879883  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6786928176879883  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6348, 128]), torch.Size([1, 6348, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6850461959838867  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8631610870361328  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6348, 128])
m.shape torch.Size([5323, 5, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8728251457214355  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8728251457214355  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 5323, 128]), torch.Size([1, 5323, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8783903121948242  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.0617294311523438  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 5323, 128])
m.shape torch.Size([4372, 6, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.071699619293213  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.071699619293213  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4372, 128]), torch.Size([1, 4372, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.075869083404541  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.259657382965088  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4372, 128])
m.shape torch.Size([3721, 7, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2699928283691406  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2699928283691406  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 3721, 128]), torch.Size([1, 3721, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2741851806640625  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.452591896057129  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 3721, 128])
m.shape torch.Size([3256, 8, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.46323823928833  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.46323823928833  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 3256, 128]), torch.Size([1, 3256, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.4663662910461426  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.6507821083068848  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 3256, 128])
m.shape torch.Size([2756, 9, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.661043643951416  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.661043643951416  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2756, 128]), torch.Size([1, 2756, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.66404390335083  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.8358240127563477  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2756, 128])
m.shape torch.Size([20524, 10, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.9323759078979492  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.9323759078979492  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 20524, 128]), torch.Size([1, 20524, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.951949119567871  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.341647148132324  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 20524, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.167503833770752  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.235668659210205  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.303833484649658  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.235136032104492  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([71476, 256])
first layer input nodes number: 91452
first layer output nodes number: 71476
edges number: 409445
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.3045167922973633  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.3726816177368164  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.3897228240966797  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.3897228240966797  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

m.shape torch.Size([6784, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.730257511138916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.730257511138916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6784, 256]), torch.Size([1, 6784, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.743196964263916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.846712589263916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6784, 256])
m.shape torch.Size([6150, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.852065086364746  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.852065086364746  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6150, 256]), torch.Size([1, 6150, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 3.863795280456543  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.039748191833496  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6150, 256])
m.shape torch.Size([5025, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.048372268676758  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.048372268676758  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 5025, 256]), torch.Size([1, 5025, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.058411598205566  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.272892951965332  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 5025, 256])
m.shape torch.Size([4045, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.283289432525635  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.283289432525635  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4045, 256]), torch.Size([1, 4045, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.291048526763916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.516539096832275  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4045, 256])
m.shape torch.Size([3340, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.528489112854004  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.528489112854004  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 3340, 256]), torch.Size([1, 3340, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.535038948059082  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.772528648376465  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 3340, 256])
m.shape torch.Size([2680, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.784379005432129  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.784379005432129  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2680, 256]), torch.Size([1, 2680, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 4.790345191955566  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.011115074157715  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2680, 256])
m.shape torch.Size([2287, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.023946285247803  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.023946285247803  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2287, 256]), torch.Size([1, 2287, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.028883457183838  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.2588396072387695  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2287, 256])
m.shape torch.Size([1967, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.271796226501465  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.271796226501465  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1967, 256]), torch.Size([1, 1967, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.275656700134277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.4934892654418945  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1967, 256])
m.shape torch.Size([1647, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.505087852478027  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.505087852478027  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1647, 256]), torch.Size([1, 1647, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.5083746910095215  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.7204909324646  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1647, 256])
m.shape torch.Size([1461, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.732962608337402  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.732962608337402  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1461, 256]), torch.Size([1, 1461, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.735935211181641  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.9345245361328125  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1461, 256])
m.shape torch.Size([1231, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.946146011352539  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.946146011352539  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1231, 256]), torch.Size([1, 1231, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.948637008666992  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.139476776123047  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1231, 256])
m.shape torch.Size([1037, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.15026330947876  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.15026330947876  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1037, 256]), torch.Size([1, 1037, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.152267932891846  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.325331211090088  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1037, 256])
m.shape torch.Size([896, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.33479642868042  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.33479642868042  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.33650541305542  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.495471477508545  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([792, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.505274295806885  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.505274295806885  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.506784915924072  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.656336307525635  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([685, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.665456771850586  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.665456771850586  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.6667633056640625  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.805361747741699  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([567, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.813427925109863  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.813427925109863  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.814509391784668  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.9387102127075195  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([550, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.9471564292907715  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.9471564292907715  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.948205471038818  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.077479839324951  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([452, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.084775447845459  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.084775447845459  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.08563756942749  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.197559833526611  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([398, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.204397201538086  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.204397201538086  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.205156326293945  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.307050704956055  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([387, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.314110279083252  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.314110279083252  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.31484842300415  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.420498371124268  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([344, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.427072525024414  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.427072525024414  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.427728652954102  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.525930404663086  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([272, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.531353950500488  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.531353950500488  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.531872749328613  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.616175651550293  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([253, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.621509075164795  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.621509075164795  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.6219916343688965  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.70016622543335  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([236, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.705368995666504  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.705368995666504  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.705819129943848  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.781891822814941  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([2987, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.853438854217529  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.853438854217529  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2987, 256]), torch.Size([1, 2987, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.85913610458374  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.877416133880615  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2987, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.588119506835938  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.595044612884521  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.601969718933105  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.594697952270508  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([46473, 40])
input nodes number: 71476
output nodes number: 46473
edges number: 344519
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.595726490020752  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.595727443695068  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.08006620407104492  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

pseudo mini batch 1 input nodes size: 128066
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.061983585357666016  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.061983585357666016  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.12305021286010742  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.1233816146850586  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.07942724227905273  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.08769083023071289  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.08769083023071289  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.08769083023071289  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([128066, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.08769083023071289  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

m.shape torch.Size([8877, 1, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.44008541107177734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.44008541107177734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 8877, 128]), torch.Size([1, 8877, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.4485511779785156  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5182170867919922  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 8877, 128])
m.shape torch.Size([8847, 2, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5224213600158691  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5224213600158691  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 8847, 128]), torch.Size([1, 8847, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.5308585166931152  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6616387367248535  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 8847, 128])
m.shape torch.Size([7635, 3, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6691389083862305  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6691389083862305  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 7635, 128]), torch.Size([1, 7635, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.6765704154968262  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8379936218261719  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 7635, 128])
m.shape torch.Size([6505, 4, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8467602729797363  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8467602729797363  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6505, 128]), torch.Size([1, 6505, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.8532662391662598  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.0344157218933105  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6505, 128])
m.shape torch.Size([5792, 5, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.0451231002807617  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.0451231002807617  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 5792, 128]), torch.Size([1, 5792, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.0506467819213867  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.257887363433838  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 5792, 128])
m.shape torch.Size([4962, 6, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2693219184875488  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2693219184875488  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4962, 128]), torch.Size([1, 4962, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.2745709419250488  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.48081636428833  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4962, 128])
m.shape torch.Size([4480, 7, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.4934039115905762  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.4934039115905762  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4480, 128]), torch.Size([1, 4480, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.4976763725280762  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.7148075103759766  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4480, 128])
m.shape torch.Size([4011, 8, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.7279720306396484  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.7279720306396484  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4011, 128]), torch.Size([1, 4011, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.731797218322754  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.9552617073059082  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4011, 128])
m.shape torch.Size([3668, 9, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.969090461730957  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.969090461730957  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 3668, 128]), torch.Size([1, 3668, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 1.9726953506469727  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 2.200329303741455  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 3668, 128])
m.shape torch.Size([47864, 10, 128])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 2.4268136024475098  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 2.4268136024475098  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 47864, 128]), torch.Size([1, 47864, 128])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 2.4736886024475098  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.73516321182251  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 47864, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.41829776763916  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.516183853149414  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.614069938659668  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.515419006347656  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([102641, 256])
first layer input nodes number: 128066
first layer output nodes number: 102641
edges number: 709328
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.615026473999023  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.712912559509277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.738303184509277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 5.738303184509277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

m.shape torch.Size([6644, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.130805492401123  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.130805492401123  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6644, 256]), torch.Size([1, 6644, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.143477916717529  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.244994640350342  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6644, 256])
m.shape torch.Size([5556, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.250044345855713  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.250044345855713  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 5556, 256]), torch.Size([1, 5556, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.261122226715088  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.421522617340088  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 5556, 256])
m.shape torch.Size([4252, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.428244113922119  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.428244113922119  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 4252, 256]), torch.Size([1, 4252, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.436636447906494  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.616718769073486  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 4252, 256])
m.shape torch.Size([3275, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.62473201751709  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.62473201751709  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 3275, 256]), torch.Size([1, 3275, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.631354331970215  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.815221786499023  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 3275, 256])
m.shape torch.Size([2882, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.8254313468933105  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.8254313468933105  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2882, 256]), torch.Size([1, 2882, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 6.831295013427734  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.030246257781982  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2882, 256])
m.shape torch.Size([2188, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.040073871612549  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.040073871612549  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 2188, 256]), torch.Size([1, 2188, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.044559955596924  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.2318291664123535  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 2188, 256])
m.shape torch.Size([1758, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.241570472717285  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.241570472717285  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1758, 256]), torch.Size([1, 1758, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.245104789733887  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.417502403259277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1758, 256])
m.shape torch.Size([1505, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.427398204803467  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.427398204803467  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1505, 256]), torch.Size([1, 1505, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.4305100440979  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.602363109588623  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1505, 256])
m.shape torch.Size([1329, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.611626625061035  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.611626625061035  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1329, 256]), torch.Size([1, 1329, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.614292621612549  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.779877662658691  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1329, 256])
m.shape torch.Size([1138, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.789547920227051  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.789547920227051  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 1138, 256]), torch.Size([1, 1138, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.791726112365723  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.949102401733398  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 1138, 256])
m.shape torch.Size([972, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.958293914794922  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.958293914794922  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 972, 256]), torch.Size([1, 972, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 7.960147857666016  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.107227325439453  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 972, 256])
m.shape torch.Size([900, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.11668062210083  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.11668062210083  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 900, 256]), torch.Size([1, 900, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.118397235870361  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.264309406280518  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 900, 256])
m.shape torch.Size([760, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.272947311401367  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.272947311401367  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.274396896362305  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.407758712768555  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([642, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.415672779083252  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.415672779083252  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.416897296905518  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.538475513458252  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([604, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.546571254730225  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.546571254730225  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.547723293304443  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.6706862449646  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([544, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.678475856781006  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.678475856781006  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.679513454437256  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.800652980804443  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([480, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.807977199554443  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.807977199554443  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.808892726898193  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.919606685638428  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([496, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.927730083465576  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.927730083465576  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 8.928676128387451  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.051875591278076  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([438, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.059401512145996  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.059401512145996  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.060236930847168  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.17219066619873  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([420, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.17984676361084  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.17984676361084  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.180647850036621  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.295126914978027  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([373, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.302255153656006  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.302255153656006  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.302966594696045  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.408762454986572  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([284, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.414412021636963  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.414412021636963  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.414953708648682  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.50196123123169  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([266, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.507570743560791  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.507570743560791  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.50807809829712  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.591837882995605  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([289, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.59825086593628  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.59825086593628  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.598802089691162  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.69432783126831  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([6473, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.849586486816406  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.849586486816406  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

 h.shape torch.Size([1, 6473, 256]), torch.Size([1, 6473, 256])
----------------------------------------3
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 9.861932754516602  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 12.080949783325195  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

rst.shape  torch.Size([1, 6473, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.732919216156006  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.739545822143555  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.746172428131104  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.739214420318604  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

torch.Size([44468, 40])
input nodes number: 102641
output nodes number: 44468
edges number: 399731
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.740012168884277  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 11.740012645721436  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10448694229125977  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10448694229125977  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.3260498046875 GB
    Memory Allocated: 0.10448694229125977  GigaBytes
Max Memory Allocated: 12.39194917678833  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.054293155670166016 |0.004684090614318848 |0.165236234664917 |0.00011277198791503906 |0.14424073696136475 |0.006740093231201172 |
----------------------------------------------------------pseudo_mini_loss sum 3.3101654052734375
Total (block generation + training)time/epoch 25.303778767585754
Training time/epoch 0.8232896327972412
Training time without block to device /epoch 0.8139214515686035
Training time without total dataloading part /epoch 0.6259195804595947
load block tensor time/epoch 0.10858631134033203
block to device time/epoch 0.009368181228637695
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  393635
Number of first layer input nodes during this epoch:  219518
Number of first layer output nodes during this epoch:  174117
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
