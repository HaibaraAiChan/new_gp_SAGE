[17:38:47] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21674458 edges into 2 parts and get 140732 edge cuts
main start at this time 1651599505.3235533
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02550673484802246
global_2_local spend time (sec) 0.036042213439941406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0045166015625
A = g.adjacency_matrix() spent  0.0077741146087646484
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0782325267791748
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.293778419494629
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.163348913192749

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11680458, 2.0: 2009204, 3.0: 503973, 4.0: 152362, 5.0: 55000, 6.0: 23754, 7.0: 11121, 8.0: 5689, 9.0: 3141, 10.0: 1718, 11.0: 1012, 12.0: 561, 13.0: 341, 14.0: 224, 15.0: 154, 16.0: 98, 17.0: 78, 18.0: 41, 19.0: 29, 20.0: 8, 21.0: 4})
Convert a graph into a bidirected graph: 0.789 seconds
Metis partitioning: 3.973 seconds
Split the graph: 1.959 seconds
Construct subgraphs: 0.044 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.775343179702759
46423
44518
total k batches seeds list generation spend  19.603376626968384
after graph partition
graph partition algorithm spend time 19.696223258972168
46423
44518
partition_len_list
[71215, 101161]
shared_neighbor_graph_partition_s0 selection method  spend 19.779875993728638
time for parepare:  0.016488313674926758
local_output_nid generation:  0.00466156005859375
local_in_edges_tensor generation:  0.006181478500366211
mini_batch_src_global generation:  0.011726617813110352
r_  generation:  0.12227225303649902
local_output_nid generation:  0.0058977603912353516
local_in_edges_tensor generation:  0.01026296615600586
mini_batch_src_global generation:  0.015074729919433594
r_  generation:  0.1441974639892578
----------------------check_connections_block total spend ----------------------------- 0.40099573135375977
generate_one_block  0.1612105369567871
generate_one_block  0.18586349487304688
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023099184036254883
gen group dst list time:  0.004716634750366211
time for parepare:  0.019482851028442383
local_output_nid generation:  0.008408784866333008
local_in_edges_tensor generation:  0.016203880310058594
mini_batch_src_global generation:  0.013370990753173828
r_  generation:  0.15253043174743652
local_output_nid generation:  0.01422882080078125
local_in_edges_tensor generation:  0.019790172576904297
mini_batch_src_global generation:  0.023899555206298828
r_  generation:  0.2555229663848877
----------------------check_connections_block total spend ----------------------------- 0.6165385246276855
generate_one_block  0.18536806106567383
generate_one_block  0.3132174015045166
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.6165385246276855
block generation total time  0.49858546257019043
average batch blocks generation time:  0.24929273128509521
pseudo mini batch 0 input nodes size: 92384
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.0476994514465332  GigaBytes
Max Memory Allocated: 0.0476994514465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04804563522338867  GigaBytes
Max Memory Allocated: 0.04804563522338867  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04804563522338867  GigaBytes
Max Memory Allocated: 0.04804563522338867  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.05370378494262695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.05370378494262695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.05370378494262695  GigaBytes

torch.Size([92384, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05370378494262695  GigaBytes
Max Memory Allocated: 0.05370378494262695  GigaBytes

m.shape torch.Size([8633, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.2592735290527344  GigaBytes
Max Memory Allocated: 0.26093435287475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.2592735290527344  GigaBytes
Max Memory Allocated: 0.26093435287475586  GigaBytes

 h.shape torch.Size([1, 8633, 128]), torch.Size([1, 8633, 128])
----------------------------------------3
 Nvidia-smi: 1.4744873046875 GB
    Memory Allocated: 0.26750659942626953  GigaBytes
Max Memory Allocated: 0.26750659942626953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.3333711624145508  GigaBytes
Max Memory Allocated: 0.33748769760131836  GigaBytes

rst.shape  torch.Size([1, 8633, 128])
m.shape torch.Size([8667, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33752012252807617  GigaBytes
Max Memory Allocated: 0.33771419525146484  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5487060546875 GB
    Memory Allocated: 0.33752012252807617  GigaBytes
Max Memory Allocated: 0.33771419525146484  GigaBytes

 h.shape torch.Size([1, 8667, 128]), torch.Size([1, 8667, 128])
----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34578561782836914  GigaBytes
Max Memory Allocated: 0.34578561782836914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.46976804733276367  GigaBytes
Max Memory Allocated: 0.47803354263305664  GigaBytes

rst.shape  torch.Size([1, 8667, 128])
m.shape torch.Size([7552, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4764385223388672  GigaBytes
Max Memory Allocated: 0.47803354263305664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4764385223388672  GigaBytes
Max Memory Allocated: 0.47803354263305664  GigaBytes

 h.shape torch.Size([1, 7552, 128]), torch.Size([1, 7552, 128])
----------------------------------------3
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4846668243408203  GigaBytes
Max Memory Allocated: 0.4846668243408203  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6431140899658203  GigaBytes
Max Memory Allocated: 0.6548328399658203  GigaBytes

rst.shape  torch.Size([1, 7552, 128])
m.shape torch.Size([6257, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6514472961425781  GigaBytes
Max Memory Allocated: 0.6548328399658203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6514472961425781  GigaBytes
Max Memory Allocated: 0.6548328399658203  GigaBytes

 h.shape torch.Size([1, 6257, 128]), torch.Size([1, 6257, 128])
----------------------------------------3
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6574802398681641  GigaBytes
Max Memory Allocated: 0.6574802398681641  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8305926322937012  GigaBytes
Max Memory Allocated: 0.842526912689209  GigaBytes

rst.shape  torch.Size([1, 6257, 128])
m.shape torch.Size([5280, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8411731719970703  GigaBytes
Max Memory Allocated: 0.842526912689209  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8411731719970703  GigaBytes
Max Memory Allocated: 0.842526912689209  GigaBytes

 h.shape torch.Size([1, 5280, 128]), torch.Size([1, 5280, 128])
----------------------------------------3
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8469247817993164  GigaBytes
Max Memory Allocated: 0.8469247817993164  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0291748046875  GigaBytes
Max Memory Allocated: 1.0417633056640625  GigaBytes

rst.shape  torch.Size([1, 5280, 128])
m.shape torch.Size([4403, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0392541885375977  GigaBytes
Max Memory Allocated: 1.0417633056640625  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0392541885375977  GigaBytes
Max Memory Allocated: 1.0417633056640625  GigaBytes

 h.shape torch.Size([1, 4403, 128]), torch.Size([1, 4403, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0439152717590332  GigaBytes
Max Memory Allocated: 1.0439152717590332  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2295584678649902  GigaBytes
Max Memory Allocated: 1.2421555519104004  GigaBytes

rst.shape  torch.Size([1, 4403, 128])
m.shape torch.Size([3740, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2399425506591797  GigaBytes
Max Memory Allocated: 1.2421555519104004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2399425506591797  GigaBytes
Max Memory Allocated: 1.2421555519104004  GigaBytes

 h.shape torch.Size([1, 3740, 128]), torch.Size([1, 3740, 128])
----------------------------------------3
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.243748664855957  GigaBytes
Max Memory Allocated: 1.243748664855957  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4236016273498535  GigaBytes
Max Memory Allocated: 1.4360852241516113  GigaBytes

rst.shape  torch.Size([1, 3740, 128])
m.shape torch.Size([3280, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4343304634094238  GigaBytes
Max Memory Allocated: 1.4360852241516113  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4343304634094238  GigaBytes
Max Memory Allocated: 1.4360852241516113  GigaBytes

 h.shape torch.Size([1, 3280, 128]), torch.Size([1, 3280, 128])
----------------------------------------3
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 1.4376263618469238  GigaBytes
Max Memory Allocated: 1.4376263618469238  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.6233429908752441  GigaBytes
Max Memory Allocated: 1.6358551979064941  GigaBytes

rst.shape  torch.Size([1, 3280, 128])
m.shape torch.Size([2743, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.6333770751953125  GigaBytes
Max Memory Allocated: 1.6358551979064941  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.6333770751953125  GigaBytes
Max Memory Allocated: 1.6358551979064941  GigaBytes

 h.shape torch.Size([1, 2743, 128]), torch.Size([1, 2743, 128])
----------------------------------------3
 Nvidia-smi: 2.9041748046875 GB
    Memory Allocated: 1.6366405487060547  GigaBytes
Max Memory Allocated: 1.6366405487060547  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 1.8111052513122559  GigaBytes
Max Memory Allocated: 1.8228769302368164  GigaBytes

rst.shape  torch.Size([1, 2743, 128])
m.shape torch.Size([20660, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1561279296875 GB
    Memory Allocated: 1.907719612121582  GigaBytes
Max Memory Allocated: 1.910029411315918  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1561279296875 GB
    Memory Allocated: 1.907719612121582  GigaBytes
Max Memory Allocated: 1.910029411315918  GigaBytes

 h.shape torch.Size([1, 20660, 128]), torch.Size([1, 20660, 128])
----------------------------------------3
 Nvidia-smi: 3.1678466796875 GB
    Memory Allocated: 1.9274225234985352  GigaBytes
Max Memory Allocated: 1.9274225234985352  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7557373046875 GB
    Memory Allocated: 3.326329231262207  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

rst.shape  torch.Size([1, 20660, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7908935546875 GB
    Memory Allocated: 3.1533427238464355  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7908935546875 GB
    Memory Allocated: 3.2212586402893066  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2896180152893066  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2211713790893555  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

torch.Size([71215, 256])
first layer input nodes number: 92384
first layer output nodes number: 71215
edges number: 410176
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.2903084754943848  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8592529296875 GB
    Memory Allocated: 3.358224391937256  GigaBytes
Max Memory Allocated: 3.4248437881469727  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9276123046875 GB
    Memory Allocated: 3.3756470680236816  GigaBytes
Max Memory Allocated: 3.4435629844665527  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9276123046875 GB
    Memory Allocated: 3.3756470680236816  GigaBytes
Max Memory Allocated: 3.4435629844665527  GigaBytes

m.shape torch.Size([6589, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.7198920249938965  GigaBytes
Max Memory Allocated: 3.719916820526123  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.7198920249938965  GigaBytes
Max Memory Allocated: 3.719916820526123  GigaBytes

 h.shape torch.Size([1, 6589, 256]), torch.Size([1, 6589, 256])
----------------------------------------3
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.732459545135498  GigaBytes
Max Memory Allocated: 3.732459545135498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.8329997062683105  GigaBytes
Max Memory Allocated: 3.8392834663391113  GigaBytes

rst.shape  torch.Size([1, 6589, 256])
m.shape torch.Size([6021, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.838290214538574  GigaBytes
Max Memory Allocated: 3.8392834663391113  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.838290214538574  GigaBytes
Max Memory Allocated: 3.8392834663391113  GigaBytes

 h.shape torch.Size([1, 6021, 256]), torch.Size([1, 6021, 256])
----------------------------------------3
 Nvidia-smi: 5.2615966796875 GB
    Memory Allocated: 3.850316047668457  GigaBytes
Max Memory Allocated: 3.850316047668457  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4178466796875 GB
    Memory Allocated: 4.024924278259277  GigaBytes
Max Memory Allocated: 4.036408424377441  GigaBytes

rst.shape  torch.Size([1, 6021, 256])
m.shape torch.Size([4991, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.033573150634766  GigaBytes
Max Memory Allocated: 4.036408424377441  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.033573150634766  GigaBytes
Max Memory Allocated: 4.036408424377441  GigaBytes

 h.shape torch.Size([1, 4991, 256]), torch.Size([1, 4991, 256])
----------------------------------------3
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.044081687927246  GigaBytes
Max Memory Allocated: 4.044081687927246  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6483154296875 GB
    Memory Allocated: 4.2586164474487305  GigaBytes
Max Memory Allocated: 4.273387908935547  GigaBytes

rst.shape  torch.Size([1, 4991, 256])
m.shape torch.Size([4004, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.269601345062256  GigaBytes
Max Memory Allocated: 4.273387908935547  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.269601345062256  GigaBytes
Max Memory Allocated: 4.273387908935547  GigaBytes

 h.shape torch.Size([1, 4004, 256]), torch.Size([1, 4004, 256])
----------------------------------------3
 Nvidia-smi: 5.6639404296875 GB
    Memory Allocated: 4.277257442474365  GigaBytes
Max Memory Allocated: 4.277257442474365  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8670654296875 GB
    Memory Allocated: 4.504998683929443  GigaBytes
Max Memory Allocated: 4.520623683929443  GigaBytes

rst.shape  torch.Size([1, 4004, 256])
m.shape torch.Size([3348, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.517269611358643  GigaBytes
Max Memory Allocated: 4.520623683929443  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.517269611358643  GigaBytes
Max Memory Allocated: 4.520623683929443  GigaBytes

 h.shape torch.Size([1, 3348, 256]), torch.Size([1, 3348, 256])
----------------------------------------3
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.52391242980957  GigaBytes
Max Memory Allocated: 4.52391242980957  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 4.766763687133789  GigaBytes
Max Memory Allocated: 4.78272819519043  GigaBytes

rst.shape  torch.Size([1, 3348, 256])
m.shape torch.Size([2706, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 4.779175758361816  GigaBytes
Max Memory Allocated: 4.78272819519043  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 4.779175758361816  GigaBytes
Max Memory Allocated: 4.78272819519043  GigaBytes

 h.shape torch.Size([1, 2706, 256]), torch.Size([1, 2706, 256])
----------------------------------------3
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 4.785012722015381  GigaBytes
Max Memory Allocated: 4.785012722015381  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3807373046875 GB
    Memory Allocated: 5.007979869842529  GigaBytes
Max Memory Allocated: 5.023604869842529  GigaBytes

rst.shape  torch.Size([1, 2706, 256])
m.shape torch.Size([2329, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.3807373046875 GB
    Memory Allocated: 5.021145820617676  GigaBytes
Max Memory Allocated: 5.023604869842529  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3807373046875 GB
    Memory Allocated: 5.021145820617676  GigaBytes
Max Memory Allocated: 5.023604869842529  GigaBytes

 h.shape torch.Size([1, 2329, 256]), torch.Size([1, 2329, 256])
----------------------------------------3
 Nvidia-smi: 6.3807373046875 GB
    Memory Allocated: 5.026244163513184  GigaBytes
Max Memory Allocated: 5.026244163513184  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6307373046875 GB
    Memory Allocated: 5.248679161071777  GigaBytes
Max Memory Allocated: 5.264304161071777  GigaBytes

rst.shape  torch.Size([1, 2329, 256])
m.shape torch.Size([1981, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6307373046875 GB
    Memory Allocated: 5.262201309204102  GigaBytes
Max Memory Allocated: 5.264304161071777  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6307373046875 GB
    Memory Allocated: 5.262201309204102  GigaBytes
Max Memory Allocated: 5.264304161071777  GigaBytes

 h.shape torch.Size([1, 1981, 256]), torch.Size([1, 1981, 256])
----------------------------------------3
 Nvidia-smi: 6.6307373046875 GB
    Memory Allocated: 5.266395092010498  GigaBytes
Max Memory Allocated: 5.266395092010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.487210750579834  GigaBytes
Max Memory Allocated: 5.502835750579834  GigaBytes

rst.shape  torch.Size([1, 1981, 256])
m.shape torch.Size([1664, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.4990763664245605  GigaBytes
Max Memory Allocated: 5.502835750579834  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.4990763664245605  GigaBytes
Max Memory Allocated: 5.502835750579834  GigaBytes

 h.shape torch.Size([1, 1664, 256]), torch.Size([1, 1664, 256])
----------------------------------------3
 Nvidia-smi: 6.8807373046875 GB
    Memory Allocated: 5.502284526824951  GigaBytes
Max Memory Allocated: 5.502835750579834  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 5.710261821746826  GigaBytes
Max Memory Allocated: 5.724544048309326  GigaBytes

rst.shape  torch.Size([1, 1664, 256])
m.shape torch.Size([1462, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 5.72270393371582  GigaBytes
Max Memory Allocated: 5.724544048309326  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 5.72270393371582  GigaBytes
Max Memory Allocated: 5.724544048309326  GigaBytes

 h.shape torch.Size([1, 1462, 256]), torch.Size([1, 1462, 256])
----------------------------------------3
 Nvidia-smi: 7.0721435546875 GB
    Memory Allocated: 5.725496292114258  GigaBytes
Max Memory Allocated: 5.725496292114258  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2830810546875 GB
    Memory Allocated: 5.924947738647461  GigaBytes
Max Memory Allocated: 5.93889045715332  GigaBytes

rst.shape  torch.Size([1, 1462, 256])
m.shape torch.Size([1244, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2830810546875 GB
    Memory Allocated: 5.936490058898926  GigaBytes
Max Memory Allocated: 5.93889045715332  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2830810546875 GB
    Memory Allocated: 5.936490058898926  GigaBytes
Max Memory Allocated: 5.93889045715332  GigaBytes

 h.shape torch.Size([1, 1244, 256]), torch.Size([1, 1244, 256])
----------------------------------------3
 Nvidia-smi: 7.2830810546875 GB
    Memory Allocated: 5.938876628875732  GigaBytes
Max Memory Allocated: 5.93889045715332  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.4588623046875 GB
    Memory Allocated: 6.134787082672119  GigaBytes
Max Memory Allocated: 6.147837162017822  GigaBytes

rst.shape  torch.Size([1, 1244, 256])
m.shape torch.Size([1055, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.4588623046875 GB
    Memory Allocated: 6.145219326019287  GigaBytes
Max Memory Allocated: 6.147837162017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.4588623046875 GB
    Memory Allocated: 6.145219326019287  GigaBytes
Max Memory Allocated: 6.147837162017822  GigaBytes

 h.shape torch.Size([1, 1055, 256]), torch.Size([1, 1055, 256])
----------------------------------------3
 Nvidia-smi: 7.4588623046875 GB
    Memory Allocated: 6.147271156311035  GigaBytes
Max Memory Allocated: 6.147837162017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 6.331499099731445  GigaBytes
Max Memory Allocated: 6.343572616577148  GigaBytes

rst.shape  torch.Size([1, 1055, 256])
m.shape torch.Size([909, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 6.340989589691162  GigaBytes
Max Memory Allocated: 6.343572616577148  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6346435546875 GB
    Memory Allocated: 6.340989589691162  GigaBytes
Max Memory Allocated: 6.343572616577148  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 7.6365966796875 GB
    Memory Allocated: 6.342723369598389  GigaBytes
Max Memory Allocated: 6.343572616577148  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8319091796875 GB
    Memory Allocated: 6.503000736236572  GigaBytes
Max Memory Allocated: 6.514719486236572  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([804, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8319091796875 GB
    Memory Allocated: 6.5129523277282715  GigaBytes
Max Memory Allocated: 6.514719486236572  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8319091796875 GB
    Memory Allocated: 6.5129523277282715  GigaBytes
Max Memory Allocated: 6.514719486236572  GigaBytes

 h.shape torch.Size([1, 804, 256]), torch.Size([1, 804, 256])
----------------------------------------3
 Nvidia-smi: 7.8319091796875 GB
    Memory Allocated: 6.514485836029053  GigaBytes
Max Memory Allocated: 6.514719486236572  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 6.6692328453063965  GigaBytes
Max Memory Allocated: 6.679967403411865  GigaBytes

rst.shape  torch.Size([1, 804, 256])
m.shape torch.Size([714, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 6.678760051727295  GigaBytes
Max Memory Allocated: 6.679967403411865  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 6.678760051727295  GigaBytes
Max Memory Allocated: 6.679967403411865  GigaBytes

 h.shape torch.Size([1, 714, 256]), torch.Size([1, 714, 256])
----------------------------------------3
 Nvidia-smi: 7.9803466796875 GB
    Memory Allocated: 6.680121898651123  GigaBytes
Max Memory Allocated: 6.680121898651123  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1209716796875 GB
    Memory Allocated: 6.8278326988220215  GigaBytes
Max Memory Allocated: 6.838046550750732  GigaBytes

rst.shape  torch.Size([1, 714, 256])
m.shape torch.Size([584, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.1209716796875 GB
    Memory Allocated: 6.836132526397705  GigaBytes
Max Memory Allocated: 6.838046550750732  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1209716796875 GB
    Memory Allocated: 6.836132526397705  GigaBytes
Max Memory Allocated: 6.838046550750732  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 8.1209716796875 GB
    Memory Allocated: 6.837246417999268  GigaBytes
Max Memory Allocated: 6.838046550750732  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2498779296875 GB
    Memory Allocated: 6.965128421783447  GigaBytes
Max Memory Allocated: 6.974039554595947  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([558, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.2498779296875 GB
    Memory Allocated: 6.973689079284668  GigaBytes
Max Memory Allocated: 6.974039554595947  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2498779296875 GB
    Memory Allocated: 6.973689079284668  GigaBytes
Max Memory Allocated: 6.974039554595947  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 8.2498779296875 GB
    Memory Allocated: 6.974753379821777  GigaBytes
Max Memory Allocated: 6.974753379821777  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.104418754577637  GigaBytes
Max Memory Allocated: 7.113465309143066  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([459, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.111827850341797  GigaBytes
Max Memory Allocated: 7.113465309143066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3905029296875 GB
    Memory Allocated: 7.111827850341797  GigaBytes
Max Memory Allocated: 7.113465309143066  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.112703323364258  GigaBytes
Max Memory Allocated: 7.113465309143066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4686279296875 GB
    Memory Allocated: 7.226799011230469  GigaBytes
Max Memory Allocated: 7.234678268432617  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([405, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4686279296875 GB
    Memory Allocated: 7.233757495880127  GigaBytes
Max Memory Allocated: 7.234678268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4686279296875 GB
    Memory Allocated: 7.233757495880127  GigaBytes
Max Memory Allocated: 7.234678268432617  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 8.4686279296875 GB
    Memory Allocated: 7.234529972076416  GigaBytes
Max Memory Allocated: 7.234678268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5760498046875 GB
    Memory Allocated: 7.3396220207214355  GigaBytes
Max Memory Allocated: 7.346960544586182  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([412, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5760498046875 GB
    Memory Allocated: 7.347155570983887  GigaBytes
Max Memory Allocated: 7.34718656539917  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5760498046875 GB
    Memory Allocated: 7.347155570983887  GigaBytes
Max Memory Allocated: 7.34718656539917  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 8.5780029296875 GB
    Memory Allocated: 7.3479413986206055  GigaBytes
Max Memory Allocated: 7.3479413986206055  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6951904296875 GB
    Memory Allocated: 7.462100028991699  GigaBytes
Max Memory Allocated: 7.469958305358887  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([347, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6951904296875 GB
    Memory Allocated: 7.468710899353027  GigaBytes
Max Memory Allocated: 7.469958305358887  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6951904296875 GB
    Memory Allocated: 7.468710899353027  GigaBytes
Max Memory Allocated: 7.469958305358887  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 8.6951904296875 GB
    Memory Allocated: 7.469372749328613  GigaBytes
Max Memory Allocated: 7.469958305358887  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8006591796875 GB
    Memory Allocated: 7.568212509155273  GigaBytes
Max Memory Allocated: 7.575161933898926  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([280, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8006591796875 GB
    Memory Allocated: 7.573802471160889  GigaBytes
Max Memory Allocated: 7.575161933898926  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8006591796875 GB
    Memory Allocated: 7.573802471160889  GigaBytes
Max Memory Allocated: 7.575161933898926  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.8006591796875 GB
    Memory Allocated: 7.574336528778076  GigaBytes
Max Memory Allocated: 7.575161933898926  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 7.6581034660339355  GigaBytes
Max Memory Allocated: 7.663978099822998  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([254, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 7.663451671600342  GigaBytes
Max Memory Allocated: 7.663978099822998  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 7.663451671600342  GigaBytes
Max Memory Allocated: 7.663978099822998  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 7.663936138153076  GigaBytes
Max Memory Allocated: 7.663978099822998  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9686279296875 GB
    Memory Allocated: 7.742419719696045  GigaBytes
Max Memory Allocated: 7.74799108505249  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([243, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.9686279296875 GB
    Memory Allocated: 7.747783184051514  GigaBytes
Max Memory Allocated: 7.74799108505249  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9686279296875 GB
    Memory Allocated: 7.747783184051514  GigaBytes
Max Memory Allocated: 7.74799108505249  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 8.9686279296875 GB
    Memory Allocated: 7.748246669769287  GigaBytes
Max Memory Allocated: 7.748246669769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0506591796875 GB
    Memory Allocated: 7.826575756072998  GigaBytes
Max Memory Allocated: 7.832137584686279  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([3060, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 7.8998703956604  GigaBytes
Max Memory Allocated: 7.900155544281006  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 7.8998703956604  GigaBytes
Max Memory Allocated: 7.900155544281006  GigaBytes

 h.shape torch.Size([1, 3060, 256]), torch.Size([1, 3060, 256])
----------------------------------------3
 Nvidia-smi: 9.1268310546875 GB
    Memory Allocated: 7.905706882476807  GigaBytes
Max Memory Allocated: 7.905706882476807  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2869873046875 GB
    Memory Allocated: 8.93526315689087  GigaBytes
Max Memory Allocated: 9.008219242095947  GigaBytes

rst.shape  torch.Size([1, 3060, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.641764163970947  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.648682117462158  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.65560007095337  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.648335933685303  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

torch.Size([46423, 40])
input nodes number: 71215
output nodes number: 46423
edges number: 349118
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.65613079071045  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3768310546875 GB
    Memory Allocated: 8.656131744384766  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07584428787231445  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

pseudo mini batch 1 input nodes size: 125286
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0577397346496582  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0577397346496582  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.11748075485229492  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.1178126335144043  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07254457473754883  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08116292953491211  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08116292953491211  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08116292953491211  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

torch.Size([125286, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08116292953491211  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

m.shape torch.Size([9210, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.4240732192993164  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.4240732192993164  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 9210, 128]), torch.Size([1, 9210, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.4336123466491699  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.503913402557373  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 9210, 128])
m.shape torch.Size([9034, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.5081372261047363  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.5081372261047363  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 9034, 128]), torch.Size([1, 9034, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.5168366432189941  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.6481518745422363  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 9034, 128])
m.shape torch.Size([7679, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.6555628776550293  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.6555628776550293  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 7679, 128]), torch.Size([1, 7679, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.6635322570800781  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.826845645904541  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 7679, 128])
m.shape torch.Size([6561, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.835698127746582  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.835698127746582  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 6561, 128]), torch.Size([1, 6561, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 0.8424882888793945  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.0239429473876953  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 6561, 128])
m.shape torch.Size([5711, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.0344862937927246  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.0344862937927246  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 5711, 128]), torch.Size([1, 5711, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.0403571128845215  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.2518796920776367  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 5711, 128])
m.shape torch.Size([4865, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.263075351715088  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.263075351715088  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 4865, 128]), torch.Size([1, 4865, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.2677416801452637  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.4688148498535156  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 4865, 128])
m.shape torch.Size([4362, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.4809350967407227  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.4809350967407227  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 4362, 128]), torch.Size([1, 4362, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.485814094543457  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.6958918571472168  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 4362, 128])
m.shape torch.Size([3906, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.7094368934631348  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.7094368934631348  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 3906, 128]), torch.Size([1, 3906, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.7131619453430176  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.9276642799377441  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 3906, 128])
m.shape torch.Size([3548, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.9408831596374512  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.9408831596374512  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 3548, 128]), torch.Size([1, 3548, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 1.944995403289795  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 2.1714634895324707  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 3548, 128])
m.shape torch.Size([46285, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 2.3895907402038574  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 2.3895907402038574  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 46285, 128]), torch.Size([1, 46285, 128])
----------------------------------------3
 Nvidia-smi: 11.0584716796875 GB
    Memory Allocated: 2.434689521789551  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.568687438964844  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 46285, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.261850357055664  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.358325004577637  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.454799652099609  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.357571125030518  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

torch.Size([101161, 256])
first layer input nodes number: 125286
first layer output nodes number: 101161
edges number: 690868
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.455735206604004  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.552209854125977  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.576328754425049  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.2576904296875 GB
    Memory Allocated: 5.576328754425049  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

m.shape torch.Size([6839, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 5.964600086212158  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 5.964600086212158  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 6839, 256]), torch.Size([1, 6839, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 5.977644443511963  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.082668304443359  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 6839, 256])
m.shape torch.Size([5685, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.087074279785156  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.087074279785156  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 5685, 256]), torch.Size([1, 5685, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.097917556762695  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.260566711425781  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 5685, 256])
m.shape torch.Size([4286, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.267503261566162  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.267503261566162  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 4286, 256]), torch.Size([1, 4286, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.276040554046631  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.457337856292725  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 4286, 256])
m.shape torch.Size([3316, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.465817928314209  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.465817928314209  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 3316, 256]), torch.Size([1, 3316, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.472765922546387  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.656184196472168  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 3316, 256])
m.shape torch.Size([2874, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.666833400726318  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.666833400726318  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 2874, 256]), torch.Size([1, 2874, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.67249059677124  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.872306823730469  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 2874, 256])
m.shape torch.Size([2162, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.881799221038818  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.881799221038818  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 2162, 256]), torch.Size([1, 2162, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 6.886353969573975  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.072883605957031  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 2162, 256])
m.shape torch.Size([1716, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.081392288208008  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.081392288208008  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 1716, 256]), torch.Size([1, 1716, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.084678649902344  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.250026702880859  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 1716, 256])
m.shape torch.Size([1491, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.259854793548584  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.259854793548584  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 1491, 256]), torch.Size([1, 1491, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.26271390914917  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.430002212524414  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 1491, 256])
m.shape torch.Size([1312, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.439815044403076  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.439815044403076  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 1312, 256]), torch.Size([1, 1312, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.442452907562256  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.60557746887207  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 1312, 256])
m.shape torch.Size([1137, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.614969253540039  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.614969253540039  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 1137, 256]), torch.Size([1, 1137, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.617176055908203  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.781337738037109  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 1137, 256])
m.shape torch.Size([959, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.790710926055908  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.790710926055908  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 959, 256]), torch.Size([1, 959, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.792540073394775  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.935213565826416  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 959, 256])
m.shape torch.Size([882, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.944471836090088  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.944471836090088  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 7.9461541175842285  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.089148044586182  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([747, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.09764051437378  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.09764051437378  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 747, 256]), torch.Size([1, 747, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.09906530380249  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.231188297271729  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 747, 256])
m.shape torch.Size([630, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.238953113555908  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.238953113555908  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.24015474319458  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.362614154815674  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([575, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.3703031539917  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.3703031539917  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.371399879455566  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.487652778625488  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([527, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.495208740234375  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.495208740234375  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.496213912963867  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.611132621765137  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([472, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.618342399597168  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.618342399597168  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.619242668151855  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.72827434539795  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([489, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.736618041992188  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.736618041992188  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.737550735473633  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.860389709472656  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([431, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.867794036865234  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.867794036865234  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.868616104125977  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.979744911193848  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([395, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.986927032470703  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.986927032470703  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 8.987680435180664  GigaBytes
Max Memory Allocated: 9.066651821136475  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.09506607055664  GigaBytes
Max Memory Allocated: 9.10260009765625  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([370, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.102157592773438  GigaBytes
Max Memory Allocated: 9.10260009765625  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.102157592773438  GigaBytes
Max Memory Allocated: 9.10260009765625  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.102863311767578  GigaBytes
Max Memory Allocated: 9.102863311767578  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.20796012878418  GigaBytes
Max Memory Allocated: 9.215370178222656  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([276, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.213443279266357  GigaBytes
Max Memory Allocated: 9.215370178222656  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.213443279266357  GigaBytes
Max Memory Allocated: 9.215370178222656  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.213969707489014  GigaBytes
Max Memory Allocated: 9.215370178222656  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.29847764968872  GigaBytes
Max Memory Allocated: 9.30426836013794  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([265, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.304072856903076  GigaBytes
Max Memory Allocated: 9.30426836013794  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.304072856903076  GigaBytes
Max Memory Allocated: 9.30426836013794  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.304578304290771  GigaBytes
Max Memory Allocated: 9.304578304290771  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.38796854019165  GigaBytes
Max Memory Allocated: 9.393781185150146  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([282, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.39422082901001  GigaBytes
Max Memory Allocated: 9.394246101379395  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.39422082901001  GigaBytes
Max Memory Allocated: 9.394246101379395  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.394758701324463  GigaBytes
Max Memory Allocated: 9.394758701324463  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6346435546875 GB
    Memory Allocated: 9.486330509185791  GigaBytes
Max Memory Allocated: 9.492784976959229  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([6400, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7889404296875 GB
    Memory Allocated: 9.639841556549072  GigaBytes
Max Memory Allocated: 9.640437602996826  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7889404296875 GB
    Memory Allocated: 9.639841556549072  GigaBytes
Max Memory Allocated: 9.640437602996826  GigaBytes

 h.shape torch.Size([1, 6400, 256]), torch.Size([1, 6400, 256])
----------------------------------------3
 Nvidia-smi: 13.7889404296875 GB
    Memory Allocated: 9.652048587799072  GigaBytes
Max Memory Allocated: 9.652048587799072  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.851267337799072  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6400, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.506876945495605  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.514026641845703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.520660400390625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.513178825378418  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes
[17:39:11] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21719692 edges into 2 parts and get 135428 edge cuts

torch.Size([44518, 40])
input nodes number: 101161
output nodes number: 44518
edges number: 395132
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.514496326446533  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2635498046875 GB
    Memory Allocated: 11.514496803283691  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.09638166427612305  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.10193204879760742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.10193204879760742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05460774898529053 |0.1694626808166504 |0.4361079931259155 |0.00017392635345458984 |0.1630631685256958 |0.005747795104980469 |
----------------------------------------------------------pseudo_mini_loss sum 5.321305274963379
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  390046
Number of first layer input nodes during this epoch:  217670
Number of first layer output nodes during this epoch:  172376
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.10193157196044922  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016985654830932617
global_2_local spend time (sec) 0.038071393966674805
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0044133663177490234
A = g.adjacency_matrix() spent  0.008089303970336914
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08279967308044434
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.4488704204559326
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1851558685302734

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11701738, 2.0: 2017886, 3.0: 504377, 4.0: 152112, 5.0: 55817, 6.0: 23824, 7.0: 11409, 8.0: 5685, 9.0: 3070, 10.0: 1700, 11.0: 1036, 12.0: 534, 13.0: 336, 14.0: 225, 15.0: 120, 16.0: 118, 17.0: 96, 18.0: 53, 19.0: 34, 20.0: 8, 21.0: 6})
Convert a graph into a bidirected graph: 0.851 seconds
Metis partitioning: 4.159 seconds
Split the graph: 2.218 seconds
Construct subgraphs: 0.062 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.301692485809326
46398
44543
total k batches seeds list generation spend  20.82527804374695
after graph partition
graph partition algorithm spend time 20.934150457382202
46398
44543
partition_len_list
[72123, 100104]
shared_neighbor_graph_partition_s0 selection method  spend 21.02474331855774
time for parepare:  0.017333269119262695
local_output_nid generation:  0.004498720169067383
local_in_edges_tensor generation:  0.006680011749267578
mini_batch_src_global generation:  0.011446475982666016
r_  generation:  0.11946940422058105
local_output_nid generation:  0.005690813064575195
local_in_edges_tensor generation:  0.009883880615234375
mini_batch_src_global generation:  0.01500558853149414
r_  generation:  0.14321088790893555
----------------------check_connections_block total spend ----------------------------- 0.40242838859558105
generate_one_block  0.16481351852416992
generate_one_block  0.18670916557312012
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.052861928939819336
gen group dst list time:  0.00460362434387207
time for parepare:  0.01965498924255371
local_output_nid generation:  0.008270502090454102
local_in_edges_tensor generation:  0.03430318832397461
mini_batch_src_global generation:  0.013134241104125977
r_  generation:  0.1558363437652588
local_output_nid generation:  0.013542413711547852
local_in_edges_tensor generation:  0.018320083618164062
mini_batch_src_global generation:  0.026756763458251953
r_  generation:  0.2469186782836914
----------------------check_connections_block total spend ----------------------------- 0.628415584564209
generate_one_block  0.2006211280822754
generate_one_block  0.31220006942749023
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.10193157196044922  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

connection checking time:  0.628415584564209
block generation total time  0.5128211975097656
average batch blocks generation time:  0.2564105987548828
block dataloader generation time/epoch 23.10318684577942
pseudo mini batch 0 input nodes size: 93874
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07832574844360352  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07832574844360352  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.12324762344360352  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.12359333038330078  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.06352043151855469  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07004261016845703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07004261016845703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07004261016845703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([93874, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.07004261016845703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([8902, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.2774028778076172  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.2774028778076172  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 8902, 128]), torch.Size([1, 8902, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.2860374450683594  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.35575103759765625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 8902, 128])
m.shape torch.Size([8817, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.35991477966308594  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.35991477966308594  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 8817, 128]), torch.Size([1, 8817, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.3683638572692871  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.49905824661254883  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 8817, 128])
m.shape torch.Size([7635, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.5065727233886719  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.5065727233886719  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 7635, 128]), torch.Size([1, 7635, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.5144176483154297  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.6769967079162598  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 7635, 128])
m.shape torch.Size([6372, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.6855096817016602  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.6855096817016602  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6372, 128]), torch.Size([1, 6372, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.6919679641723633  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.8701162338256836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6372, 128])
m.shape torch.Size([5358, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.8807497024536133  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.8807497024536133  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5358, 128]), torch.Size([1, 5358, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 0.8863916397094727  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.0703439712524414  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5358, 128])
m.shape torch.Size([4429, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.080460548400879  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.080460548400879  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4429, 128]), torch.Size([1, 4429, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.0846843719482422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.2663087844848633  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4429, 128])
m.shape torch.Size([3739, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.276677131652832  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.276677131652832  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3739, 128]), torch.Size([1, 3739, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.2804021835327148  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.4586915969848633  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3739, 128])
m.shape torch.Size([3298, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.469489574432373  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.469489574432373  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3298, 128]), torch.Size([1, 3298, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.4728450775146484  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.6528840065002441  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3298, 128])
m.shape torch.Size([2734, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.6630444526672363  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.6630444526672363  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2734, 128]), torch.Size([1, 2734, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.6659283638000488  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.8412237167358398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2734, 128])
m.shape torch.Size([20839, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.9393339157104492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.9393339157104492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 20839, 128]), torch.Size([1, 20839, 128])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 1.959207534790039  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.370234489440918  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 20839, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.1957740783691406  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.2645559310913086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.3333377838134766  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.2640185356140137  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([72123, 256])
first layer input nodes number: 93874
first layer output nodes number: 72123
edges number: 413846
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.3340392112731934  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.4028210639953613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.4203991889953613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.4203991889953613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([6793, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.7624173164367676  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.7624173164367676  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6793, 256]), torch.Size([1, 6793, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.775373935699463  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.8790268898010254  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6793, 256])
m.shape torch.Size([6007, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.8840956687927246  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.8840956687927246  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6007, 256]), torch.Size([1, 6007, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 3.8955531120300293  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.070027828216553  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6007, 256])
m.shape torch.Size([4973, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.078638553619385  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.078638553619385  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4973, 256]), torch.Size([1, 4973, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.089763641357422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.305676460266113  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4973, 256])
m.shape torch.Size([4007, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.316678524017334  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.316678524017334  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4007, 256]), torch.Size([1, 4007, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.324898719787598  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.551941394805908  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4007, 256])
m.shape torch.Size([3375, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.563914775848389  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.563914775848389  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3375, 256]), torch.Size([1, 3375, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.5704264640808105  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.807455062866211  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3375, 256])
m.shape torch.Size([2681, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.8194780349731445  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.8194780349731445  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2681, 256]), torch.Size([1, 2681, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 4.824814796447754  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.045886516571045  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2681, 256])
m.shape torch.Size([2257, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.058514595031738  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.058514595031738  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2257, 256]), torch.Size([1, 2257, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.0632829666137695  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.292823791503906  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2257, 256])
m.shape torch.Size([1981, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.305903434753418  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.305903434753418  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1981, 256]), torch.Size([1, 1981, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.309872627258301  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.52985954284668  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1981, 256])
m.shape torch.Size([1631, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.542078971862793  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.542078971862793  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1631, 256]), torch.Size([1, 1631, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.545401573181152  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.756365776062012  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1631, 256])
m.shape torch.Size([1468, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.768919944763184  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.768919944763184  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1468, 256]), torch.Size([1, 1468, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.771894454956055  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.973688125610352  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1468, 256])
m.shape torch.Size([1237, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.985366344451904  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.985366344451904  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 5.987805366516113  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.180185317993164  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
m.shape torch.Size([1043, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.190946578979492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.190946578979492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1043, 256]), torch.Size([1, 1043, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.192962646484375  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.365232944488525  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1043, 256])
m.shape torch.Size([902, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.375344276428223  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.375344276428223  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 902, 256]), torch.Size([1, 902, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.3770647048950195  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.536923408508301  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 902, 256])
m.shape torch.Size([790, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.546693325042725  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.546693325042725  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 790, 256]), torch.Size([1, 790, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.5482001304626465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.6975417137146  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 790, 256])
m.shape torch.Size([707, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.706981182098389  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.706981182098389  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 707, 256]), torch.Size([1, 707, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.708329677581787  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.854743480682373  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 707, 256])
m.shape torch.Size([576, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.862926959991455  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.862926959991455  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 576, 256]), torch.Size([1, 576, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.864025592803955  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.988819599151611  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 576, 256])
m.shape torch.Size([556, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.997354984283447  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.997354984283447  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 6.998415470123291  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.127932071685791  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([449, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.135169982910156  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.135169982910156  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.136026382446289  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.2488908767700195  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([390, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.255584716796875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.255584716796875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.256328582763672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.356830596923828  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([402, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.3641862869262695  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.3641862869262695  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.36495304107666  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.4731645584106445  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([344, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.479724407196045  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.479724407196045  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.480380535125732  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.578737735748291  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([279, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.584309101104736  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.584309101104736  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.584841251373291  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.6721882820129395  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([251, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.677471160888672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.677471160888672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.677949905395508  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.75550651550293  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([235, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.760688304901123  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.760688304901123  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.761136531829834  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.836886882781982  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([3064, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.910284996032715  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.910284996032715  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3064, 256]), torch.Size([1, 3064, 256])
----------------------------------------3
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 7.916129112243652  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.944693565368652  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3064, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.6524019241333  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.660244941711426  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.66808795928955  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.659899234771729  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([46398, 40])
input nodes number: 72123
output nodes number: 46398
edges number: 346810
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.661475658416748  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0174560546875 GB
    Memory Allocated: 8.661476612091064  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.08264875411987305  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

pseudo mini batch 1 input nodes size: 123433
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.06421470642089844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.06421470642089844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.12307214736938477  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.12340402603149414  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.07813644409179688  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.0861968994140625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.0861968994140625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.0861968994140625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([123433, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.0861968994140625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([9015, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.4256267547607422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.4256267547607422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 9015, 128]), torch.Size([1, 9015, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.43422412872314453  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.5041532516479492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 9015, 128])
m.shape torch.Size([9001, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.5084385871887207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.5084385871887207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 9001, 128]), torch.Size([1, 9001, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.5170292854309082  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.6482501029968262  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 9001, 128])
m.shape torch.Size([7592, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.6556768417358398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.6556768417358398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 7592, 128]), torch.Size([1, 7592, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.6635890007019043  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.8254504203796387  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 7592, 128])
m.shape torch.Size([6427, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.8340888023376465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.8340888023376465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6427, 128]), torch.Size([1, 6427, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 0.8403010368347168  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.0190057754516602  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6427, 128])
m.shape torch.Size([5687, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.0296130180358887  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.0296130180358887  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5687, 128]), torch.Size([1, 5687, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.0353894233703613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.2463269233703613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5687, 128])
m.shape torch.Size([4807, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.2564964294433594  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.2564964294433594  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4807, 128]), torch.Size([1, 4807, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.2616119384765625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.4623489379882812  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4807, 128])
m.shape torch.Size([4347, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.4743084907531738  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.4743084907531738  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4347, 128]), torch.Size([1, 4347, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.4794087409973145  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.6888375282287598  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4347, 128])
m.shape torch.Size([3844, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.7023897171020508  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.7023897171020508  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3844, 128]), torch.Size([1, 3844, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.706094741821289  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.9186573028564453  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3844, 128])
m.shape torch.Size([3510, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.9324493408203125  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.9324493408203125  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3510, 128]), torch.Size([1, 3510, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 1.936032772064209  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 2.152524471282959  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3510, 128])
m.shape torch.Size([45874, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 2.3695950508117676  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 2.3695950508117676  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 45874, 128]), torch.Size([1, 45874, 128])
----------------------------------------3
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 2.413343906402588  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.519908428192139  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 45874, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.215764045715332  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.311230659484863  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.4066972732543945  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.310484409332275  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([100104, 256])
first layer input nodes number: 123433
first layer output nodes number: 100104
edges number: 684289
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.407618999481201  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.503085613250732  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.526952266693115  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 5.526952266693115  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([6635, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 5.917121887207031  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 5.917121887207031  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6635, 256]), torch.Size([1, 6635, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 5.929777145385742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.031259536743164  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6635, 256])
m.shape torch.Size([5699, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.035887241363525  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.035887241363525  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5699, 256]), torch.Size([1, 5699, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.047455310821533  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.211397647857666  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5699, 256])
m.shape torch.Size([4304, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.218372821807861  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.218372821807861  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4304, 256]), torch.Size([1, 4304, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.226963520050049  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.409824848175049  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4304, 256])
m.shape torch.Size([3313, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.418175220489502  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.418175220489502  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3313, 256]), torch.Size([1, 3313, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.425118923187256  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.611937999725342  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3313, 256])
m.shape torch.Size([2847, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.622103691101074  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.622103691101074  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2847, 256]), torch.Size([1, 2847, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.627707481384277  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.826272010803223  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2847, 256])
m.shape torch.Size([2187, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.835897445678711  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.835897445678711  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2187, 256]), torch.Size([1, 2187, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 6.84058952331543  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.028196334838867  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2187, 256])
m.shape torch.Size([1788, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.037879943847656  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.037879943847656  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1788, 256]), torch.Size([1, 1788, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.041620254516602  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.220574378967285  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1788, 256])
m.shape torch.Size([1491, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.2303338050842285  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.2303338050842285  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1491, 256]), torch.Size([1, 1491, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.233338356018066  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.399205207824707  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1491, 256])
m.shape torch.Size([1345, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.409418106079102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.409418106079102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1345, 256]), torch.Size([1, 1345, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.412107944488525  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.578567981719971  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1345, 256])
m.shape torch.Size([1131, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.588025093078613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.588025093078613  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.590281009674072  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.755232334136963  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([966, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.765019416809082  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.765019416809082  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 966, 256]), torch.Size([1, 966, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.766861915588379  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.914435386657715  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 966, 256])
m.shape torch.Size([894, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.923825263977051  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.923825263977051  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 7.925530433654785  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.07275104522705  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 894, 256])
m.shape torch.Size([754, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.081319808959961  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.081319808959961  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.082757949829102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.216674327850342  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([644, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.224620819091797  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.224620819091797  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.225849151611328  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.348204612731934  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([582, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.355981349945068  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.355981349945068  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.357091426849365  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.475484371185303  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([535, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.483156681060791  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.483156681060791  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.484177112579346  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.600290775299072  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([474, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.60752534866333  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.60752534866333  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.608429431915283  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.716963291168213  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([499, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.725144386291504  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.725144386291504  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.726096153259277  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.84945011138916  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([446, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.857119083404541  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.857119083404541  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.857969760894775  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.976263523101807  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([405, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.983623504638672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.983623504638672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 8.984395980834961  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.093534469604492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([373, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.100677013397217  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.100677013397217  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.101388454437256  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.20746660232544  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([277, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.213881969451904  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.213881969451904  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.214410305023193  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.299008846282959  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([268, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.304669380187988  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.304669380187988  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.305180549621582  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.389358520507812  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([290, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.395792484283447  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.395792484283447  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.396345615386963  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.492723941802979  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([6396, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.64613151550293  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.64613151550293  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes
[17:39:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 21724554 edges into 2 parts and get 146006 edge cuts

 h.shape torch.Size([1, 6396, 256]), torch.Size([1, 6396, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 9.658330917358398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.805425643920898  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6396, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.460484981536865  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.46782922744751  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.474466800689697  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.466790676116943  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([44543, 40])
input nodes number: 100104
output nodes number: 44543
edges number: 397440
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.466663360595703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.466663837432861  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.0999608039855957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.0999608039855957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.0999608039855957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06964504718780518 |0.0060389041900634766 |0.16467201709747314 |0.00011527538299560547 |0.15740394592285156 |0.004760026931762695 |
----------------------------------------------------------pseudo_mini_loss sum 4.277791500091553
Total (block generation + training)time/epoch 23.945212364196777
Training time/epoch 0.8416943550109863
Training time without block to device /epoch 0.8296165466308594
Training time without total dataloading part /epoch 0.6491425037384033
load block tensor time/epoch 0.13929009437561035
block to device time/epoch 0.012077808380126953
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  389534
Number of first layer input nodes during this epoch:  217307
Number of first layer output nodes during this epoch:  172227
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.0999603271484375  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.07755374908447266
global_2_local spend time (sec) 0.04392218589782715
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004632711410522461
A = g.adjacency_matrix() spent  0.013391256332397461
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08681917190551758
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3231558799743652
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1650898456573486

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 11704867, 2.0: 2016386, 3.0: 505014, 4.0: 151832, 5.0: 55157, 6.0: 24090, 7.0: 11047, 8.0: 5737, 9.0: 3033, 10.0: 1743, 11.0: 999, 12.0: 546, 13.0: 336, 14.0: 193, 15.0: 115, 16.0: 108, 17.0: 90, 18.0: 42, 19.0: 26, 20.0: 6, 21.0: 3})
Convert a graph into a bidirected graph: 0.799 seconds
Metis partitioning: 3.989 seconds
Split the graph: 2.015 seconds
Construct subgraphs: 0.047 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  6.860982656478882
46429
44512
total k batches seeds list generation spend  19.86264204978943
after graph partition
graph partition algorithm spend time 19.953550100326538
46429
44512
partition_len_list
[71863, 100842]
shared_neighbor_graph_partition_s0 selection method  spend 20.049135208129883
time for parepare:  0.017429590225219727
local_output_nid generation:  0.00492405891418457
local_in_edges_tensor generation:  0.006208181381225586
mini_batch_src_global generation:  0.011301279067993164
r_  generation:  0.12154483795166016
local_output_nid generation:  0.00578618049621582
local_in_edges_tensor generation:  0.009360790252685547
mini_batch_src_global generation:  0.015275239944458008
r_  generation:  0.1459355354309082
----------------------check_connections_block total spend ----------------------------- 0.40119218826293945
generate_one_block  0.16677045822143555
generate_one_block  0.1865530014038086
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03560185432434082
gen group dst list time:  0.004998207092285156
time for parepare:  0.020290613174438477
local_output_nid generation:  0.009006500244140625
local_in_edges_tensor generation:  0.016614913940429688
mini_batch_src_global generation:  0.013020992279052734
r_  generation:  0.16246652603149414
local_output_nid generation:  0.018288612365722656
local_in_edges_tensor generation:  0.024339675903320312
mini_batch_src_global generation:  0.028449058532714844
r_  generation:  0.25999975204467773
----------------------check_connections_block total spend ----------------------------- 0.6644997596740723
generate_one_block  0.19468307495117188
generate_one_block  0.3146204948425293
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.0999603271484375  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

connection checking time:  0.6644997596740723
block generation total time  0.5093035697937012
average batch blocks generation time:  0.2546517848968506
block dataloader generation time/epoch 22.65865647792816
pseudo mini batch 0 input nodes size: 93887
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.07693004608154297  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.07693004608154297  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.12185192108154297  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.12219810485839844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.06300878524780273  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.06870603561401367  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.06870603561401367  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.06870603561401367  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([93887, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.06870603561401367  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([8632, 1, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.2768545150756836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.2768545150756836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 8632, 128]), torch.Size([1, 8632, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.28508663177490234  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.35094356536865234  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 8632, 128])
m.shape torch.Size([8732, 2, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.35515499114990234  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.35515499114990234  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 8732, 128]), torch.Size([1, 8732, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.3634824752807617  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.49393367767333984  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 8732, 128])
m.shape torch.Size([7550, 3, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.5014886856079102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.5014886856079102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 7550, 128]), torch.Size([1, 7550, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.5092048645019531  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.6692380905151367  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 7550, 128])
m.shape torch.Size([6261, 4, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.6775798797607422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.6775798797607422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6261, 128]), torch.Size([1, 6261, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.6843624114990234  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.8604974746704102  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6261, 128])
m.shape torch.Size([5337, 5, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.8711838722229004  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.8711838722229004  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5337, 128]), torch.Size([1, 5337, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 0.8769316673278809  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.0601630210876465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5337, 128])
m.shape torch.Size([4406, 6, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.0702238082885742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.0702238082885742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4406, 128]), torch.Size([1, 4406, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.0748696327209473  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.2555508613586426  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4406, 128])
m.shape torch.Size([3752, 7, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.2659735679626465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.2659735679626465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3752, 128]), torch.Size([1, 3752, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.2695517539978027  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.4484610557556152  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3752, 128])
m.shape torch.Size([3274, 8, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.4591612815856934  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.4591612815856934  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3274, 128]), torch.Size([1, 3274, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.4626212120056152  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.6426787376403809  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3274, 128])
m.shape torch.Size([2797, 9, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.653120994567871  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.653120994567871  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2797, 128]), torch.Size([1, 2797, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.656001091003418  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.8340096473693848  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2797, 128])
m.shape torch.Size([21122, 10, 128])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.9331879615783691  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.9331879615783691  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 21122, 128]), torch.Size([1, 21122, 128])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 1.953331470489502  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.4046502113342285  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 21122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.2299342155456543  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.2984681129455566  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.367002010345459  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.2979326248168945  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([71863, 256])
first layer input nodes number: 93887
first layer output nodes number: 71863
edges number: 415760
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.367703437805176  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.436237335205078  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.453815460205078  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.453815460205078  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([6559, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.79752254486084  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.79752254486084  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6559, 256]), torch.Size([1, 6559, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.810032844543457  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.9112253189086914  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6559, 256])
m.shape torch.Size([6044, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.916588306427002  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.916588306427002  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6044, 256]), torch.Size([1, 6044, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 3.9281163215637207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.1029438972473145  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6044, 256])
m.shape torch.Size([4997, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.111588478088379  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.111588478088379  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4997, 256]), torch.Size([1, 4997, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.122694969177246  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.337960720062256  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4997, 256])
m.shape torch.Size([4025, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.348940372467041  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.348940372467041  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4025, 256]), torch.Size([1, 4025, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.357121467590332  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.584261894226074  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4025, 256])
m.shape torch.Size([3375, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.596303939819336  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.596303939819336  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3375, 256]), torch.Size([1, 3375, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.603056907653809  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.839215278625488  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3375, 256])
m.shape torch.Size([2724, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.8514862060546875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.8514862060546875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2724, 256]), torch.Size([1, 2724, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 4.857244968414307  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.082214832305908  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2724, 256])
m.shape torch.Size([2311, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.095165252685547  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.095165252685547  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2311, 256]), torch.Size([1, 2311, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.099593162536621  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.326977729797363  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2311, 256])
m.shape torch.Size([1975, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.339959621429443  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.339959621429443  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1975, 256]), torch.Size([1, 1975, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.343759059906006  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.563043117523193  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1975, 256])
m.shape torch.Size([1666, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.5748748779296875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.5748748779296875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1666, 256]), torch.Size([1, 1666, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.578168869018555  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.787883281707764  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1666, 256])
m.shape torch.Size([1453, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.800260066986084  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.800260066986084  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1453, 256]), torch.Size([1, 1453, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 5.803338527679443  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.001965045928955  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1453, 256])
m.shape torch.Size([1238, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.01353645324707  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.01353645324707  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.015902519226074  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.206110000610352  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
m.shape torch.Size([1063, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.217092514038086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.217092514038086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1063, 256]), torch.Size([1, 1063, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.219207763671875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.398160934448242  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1063, 256])
m.shape torch.Size([901, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.40838623046875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.40838623046875  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.410104751586914  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.568208694458008  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([802, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.578141212463379  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.578141212463379  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.5796709060668945  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.732621192932129  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([708, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.742288589477539  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.742288589477539  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.74363899230957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.890562057495117  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([583, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.898852348327637  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.898852348327637  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 6.899964332580566  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.026546478271484  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([557, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.035091400146484  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.035091400146484  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.036153793334961  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.165273666381836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([462, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.172735214233398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.172735214233398  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.173616409301758  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.287392616271973  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([407, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.294384479522705  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.294384479522705  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.29516077041626  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.402632236480713  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([397, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.409875869750977  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.409875869750977  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.410633087158203  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.518339157104492  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([349, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.525004863739014  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.525004863739014  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.525670528411865  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.627000331878662  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([284, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.6326727867126465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.6326727867126465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.633214473724365  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.719027042388916  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([256, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.724415302276611  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.724415302276611  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.724903583526611  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.804005146026611  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([247, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.810137748718262  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.810137748718262  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.810608863830566  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1619873046875 GB
    Memory Allocated: 7.890227317810059  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([3046, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 7.963181495666504  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 7.963181495666504  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3046, 256]), torch.Size([1, 3046, 256])
----------------------------------------3
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 7.968991279602051  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.9915132522583  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3046, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.69925308227539  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.706171989440918  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.713090896606445  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.705825805664062  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([46429, 40])
input nodes number: 71863
output nodes number: 46429
edges number: 348722
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.70698881149292  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.1639404296875 GB
    Memory Allocated: 8.706989765167236  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.0808253288269043  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

pseudo mini batch 1 input nodes size: 124122
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.06329107284545898  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.06329107284545898  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.12247705459594727  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.12280893325805664  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.07754087448120117  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.08561849594116211  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.08561849594116211  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.08561849594116211  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([124122, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.08561849594116211  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([9234, 1, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.42776918411254883  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.42776918411254883  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 9234, 128]), torch.Size([1, 9234, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.43657541275024414  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.5070252418518066  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 9234, 128])
m.shape torch.Size([9043, 2, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.5112462043762207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.5112462043762207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 9043, 128]), torch.Size([1, 9043, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.5199613571166992  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.6513023376464844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 9043, 128])
m.shape torch.Size([7649, 3, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.6587090492248535  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.6587090492248535  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 7649, 128]), torch.Size([1, 7649, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.6666684150695801  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.8294811248779297  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 7649, 128])
m.shape torch.Size([6502, 4, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.8382353782653809  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.8382353782653809  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6502, 128]), torch.Size([1, 6502, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.8449831008911133  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.024806022644043  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6502, 128])
m.shape torch.Size([5681, 5, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.0353775024414062  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.0353775024414062  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5681, 128]), torch.Size([1, 5681, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.0411033630371094  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.2519245147705078  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5681, 128])
m.shape torch.Size([4826, 6, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.2630228996276855  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.2630228996276855  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4826, 128]), torch.Size([1, 4826, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.2678580284118652  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.4686436653137207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4826, 128])
m.shape torch.Size([4306, 7, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.4805026054382324  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.4805026054382324  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4306, 128]), torch.Size([1, 4306, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.4855303764343262  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.693354606628418  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4306, 128])
m.shape torch.Size([3887, 8, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.7069263458251953  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.7069263458251953  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3887, 128]), torch.Size([1, 3887, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.710763931274414  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.9233202934265137  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3887, 128])
m.shape torch.Size([3506, 9, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.9364938735961914  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.9364938735961914  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3506, 128]), torch.Size([1, 3506, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 1.9400501251220703  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 2.166630744934082  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3506, 128])
m.shape torch.Size([46208, 10, 128])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 2.385295867919922  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 2.385295867919922  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 46208, 128]), torch.Size([1, 46208, 128])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 2.429363250732422  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.558147430419922  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 46208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.2520575523376465  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.3482279777526855  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.444398403167725  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.347476482391357  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([100842, 256])
first layer input nodes number: 124122
first layer output nodes number: 100842
edges number: 688508
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.4453253746032715  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.5414958000183105  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.56553840637207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.56553840637207  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

m.shape torch.Size([6869, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.954761505126953  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.954761505126953  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6869, 256]), torch.Size([1, 6869, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 5.967863082885742  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.073246002197266  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6869, 256])
m.shape torch.Size([5662, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.077579021453857  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.077579021453857  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 5662, 256]), torch.Size([1, 5662, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.088378429412842  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.250369548797607  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 5662, 256])
m.shape torch.Size([4280, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.25731086730957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.25731086730957  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 4280, 256]), torch.Size([1, 4280, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.265920639038086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.447301864624023  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 4280, 256])
m.shape torch.Size([3295, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.45566463470459  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.45566463470459  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 3295, 256]), torch.Size([1, 3295, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.46207332611084  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.646323204040527  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 3295, 256])
m.shape torch.Size([2847, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.6566481590271  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.6566481590271  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2847, 256]), torch.Size([1, 2847, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.662393093109131  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.861600399017334  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2847, 256])
m.shape torch.Size([2144, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.870908737182617  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.870908737182617  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 2144, 256]), torch.Size([1, 2144, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 6.875201225280762  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.0594048500061035  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 2144, 256])
m.shape torch.Size([1734, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.069026470184326  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.069026470184326  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1734, 256]), torch.Size([1, 1734, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.072444438934326  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.239345073699951  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1734, 256])
m.shape torch.Size([1497, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.249146938323975  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.249146938323975  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1497, 256]), torch.Size([1, 1497, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.252051830291748  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.422883033752441  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1497, 256])
m.shape torch.Size([1310, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.432506084442139  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.432506084442139  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1310, 256]), torch.Size([1, 1310, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.435008525848389  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.596136569976807  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1310, 256])
m.shape torch.Size([1146, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.605839252471924  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.605839252471924  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 1146, 256]), torch.Size([1, 1146, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.6080641746521  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.778085231781006  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 1146, 256])
m.shape torch.Size([965, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.786242961883545  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.786242961883545  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.788083553314209  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.935988426208496  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([874, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.945148468017578  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.945148468017578  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 874, 256]), torch.Size([1, 874, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 7.946815490722656  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.089141845703125  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 874, 256])
m.shape torch.Size([755, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.097742080688477  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.097742080688477  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.09918212890625  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.232309341430664  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([632, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.24009370803833  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.24009370803833  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.241299152374268  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.36484956741333  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([581, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.372623443603516  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.372623443603516  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.37373161315918  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.493250846862793  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([528, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.500816345214844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.500816345214844  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.501823425292969  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.616482734680176  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([473, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.62370777130127  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.62370777130127  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.62460994720459  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.732871055603027  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([486, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.740828037261963  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.740828037261963  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.74175500869751  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.859743595123291  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([429, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.867114543914795  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.867114543914795  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.867932796478271  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.978070735931396  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([410, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.985543251037598  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.985543251037598  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 8.98632526397705  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.100018501281738  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([368, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.107055187225342  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.107055187225342  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.107757091522217  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.21375036239624  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([272, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.219151020050049  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.219151020050049  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.219669818878174  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.303920269012451  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([263, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.30947494506836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.30947494506836  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.309976577758789  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.392999649047852  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([278, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.399287700653076  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.399287700653076  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.399817943572998  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.491199016571045  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([6414, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.645050525665283  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.645050525665283  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

 h.shape torch.Size([1, 6414, 256]), torch.Size([1, 6414, 256])
----------------------------------------3
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 9.657284259796143  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.83827829360962  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

rst.shape  torch.Size([1, 6414, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.493858814239502  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.500979900360107  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.507612705230713  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.500159740447998  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

torch.Size([44512, 40])
input nodes number: 100842
output nodes number: 44512
edges number: 395528
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.500957012176514  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 11.500957489013672  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.10129690170288086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.10129690170288086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.1658935546875 GB
    Memory Allocated: 0.10129690170288086  GigaBytes
Max Memory Allocated: 12.003855228424072  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056940555572509766 |0.005324244499206543 |0.16693508625030518 |0.0001150369644165039 |0.13841640949249268 |0.00877070426940918 |
----------------------------------------------------------pseudo_mini_loss sum 3.3155083656311035
Total (block generation + training)time/epoch 23.489302277565002
Training time/epoch 0.8190562725067139
Training time without block to device /epoch 0.8084077835083008
Training time without total dataloading part /epoch 0.6197037696838379
load block tensor time/epoch 0.11388111114501953
block to device time/epoch 0.010648488998413086
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  390714
Number of first layer input nodes during this epoch:  218009
Number of first layer output nodes during this epoch:  172705
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
