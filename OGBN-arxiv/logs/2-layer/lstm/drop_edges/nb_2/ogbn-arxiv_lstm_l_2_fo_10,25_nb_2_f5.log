[17:42:49] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23358328 edges into 2 parts and get 178051 edge cuts
main start at this time 1651599749.5223527
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.025919198989868164
global_2_local spend time (sec) 0.03452253341674805
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004308938980102539
A = g.adjacency_matrix() spent  0.007951498031616211
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08319091796875
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3103322982788086
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1905503273010254

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328})
Convert a graph into a bidirected graph: 0.994 seconds
Metis partitioning: 4.293 seconds
Split the graph: 3.347 seconds
Construct subgraphs: 0.036 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.680783033370972
46399
44542
total k batches seeds list generation spend  19.33456039428711
after graph partition
graph partition algorithm spend time 19.447086334228516
46399
44542
partition_len_list
[71197, 103173]
shared_neighbor_graph_partition_s0 selection method  spend 19.529298782348633
time for parepare:  0.01667165756225586
local_output_nid generation:  0.004639148712158203
local_in_edges_tensor generation:  0.006533622741699219
mini_batch_src_global generation:  0.01218724250793457
r_  generation:  0.12172603607177734
local_output_nid generation:  0.005579233169555664
local_in_edges_tensor generation:  0.010617494583129883
mini_batch_src_global generation:  0.015117168426513672
r_  generation:  0.14621758460998535
----------------------check_connections_block total spend ----------------------------- 0.40681934356689453
generate_one_block  0.16313934326171875
generate_one_block  0.19777441024780273
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04169130325317383
gen group dst list time:  0.00474858283996582
time for parepare:  0.019579648971557617
local_output_nid generation:  0.008720874786376953
local_in_edges_tensor generation:  0.03164339065551758
mini_batch_src_global generation:  0.012481212615966797
r_  generation:  0.15621232986450195
local_output_nid generation:  0.014096975326538086
local_in_edges_tensor generation:  0.021892309188842773
mini_batch_src_global generation:  0.02426624298095703
r_  generation:  0.2559776306152344
----------------------check_connections_block total spend ----------------------------- 0.6398544311523438
generate_one_block  0.18864130973815918
generate_one_block  0.3223447799682617
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.6398544311523438
block generation total time  0.5109860897064209
average batch blocks generation time:  0.25549304485321045
pseudo mini batch 0 input nodes size: 91643
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04647636413574219  GigaBytes
Max Memory Allocated: 0.04647636413574219  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04682207107543945  GigaBytes
Max Memory Allocated: 0.04682207107543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04682207107543945  GigaBytes
Max Memory Allocated: 0.04682207107543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.052434444427490234  GigaBytes
Max Memory Allocated: 0.052434444427490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.052434444427490234  GigaBytes
Max Memory Allocated: 0.052434444427490234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.052434444427490234  GigaBytes
Max Memory Allocated: 0.052434444427490234  GigaBytes

torch.Size([91643, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.052434444427490234  GigaBytes
Max Memory Allocated: 0.052434444427490234  GigaBytes

m.shape torch.Size([8743, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25783348083496094  GigaBytes
Max Memory Allocated: 0.2592043876647949  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25783348083496094  GigaBytes
Max Memory Allocated: 0.2592043876647949  GigaBytes

 h.shape torch.Size([1, 8743, 128]), torch.Size([1, 8743, 128])
----------------------------------------3
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.2661714553833008  GigaBytes
Max Memory Allocated: 0.2661714553833008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.33558177947998047  GigaBytes
Max Memory Allocated: 0.3397507667541504  GigaBytes

rst.shape  torch.Size([1, 8743, 128])
m.shape torch.Size([8689, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.33969926834106445  GigaBytes
Max Memory Allocated: 0.33989381790161133  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.33969926834106445  GigaBytes
Max Memory Allocated: 0.33989381790161133  GigaBytes

 h.shape torch.Size([1, 8689, 128]), torch.Size([1, 8689, 128])
----------------------------------------3
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34801149368286133  GigaBytes
Max Memory Allocated: 0.34801149368286133  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4723086357116699  GigaBytes
Max Memory Allocated: 0.48059511184692383  GigaBytes

rst.shape  torch.Size([1, 8689, 128])
m.shape torch.Size([7556, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4789743423461914  GigaBytes
Max Memory Allocated: 0.48059511184692383  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4789743423461914  GigaBytes
Max Memory Allocated: 0.48059511184692383  GigaBytes

 h.shape torch.Size([1, 7556, 128]), torch.Size([1, 7556, 128])
----------------------------------------3
 Nvidia-smi: 1.7108154296875 GB
    Memory Allocated: 0.48618030548095703  GigaBytes
Max Memory Allocated: 0.48618030548095703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6447114944458008  GigaBytes
Max Memory Allocated: 0.6555204391479492  GigaBytes

rst.shape  torch.Size([1, 7556, 128])
m.shape torch.Size([6263, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6534337997436523  GigaBytes
Max Memory Allocated: 0.6555204391479492  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6534337997436523  GigaBytes
Max Memory Allocated: 0.6555204391479492  GigaBytes

 h.shape torch.Size([1, 6263, 128]), torch.Size([1, 6263, 128])
----------------------------------------3
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6600232124328613  GigaBytes
Max Memory Allocated: 0.6600232124328613  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.833615779876709  GigaBytes
Max Memory Allocated: 0.8455615043640137  GigaBytes

rst.shape  torch.Size([1, 6263, 128])
m.shape torch.Size([5283, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.8432250022888184  GigaBytes
Max Memory Allocated: 0.8455615043640137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.8432250022888184  GigaBytes
Max Memory Allocated: 0.8455615043640137  GigaBytes

 h.shape torch.Size([1, 5283, 128]), torch.Size([1, 5283, 128])
----------------------------------------3
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.8490128517150879  GigaBytes
Max Memory Allocated: 0.8490128517150879  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 1.03126859664917  GigaBytes
Max Memory Allocated: 1.0438642501831055  GigaBytes

rst.shape  torch.Size([1, 5283, 128])
m.shape torch.Size([4403, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 1.041346549987793  GigaBytes
Max Memory Allocated: 1.0438642501831055  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 1.041346549987793  GigaBytes
Max Memory Allocated: 1.0438642501831055  GigaBytes

 h.shape torch.Size([1, 4403, 128]), torch.Size([1, 4403, 128])
----------------------------------------3
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 1.0461888313293457  GigaBytes
Max Memory Allocated: 1.0461888313293457  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 1.2318320274353027  GigaBytes
Max Memory Allocated: 1.244429111480713  GigaBytes

rst.shape  torch.Size([1, 4403, 128])
m.shape torch.Size([3736, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 1.2422027587890625  GigaBytes
Max Memory Allocated: 1.244429111480713  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 1.2422027587890625  GigaBytes
Max Memory Allocated: 1.244429111480713  GigaBytes

 h.shape torch.Size([1, 3736, 128]), torch.Size([1, 3736, 128])
----------------------------------------3
 Nvidia-smi: 2.5096435546875 GB
    Memory Allocated: 1.2459945678710938  GigaBytes
Max Memory Allocated: 1.2459945678710938  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4255285263061523  GigaBytes
Max Memory Allocated: 1.4379987716674805  GigaBytes

rst.shape  torch.Size([1, 3736, 128])
m.shape torch.Size([3253, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4361562728881836  GigaBytes
Max Memory Allocated: 1.4379987716674805  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4361562728881836  GigaBytes
Max Memory Allocated: 1.4379987716674805  GigaBytes

 h.shape torch.Size([1, 3253, 128]), torch.Size([1, 3253, 128])
----------------------------------------3
 Nvidia-smi: 2.7381591796875 GB
    Memory Allocated: 1.4393815994262695  GigaBytes
Max Memory Allocated: 1.4393815994262695  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.6245503425598145  GigaBytes
Max Memory Allocated: 1.6369595527648926  GigaBytes

rst.shape  torch.Size([1, 3253, 128])
m.shape torch.Size([2741, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.634596824645996  GigaBytes
Max Memory Allocated: 1.6369595527648926  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.634596824645996  GigaBytes
Max Memory Allocated: 1.6369595527648926  GigaBytes

 h.shape torch.Size([1, 2741, 128]), torch.Size([1, 2741, 128])
----------------------------------------3
 Nvidia-smi: 2.9080810546875 GB
    Memory Allocated: 1.6374568939208984  GigaBytes
Max Memory Allocated: 1.6374568939208984  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0643310546875 GB
    Memory Allocated: 1.8133835792541504  GigaBytes
Max Memory Allocated: 1.8251466751098633  GigaBytes

rst.shape  torch.Size([1, 2741, 128])
m.shape torch.Size([20530, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1658935546875 GB
    Memory Allocated: 1.9099712371826172  GigaBytes
Max Memory Allocated: 1.9129271507263184  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1658935546875 GB
    Memory Allocated: 1.9099712371826172  GigaBytes
Max Memory Allocated: 1.9129271507263184  GigaBytes

 h.shape torch.Size([1, 20530, 128]), torch.Size([1, 20530, 128])
----------------------------------------3
 Nvidia-smi: 3.1776123046875 GB
    Memory Allocated: 1.9295501708984375  GigaBytes
Max Memory Allocated: 1.9295501708984375  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7655029296875 GB
    Memory Allocated: 3.3196544647216797  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

rst.shape  torch.Size([1, 20530, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8006591796875 GB
    Memory Allocated: 3.147003650665283  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8006591796875 GB
    Memory Allocated: 3.214902400970459  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 3.283261775970459  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 3.214832305908203  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

torch.Size([71197, 256])
first layer input nodes number: 91643
first layer output nodes number: 71197
edges number: 408819
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 3.2839465141296387  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8690185546875 GB
    Memory Allocated: 3.3518452644348145  GigaBytes
Max Memory Allocated: 3.4175491333007812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9373779296875 GB
    Memory Allocated: 3.3692808151245117  GigaBytes
Max Memory Allocated: 3.4371795654296875  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9373779296875 GB
    Memory Allocated: 3.3692808151245117  GigaBytes
Max Memory Allocated: 3.4371795654296875  GigaBytes

m.shape torch.Size([6770, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.70932674407959  GigaBytes
Max Memory Allocated: 3.7093520164489746  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.70932674407959  GigaBytes
Max Memory Allocated: 3.7093520164489746  GigaBytes

 h.shape torch.Size([1, 6770, 256]), torch.Size([1, 6770, 256])
----------------------------------------3
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.7222394943237305  GigaBytes
Max Memory Allocated: 3.7222394943237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.8255414962768555  GigaBytes
Max Memory Allocated: 3.831997871398926  GigaBytes

rst.shape  torch.Size([1, 6770, 256])
m.shape torch.Size([6115, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.8308401107788086  GigaBytes
Max Memory Allocated: 3.831997871398926  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.8308401107788086  GigaBytes
Max Memory Allocated: 3.831997871398926  GigaBytes

 h.shape torch.Size([1, 6115, 256]), torch.Size([1, 6115, 256])
----------------------------------------3
 Nvidia-smi: 5.2674560546875 GB
    Memory Allocated: 3.843128204345703  GigaBytes
Max Memory Allocated: 3.843128204345703  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4237060546875 GB
    Memory Allocated: 4.018632888793945  GigaBytes
Max Memory Allocated: 4.030296325683594  GigaBytes

rst.shape  torch.Size([1, 6115, 256])
m.shape torch.Size([5040, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.4393310546875 GB
    Memory Allocated: 4.027333736419678  GigaBytes
Max Memory Allocated: 4.030296325683594  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4393310546875 GB
    Memory Allocated: 4.027333736419678  GigaBytes
Max Memory Allocated: 4.030296325683594  GigaBytes

 h.shape torch.Size([1, 5040, 256]), torch.Size([1, 5040, 256])
----------------------------------------3
 Nvidia-smi: 5.4393310546875 GB
    Memory Allocated: 4.037858486175537  GigaBytes
Max Memory Allocated: 4.037858486175537  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6541748046875 GB
    Memory Allocated: 4.252564907073975  GigaBytes
Max Memory Allocated: 4.267289638519287  GigaBytes

rst.shape  torch.Size([1, 5040, 256])
m.shape torch.Size([4009, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 4.263503074645996  GigaBytes
Max Memory Allocated: 4.267289638519287  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 4.263503074645996  GigaBytes
Max Memory Allocated: 4.267289638519287  GigaBytes

 h.shape torch.Size([1, 4009, 256]), torch.Size([1, 4009, 256])
----------------------------------------3
 Nvidia-smi: 5.6697998046875 GB
    Memory Allocated: 4.271197319030762  GigaBytes
Max Memory Allocated: 4.271197319030762  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8729248046875 GB
    Memory Allocated: 4.498668670654297  GigaBytes
Max Memory Allocated: 4.514293670654297  GigaBytes

rst.shape  torch.Size([1, 4009, 256])
m.shape torch.Size([3344, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8905029296875 GB
    Memory Allocated: 4.510225296020508  GigaBytes
Max Memory Allocated: 4.514293670654297  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8905029296875 GB
    Memory Allocated: 4.510225296020508  GigaBytes
Max Memory Allocated: 4.514293670654297  GigaBytes

 h.shape torch.Size([1, 3344, 256]), torch.Size([1, 3344, 256])
----------------------------------------3
 Nvidia-smi: 5.8905029296875 GB
    Memory Allocated: 4.517630100250244  GigaBytes
Max Memory Allocated: 4.517630100250244  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1170654296875 GB
    Memory Allocated: 4.758459568023682  GigaBytes
Max Memory Allocated: 4.774405002593994  GigaBytes

rst.shape  torch.Size([1, 3344, 256])
m.shape torch.Size([2714, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.1170654296875 GB
    Memory Allocated: 4.77092170715332  GigaBytes
Max Memory Allocated: 4.774405002593994  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1170654296875 GB
    Memory Allocated: 4.77092170715332  GigaBytes
Max Memory Allocated: 4.774405002593994  GigaBytes

 h.shape torch.Size([1, 2714, 256]), torch.Size([1, 2714, 256])
----------------------------------------3
 Nvidia-smi: 6.1170654296875 GB
    Memory Allocated: 4.7767767906188965  GigaBytes
Max Memory Allocated: 4.7767767906188965  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3787841796875 GB
    Memory Allocated: 5.000442028045654  GigaBytes
Max Memory Allocated: 5.016067028045654  GigaBytes

rst.shape  torch.Size([1, 2714, 256])
m.shape torch.Size([2288, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.3787841796875 GB
    Memory Allocated: 5.013598442077637  GigaBytes
Max Memory Allocated: 5.016067028045654  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3787841796875 GB
    Memory Allocated: 5.013598442077637  GigaBytes
Max Memory Allocated: 5.016067028045654  GigaBytes

 h.shape torch.Size([1, 2288, 256]), torch.Size([1, 2288, 256])
----------------------------------------3
 Nvidia-smi: 6.3787841796875 GB
    Memory Allocated: 5.018618106842041  GigaBytes
Max Memory Allocated: 5.018618106842041  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.237675189971924  GigaBytes
Max Memory Allocated: 5.253300189971924  GigaBytes

rst.shape  torch.Size([1, 2288, 256])
m.shape torch.Size([1950, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.251234531402588  GigaBytes
Max Memory Allocated: 5.253300189971924  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.251234531402588  GigaBytes
Max Memory Allocated: 5.253300189971924  GigaBytes

 h.shape torch.Size([1, 1950, 256]), torch.Size([1, 1950, 256])
----------------------------------------3
 Nvidia-smi: 6.6287841796875 GB
    Memory Allocated: 5.255093097686768  GigaBytes
Max Memory Allocated: 5.255093097686768  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8787841796875 GB
    Memory Allocated: 5.468348026275635  GigaBytes
Max Memory Allocated: 5.483973026275635  GigaBytes

rst.shape  torch.Size([1, 1950, 256])
m.shape torch.Size([1633, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8787841796875 GB
    Memory Allocated: 5.480544567108154  GigaBytes
Max Memory Allocated: 5.483973026275635  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8787841796875 GB
    Memory Allocated: 5.480544567108154  GigaBytes
Max Memory Allocated: 5.483973026275635  GigaBytes

 h.shape torch.Size([1, 1633, 256]), torch.Size([1, 1633, 256])
----------------------------------------3
 Nvidia-smi: 6.8787841796875 GB
    Memory Allocated: 5.4837517738342285  GigaBytes
Max Memory Allocated: 5.483973026275635  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0701904296875 GB
    Memory Allocated: 5.69593620300293  GigaBytes
Max Memory Allocated: 5.709952354431152  GigaBytes

rst.shape  torch.Size([1, 1633, 256])
m.shape torch.Size([1446, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0701904296875 GB
    Memory Allocated: 5.708225250244141  GigaBytes
Max Memory Allocated: 5.709952354431152  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0701904296875 GB
    Memory Allocated: 5.708225250244141  GigaBytes
Max Memory Allocated: 5.709952354431152  GigaBytes

 h.shape torch.Size([1, 1446, 256]), torch.Size([1, 1446, 256])
----------------------------------------3
 Nvidia-smi: 7.0701904296875 GB
    Memory Allocated: 5.711051940917969  GigaBytes
Max Memory Allocated: 5.711051940917969  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2811279296875 GB
    Memory Allocated: 5.918237686157227  GigaBytes
Max Memory Allocated: 5.932027816772461  GigaBytes

rst.shape  torch.Size([1, 1446, 256])
m.shape torch.Size([1212, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2811279296875 GB
    Memory Allocated: 5.9292168617248535  GigaBytes
Max Memory Allocated: 5.932027816772461  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2811279296875 GB
    Memory Allocated: 5.9292168617248535  GigaBytes
Max Memory Allocated: 5.932027816772461  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 7.2811279296875 GB
    Memory Allocated: 5.931623935699463  GigaBytes
Max Memory Allocated: 5.932027816772461  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 6.115672588348389  GigaBytes
Max Memory Allocated: 6.128386974334717  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([1046, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 6.126371383666992  GigaBytes
Max Memory Allocated: 6.128386974334717  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 6.126371383666992  GigaBytes
Max Memory Allocated: 6.128386974334717  GigaBytes

 h.shape torch.Size([1, 1046, 256]), torch.Size([1, 1046, 256])
----------------------------------------3
 Nvidia-smi: 7.3983154296875 GB
    Memory Allocated: 6.128381729125977  GigaBytes
Max Memory Allocated: 6.128386974334717  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.301434516906738  GigaBytes
Max Memory Allocated: 6.3134050369262695  GigaBytes

rst.shape  torch.Size([1, 1046, 256])
m.shape torch.Size([881, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.311364650726318  GigaBytes
Max Memory Allocated: 6.3134050369262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5877685546875 GB
    Memory Allocated: 6.311364650726318  GigaBytes
Max Memory Allocated: 6.3134050369262695  GigaBytes

 h.shape torch.Size([1, 881, 256]), torch.Size([1, 881, 256])
----------------------------------------3
 Nvidia-smi: 7.5897216796875 GB
    Memory Allocated: 6.313045024871826  GigaBytes
Max Memory Allocated: 6.3134050369262695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7459716796875 GB
    Memory Allocated: 6.470157146453857  GigaBytes
Max Memory Allocated: 6.481875896453857  GigaBytes

rst.shape  torch.Size([1, 881, 256])
m.shape torch.Size([789, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7459716796875 GB
    Memory Allocated: 6.479933738708496  GigaBytes
Max Memory Allocated: 6.481875896453857  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7459716796875 GB
    Memory Allocated: 6.479933738708496  GigaBytes
Max Memory Allocated: 6.481875896453857  GigaBytes

 h.shape torch.Size([1, 789, 256]), torch.Size([1, 789, 256])
----------------------------------------3
 Nvidia-smi: 7.7459716796875 GB
    Memory Allocated: 6.481438636779785  GigaBytes
Max Memory Allocated: 6.481875896453857  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9237060546875 GB
    Memory Allocated: 6.630492210388184  GigaBytes
Max Memory Allocated: 6.641026496887207  GigaBytes

rst.shape  torch.Size([1, 789, 256])
m.shape torch.Size([701, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9237060546875 GB
    Memory Allocated: 6.639846324920654  GigaBytes
Max Memory Allocated: 6.641026496887207  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9237060546875 GB
    Memory Allocated: 6.639846324920654  GigaBytes
Max Memory Allocated: 6.641026496887207  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 7.9256591796875 GB
    Memory Allocated: 6.641183376312256  GigaBytes
Max Memory Allocated: 6.641183376312256  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.789205074310303  GigaBytes
Max Memory Allocated: 6.7992329597473145  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([570, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.79730224609375  GigaBytes
Max Memory Allocated: 6.7992329597473145  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.79730224609375  GigaBytes
Max Memory Allocated: 6.7992329597473145  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 8.0467529296875 GB
    Memory Allocated: 6.798389434814453  GigaBytes
Max Memory Allocated: 6.7992329597473145  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1756591796875 GB
    Memory Allocated: 6.922096252441406  GigaBytes
Max Memory Allocated: 6.930793762207031  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([552, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1756591796875 GB
    Memory Allocated: 6.930572032928467  GigaBytes
Max Memory Allocated: 6.930793762207031  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1756591796875 GB
    Memory Allocated: 6.930572032928467  GigaBytes
Max Memory Allocated: 6.930793762207031  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 8.1756591796875 GB
    Memory Allocated: 6.931624889373779  GigaBytes
Max Memory Allocated: 6.931624889373779  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3162841796875 GB
    Memory Allocated: 7.0610575675964355  GigaBytes
Max Memory Allocated: 7.070006847381592  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([452, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3162841796875 GB
    Memory Allocated: 7.0683512687683105  GigaBytes
Max Memory Allocated: 7.070006847381592  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3162841796875 GB
    Memory Allocated: 7.0683512687683105  GigaBytes
Max Memory Allocated: 7.070006847381592  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 8.3162841796875 GB
    Memory Allocated: 7.069213390350342  GigaBytes
Max Memory Allocated: 7.070006847381592  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.1824235916137695  GigaBytes
Max Memory Allocated: 7.190182685852051  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([390, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.189114570617676  GigaBytes
Max Memory Allocated: 7.190182685852051  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.189114570617676  GigaBytes
Max Memory Allocated: 7.190182685852051  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 8.4256591796875 GB
    Memory Allocated: 7.189858436584473  GigaBytes
Max Memory Allocated: 7.190182685852051  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5155029296875 GB
    Memory Allocated: 7.290874481201172  GigaBytes
Max Memory Allocated: 7.297941207885742  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([403, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5155029296875 GB
    Memory Allocated: 7.298249244689941  GigaBytes
Max Memory Allocated: 7.298279285430908  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5155029296875 GB
    Memory Allocated: 7.298249244689941  GigaBytes
Max Memory Allocated: 7.298279285430908  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 8.5155029296875 GB
    Memory Allocated: 7.299017906188965  GigaBytes
Max Memory Allocated: 7.299017906188965  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6502685546875 GB
    Memory Allocated: 7.4073991775512695  GigaBytes
Max Memory Allocated: 7.415085792541504  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([341, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6502685546875 GB
    Memory Allocated: 7.413897514343262  GigaBytes
Max Memory Allocated: 7.415085792541504  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6502685546875 GB
    Memory Allocated: 7.413897514343262  GigaBytes
Max Memory Allocated: 7.415085792541504  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 8.6502685546875 GB
    Memory Allocated: 7.414547920227051  GigaBytes
Max Memory Allocated: 7.415085792541504  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7420654296875 GB
    Memory Allocated: 7.512101173400879  GigaBytes
Max Memory Allocated: 7.518930435180664  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([280, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.7420654296875 GB
    Memory Allocated: 7.517696857452393  GigaBytes
Max Memory Allocated: 7.518930435180664  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7420654296875 GB
    Memory Allocated: 7.517696857452393  GigaBytes
Max Memory Allocated: 7.518930435180664  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.7420654296875 GB
    Memory Allocated: 7.51823091506958  GigaBytes
Max Memory Allocated: 7.518930435180664  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8084716796875 GB
    Memory Allocated: 7.603104114532471  GigaBytes
Max Memory Allocated: 7.608978748321533  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([247, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8084716796875 GB
    Memory Allocated: 7.608297348022461  GigaBytes
Max Memory Allocated: 7.608978748321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8084716796875 GB
    Memory Allocated: 7.608297348022461  GigaBytes
Max Memory Allocated: 7.608978748321533  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.8084716796875 GB
    Memory Allocated: 7.608768463134766  GigaBytes
Max Memory Allocated: 7.608978748321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9080810546875 GB
    Memory Allocated: 7.685089111328125  GigaBytes
Max Memory Allocated: 7.690506935119629  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([235, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.9080810546875 GB
    Memory Allocated: 7.690274715423584  GigaBytes
Max Memory Allocated: 7.690506935119629  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.9080810546875 GB
    Memory Allocated: 7.690274715423584  GigaBytes
Max Memory Allocated: 7.690506935119629  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 8.9080810546875 GB
    Memory Allocated: 7.690722942352295  GigaBytes
Max Memory Allocated: 7.690722942352295  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9881591796875 GB
    Memory Allocated: 7.766473293304443  GigaBytes
Max Memory Allocated: 7.771852016448975  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([2991, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.0623779296875 GB
    Memory Allocated: 7.839072227478027  GigaBytes
Max Memory Allocated: 7.839351177215576  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0623779296875 GB
    Memory Allocated: 7.839072227478027  GigaBytes
Max Memory Allocated: 7.839351177215576  GigaBytes

 h.shape torch.Size([1, 2991, 256]), torch.Size([1, 2991, 256])
----------------------------------------3
 Nvidia-smi: 9.0623779296875 GB
    Memory Allocated: 7.8453569412231445  GigaBytes
Max Memory Allocated: 7.8453569412231445  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2127685546875 GB
    Memory Allocated: 8.865483283996582  GigaBytes
Max Memory Allocated: 8.937748908996582  GigaBytes

rst.shape  torch.Size([1, 2991, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.57628583908081  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.583199977874756  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.590114116668701  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.582854270935059  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

torch.Size([46399, 40])
input nodes number: 71197
output nodes number: 46399
edges number: 344358
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.590644836425781  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.3026123046875 GB
    Memory Allocated: 8.590645790100098  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.07495355606079102  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

pseudo mini batch 1 input nodes size: 127886
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.05651235580444336  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.05651235580444336  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.1174931526184082  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.11782503128051758  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.07378053665161133  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.08225488662719727  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.08225488662719727  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.08225488662719727  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

torch.Size([127886, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 0.08225488662719727  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

m.shape torch.Size([9047, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.43396997451782227  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.43396997451782227  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 9047, 128]), torch.Size([1, 9047, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.4425978660583496  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.5125880241394043  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 9047, 128])
m.shape torch.Size([9005, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.5168619155883789  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.5168619155883789  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 9005, 128]), torch.Size([1, 9005, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.5254497528076172  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.656682014465332  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 9005, 128])
m.shape torch.Size([7707, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.6641068458557129  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.6641068458557129  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 7707, 128]), torch.Size([1, 7707, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.6715316772460938  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.8430190086364746  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 7707, 128])
m.shape torch.Size([6693, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.8530158996582031  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.8530158996582031  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 6693, 128]), torch.Size([1, 6693, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 0.8598823547363281  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.0558595657348633  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 6693, 128])
m.shape torch.Size([5933, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.0668134689331055  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.0668134689331055  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 5933, 128]), torch.Size([1, 5933, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.0729951858520508  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.284677505493164  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 5933, 128])
m.shape torch.Size([4998, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.2961478233337402  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.2961478233337402  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 4998, 128]), torch.Size([1, 4998, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.3014836311340332  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.506441593170166  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 4998, 128])
m.shape torch.Size([4556, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.5196833610534668  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.5196833610534668  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 4556, 128]), torch.Size([1, 4556, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.524055004119873  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.7415156364440918  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 4556, 128])
m.shape torch.Size([4063, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.7549548149108887  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.7549548149108887  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 4063, 128]), torch.Size([1, 4063, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.7592434883117676  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.9817523956298828  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 4063, 128])
m.shape torch.Size([3669, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.995560646057129  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.995560646057129  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 3669, 128]), torch.Size([1, 3669, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 1.9991497993469238  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 2.2250514030456543  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 3669, 128])
m.shape torch.Size([47502, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 2.449726104736328  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 2.449726104736328  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 47502, 128]), torch.Size([1, 47502, 128])
----------------------------------------3
 Nvidia-smi: 11.3162841796875 GB
    Memory Allocated: 2.496601104736328  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.715363502502441  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 47502, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.401175022125244  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.499568462371826  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.597961902618408  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.4987993240356445  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

torch.Size([103173, 256])
first layer input nodes number: 127886
first layer output nodes number: 103173
edges number: 709040
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.598917007446289  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.697310447692871  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.721909046173096  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.2869873046875 GB
    Memory Allocated: 5.721909046173096  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

m.shape torch.Size([6658, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.114935398101807  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.114935398101807  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 6658, 256]), torch.Size([1, 6658, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.1282830238342285  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.231173038482666  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 6658, 256])
m.shape torch.Size([5591, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.235246658325195  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.235246658325195  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 5591, 256]), torch.Size([1, 5591, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.24591064453125  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.40587043762207  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 5591, 256])
m.shape torch.Size([4237, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.413601398468018  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.413601398468018  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 4237, 256]), torch.Size([1, 4237, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.4222092628479  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.605088710784912  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 4237, 256])
m.shape torch.Size([3311, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.613097190856934  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.613097190856934  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 3311, 256]), torch.Size([1, 3311, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.6199631690979  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.811220645904541  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 3311, 256])
m.shape torch.Size([2878, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.82108211517334  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.82108211517334  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 2878, 256]), torch.Size([1, 2878, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 6.826898097991943  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.02753210067749  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 2878, 256])
m.shape torch.Size([2154, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.036959171295166  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.036959171295166  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 2154, 256]), torch.Size([1, 2154, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.041347026824951  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.223301887512207  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 2154, 256])
m.shape torch.Size([1757, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.233068943023682  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.233068943023682  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 1757, 256]), torch.Size([1, 1757, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.236812114715576  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.414672374725342  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 1757, 256])
m.shape torch.Size([1522, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.424699783325195  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.424699783325195  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 1522, 256]), torch.Size([1, 1522, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.4276556968688965  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.59979248046875  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 1522, 256])
m.shape torch.Size([1343, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.609958171844482  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.609958171844482  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 1343, 256]), torch.Size([1, 1343, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.61257791519165  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.77864933013916  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 1343, 256])
m.shape torch.Size([1153, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.788662433624268  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.788662433624268  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 1153, 256]), torch.Size([1, 1153, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.790956020355225  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.950978755950928  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 1153, 256])
m.shape torch.Size([991, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.960176944732666  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.960176944732666  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 991, 256]), torch.Size([1, 991, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 7.962067127227783  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.115893840789795  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 991, 256])
m.shape torch.Size([891, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.12522554397583  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.12522554397583  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.126924991607666  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.27137804031372  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([775, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.280211925506592  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.280211925506592  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 775, 256]), torch.Size([1, 775, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.281690120697021  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.417684078216553  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 775, 256])
m.shape torch.Size([645, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.425624370574951  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.425624370574951  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 645, 256]), torch.Size([1, 645, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.426854610443115  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.549182415008545  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 645, 256])
m.shape torch.Size([588, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.557044506072998  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.557044506072998  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.558166027069092  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.677306652069092  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([541, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.685065746307373  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.685065746307373  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 541, 256]), torch.Size([1, 541, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.686097621917725  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.807578563690186  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 541, 256])
m.shape torch.Size([478, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.814872741699219  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.814872741699219  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.815784454345703  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.926717758178711  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([496, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.934919357299805  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.934919357299805  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 8.93586540222168  GigaBytes
Max Memory Allocated: 8.996914386749268  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.059064865112305  GigaBytes
Max Memory Allocated: 9.06757926940918  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([446, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.066736698150635  GigaBytes
Max Memory Allocated: 9.06757926940918  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.066736698150635  GigaBytes
Max Memory Allocated: 9.06757926940918  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.06758737564087  GigaBytes
Max Memory Allocated: 9.06758737564087  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.185871601104736  GigaBytes
Max Memory Allocated: 9.193953037261963  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([404, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.193212509155273  GigaBytes
Max Memory Allocated: 9.193953037261963  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.193212509155273  GigaBytes
Max Memory Allocated: 9.193953037261963  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.19398307800293  GigaBytes
Max Memory Allocated: 9.19398307800293  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.303354263305664  GigaBytes
Max Memory Allocated: 9.311059951782227  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([376, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.310558319091797  GigaBytes
Max Memory Allocated: 9.311059951782227  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.310558319091797  GigaBytes
Max Memory Allocated: 9.311059951782227  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.311275482177734  GigaBytes
Max Memory Allocated: 9.311275482177734  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.421329498291016  GigaBytes
Max Memory Allocated: 9.42885971069336  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([276, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.426806926727295  GigaBytes
Max Memory Allocated: 9.42885971069336  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.426806926727295  GigaBytes
Max Memory Allocated: 9.42885971069336  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.427333354949951  GigaBytes
Max Memory Allocated: 9.42885971069336  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.51292610168457  GigaBytes
Max Memory Allocated: 9.518716812133789  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([272, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.518675804138184  GigaBytes
Max Memory Allocated: 9.518716812133789  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.518675804138184  GigaBytes
Max Memory Allocated: 9.518716812133789  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.519194602966309  GigaBytes
Max Memory Allocated: 9.519194602966309  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.605673789978027  GigaBytes
Max Memory Allocated: 9.611639976501465  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([290, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.612103939056396  GigaBytes
Max Memory Allocated: 9.612130165100098  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.612103939056396  GigaBytes
Max Memory Allocated: 9.612130165100098  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.612657070159912  GigaBytes
Max Memory Allocated: 9.612657070159912  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6697998046875 GB
    Memory Allocated: 9.709271907806396  GigaBytes
Max Memory Allocated: 9.715909481048584  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([6469, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.8240966796875 GB
    Memory Allocated: 9.864497184753418  GigaBytes
Max Memory Allocated: 9.865099906921387  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.8240966796875 GB
    Memory Allocated: 9.864497184753418  GigaBytes
Max Memory Allocated: 9.865099906921387  GigaBytes

 h.shape torch.Size([1, 6469, 256]), torch.Size([1, 6469, 256])
----------------------------------------3
 Nvidia-smi: 13.8240966796875 GB
    Memory Allocated: 9.876835823059082  GigaBytes
Max Memory Allocated: 9.876835823059082  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 12.086243629455566  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6469, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.73744010925293  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.74411392211914  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.750751495361328  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.743745803833008  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([44542, 40])
input nodes number: 103173
output nodes number: 44542
edges number: 399892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.744570255279541  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.3240966796875 GB
    Memory Allocated: 11.7445707321167  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes
[17:43:13] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23400434 edges into 2 parts and get 180663 edge cuts

-----------------------------------------after loss backward
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.09809303283691406  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.10364341735839844  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.10364341735839844  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06142568588256836 |0.16919922828674316 |0.4407622814178467 |0.00016939640045166016 |0.16248106956481934 |0.005799055099487305 |
----------------------------------------------------------pseudo_mini_loss sum 5.301281929016113
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  393899
Number of first layer input nodes during this epoch:  219529
Number of first layer output nodes during this epoch:  174370
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.10364294052124023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019014596939086914
global_2_local spend time (sec) 0.03980445861816406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0044863224029541016
A = g.adjacency_matrix() spent  0.007708311080932617
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0781404972076416
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.411675214767456
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1997616291046143

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434})
Convert a graph into a bidirected graph: 1.096 seconds
Metis partitioning: 4.349 seconds
Split the graph: 3.586 seconds
Construct subgraphs: 0.037 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.079342126846313
46466
44475
total k batches seeds list generation spend  20.247730255126953
after graph partition
graph partition algorithm spend time 20.373889446258545
46466
44475
partition_len_list
[71072, 101066]
shared_neighbor_graph_partition_s0 selection method  spend 20.46402931213379
time for parepare:  0.018065452575683594
local_output_nid generation:  0.0047893524169921875
local_in_edges_tensor generation:  0.006307125091552734
mini_batch_src_global generation:  0.01292872428894043
r_  generation:  0.12262701988220215
local_output_nid generation:  0.006194353103637695
local_in_edges_tensor generation:  0.01060795783996582
mini_batch_src_global generation:  0.018509864807128906
r_  generation:  0.14699220657348633
----------------------check_connections_block total spend ----------------------------- 0.418520450592041
generate_one_block  0.1683206558227539
generate_one_block  0.18949294090270996
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05167412757873535
gen group dst list time:  0.0046062469482421875
time for parepare:  0.020080089569091797
local_output_nid generation:  0.008609533309936523
local_in_edges_tensor generation:  0.01898813247680664
mini_batch_src_global generation:  0.012377500534057617
r_  generation:  0.16141915321350098
local_output_nid generation:  0.014046907424926758
local_in_edges_tensor generation:  0.018311500549316406
mini_batch_src_global generation:  0.02572321891784668
r_  generation:  0.25167107582092285
----------------------check_connections_block total spend ----------------------------- 0.6247458457946777
generate_one_block  0.18506288528442383
generate_one_block  0.3170285224914551
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.10364294052124023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

connection checking time:  0.6247458457946777
block generation total time  0.5020914077758789
average batch blocks generation time:  0.25104570388793945
block dataloader generation time/epoch 22.53720188140869
pseudo mini batch 0 input nodes size: 91128
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.07905340194702148  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.12250661849975586  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.12285327911376953  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.06154060363769531  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.06733942031860352  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.06733942031860352  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.06733942031860352  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([91128, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.06733942031860352  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([8646, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.27269744873046875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.27269744873046875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8646, 128]), torch.Size([1, 8646, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.2809429168701172  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.3469066619873047  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8646, 128])
m.shape torch.Size([8676, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.3510580062866211  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.3510580062866211  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8676, 128]), torch.Size([1, 8676, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.3593320846557617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.4834432601928711  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8676, 128])
m.shape torch.Size([7471, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.4899935722351074  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.4899935722351074  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 7471, 128]), torch.Size([1, 7471, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.4975752830505371  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.6547799110412598  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 7471, 128])
m.shape torch.Size([6282, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.6641111373901367  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.6641111373901367  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6282, 128]), torch.Size([1, 6282, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.6710004806518555  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.8471741676330566  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6282, 128])
m.shape torch.Size([5324, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.8568720817565918  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.8568720817565918  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5324, 128]), torch.Size([1, 5324, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 0.8625998497009277  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.0460352897644043  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5324, 128])
m.shape torch.Size([4362, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.055976390838623  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.055976390838623  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4362, 128]), torch.Size([1, 4362, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.0605950355529785  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.2394719123840332  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4362, 128])
m.shape torch.Size([3711, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.2497787475585938  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.2497787475585938  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3711, 128]), torch.Size([1, 3711, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.2533178329467773  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.430272102355957  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3711, 128])
m.shape torch.Size([3248, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.4408926963806152  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.4408926963806152  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3248, 128]), torch.Size([1, 3248, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.4440207481384277  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.6210508346557617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3248, 128])
m.shape torch.Size([2738, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.631171703338623  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.631171703338623  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2738, 128]), torch.Size([1, 2738, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.6338095664978027  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.8089299201965332  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2738, 128])
m.shape torch.Size([20614, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.9058499336242676  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.9058499336242676  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 20614, 128]), torch.Size([1, 20614, 128])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 1.925508975982666  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.321300983428955  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 20614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.148566246032715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.216925621032715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.28470516204834  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.215816020965576  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([71072, 256])
first layer input nodes number: 91128
first layer output nodes number: 71072
edges number: 409074
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.285386085510254  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.353745460510254  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.370743751525879  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.370743751525879  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([6768, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.709775924682617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.709775924682617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6768, 256]), torch.Size([1, 6768, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.722684860229492  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.825956344604492  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6768, 256])
m.shape torch.Size([6151, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.8313260078430176  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.8313260078430176  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6151, 256]), torch.Size([1, 6151, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 3.84364652633667  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.019628047943115  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6151, 256])
m.shape torch.Size([5035, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.028280258178711  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.028280258178711  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5035, 256]), torch.Size([1, 5035, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.037883758544922  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.252079010009766  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5035, 256])
m.shape torch.Size([4037, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.2630228996276855  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.2630228996276855  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4037, 256]), torch.Size([1, 4037, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.270808696746826  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.497341632843018  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4037, 256])
m.shape torch.Size([3373, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.509419918060303  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.509419918060303  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3373, 256]), torch.Size([1, 3373, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.516171932220459  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.754415035247803  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3373, 256])
m.shape torch.Size([2706, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.76657247543335  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.76657247543335  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2706, 256]), torch.Size([1, 2706, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.7720046043396  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 4.994645118713379  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2706, 256])
m.shape torch.Size([2274, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.007363796234131  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.007363796234131  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2274, 256]), torch.Size([1, 2274, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.012074947357178  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.240479946136475  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2274, 256])
m.shape torch.Size([1944, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.25325870513916  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.25325870513916  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1944, 256]), torch.Size([1, 1944, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.257037162780762  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.469454765319824  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1944, 256])
m.shape torch.Size([1636, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.481664180755615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.481664180755615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1636, 256]), torch.Size([1, 1636, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.484922885894775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.6963114738464355  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1636, 256])
m.shape torch.Size([1438, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.70843505859375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.70843505859375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1438, 256]), torch.Size([1, 1438, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.711185455322266  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.914127349853516  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1438, 256])
m.shape torch.Size([1234, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.925476551055908  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.925476551055908  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1234, 256]), torch.Size([1, 1234, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 5.9278883934021  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.129212856292725  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1234, 256])
m.shape torch.Size([1055, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.140203952789307  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.140203952789307  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1055, 256]), torch.Size([1, 1055, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.142256259918213  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.324380397796631  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1055, 256])
m.shape torch.Size([896, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.3349432945251465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.3349432945251465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.3366522789001465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.494412899017334  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([786, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.504134654998779  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.504134654998779  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.50563383102417  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.654433727264404  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([702, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.66380500793457  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.66380500793457  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.665143966674805  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.811788558959961  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([573, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.8199310302734375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.8199310302734375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.821023941040039  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.946071624755859  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([552, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.954544544219971  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.954544544219971  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 6.955597400665283  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.084412097930908  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([460, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.091844081878662  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.091844081878662  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.092721462249756  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.205995082855225  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([400, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.212861061096191  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.212861061096191  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.213624000549316  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.316739082336426  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([398, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.324008464813232  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.324008464813232  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.324767589569092  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.431804180145264  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([341, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.438307285308838  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.438307285308838  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.438957691192627  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.535984516143799  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([276, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.541495323181152  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.541495323181152  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.542021751403809  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.626742362976074  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([251, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.632028102874756  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.632028102874756  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.632506847381592  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.710063457489014  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([237, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.7152910232543945  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.7152910232543945  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 16.0897216796875 GB
    Memory Allocated: 7.715743064880371  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 7.79213809967041  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([2943, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 7.862627029418945  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 7.862627029418945  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2943, 256]), torch.Size([1, 2943, 256])
----------------------------------------3
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 7.8682403564453125  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.856839179992676  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2943, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.568261623382568  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.575185775756836  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.582109928131104  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.574839115142822  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([46466, 40])
input nodes number: 71072
output nodes number: 46466
edges number: 344075
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.57600212097168  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0955810546875 GB
    Memory Allocated: 8.576003074645996  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.07881355285644531  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

pseudo mini batch 1 input nodes size: 123670
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.0618281364440918  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.0618281364440918  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12079858779907227  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12112998962402344  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.07733011245727539  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08549165725708008  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08549165725708008  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08549165725708008  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([123670, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08549165725708008  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([8959, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.43018102645874023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.43018102645874023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8959, 128]), torch.Size([1, 8959, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.43872499465942383  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.508547306060791  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8959, 128])
m.shape torch.Size([8811, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5126781463623047  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5126781463623047  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8811, 128]), torch.Size([1, 8811, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5211515426635742  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6518287658691406  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8811, 128])
m.shape torch.Size([7534, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6593461036682129  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6593461036682129  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 7534, 128]), torch.Size([1, 7534, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.667140007019043  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.828033447265625  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 7534, 128])
m.shape torch.Size([6480, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8368005752563477  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8368005752563477  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6480, 128]), torch.Size([1, 6480, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8431501388549805  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0240345001220703  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6480, 128])
m.shape torch.Size([5735, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0346179008483887  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0346179008483887  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5735, 128]), torch.Size([1, 5735, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0404424667358398  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2513799667358398  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5735, 128])
m.shape torch.Size([4850, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2617411613464355  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2617411613464355  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4850, 128]), torch.Size([1, 4850, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2668728828430176  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.46793794631958  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4850, 128])
m.shape torch.Size([4396, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4396, 128]), torch.Size([1, 4396, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4860310554504395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.6973638534545898  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4396, 128])
m.shape torch.Size([3976, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.710892677307129  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.710892677307129  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3976, 128]), torch.Size([1, 3976, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.71474027633667  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9325900077819824  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3976, 128])
m.shape torch.Size([3572, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9463191032409668  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9463191032409668  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3572, 128]), torch.Size([1, 3572, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9499640464782715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.1755423545837402  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3572, 128])
m.shape torch.Size([46753, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.3967747688293457  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.3967747688293457  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 46753, 128]), torch.Size([1, 46753, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.441361904144287  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.607048511505127  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 46753, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.297423839569092  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.393807888031006  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.49019193649292  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.393054485321045  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([101066, 256])
first layer input nodes number: 123670
first layer output nodes number: 101066
edges number: 695136
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.491115570068359  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.587499618530273  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.611595630645752  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.611595630645752  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([6660, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.005674362182617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.005674362182617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6660, 256]), torch.Size([1, 6660, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.018377304077148  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.120969772338867  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6660, 256])
m.shape torch.Size([5555, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.125296592712402  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.125296592712402  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5555, 256]), torch.Size([1, 5555, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.135891914367676  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.294821739196777  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5555, 256])
m.shape torch.Size([4242, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.301755428314209  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.301755428314209  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4242, 256]), torch.Size([1, 4242, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.309922695159912  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.490171909332275  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4242, 256])
m.shape torch.Size([3283, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.498658657073975  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.498658657073975  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3283, 256]), torch.Size([1, 3283, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.50534200668335  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.688572406768799  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3283, 256])
m.shape torch.Size([2849, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.699132919311523  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.699132919311523  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2849, 256]), torch.Size([1, 2849, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.704944133758545  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.905070781707764  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2849, 256])
m.shape torch.Size([2162, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.9144415855407715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.9144415855407715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2162, 256]), torch.Size([1, 2162, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.9191365242004395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.110126972198486  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2162, 256])
m.shape torch.Size([1771, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.119419574737549  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.119419574737549  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1771, 256]), torch.Size([1, 1771, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.1234822273254395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.299336910247803  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1771, 256])
m.shape torch.Size([1528, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.309396743774414  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.309396743774414  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1528, 256]), torch.Size([1, 1528, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.312493801116943  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.4843831062316895  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1528, 256])
m.shape torch.Size([1340, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.494330406188965  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.494330406188965  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1340, 256]), torch.Size([1, 1340, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.496937274932861  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.661978244781494  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1340, 256])
m.shape torch.Size([1161, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.67172908782959  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.67172908782959  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.673990726470947  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.841421604156494  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
m.shape torch.Size([969, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.850411415100098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.850411415100098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.852259635925293  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.00445556640625  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([882, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.013704299926758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.013704299926758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.015386581420898  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.158380508422852  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([760, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.167035579681396  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.167035579681396  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.168485164642334  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.30372953414917  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([648, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.311724185943604  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.311724185943604  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 648, 256]), torch.Size([1, 648, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.312960147857666  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.436975955963135  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 648, 256])
m.shape torch.Size([587, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.444820880889893  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.444820880889893  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.445940494537354  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.564756870269775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([538, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.572470664978027  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.572470664978027  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.57349681854248  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.690919876098633  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([478, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.698216915130615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.698216915130615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 478, 256]), torch.Size([1, 478, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.6991286277771  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.808534145355225  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 478, 256])
m.shape torch.Size([488, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.816521167755127  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.816521167755127  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.81745195388794  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.93934679031372  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([436, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.94684362411499  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.94684362411499  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.947675228118896  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.059567928314209  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([409, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.067014217376709  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.067014217376709  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.06779432296753  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.182069301605225  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([376, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.189268589019775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.189268589019775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.189985752105713  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.299423694610596  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([280, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.304986000061035  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.304986000061035  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.305520057678223  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.394334316253662  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([268, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.399991989135742  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.399991989135742  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.400503158569336  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.483969688415527  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([288, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.490357398986816  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.490357398986816  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.490906715393066  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.587983131408691  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([6517, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.74429988861084  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.74429988861084  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6517, 256]), torch.Size([1, 6517, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.756730079650879  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.96660041809082  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6517, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.618039608001709  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.625360012054443  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes
[17:43:37] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23407770 edges into 2 parts and get 174357 edge cuts

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.631987571716309  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.624335765838623  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([44475, 40])
input nodes number: 101066
output nodes number: 44475
edges number: 400175
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.625123977661133  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.625124454498291  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10089397430419922  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10089397430419922  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10089397430419922  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05569899082183838 |0.0043076276779174805 |0.16668903827667236 |0.0001214742660522461 |0.14610493183135986 |0.007449626922607422 |
----------------------------------------------------------pseudo_mini_loss sum 4.274548530578613
Total (block generation + training)time/epoch 23.367588996887207
Training time/epoch 0.8298864364624023
Training time without block to device /epoch 0.8212711811065674
Training time without total dataloading part /epoch 0.6332805156707764
load block tensor time/epoch 0.11139798164367676
block to device time/epoch 0.008615255355834961
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  386936
Number of first layer input nodes during this epoch:  214798
Number of first layer output nodes during this epoch:  172138
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10089349746704102  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016928672790527344
global_2_local spend time (sec) 0.040784358978271484
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004402637481689453
A = g.adjacency_matrix() spent  0.009613513946533203
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07951736450195312
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3072161674499512
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2797482013702393

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770})
Convert a graph into a bidirected graph: 1.141 seconds
Metis partitioning: 4.559 seconds
Split the graph: 3.376 seconds
Construct subgraphs: 0.048 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.134707927703857
46464
44477
total k batches seeds list generation spend  20.024434566497803
after graph partition
graph partition algorithm spend time 20.131038665771484
46464
44477
partition_len_list
[71700, 102248]
shared_neighbor_graph_partition_s0 selection method  spend 20.22484040260315
time for parepare:  0.018573999404907227
local_output_nid generation:  0.004996061325073242
local_in_edges_tensor generation:  0.006392717361450195
mini_batch_src_global generation:  0.011704206466674805
r_  generation:  0.11962342262268066
local_output_nid generation:  0.005823850631713867
local_in_edges_tensor generation:  0.008744955062866211
mini_batch_src_global generation:  0.01477360725402832
r_  generation:  0.1456449031829834
----------------------check_connections_block total spend ----------------------------- 0.41197800636291504
generate_one_block  0.16494035720825195
generate_one_block  0.18776893615722656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0507969856262207
gen group dst list time:  0.00478816032409668
time for parepare:  0.01963353157043457
local_output_nid generation:  0.00876760482788086
local_in_edges_tensor generation:  0.027538776397705078
mini_batch_src_global generation:  0.01286935806274414
r_  generation:  0.16160893440246582
local_output_nid generation:  0.014106512069702148
local_in_edges_tensor generation:  0.023499011993408203
mini_batch_src_global generation:  0.03093409538269043
r_  generation:  0.2569897174835205
----------------------check_connections_block total spend ----------------------------- 0.6517949104309082
generate_one_block  0.18880963325500488
generate_one_block  0.32252001762390137
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10089349746704102  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

connection checking time:  0.6517949104309082
block generation total time  0.5113296508789062
average batch blocks generation time:  0.2556648254394531
block dataloader generation time/epoch 22.424971103668213
pseudo mini batch 0 input nodes size: 91776
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.07703256607055664  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.07703256607055664  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12079477310180664  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12114095687866211  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.06183910369873047  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.06746387481689453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.06746387481689453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.06746387481689453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([91776, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.06746387481689453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([8839, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.27411365509033203  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.27411365509033203  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8839, 128]), torch.Size([1, 8839, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.2825431823730469  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.35213661193847656  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8839, 128])
m.shape torch.Size([8864, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.35637521743774414  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.35637521743774414  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8864, 128]), torch.Size([1, 8864, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.36482858657836914  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.49565744400024414  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8864, 128])
m.shape torch.Size([7587, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5031495094299316  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5031495094299316  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 7587, 128]), torch.Size([1, 7587, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5109820365905762  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6715421676635742  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 7587, 128])
m.shape torch.Size([6336, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6800093650817871  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6800093650817871  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6336, 128]), torch.Size([1, 6336, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6865401268005371  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8636727333068848  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6336, 128])
m.shape torch.Size([5330, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8743233680725098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8743233680725098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5330, 128]), torch.Size([1, 5330, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8799996376037598  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.062990665435791  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5330, 128])
m.shape torch.Size([4403, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0730462074279785  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0730462074279785  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4403, 128]), torch.Size([1, 4403, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0776872634887695  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2582454681396484  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4403, 128])
m.shape torch.Size([3717, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2685527801513672  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2685527801513672  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3717, 128]), torch.Size([1, 3717, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2720975875854492  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4493379592895508  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3717, 128])
m.shape torch.Size([3251, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4599671363830566  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4599671363830566  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3251, 128]), torch.Size([1, 3251, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4630722999572754  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.639906406402588  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3251, 128])
m.shape torch.Size([2765, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.6501855850219727  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.6501855850219727  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2765, 128]), torch.Size([1, 2765, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.653195858001709  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.8331570625305176  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2765, 128])
m.shape torch.Size([20608, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9296178817749023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9296178817749023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 20608, 128]), torch.Size([1, 20608, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9492712020874023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.3446569442749023  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 20608, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.1727542877197266  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.2411327362060547  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.309511184692383  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.240598201751709  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([71700, 256])
first layer input nodes number: 91776
first layer output nodes number: 71700
edges number: 410732
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.310196876525879  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.378575325012207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.396153450012207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.396153450012207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([6812, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.7355971336364746  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.7355971336364746  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6812, 256]), torch.Size([1, 6812, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.7485899925231934  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.8525328636169434  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6812, 256])
m.shape torch.Size([6156, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.857870101928711  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.857870101928711  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6156, 256]), torch.Size([1, 6156, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 3.8701858520507812  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.0463104248046875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6156, 256])
m.shape torch.Size([5032, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.054948806762695  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.054948806762695  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5032, 256]), torch.Size([1, 5032, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.065362930297852  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.279535293579102  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5032, 256])
m.shape torch.Size([4021, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.2904815673828125  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.2904815673828125  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4021, 256]), torch.Size([1, 4021, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.2981719970703125  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.522029876708984  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4021, 256])
m.shape torch.Size([3371, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.534346580505371  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.534346580505371  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3371, 256]), torch.Size([1, 3371, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.540915012359619  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.77442741394043  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3371, 256])
m.shape torch.Size([2689, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.786477565765381  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.786477565765381  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2689, 256]), torch.Size([1, 2689, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 4.791741847991943  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.0136003494262695  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2689, 256])
m.shape torch.Size([2270, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.026308536529541  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.026308536529541  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2270, 256]), torch.Size([1, 2270, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.0310893058776855  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.259702205657959  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2270, 256])
m.shape torch.Size([1942, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.272469520568848  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.272469520568848  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1942, 256]), torch.Size([1, 1942, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.276224136352539  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.48867130279541  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1942, 256])
m.shape torch.Size([1641, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.5008015632629395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.5008015632629395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1641, 256]), torch.Size([1, 1641, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.504032135009766  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.716347694396973  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1641, 256])
m.shape torch.Size([1443, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.728507995605469  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.728507995605469  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1443, 256]), torch.Size([1, 1443, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.731594085693359  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.936118125915527  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1443, 256])
m.shape torch.Size([1224, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.947682857513428  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.947682857513428  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1224, 256]), torch.Size([1, 1224, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.950040340423584  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.140957355499268  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1224, 256])
m.shape torch.Size([1046, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.151171684265137  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.151171684265137  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1046, 256]), torch.Size([1, 1046, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.153170585632324  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.326857566833496  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1046, 256])
m.shape torch.Size([894, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.337030410766602  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.337030410766602  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.338735580444336  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.497793197631836  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 894, 256])
m.shape torch.Size([782, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.507463455200195  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.507463455200195  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.508955001831055  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.656686782836914  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([695, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.666600704193115  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.666600704193115  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 695, 256]), torch.Size([1, 695, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.66792631149292  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.8143229484558105  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 695, 256])
m.shape torch.Size([567, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.8223795890808105  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.8223795890808105  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.823461055755615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.947509288787842  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([550, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.955955505371094  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.955955505371094  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 550, 256]), torch.Size([1, 550, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.957004547119141  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.085931777954102  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 550, 256])
m.shape torch.Size([453, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.093244552612305  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.093244552612305  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.094108581542969  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.205961227416992  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([397, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.2127790451049805  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.2127790451049805  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.213536262512207  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.316047668457031  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([389, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.323146820068359  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.323146820068359  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 389, 256]), torch.Size([1, 389, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.323888778686523  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.429523468017578  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 389, 256])
m.shape torch.Size([338, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.435974597930908  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.435974597930908  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.436619281768799  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.532907962799072  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([278, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.538464069366455  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.538464069366455  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.538994312286377  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.624327182769775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([248, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.629849910736084  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.629849910736084  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.6303229331970215  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.7069525718688965  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([237, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.712182998657227  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.712182998657227  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.712635040283203  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.789030075073242  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([2989, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.860624313354492  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.860624313354492  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2989, 256]), torch.Size([1, 2989, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.866325378417969  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.874107360839844  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2989, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.585721015930176  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.592644691467285  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.599568367004395  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.59229850769043  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([46464, 40])
input nodes number: 71700
output nodes number: 46464
edges number: 344159
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.593475341796875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.593476295471191  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08081912994384766  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

pseudo mini batch 1 input nodes size: 126322
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.062136173248291016  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.062136173248291016  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12237119674682617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.12270259857177734  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.07859420776367188  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08682823181152344  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08682823181152344  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08682823181152344  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([126322, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.08682823181152344  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([8894, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.43629932403564453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.43629932403564453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8894, 128]), torch.Size([1, 8894, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.4447813034057617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5144796371459961  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8894, 128])
m.shape torch.Size([8832, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5186614990234375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5186614990234375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 8832, 128]), torch.Size([1, 8832, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.5270843505859375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6578216552734375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 8832, 128])
m.shape torch.Size([7638, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6653289794921875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6653289794921875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 7638, 128]), torch.Size([1, 7638, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.6728363037109375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8348960876464844  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 7638, 128])
m.shape torch.Size([6548, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8437433242797852  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8437433242797852  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6548, 128]), torch.Size([1, 6548, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.8502464294433594  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.03289794921875  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6548, 128])
m.shape torch.Size([5817, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0436444282531738  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0436444282531738  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5817, 128]), torch.Size([1, 5817, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.0495405197143555  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2604780197143555  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5817, 128])
m.shape torch.Size([4964, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2719063758850098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2719063758850098  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4964, 128]), torch.Size([1, 4964, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.2773804664611816  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4809441566467285  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4964, 128])
m.shape torch.Size([4469, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4942021369934082  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4942021369934082  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4469, 128]), torch.Size([1, 4469, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.4987034797668457  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.713716983795166  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4469, 128])
m.shape torch.Size([4036, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.7270913124084473  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.7270913124084473  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4036, 128]), torch.Size([1, 4036, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.7315926551818848  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9525094032287598  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4036, 128])
m.shape torch.Size([3622, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.966209888458252  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.966209888458252  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3622, 128]), torch.Size([1, 3622, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 1.9696931838989258  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.193833351135254  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3622, 128])
m.shape torch.Size([47428, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.418102264404297  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.418102264404297  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 47428, 128]), torch.Size([1, 47428, 128])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 2.464977264404297  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.678834915161133  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 47428, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.3653669357299805  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.462878227233887  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.560389518737793  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.462116241455078  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([102248, 256])
first layer input nodes number: 126322
first layer output nodes number: 102248
edges number: 704982
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.561332702636719  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.658843994140625  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.683221817016602  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 5.683221817016602  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

m.shape torch.Size([6616, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.077810764312744  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.077810764312744  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6616, 256]), torch.Size([1, 6616, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.09133768081665  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.194563388824463  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6616, 256])
m.shape torch.Size([5550, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.1984686851501465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.1984686851501465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 5550, 256]), torch.Size([1, 5550, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.209054470062256  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.3678412437438965  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 5550, 256])
m.shape torch.Size([4245, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.374788284301758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.374788284301758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 4245, 256]), torch.Size([1, 4245, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.383218765258789  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.563540458679199  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 4245, 256])
m.shape torch.Size([3299, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.571789264678955  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.571789264678955  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 3299, 256]), torch.Size([1, 3299, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.578321933746338  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.76444149017334  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 3299, 256])
m.shape torch.Size([2851, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.774287700653076  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.774287700653076  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2851, 256]), torch.Size([1, 2851, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.7798380851745605  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.97627592086792  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2851, 256])
m.shape torch.Size([2179, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.986066818237305  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.986066818237305  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 2179, 256]), torch.Size([1, 2179, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 6.991209030151367  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.188881874084473  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 2179, 256])
m.shape torch.Size([1775, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.197783946990967  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.197783946990967  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.201169490814209  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.376280307769775  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1530, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.385716915130615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.385716915130615  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1530, 256]), torch.Size([1, 1530, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.388652324676514  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.559412479400635  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1530, 256])
m.shape torch.Size([1335, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.568938732147217  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.568938732147217  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1335, 256]), torch.Size([1, 1335, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.571609020233154  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.7358832359313965  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1335, 256])
m.shape torch.Size([1156, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.7456464767456055  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.7456464767456055  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 1156, 256]), torch.Size([1, 1156, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.748011589050293  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.910905838012695  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 1156, 256])
m.shape torch.Size([979, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.9204277992248535  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.9204277992248535  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 979, 256]), torch.Size([1, 979, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 7.922295093536377  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.077320575714111  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 979, 256])
m.shape torch.Size([891, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.086663722991943  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.086663722991943  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.08836317062378  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.232816219329834  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([762, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.241487503051758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.241487503051758  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.242940902709961  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.377106666564941  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([652, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.38515329360962  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.38515329360962  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.386396884918213  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.510317325592041  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([594, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.518259525299072  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.518259525299072  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.519392490386963  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.639610767364502  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([544, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.647409915924072  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.647409915924072  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.648447513580322  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.769670963287354  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([480, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.776995182037354  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.776995182037354  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.777910709381104  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.88897180557251  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([495, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.897078037261963  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.897078037261963  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 8.898022174835205  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.020521640777588  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([439, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.028066635131836  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.028066635131836  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.02890396118164  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.1419677734375  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([418, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.149584293365479  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.149584293365479  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.150381565093994  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.264780521392822  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([379, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.272031784057617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.272031784057617  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.272754669189453  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.38270378112793  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([278, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.38822078704834  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.38822078704834  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.388751029968262  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.478107452392578  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([271, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.483833312988281  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.483833312988281  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.484350204467773  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.572052001953125  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([288, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.578436851501465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.578436851501465  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.578986167907715  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.67530345916748  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([6471, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.830514907836914  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.830514907836914  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

 h.shape torch.Size([1, 6471, 256]), torch.Size([1, 6471, 256])
----------------------------------------3
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 9.842926979064941  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 12.033547401428223  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

rst.shape  torch.Size([1, 6471, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.68344259262085  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.690206050872803  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.696834087371826  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.689739227294922  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

torch.Size([44477, 40])
input nodes number: 102248
output nodes number: 44477
edges number: 400091
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.690672397613525  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 11.690672874450684  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10404729843139648  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10404729843139648  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0994873046875 GB
    Memory Allocated: 0.10404729843139648  GigaBytes
Max Memory Allocated: 12.240540504455566  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06062209606170654 |0.004727482795715332 |0.1660522222518921 |0.00011444091796875 |0.14170777797698975 |0.007889032363891602 |
----------------------------------------------------------pseudo_mini_loss sum 3.350933313369751
Total (block generation + training)time/epoch 23.25621795654297
Training time/epoch 0.8318517208099365
Training time without block to device /epoch 0.8223967552185059
Training time without total dataloading part /epoch 0.6236379146575928
load block tensor time/epoch 0.12124419212341309
block to device time/epoch 0.009454965591430664
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  392046
Number of first layer input nodes during this epoch:  218098
Number of first layer output nodes during this epoch:  173948
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
