[17:45:24] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510562 edges into 2 parts and get 540 edge cuts
main start at this time 1651599909.5095344
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029062747955322266
global_2_local spend time (sec) 0.03681302070617676
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004332542419433594
A = g.adjacency_matrix() spent  0.013860464096069336
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08078432083129883
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3001255989074707
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.172236442565918

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 0.021 seconds
Metis partitioning: 0.070 seconds
Split the graph: 0.078 seconds
Construct subgraphs: 0.079 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.24824953079223633
45673
45268
total k batches seeds list generation spend  10.802998065948486
after graph partition
graph partition algorithm spend time 10.907204866409302
45673
45268
partition_len_list
[122876, 111867]
shared_neighbor_graph_partition_s0 selection method  spend 10.992868900299072
time for parepare:  0.01701211929321289
local_output_nid generation:  0.004418611526489258
local_in_edges_tensor generation:  0.0069255828857421875
mini_batch_src_global generation:  0.020354747772216797
r_  generation:  0.15425682067871094
local_output_nid generation:  0.005854368209838867
local_in_edges_tensor generation:  0.007416725158691406
mini_batch_src_global generation:  0.01265859603881836
r_  generation:  0.1138606071472168
----------------------check_connections_block total spend ----------------------------- 0.4112732410430908
generate_one_block  0.2293987274169922
generate_one_block  0.14554619789123535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05264449119567871
gen group dst list time:  0.0067098140716552734
time for parepare:  0.019412994384765625
local_output_nid generation:  0.01555013656616211
local_in_edges_tensor generation:  0.04007530212402344
mini_batch_src_global generation:  0.027158737182617188
r_  generation:  0.29764866828918457
local_output_nid generation:  0.02030491828918457
local_in_edges_tensor generation:  0.02346634864807129
mini_batch_src_global generation:  0.026317358016967773
r_  generation:  0.26250648498535156
----------------------check_connections_block total spend ----------------------------- 0.8615875244140625
generate_one_block  0.37363433837890625
generate_one_block  0.3555624485015869
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.8615875244140625
block generation total time  0.7291967868804932
average batch blocks generation time:  0.3645983934402466
pseudo mini batch 0 input nodes size: 154263
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.0769963264465332  GigaBytes
Max Memory Allocated: 0.0769963264465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07733678817749023  GigaBytes
Max Memory Allocated: 0.07733678817749023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07733678817749023  GigaBytes
Max Memory Allocated: 0.07733678817749023  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08705282211303711  GigaBytes
Max Memory Allocated: 0.08705282211303711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08705282211303711  GigaBytes
Max Memory Allocated: 0.08705282211303711  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08705282211303711  GigaBytes
Max Memory Allocated: 0.08705282211303711  GigaBytes

torch.Size([154263, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08705282211303711  GigaBytes
Max Memory Allocated: 0.08705282211303711  GigaBytes

m.shape torch.Size([9453, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5032868385314941  GigaBytes
Max Memory Allocated: 0.5116472244262695  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5032868385314941  GigaBytes
Max Memory Allocated: 0.5116472244262695  GigaBytes

 h.shape torch.Size([1, 9453, 128]), torch.Size([1, 9453, 128])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5123019218444824  GigaBytes
Max Memory Allocated: 0.5123019218444824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.5844225883483887  GigaBytes
Max Memory Allocated: 0.5889301300048828  GigaBytes

rst.shape  torch.Size([1, 9453, 128])
m.shape torch.Size([10788, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5902032852172852  GigaBytes
Max Memory Allocated: 0.5904450416564941  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5902032852172852  GigaBytes
Max Memory Allocated: 0.5904450416564941  GigaBytes

 h.shape torch.Size([1, 10788, 128]), torch.Size([1, 10788, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6004915237426758  GigaBytes
Max Memory Allocated: 0.6004915237426758  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7602624893188477  GigaBytes
Max Memory Allocated: 0.7705507278442383  GigaBytes

rst.shape  torch.Size([1, 10788, 128])
m.shape torch.Size([9873, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.769505500793457  GigaBytes
Max Memory Allocated: 0.7705507278442383  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.769505500793457  GigaBytes
Max Memory Allocated: 0.7705507278442383  GigaBytes

 h.shape torch.Size([1, 9873, 128]), torch.Size([1, 9873, 128])
----------------------------------------3
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7789211273193359  GigaBytes
Max Memory Allocated: 0.7789211273193359  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2401123046875 GB
    Memory Allocated: 0.9930648803710938  GigaBytes
Max Memory Allocated: 1.0078883171081543  GigaBytes

rst.shape  torch.Size([1, 9873, 128])
m.shape torch.Size([8573, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0047087669372559  GigaBytes
Max Memory Allocated: 1.0078883171081543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0047087669372559  GigaBytes
Max Memory Allocated: 1.0078883171081543  GigaBytes

 h.shape torch.Size([1, 8573, 128]), torch.Size([1, 8573, 128])
----------------------------------------3
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.0133428573608398  GigaBytes
Max Memory Allocated: 1.0133428573608398  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2510623931884766  GigaBytes
Max Memory Allocated: 1.2674140930175781  GigaBytes

rst.shape  torch.Size([1, 8573, 128])
m.shape torch.Size([7629, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.2651634216308594  GigaBytes
Max Memory Allocated: 1.2674140930175781  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.2651634216308594  GigaBytes
Max Memory Allocated: 1.2674140930175781  GigaBytes

 h.shape torch.Size([1, 7629, 128]), torch.Size([1, 7629, 128])
----------------------------------------3
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.2731223106384277  GigaBytes
Max Memory Allocated: 1.2731223106384277  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5350432395935059  GigaBytes
Max Memory Allocated: 1.553232192993164  GigaBytes

rst.shape  torch.Size([1, 7629, 128])
m.shape torch.Size([6476, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5499334335327148  GigaBytes
Max Memory Allocated: 1.553232192993164  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5499334335327148  GigaBytes
Max Memory Allocated: 1.553232192993164  GigaBytes

 h.shape torch.Size([1, 6476, 128]), torch.Size([1, 6476, 128])
----------------------------------------3
 Nvidia-smi: 2.8260498046875 GB
    Memory Allocated: 1.5566644668579102  GigaBytes
Max Memory Allocated: 1.5566644668579102  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1209716796875 GB
    Memory Allocated: 1.822685718536377  GigaBytes
Max Memory Allocated: 1.8412137031555176  GigaBytes

rst.shape  torch.Size([1, 6476, 128])
m.shape torch.Size([5745, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.1209716796875 GB
    Memory Allocated: 1.8391289710998535  GigaBytes
Max Memory Allocated: 1.8412137031555176  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1209716796875 GB
    Memory Allocated: 1.8391289710998535  GigaBytes
Max Memory Allocated: 1.8412137031555176  GigaBytes

 h.shape torch.Size([1, 5745, 128]), torch.Size([1, 5745, 128])
----------------------------------------3
 Nvidia-smi: 3.1209716796875 GB
    Memory Allocated: 1.8452439308166504  GigaBytes
Max Memory Allocated: 1.8452439308166504  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.4373779296875 GB
    Memory Allocated: 2.133545398712158  GigaBytes
Max Memory Allocated: 2.153076648712158  GigaBytes

rst.shape  torch.Size([1, 5745, 128])
m.shape torch.Size([5127, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.4588623046875 GB
    Memory Allocated: 2.1503639221191406  GigaBytes
Max Memory Allocated: 2.153076648712158  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4588623046875 GB
    Memory Allocated: 2.1503639221191406  GigaBytes
Max Memory Allocated: 2.153076648712158  GigaBytes

 h.shape torch.Size([1, 5127, 128]), torch.Size([1, 5127, 128])
----------------------------------------3
 Nvidia-smi: 3.4588623046875 GB
    Memory Allocated: 2.155663013458252  GigaBytes
Max Memory Allocated: 2.155663013458252  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.434363842010498  GigaBytes
Max Memory Allocated: 2.4539217948913574  GigaBytes

rst.shape  torch.Size([1, 5127, 128])
m.shape torch.Size([4589, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.451612949371338  GigaBytes
Max Memory Allocated: 2.4539217948913574  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.451612949371338  GigaBytes
Max Memory Allocated: 2.4539217948913574  GigaBytes

 h.shape torch.Size([1, 4589, 128]), torch.Size([1, 4589, 128])
----------------------------------------3
 Nvidia-smi: 3.7889404296875 GB
    Memory Allocated: 2.456334114074707  GigaBytes
Max Memory Allocated: 2.456334114074707  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1033935546875 GB
    Memory Allocated: 2.737600326538086  GigaBytes
Max Memory Allocated: 2.757294178009033  GigaBytes

rst.shape  torch.Size([1, 4589, 128])
m.shape torch.Size([54623, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 2.9958748817443848  GigaBytes
Max Memory Allocated: 3.0019798278808594  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 2.9958748817443848  GigaBytes
Max Memory Allocated: 3.0019798278808594  GigaBytes

 h.shape torch.Size([1, 54623, 128]), torch.Size([1, 54623, 128])
----------------------------------------3
 Nvidia-smi: 4.4197998046875 GB
    Memory Allocated: 3.0479674339294434  GigaBytes
Max Memory Allocated: 3.0479674339294434  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.7465386390686035  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

rst.shape  torch.Size([1, 54623, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.37591028213501  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.493093967437744  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.6102776527404785  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.492178440093994  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

torch.Size([122876, 256])
first layer input nodes number: 154263
first layer output nodes number: 122876
edges number: 840703
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.61150598526001  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4471435546875 GB
    Memory Allocated: 6.728689670562744  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5643310546875 GB
    Memory Allocated: 6.757989406585693  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5643310546875 GB
    Memory Allocated: 6.757989406585693  GigaBytes
Max Memory Allocated: 7.0070013999938965  GigaBytes

m.shape torch.Size([5349, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.2103271484375  GigaBytes
Max Memory Allocated: 7.213550567626953  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.2103271484375  GigaBytes
Max Memory Allocated: 7.213550567626953  GigaBytes

 h.shape torch.Size([1, 5349, 256]), torch.Size([1, 5349, 256])
----------------------------------------3
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.221436977386475  GigaBytes
Max Memory Allocated: 7.221436977386475  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.3036322593688965  GigaBytes
Max Memory Allocated: 7.3087334632873535  GigaBytes

rst.shape  torch.Size([1, 5349, 256])
m.shape torch.Size([4772, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.307704448699951  GigaBytes
Max Memory Allocated: 7.3087334632873535  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.307704448699951  GigaBytes
Max Memory Allocated: 7.3087334632873535  GigaBytes

 h.shape torch.Size([1, 4772, 256]), torch.Size([1, 4772, 256])
----------------------------------------3
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.316963195800781  GigaBytes
Max Memory Allocated: 7.316963195800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.4534912109375  GigaBytes
Max Memory Allocated: 7.462593078613281  GigaBytes

rst.shape  torch.Size([1, 4772, 256])
m.shape torch.Size([3764, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.459793567657471  GigaBytes
Max Memory Allocated: 7.462593078613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.459793567657471  GigaBytes
Max Memory Allocated: 7.462593078613281  GigaBytes

 h.shape torch.Size([1, 3764, 256]), torch.Size([1, 3764, 256])
----------------------------------------3
 Nvidia-smi: 9.0076904296875 GB
    Memory Allocated: 7.467411994934082  GigaBytes
Max Memory Allocated: 7.467411994934082  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 7.62647819519043  GigaBytes
Max Memory Allocated: 7.63819694519043  GigaBytes

rst.shape  torch.Size([1, 3764, 256])
m.shape torch.Size([3020, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 7.634697437286377  GigaBytes
Max Memory Allocated: 7.63819694519043  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 7.634697437286377  GigaBytes
Max Memory Allocated: 7.63819694519043  GigaBytes

 h.shape torch.Size([1, 3020, 256]), torch.Size([1, 3020, 256])
----------------------------------------3
 Nvidia-smi: 9.0701904296875 GB
    Memory Allocated: 7.640723705291748  GigaBytes
Max Memory Allocated: 7.640723705291748  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.2537841796875 GB
    Memory Allocated: 7.8115363121032715  GigaBytes
Max Memory Allocated: 7.823056697845459  GigaBytes

rst.shape  torch.Size([1, 3020, 256])
m.shape torch.Size([2629, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.2537841796875 GB
    Memory Allocated: 7.821290493011475  GigaBytes
Max Memory Allocated: 7.823056697845459  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.2537841796875 GB
    Memory Allocated: 7.821290493011475  GigaBytes
Max Memory Allocated: 7.823056697845459  GigaBytes

 h.shape torch.Size([1, 2629, 256]), torch.Size([1, 2629, 256])
----------------------------------------3
 Nvidia-smi: 9.2537841796875 GB
    Memory Allocated: 7.826910018920898  GigaBytes
Max Memory Allocated: 7.826910018920898  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4744873046875 GB
    Memory Allocated: 8.007429122924805  GigaBytes
Max Memory Allocated: 8.019965171813965  GigaBytes

rst.shape  torch.Size([1, 2629, 256])
m.shape torch.Size([2158, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.4744873046875 GB
    Memory Allocated: 8.017366886138916  GigaBytes
Max Memory Allocated: 8.019965171813965  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4744873046875 GB
    Memory Allocated: 8.017366886138916  GigaBytes
Max Memory Allocated: 8.019965171813965  GigaBytes

 h.shape torch.Size([1, 2158, 256]), torch.Size([1, 2158, 256])
----------------------------------------3
 Nvidia-smi: 9.4744873046875 GB
    Memory Allocated: 8.021868228912354  GigaBytes
Max Memory Allocated: 8.021868228912354  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 8.19980525970459  GigaBytes
Max Memory Allocated: 8.212153434753418  GigaBytes

rst.shape  torch.Size([1, 2158, 256])
m.shape torch.Size([1931, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 8.211409568786621  GigaBytes
Max Memory Allocated: 8.212153434753418  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 8.211409568786621  GigaBytes
Max Memory Allocated: 8.212153434753418  GigaBytes

 h.shape torch.Size([1, 1931, 256]), torch.Size([1, 1931, 256])
----------------------------------------3
 Nvidia-smi: 9.6639404296875 GB
    Memory Allocated: 8.215228080749512  GigaBytes
Max Memory Allocated: 8.215228080749512  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8729248046875 GB
    Memory Allocated: 8.40088939666748  GigaBytes
Max Memory Allocated: 8.41456127166748  GigaBytes

rst.shape  torch.Size([1, 1931, 256])
m.shape torch.Size([1680, 8, 256])
----------------------------------------1
 Nvidia-smi: 9.8729248046875 GB
    Memory Allocated: 8.412721633911133  GigaBytes
Max Memory Allocated: 8.41456127166748  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.8729248046875 GB
    Memory Allocated: 8.412721633911133  GigaBytes
Max Memory Allocated: 8.41456127166748  GigaBytes

 h.shape torch.Size([1, 1680, 256]), torch.Size([1, 1680, 256])
----------------------------------------3
 Nvidia-smi: 9.8729248046875 GB
    Memory Allocated: 8.416101455688477  GigaBytes
Max Memory Allocated: 8.416101455688477  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.0428466796875 GB
    Memory Allocated: 8.604759216308594  GigaBytes
Max Memory Allocated: 8.618431091308594  GigaBytes

rst.shape  torch.Size([1, 1680, 256])
m.shape torch.Size([1566, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.0428466796875 GB
    Memory Allocated: 8.61655569076538  GigaBytes
Max Memory Allocated: 8.618431091308594  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.0428466796875 GB
    Memory Allocated: 8.61655569076538  GigaBytes
Max Memory Allocated: 8.618431091308594  GigaBytes

 h.shape torch.Size([1, 1566, 256]), torch.Size([1, 1566, 256])
----------------------------------------3
 Nvidia-smi: 10.0428466796875 GB
    Memory Allocated: 8.619557857513428  GigaBytes
Max Memory Allocated: 8.619557857513428  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2322998046875 GB
    Memory Allocated: 8.815489292144775  GigaBytes
Max Memory Allocated: 8.829161167144775  GigaBytes

rst.shape  torch.Size([1, 1566, 256])
m.shape torch.Size([1434, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.2479248046875 GB
    Memory Allocated: 8.82724666595459  GigaBytes
Max Memory Allocated: 8.829161167144775  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2479248046875 GB
    Memory Allocated: 8.82724666595459  GigaBytes
Max Memory Allocated: 8.829161167144775  GigaBytes

 h.shape torch.Size([1, 1434, 256]), torch.Size([1, 1434, 256])
----------------------------------------3
 Nvidia-smi: 10.2479248046875 GB
    Memory Allocated: 8.830626487731934  GigaBytes
Max Memory Allocated: 8.830626487731934  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 9.03347110748291  GigaBytes
Max Memory Allocated: 9.047532081604004  GigaBytes

rst.shape  torch.Size([1, 1434, 256])
m.shape torch.Size([1257, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 9.04588270187378  GigaBytes
Max Memory Allocated: 9.047532081604004  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 9.04588270187378  GigaBytes
Max Memory Allocated: 9.047532081604004  GigaBytes

 h.shape torch.Size([1, 1257, 256]), torch.Size([1, 1257, 256])
----------------------------------------3
 Nvidia-smi: 10.4432373046875 GB
    Memory Allocated: 9.048335552215576  GigaBytes
Max Memory Allocated: 9.048335552215576  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.238441944122314  GigaBytes
Max Memory Allocated: 9.252113819122314  GigaBytes

rst.shape  torch.Size([1, 1257, 256])
m.shape torch.Size([1140, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.250932216644287  GigaBytes
Max Memory Allocated: 9.252113819122314  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.250932216644287  GigaBytes
Max Memory Allocated: 9.252113819122314  GigaBytes

 h.shape torch.Size([1, 1140, 256]), torch.Size([1, 1140, 256])
----------------------------------------3
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.253124713897705  GigaBytes
Max Memory Allocated: 9.253124713897705  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7635498046875 GB
    Memory Allocated: 9.443907260894775  GigaBytes
Max Memory Allocated: 9.457579135894775  GigaBytes

rst.shape  torch.Size([1, 1140, 256])
m.shape torch.Size([1036, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7635498046875 GB
    Memory Allocated: 9.456382274627686  GigaBytes
Max Memory Allocated: 9.457579135894775  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7635498046875 GB
    Memory Allocated: 9.456382274627686  GigaBytes
Max Memory Allocated: 9.457579135894775  GigaBytes

 h.shape torch.Size([1, 1036, 256]), torch.Size([1, 1036, 256])
----------------------------------------3
 Nvidia-smi: 10.7635498046875 GB
    Memory Allocated: 9.458388805389404  GigaBytes
Max Memory Allocated: 9.458388805389404  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 9.642531394958496  GigaBytes
Max Memory Allocated: 9.656203269958496  GigaBytes

rst.shape  torch.Size([1, 1036, 256])
m.shape torch.Size([890, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 9.653209686279297  GigaBytes
Max Memory Allocated: 9.656203269958496  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9725341796875 GB
    Memory Allocated: 9.653209686279297  GigaBytes
Max Memory Allocated: 9.656203269958496  GigaBytes

 h.shape torch.Size([1, 890, 256]), torch.Size([1, 890, 256])
----------------------------------------3
 Nvidia-smi: 10.9744873046875 GB
    Memory Allocated: 9.6549072265625  GigaBytes
Max Memory Allocated: 9.656203269958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1346435546875 GB
    Memory Allocated: 9.825916290283203  GigaBytes
Max Memory Allocated: 9.837799072265625  GigaBytes

rst.shape  torch.Size([1, 890, 256])
m.shape torch.Size([829, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.1346435546875 GB
    Memory Allocated: 9.837019443511963  GigaBytes
Max Memory Allocated: 9.837799072265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1346435546875 GB
    Memory Allocated: 9.837019443511963  GigaBytes
Max Memory Allocated: 9.837799072265625  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 11.1346435546875 GB
    Memory Allocated: 9.838600635528564  GigaBytes
Max Memory Allocated: 9.838600635528564  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3358154296875 GB
    Memory Allocated: 10.010105609893799  GigaBytes
Max Memory Allocated: 10.02196455001831  GigaBytes

rst.shape  torch.Size([1, 829, 256])
m.shape torch.Size([724, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.3358154296875 GB
    Memory Allocated: 10.020448684692383  GigaBytes
Max Memory Allocated: 10.02196455001831  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3358154296875 GB
    Memory Allocated: 10.020448684692383  GigaBytes
Max Memory Allocated: 10.02196455001831  GigaBytes

 h.shape torch.Size([1, 724, 256]), torch.Size([1, 724, 256])
----------------------------------------3
 Nvidia-smi: 11.3377685546875 GB
    Memory Allocated: 10.021829605102539  GigaBytes
Max Memory Allocated: 10.02196455001831  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4998779296875 GB
    Memory Allocated: 10.180139541625977  GigaBytes
Max Memory Allocated: 10.191858291625977  GigaBytes

rst.shape  torch.Size([1, 724, 256])
m.shape torch.Size([725, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.5135498046875 GB
    Memory Allocated: 10.191295146942139  GigaBytes
Max Memory Allocated: 10.191858291625977  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5135498046875 GB
    Memory Allocated: 10.191295146942139  GigaBytes
Max Memory Allocated: 10.191858291625977  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 11.5135498046875 GB
    Memory Allocated: 10.192677974700928  GigaBytes
Max Memory Allocated: 10.192677974700928  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6990966796875 GB
    Memory Allocated: 10.360303401947021  GigaBytes
Max Memory Allocated: 10.372057437896729  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([673, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.6990966796875 GB
    Memory Allocated: 10.37125539779663  GigaBytes
Max Memory Allocated: 10.372057437896729  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6990966796875 GB
    Memory Allocated: 10.37125539779663  GigaBytes
Max Memory Allocated: 10.372057437896729  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 11.7010498046875 GB
    Memory Allocated: 10.372539043426514  GigaBytes
Max Memory Allocated: 10.372539043426514  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.536187648773193  GigaBytes
Max Memory Allocated: 10.547740459442139  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([566, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.545882225036621  GigaBytes
Max Memory Allocated: 10.547740459442139  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.545882225036621  GigaBytes
Max Memory Allocated: 10.547740459442139  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 11.8807373046875 GB
    Memory Allocated: 10.546961784362793  GigaBytes
Max Memory Allocated: 10.547740459442139  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0018310546875 GB
    Memory Allocated: 10.694872856140137  GigaBytes
Max Memory Allocated: 10.705767631530762  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([583, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 10.706139087677002  GigaBytes
Max Memory Allocated: 10.706182956695557  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 10.706139087677002  GigaBytes
Max Memory Allocated: 10.706182956695557  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 10.707251071929932  GigaBytes
Max Memory Allocated: 10.707251071929932  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1912841796875 GB
    Memory Allocated: 10.864040851593018  GigaBytes
Max Memory Allocated: 10.875759601593018  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([523, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.1912841796875 GB
    Memory Allocated: 10.874041080474854  GigaBytes
Max Memory Allocated: 10.875759601593018  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1912841796875 GB
    Memory Allocated: 10.874041080474854  GigaBytes
Max Memory Allocated: 10.875759601593018  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 12.1912841796875 GB
    Memory Allocated: 10.875038623809814  GigaBytes
Max Memory Allocated: 10.875759601593018  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 11.023931980133057  GigaBytes
Max Memory Allocated: 11.034406185150146  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([412, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 11.032145023345947  GigaBytes
Max Memory Allocated: 11.034406185150146  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 11.032145023345947  GigaBytes
Max Memory Allocated: 11.034406185150146  GigaBytes

 h.shape torch.Size([1, 412, 256]), torch.Size([1, 412, 256])
----------------------------------------3
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 11.032930850982666  GigaBytes
Max Memory Allocated: 11.034406185150146  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4608154296875 GB
    Memory Allocated: 11.160133838653564  GigaBytes
Max Memory Allocated: 11.16877794265747  GigaBytes

rst.shape  torch.Size([1, 412, 256])
m.shape torch.Size([366, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.4608154296875 GB
    Memory Allocated: 11.167831897735596  GigaBytes
Max Memory Allocated: 11.16877794265747  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4608154296875 GB
    Memory Allocated: 11.167831897735596  GigaBytes
Max Memory Allocated: 11.16877794265747  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 12.4608154296875 GB
    Memory Allocated: 11.168529987335205  GigaBytes
Max Memory Allocated: 11.16877794265747  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.5682373046875 GB
    Memory Allocated: 11.283255100250244  GigaBytes
Max Memory Allocated: 11.291283130645752  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([396, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.5682373046875 GB
    Memory Allocated: 11.292040824890137  GigaBytes
Max Memory Allocated: 11.292076587677002  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.5682373046875 GB
    Memory Allocated: 11.292040824890137  GigaBytes
Max Memory Allocated: 11.292076587677002  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 12.5701904296875 GB
    Memory Allocated: 11.29279613494873  GigaBytes
Max Memory Allocated: 11.29279613494873  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.7069091796875 GB
    Memory Allocated: 11.421366691589355  GigaBytes
Max Memory Allocated: 11.43043041229248  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([7250, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.8846435546875 GB
    Memory Allocated: 11.596171379089355  GigaBytes
Max Memory Allocated: 11.59684705734253  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.8846435546875 GB
    Memory Allocated: 11.596171379089355  GigaBytes
Max Memory Allocated: 11.59684705734253  GigaBytes

 h.shape torch.Size([1, 7250, 256]), torch.Size([1, 7250, 256])
----------------------------------------3
 Nvidia-smi: 12.8846435546875 GB
    Memory Allocated: 11.609999656677246  GigaBytes
Max Memory Allocated: 11.609999656677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 14.043776512145996  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 7250, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.636122703552246  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.64292860031128  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.649734497070312  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.642588138580322  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([45673, 40])
input nodes number: 122876
output nodes number: 45673
edges number: 463275
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.650650024414062  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 13.650650978088379  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.11482000350952148  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

pseudo mini batch 1 input nodes size: 151652
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.08691883087158203  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.08691883087158203  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.15923213958740234  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.15956974029541016  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.08501052856445312  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.092193603515625  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.092193603515625  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.092193603515625  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([151652, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.092193603515625  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

m.shape torch.Size([12230, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.4329719543457031  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.4329719543457031  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 12230, 128]), torch.Size([1, 12230, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.4446907043457031  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.5381088256835938  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 12230, 128])
m.shape torch.Size([12631, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.5450024604797363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.5450024604797363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 12631, 128]), torch.Size([1, 12631, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.5570483207702637  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.7377362251281738  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 12631, 128])
m.shape torch.Size([10980, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.7474203109741211  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.7474203109741211  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 10980, 128]), torch.Size([1, 10980, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.7588119506835938  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 0.9976048469543457  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 10980, 128])
m.shape torch.Size([9217, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.0092978477478027  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.0092978477478027  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 9217, 128]), torch.Size([1, 9217, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.0189223289489746  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.2738327980041504  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 9217, 128])
m.shape torch.Size([7737, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.28788423538208  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.28788423538208  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 7737, 128]), torch.Size([1, 7737, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.2959179878234863  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.5775504112243652  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 7737, 128])
m.shape torch.Size([6226, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.5910229682922363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.5910229682922363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 6226, 128]), torch.Size([1, 6226, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.597527027130127  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.853975772857666  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 6226, 128])
m.shape torch.Size([5248, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.8685851097106934  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.8685851097106934  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 5248, 128]), torch.Size([1, 5248, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 1.874326229095459  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.1266255378723145  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 5248, 128])
m.shape torch.Size([4553, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.1417012214660645  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.1417012214660645  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 4553, 128]), torch.Size([1, 4553, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.1463747024536133  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.407464027404785  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 4553, 128])
m.shape torch.Size([3943, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.4222254753112793  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.4222254753112793  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 3943, 128]), torch.Size([1, 3943, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.4261279106140137  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.6725869178771973  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 3943, 128])
m.shape torch.Size([39102, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.8565030097961426  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.8565030097961426  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 39102, 128]), torch.Size([1, 39102, 128])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 2.8955655097961426  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.5633721351623535  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 39102, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.267811298370361  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.374495983123779  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.481180667877197  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.37366247177124  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([111867, 256])
first layer input nodes number: 151652
first layer output nodes number: 111867
edges number: 683008
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.482425212860107  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.589109897613525  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.616453647613525  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.616453647613525  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

m.shape torch.Size([8079, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.896345138549805  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.896345138549805  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 8079, 256]), torch.Size([1, 8079, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 5.911754608154297  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.035236358642578  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 8079, 256])
m.shape torch.Size([6934, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.040860652923584  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.040860652923584  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 6934, 256]), torch.Size([1, 6934, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.05441427230835  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.258153438568115  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 6934, 256])
m.shape torch.Size([5513, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.267436981201172  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.267436981201172  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 5513, 256]), torch.Size([1, 5513, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.279346942901611  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.510681629180908  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 5513, 256])
m.shape torch.Size([4300, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.521955490112305  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.521955490112305  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 4300, 256]), torch.Size([1, 4300, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.53019905090332  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.772872447967529  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 4300, 256])
m.shape torch.Size([3593, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.785151481628418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.785151481628418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 3593, 256]), torch.Size([1, 3593, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 6.792599201202393  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.039310932159424  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 3593, 256])
m.shape torch.Size([2710, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.051512718200684  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.051512718200684  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 2710, 256]), torch.Size([1, 2710, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.057298183441162  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.286628246307373  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 2710, 256])
m.shape torch.Size([2114, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.297723293304443  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.297723293304443  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 2114, 256]), torch.Size([1, 2114, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.302200794219971  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.508387088775635  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 2114, 256])
m.shape torch.Size([1792, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.5201497077941895  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.5201497077941895  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1792, 256]), torch.Size([1, 1792, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.5235676765441895  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.7183918952941895  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1792, 256])
m.shape torch.Size([1410, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.728879928588867  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.728879928588867  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1410, 256]), torch.Size([1, 1410, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.731653213500977  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.924886226654053  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1410, 256])
m.shape torch.Size([1165, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.934287071228027  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.934287071228027  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1165, 256]), torch.Size([1, 1165, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 7.936528205871582  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.09730052947998  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1165, 256])
m.shape torch.Size([946, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.105547428131104  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.105547428131104  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 946, 256]), torch.Size([1, 946, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.107351779937744  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.248459339141846  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 946, 256])
m.shape torch.Size([797, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.256749629974365  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.256749629974365  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.258269786834717  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.3874831199646  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([620, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.394469738006592  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.394469738006592  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.395652294158936  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.507983684539795  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 620, 256])
m.shape torch.Size([544, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.5147123336792  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.5147123336792  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.51574993133545  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.6218900680542  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([460, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.628003120422363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.628003120422363  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.628880500793457  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.722972869873047  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([387, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.728485584259033  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.728485584259033  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.729223728179932  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.814083576202393  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([305, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.818698406219482  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.818698406219482  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.81928014755249  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.89295244216919  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([275, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.897419452667236  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.897419452667236  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.89794397354126  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.966090679168701  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([270, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.970759391784668  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.970759391784668  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 8.971274375915527  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.040574073791504  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([224, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.044622421264648  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.044622421264648  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.045049667358398  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.105291366577148  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([194, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.108993530273438  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.108993530273438  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.109363555908203  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.164127349853516  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([144, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.166987419128418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.166987419128418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 16.6561279296875 GB
    Memory Allocated: 9.167262077331543  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6990966796875 GB
    Memory Allocated: 9.209834098815918  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([153, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.6990966796875 GB
    Memory Allocated: 9.21307897567749  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6990966796875 GB
    Memory Allocated: 9.21307897567749  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 16.6990966796875 GB
    Memory Allocated: 9.21337080001831  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7440185546875 GB
    Memory Allocated: 9.260646343231201  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([129, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.7440185546875 GB
    Memory Allocated: 9.263476371765137  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7440185546875 GB
    Memory Allocated: 9.263476371765137  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 16.7440185546875 GB
    Memory Allocated: 9.26372241973877  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.305304527282715  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([2210, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.358283996582031  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.358283996582031  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 2210, 256]), torch.Size([1, 2210, 256])
----------------------------------------3
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.36331844329834  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 10.126582145690918  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 2210, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.896836757659912  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.904541492462158  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes
[17:45:40] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 512748 edges into 2 parts and get 596 edge cuts

----------------------------------------after rst
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.911287307739258  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.903244972229004  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([45268, 40])
input nodes number: 111867
output nodes number: 45268
edges number: 280975
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.904356002807617  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.7908935546875 GB
    Memory Allocated: 9.904356479644775  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.10696125030517578  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.11251163482666016  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.11251163482666016  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08281409740447998 |0.16956937313079834 |0.46394598484039307 |0.000164031982421875 |0.13966715335845947 |0.010472774505615234 |
----------------------------------------------------------pseudo_mini_loss sum 5.3110151290893555
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  540658
Number of first layer input nodes during this epoch:  305915
Number of first layer output nodes during this epoch:  234743
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.11251115798950195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018617630004882812
global_2_local spend time (sec) 0.041382551193237305
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00432133674621582
A = g.adjacency_matrix() spent  0.007764101028442383
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.09244561195373535
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.326206922531128
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1837539672851562

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 0.029 seconds
Metis partitioning: 0.071 seconds
Split the graph: 0.089 seconds
Construct subgraphs: 0.051 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2409510612487793
46287
44654
total k batches seeds list generation spend  10.910741329193115
after graph partition
graph partition algorithm spend time 11.01540994644165
46287
44654
partition_len_list
[123734, 110601]
shared_neighbor_graph_partition_s0 selection method  spend 11.121532917022705
time for parepare:  0.016952991485595703
local_output_nid generation:  0.00456547737121582
local_in_edges_tensor generation:  0.00722813606262207
mini_batch_src_global generation:  0.014822959899902344
r_  generation:  0.16744518280029297
local_output_nid generation:  0.008069992065429688
local_in_edges_tensor generation:  0.007822513580322266
mini_batch_src_global generation:  0.026279687881469727
r_  generation:  0.12137031555175781
----------------------check_connections_block total spend ----------------------------- 0.4711027145385742
generate_one_block  0.23290443420410156
generate_one_block  0.1382286548614502
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03490447998046875
gen group dst list time:  0.006406307220458984
time for parepare:  0.01939678192138672
local_output_nid generation:  0.01592254638671875
local_in_edges_tensor generation:  0.031221389770507812
mini_batch_src_global generation:  0.0264892578125
r_  generation:  0.29756641387939453
local_output_nid generation:  0.02022862434387207
local_in_edges_tensor generation:  0.019927978515625
mini_batch_src_global generation:  0.026661157608032227
r_  generation:  0.2558467388153076
----------------------check_connections_block total spend ----------------------------- 0.8408451080322266
generate_one_block  0.38190793991088867
generate_one_block  0.3100004196166992
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.11251115798950195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

connection checking time:  0.8408451080322266
block generation total time  0.6919083595275879
average batch blocks generation time:  0.34595417976379395
block dataloader generation time/epoch 13.661012172698975
pseudo mini batch 0 input nodes size: 154694
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.0904998779296875  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.0904998779296875  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.1647186279296875  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.16506385803222656  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.09241294860839844  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.10256242752075195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.10256242752075195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.10256242752075195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([154694, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.10256242752075195  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

m.shape torch.Size([9611, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.5222296714782715  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.5222296714782715  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 9611, 128]), torch.Size([1, 9611, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.531395435333252  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.6047215461730957  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 9611, 128])
m.shape torch.Size([10781, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.6104202270507812  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.6104202270507812  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 10781, 128]), torch.Size([1, 10781, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.620701789855957  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.7804527282714844  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 10781, 128])
m.shape torch.Size([9870, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.789431095123291  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.789431095123291  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 9870, 128]), torch.Size([1, 9870, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 0.7988438606262207  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.0122761726379395  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 9870, 128])
m.shape torch.Size([8809, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.0251479148864746  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.0251479148864746  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 8809, 128]), torch.Size([1, 8809, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.0340547561645508  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.286996841430664  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 8809, 128])
m.shape torch.Size([7691, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.301133155822754  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.301133155822754  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 7691, 128]), torch.Size([1, 7691, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.3086514472961426  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.5893683433532715  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 7691, 128])
m.shape torch.Size([6498, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.604515552520752  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.604515552520752  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 6498, 128]), torch.Size([1, 6498, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.6111512184143066  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.8780598640441895  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 6498, 128])
m.shape torch.Size([5769, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.8944926261901855  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.8944926261901855  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 5769, 128]), torch.Size([1, 5769, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 1.9003419876098633  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.1933107376098633  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 5769, 128])
m.shape torch.Size([5223, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.209768772125244  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.209768772125244  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 5223, 128]), torch.Size([1, 5223, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.214874744415283  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.5000596046447754  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 5223, 128])
m.shape torch.Size([4604, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.517327308654785  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.517327308654785  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 4604, 128]), torch.Size([1, 4604, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.521939277648926  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 2.809659481048584  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 4604, 128])
m.shape torch.Size([54878, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 3.069182872772217  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 3.069182872772217  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 54878, 128]), torch.Size([1, 54878, 128])
----------------------------------------3
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 3.121518611907959  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.861274242401123  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 54878, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.48846435546875  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.606466293334961  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.724468231201172  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.605544090270996  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

torch.Size([123734, 256])
first layer input nodes number: 154694
first layer output nodes number: 123734
edges number: 845845
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.725646018981934  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.8436479568481445  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.873148441314697  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.7947998046875 GB
    Memory Allocated: 6.873148441314697  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

m.shape torch.Size([5545, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.3290486335754395  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.3290486335754395  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 5545, 256]), torch.Size([1, 5545, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.339798450469971  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.424740314483643  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 5545, 256])
m.shape torch.Size([4833, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.4287428855896  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.4287428855896  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 4833, 256]), torch.Size([1, 4833, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.438590049743652  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.577427387237549  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 4833, 256])
m.shape torch.Size([3780, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.5837178230285645  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.5837178230285645  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 3780, 256]), torch.Size([1, 3780, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.5910515785217285  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.751841068267822  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 3780, 256])
m.shape torch.Size([3099, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.76015043258667  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.76015043258667  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 3099, 256]), torch.Size([1, 3099, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.766204357147217  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.937619686126709  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 3099, 256])
m.shape torch.Size([2626, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.94728422164917  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.94728422164917  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 2626, 256]), torch.Size([1, 2626, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 7.9527812004089355  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.134184837341309  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 2626, 256])
m.shape torch.Size([2236, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.144575119018555  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.144575119018555  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 2236, 256]), torch.Size([1, 2236, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.148887634277344  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.333727359771729  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 2236, 256])
m.shape torch.Size([1929, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.344573020935059  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.344573020935059  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1929, 256]), torch.Size([1, 1929, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.348299026489258  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.537079811096191  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1929, 256])
m.shape torch.Size([1754, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.54851484298706  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.54851484298706  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1754, 256]), torch.Size([1, 1754, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.551997661590576  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.743996620178223  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1754, 256])
m.shape torch.Size([1576, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.755956649780273  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.755956649780273  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1576, 256]), torch.Size([1, 1576, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.7589693069458  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.957301139831543  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1576, 256])
m.shape torch.Size([1473, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.969955921173096  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.969955921173096  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1473, 256]), torch.Size([1, 1473, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 8.972830295562744  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.174057483673096  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1473, 256])
m.shape torch.Size([1286, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.186481952667236  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.186481952667236  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1286, 256]), torch.Size([1, 1286, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.18901014328003  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.382077693939209  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1286, 256])
m.shape torch.Size([1170, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.394294261932373  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.394294261932373  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.39664602279663  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.592417240142822  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
m.shape torch.Size([1012, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.603842735290527  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.603842735290527  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 1012, 256]), torch.Size([1, 1012, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.605772972106934  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.784956932067871  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 1012, 256])
m.shape torch.Size([877, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.795893669128418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.795893669128418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 877, 256]), torch.Size([1, 877, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.797566413879395  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.963168144226074  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 877, 256])
m.shape torch.Size([793, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.973764419555664  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.973764419555664  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 9.975276947021484  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.135775566101074  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([750, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.146553039550781  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.146553039550781  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 750, 256]), torch.Size([1, 750, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.14798355102539  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.30963134765625  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 750, 256])
m.shape torch.Size([713, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.320566177368164  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.320566177368164  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 713, 256]), torch.Size([1, 713, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.32192611694336  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.488250732421875  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 713, 256])
m.shape torch.Size([680, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.499335289001465  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.499335289001465  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 680, 256]), torch.Size([1, 680, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.500632286071777  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.666171073913574  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 680, 256])
m.shape torch.Size([580, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.676114559173584  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.676114559173584  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.677220821380615  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.827381610870361  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([573, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.837843418121338  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.837843418121338  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.83893632888794  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 10.993052005767822  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([535, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.00330400466919  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.00330400466919  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.004324436187744  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.155593395233154  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([426, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.164091110229492  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.164091110229492  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.16490364074707  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.293085098266602  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([371, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.300880432128906  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.300880432128906  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.30158805847168  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.416482925415039  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([399, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.425333023071289  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.425333023071289  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.426094055175781  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.555414199829102  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([7271, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.730219841003418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.730219841003418  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

 h.shape torch.Size([1, 7271, 256]), torch.Size([1, 7271, 256])
----------------------------------------3
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 11.744088172912598  GigaBytes
Max Memory Allocated: 14.217604637145996  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 14.184914588928223  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7271, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.775774002075195  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.782671451568604  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.789568901062012  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.782326221466064  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([46287, 40])
input nodes number: 123734
output nodes number: 46287
edges number: 466789
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.783745288848877  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.2401123046875 GB
    Memory Allocated: 13.783746242523193  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.12050485610961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

pseudo mini batch 1 input nodes size: 150795
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09256553649902344  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09256553649902344  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.16447019577026367  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.16480302810668945  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09023904800415039  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09732866287231445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09732866287231445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09732866287231445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([150795, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.09732866287231445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([12098, 1, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.4336585998535156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.4336585998535156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 12098, 128]), torch.Size([1, 12098, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.4453773498535156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.5380401611328125  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 12098, 128])
m.shape torch.Size([12469, 2, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.5441627502441406  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.5441627502441406  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 12469, 128]), torch.Size([1, 12469, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.556058406829834  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.734428882598877  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 12469, 128])
m.shape torch.Size([11009, 3, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.7442317008972168  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.7442317008972168  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 11009, 128]), torch.Size([1, 11009, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.7557735443115234  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 0.9937467575073242  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 11009, 128])
m.shape torch.Size([9082, 4, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.006075382232666  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.006075382232666  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 9082, 128]), torch.Size([1, 9082, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.0157265663146973  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.269970417022705  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 9082, 128])
m.shape torch.Size([7665, 5, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.283914566040039  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.283914566040039  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 7665, 128]), torch.Size([1, 7665, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.2924518585205078  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.559159755706787  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7665, 128])
m.shape torch.Size([6195, 6, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.5724749565124512  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.5724749565124512  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6195, 128]), torch.Size([1, 6195, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.578589916229248  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.8364834785461426  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6195, 128])
m.shape torch.Size([5256, 7, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.8510732650756836  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.8510732650756836  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5256, 128]), torch.Size([1, 5256, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 1.8568840026855469  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.1075096130371094  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5256, 128])
m.shape torch.Size([4518, 8, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.1222381591796875  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.1222381591796875  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4518, 128]), torch.Size([1, 4518, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.12669038772583  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.3861804008483887  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4518, 128])
m.shape torch.Size([3867, 9, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.400479316711426  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.400479316711426  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 3867, 128]), torch.Size([1, 3867, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.404191017150879  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.6411375999450684  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 3867, 128])
m.shape torch.Size([38442, 10, 128])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.8223047256469727  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.8223047256469727  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 38442, 128]), torch.Size([1, 38442, 128])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 2.8589658737182617  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.462803840637207  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 38442, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.173552989959717  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.2790303230285645  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.384507656097412  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.278205871582031  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([110601, 256])
first layer input nodes number: 150795
first layer output nodes number: 110601
edges number: 674045
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.3857102394104  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.491187572479248  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.518531322479248  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.518531322479248  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([7883, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.794796943664551  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.794796943664551  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 7883, 256]), torch.Size([1, 7883, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.809832572937012  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.930117607116699  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7883, 256])
m.shape torch.Size([6873, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.935811519622803  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.935811519622803  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6873, 256]), torch.Size([1, 6873, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 5.949373722076416  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.146011829376221  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6873, 256])
m.shape torch.Size([5497, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.155307292938232  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.155307292938232  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5497, 256]), torch.Size([1, 5497, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.166015625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.39808988571167  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5497, 256])
m.shape torch.Size([4221, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.4090752601623535  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.4090752601623535  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4221, 256]), torch.Size([1, 4221, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.4174675941467285  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.657470226287842  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4221, 256])
m.shape torch.Size([3596, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.669971466064453  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.669971466064453  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 3596, 256]), torch.Size([1, 3596, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.676830291748047  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.923856735229492  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 3596, 256])
m.shape torch.Size([2632, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.935605525970459  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.935605525970459  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2632, 256]), torch.Size([1, 2632, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 6.941495418548584  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.158315181732178  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2632, 256])
m.shape torch.Size([2116, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.1709418296813965  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.1709418296813965  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2116, 256]), torch.Size([1, 2116, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.1750922203063965  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.379978179931641  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2116, 256])
m.shape torch.Size([1718, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.391170024871826  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.391170024871826  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1718, 256]), torch.Size([1, 1718, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.394538402557373  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.5823140144348145  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1718, 256])
m.shape torch.Size([1400, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.593691825866699  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.593691825866699  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1400, 256]), torch.Size([1, 1400, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.596480369567871  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.776737689971924  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1400, 256])
m.shape torch.Size([1126, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.7858662605285645  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.7858662605285645  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.788029193878174  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.944903373718262  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([917, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.953397750854492  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.953397750854492  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 917, 256]), torch.Size([1, 917, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 7.955146789550781  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.091571807861328  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 917, 256])
m.shape torch.Size([767, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.099543571472168  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.099543571472168  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.101006507873535  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.226187705993652  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([644, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.233502864837646  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.233502864837646  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.234731197357178  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.347737789154053  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([557, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.354618549346924  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.354618549346924  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.3556809425354  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.46430253982544  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([496, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.470922470092773  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.470922470092773  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.471868515014648  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.576022148132324  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([361, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.581100940704346  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.581100940704346  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.581789493560791  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.663836479187012  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([317, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.66867208480835  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.66867208480835  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.669276714324951  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.742330551147461  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([268, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.746665000915527  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.746665000915527  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.747176170349121  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.816437721252441  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([256, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.820857048034668  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.820857048034668  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.821345329284668  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.886775016784668  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([234, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.891029357910156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.891029357910156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.891475677490234  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.95440673828125  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([182, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.957857131958008  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.957857131958008  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 8.95820426940918  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.009580612182617  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([130, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.012156009674072  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.012156009674072  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.012403964996338  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.05083703994751  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([148, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.054795742034912  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.054795742034912  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 18.1307373046875 GB
    Memory Allocated: 9.055078029632568  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1326904296875 GB
    Memory Allocated: 9.10080862045288  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([126, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.1326904296875 GB
    Memory Allocated: 9.103574275970459  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1326904296875 GB
    Memory Allocated: 9.103574275970459  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 18.1326904296875 GB
    Memory Allocated: 9.103814601898193  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.144429683685303  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes
[17:45:54] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510472 edges into 2 parts and get 604 edge cuts

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([2189, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.197447776794434  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.197447776794434  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2189, 256]), torch.Size([1, 2189, 256])
----------------------------------------3
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.20168685913086  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.964750289916992  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2189, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.737646102905273  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.745163917541504  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.751818180084229  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.743967533111572  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([44654, 40])
input nodes number: 110601
output nodes number: 44654
edges number: 277461
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.745745182037354  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.1717529296875 GB
    Memory Allocated: 9.745745658874512  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11194753646850586  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11194753646850586  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11194753646850586  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.050493478775024414 |0.0057190656661987305 |0.18423736095428467 |0.00011348724365234375 |0.1626589298248291 |0.007112264633178711 |
----------------------------------------------------------pseudo_mini_loss sum 4.190301895141602
Total (block generation + training)time/epoch 14.552043914794922
Training time/epoch 0.8905529975891113
Training time without block to device /epoch 0.8791148662567139
Training time without total dataloading part /epoch 0.7011318206787109
load block tensor time/epoch 0.10098695755004883
block to device time/epoch 0.011438131332397461
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  539824
Number of first layer input nodes during this epoch:  305489
Number of first layer output nodes during this epoch:  234335
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11194705963134766  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016156911849975586
global_2_local spend time (sec) 0.04048037528991699
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0042955875396728516
A = g.adjacency_matrix() spent  0.008101224899291992
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08086466789245605
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.315232515335083
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1666285991668701

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 0.027 seconds
Metis partitioning: 0.074 seconds
Split the graph: 0.084 seconds
Construct subgraphs: 0.045 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.23016357421875
45471
45470
total k batches seeds list generation spend  10.810256719589233
after graph partition
graph partition algorithm spend time 10.907613039016724
45471
45470
partition_len_list
[122610, 110826]
shared_neighbor_graph_partition_s0 selection method  spend 10.996607542037964
time for parepare:  0.016910552978515625
local_output_nid generation:  0.0048177242279052734
local_in_edges_tensor generation:  0.006237983703613281
mini_batch_src_global generation:  0.018610715866088867
r_  generation:  0.1477646827697754
local_output_nid generation:  0.0064084529876708984
local_in_edges_tensor generation:  0.02093052864074707
mini_batch_src_global generation:  0.015611648559570312
r_  generation:  0.12717986106872559
----------------------check_connections_block total spend ----------------------------- 0.43285584449768066
generate_one_block  0.22095227241516113
generate_one_block  0.1574392318725586
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.039945363998413086
gen group dst list time:  0.011451005935668945
time for parepare:  0.019559621810913086
local_output_nid generation:  0.01625990867614746
local_in_edges_tensor generation:  0.10590314865112305
mini_batch_src_global generation:  0.026816368103027344
r_  generation:  0.3129558563232422
local_output_nid generation:  0.024240493774414062
local_in_edges_tensor generation:  0.022920608520507812
mini_batch_src_global generation:  0.03254389762878418
r_  generation:  0.26410937309265137
----------------------check_connections_block total spend ----------------------------- 0.96370530128479
generate_one_block  0.3743305206298828
generate_one_block  0.31775665283203125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11194705963134766  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

connection checking time:  0.96370530128479
block generation total time  0.6920871734619141
average batch blocks generation time:  0.34604358673095703
block dataloader generation time/epoch 13.641705751419067
pseudo mini batch 0 input nodes size: 154359
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.09085845947265625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.09085845947265625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.16507720947265625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.16541624069213867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.09317874908447266  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.1025094985961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.1025094985961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.1025094985961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([154359, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.1025094985961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([10185, 1, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5114932060241699  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5114932060241699  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 10185, 128]), torch.Size([1, 10185, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5212063789367676  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5992264747619629  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 10185, 128])
m.shape torch.Size([11161, 2, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.6050138473510742  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.6050138473510742  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 11161, 128]), torch.Size([1, 11161, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.6156578063964844  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7764959335327148  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 11161, 128])
m.shape torch.Size([10217, 3, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7857894897460938  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7857894897460938  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 10217, 128]), torch.Size([1, 10217, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7955331802368164  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.010289192199707  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 10217, 128])
m.shape torch.Size([8831, 4, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.0229954719543457  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.0229954719543457  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 8831, 128]), torch.Size([1, 8831, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.0320782661437988  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2851252555847168  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 8831, 128])
m.shape torch.Size([7650, 5, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2991533279418945  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2991533279418945  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 7650, 128]), torch.Size([1, 7650, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.307023525238037  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.5716404914855957  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7650, 128])
m.shape torch.Size([6460, 6, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.586474895477295  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.586474895477295  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6460, 128]), torch.Size([1, 6460, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.5930685997009277  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.858980655670166  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6460, 128])
m.shape torch.Size([5658, 7, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.8754315376281738  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.8754315376281738  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5658, 128]), torch.Size([1, 5658, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.8809895515441895  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1735758781433105  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5658, 128])
m.shape torch.Size([5010, 8, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1894822120666504  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1894822120666504  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5010, 128]), torch.Size([1, 5010, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1944375038146973  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.4690699577331543  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5010, 128])
m.shape torch.Size([4527, 9, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.4853568077087402  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.4853568077087402  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4527, 128]), torch.Size([1, 4527, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.489682674407959  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.767364025115967  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4527, 128])
m.shape torch.Size([52911, 10, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 3.0174012184143066  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 3.0174012184143066  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 52911, 128]), torch.Size([1, 52911, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 3.0678610801696777  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.650511264801025  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 52911, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.287947177886963  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.404877185821533  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.5218071937561035  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.403963565826416  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([122610, 256])
first layer input nodes number: 154359
first layer output nodes number: 122610
edges number: 825031
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.523045063018799  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.639975070953369  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.669271945953369  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.669271945953369  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([6023, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.087677001953125  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.087677001953125  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6023, 256]), torch.Size([1, 6023, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.099164962768555  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.191068649291992  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6023, 256])
m.shape torch.Size([5233, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.1953840255737305  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.1953840255737305  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5233, 256]), torch.Size([1, 5233, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.2058587074279785  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.355576038360596  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5233, 256])
m.shape torch.Size([4195, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.3626813888549805  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.3626813888549805  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4195, 256]), torch.Size([1, 4195, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.371236324310303  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.551084995269775  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4195, 256])
m.shape torch.Size([3306, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.559246063232422  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.559246063232422  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 3306, 256]), torch.Size([1, 3306, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.566019058227539  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.7528181076049805  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 3306, 256])
m.shape torch.Size([2863, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.762990951538086  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.762990951538086  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2863, 256]), torch.Size([1, 2863, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.769657135009766  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.967188835144043  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2863, 256])
m.shape torch.Size([2272, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.977560520172119  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.977560520172119  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2272, 256]), torch.Size([1, 2272, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.98208475112915  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.170520305633545  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2272, 256])
m.shape torch.Size([1806, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.180504322052002  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.180504322052002  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1806, 256]), torch.Size([1, 1806, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.183958530426025  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.359772205352783  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1806, 256])
m.shape torch.Size([1648, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.370468616485596  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.370468616485596  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1648, 256]), torch.Size([1, 1648, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.37390947341919  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.564725875854492  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1648, 256])
m.shape torch.Size([1487, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.57595682144165  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.57595682144165  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1487, 256]), torch.Size([1, 1487, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.57900094985962  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.773396968841553  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1487, 256])
m.shape torch.Size([1337, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.783924102783203  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.783924102783203  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1337, 256]), torch.Size([1, 1337, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.78650712966919  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.969839572906494  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1337, 256])
m.shape torch.Size([1078, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.979556560516357  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.979556560516357  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1078, 256]), torch.Size([1, 1078, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.981624126434326  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.15375566482544  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1078, 256])
m.shape torch.Size([985, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.164088249206543  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.164088249206543  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 985, 256]), torch.Size([1, 985, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.165966987609863  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.331255912780762  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 985, 256])
m.shape torch.Size([893, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.341474533081055  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.341474533081055  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.343177795410156  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.4998779296875  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([752, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.509145259857178  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.509145259857178  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 752, 256]), torch.Size([1, 752, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.510579586029053  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.653008937835693  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 752, 256])
m.shape torch.Size([737, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.662917137145996  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.662917137145996  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.664322853088379  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.813882827758789  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([640, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.82302188873291  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.82302188873291  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 640, 256]), torch.Size([1, 640, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.82424259185791  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.96568775177002  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 640, 256])
m.shape torch.Size([574, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.974456310272217  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.974456310272217  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.975551128387451  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.10919713973999  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([582, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.11871862411499  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.11871862411499  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.119828701019287  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.261468410491943  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([529, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.27057409286499  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.27057409286499  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.271583080291748  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.406787395477295  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([485, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.415606021881104  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.415606021881104  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.416531085968018  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.547754764556885  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([438, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.556132793426514  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.556132793426514  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.556968212127686  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.68194055557251  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([365, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.6892409324646  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.6892409324646  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.689937114715576  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.798708438873291  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([316, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.805346012115479  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.805346012115479  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.805948734283447  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.905561923980713  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([345, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.913218975067139  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.913218975067139  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.913877010345459  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 11.025107860565186  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([6582, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 11.182932376861572  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 11.182932376861572  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6582, 256]), torch.Size([1, 6582, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 11.195486545562744  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.41622018814087  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6582, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.040632247924805  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.047609329223633  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.0543851852417  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.047069072723389  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([45471, 40])
input nodes number: 122610
output nodes number: 45471
edges number: 427245
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.047579765319824  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 13.04758071899414  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11930990219116211  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

pseudo mini batch 1 input nodes size: 150862
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.092437744140625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.092437744140625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.16437435150146484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.16471338272094727  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.09015560150146484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.0976266860961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.0976266860961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.0976266860961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([150862, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.0976266860961914  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([11501, 1, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.4392843246459961  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.4392843246459961  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 11501, 128]), torch.Size([1, 11501, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.4510030746459961  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5402498245239258  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 11501, 128])
m.shape torch.Size([12129, 2, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5464844703674316  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5464844703674316  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 12129, 128]), torch.Size([1, 12129, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.5585026741027832  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7324643135070801  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 12129, 128])
m.shape torch.Size([10749, 3, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7421541213989258  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7421541213989258  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 10749, 128]), torch.Size([1, 10749, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.7529687881469727  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.9807515144348145  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 10749, 128])
m.shape torch.Size([8987, 4, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.9932041168212891  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.9932041168212891  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 8987, 128]), torch.Size([1, 8987, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.0034379959106445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2572288513183594  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 8987, 128])
m.shape torch.Size([7762, 5, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2714495658874512  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2714495658874512  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 7762, 128]), torch.Size([1, 7762, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.2798686027526855  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.5630521774291992  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7762, 128])
m.shape torch.Size([6242, 6, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.57720947265625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.57720947265625  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6242, 128]), torch.Size([1, 6242, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.583505630493164  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.841567039489746  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6242, 128])
m.shape torch.Size([5308, 7, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.8563079833984375  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.8563079833984375  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5308, 128]), torch.Size([1, 5308, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 1.861886978149414  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1156959533691406  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5308, 128])
m.shape torch.Size([4642, 8, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1308727264404297  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.1308727264404297  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4642, 128]), torch.Size([1, 4642, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.135617256164551  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.397854804992676  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4642, 128])
m.shape torch.Size([3947, 9, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.4125800132751465  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.4125800132751465  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 3947, 128]), torch.Size([1, 3947, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.41670560836792  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.6647162437438965  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 3947, 128])
m.shape torch.Size([39559, 10, 128])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.8507556915283203  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.8507556915283203  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 39559, 128]), torch.Size([1, 39559, 128])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 2.8898181915283203  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.583089828491211  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 39559, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.284979820251465  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.390671730041504  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.496363639831543  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.389845848083496  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([110826, 256])
first layer input nodes number: 150862
first layer output nodes number: 110826
edges number: 685621
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.497514724731445  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.603206634521484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.630550384521484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.630550384521484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

m.shape torch.Size([7405, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.9441609382629395  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.9441609382629395  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 7405, 256]), torch.Size([1, 7405, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 5.958284854888916  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.0712761878967285  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 7405, 256])
m.shape torch.Size([6473, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.076780319213867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.076780319213867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 6473, 256]), torch.Size([1, 6473, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.089608192443848  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.274802207946777  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 6473, 256])
m.shape torch.Size([5082, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.28328275680542  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.28328275680542  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 5082, 256]), torch.Size([1, 5082, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.293215274810791  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.50997257232666  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 5082, 256])
m.shape torch.Size([4014, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.520412921905518  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.520412921905518  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 4014, 256]), torch.Size([1, 4014, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.52891731262207  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.754854202270508  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 4014, 256])
m.shape torch.Size([3359, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.766777515411377  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.766777515411377  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 3359, 256]), torch.Size([1, 3359, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 6.773956775665283  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.00491189956665  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 3359, 256])
m.shape torch.Size([2596, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.016368389129639  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.016368389129639  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2596, 256]), torch.Size([1, 2596, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.021503925323486  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.235970973968506  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2596, 256])
m.shape torch.Size([2239, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.24855899810791  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.24855899810791  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2239, 256]), torch.Size([1, 2239, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.252961158752441  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.468877792358398  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2239, 256])
m.shape torch.Size([1824, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.480767250061035  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.480767250061035  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1824, 256]), torch.Size([1, 1824, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.484299659729004  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.683528900146484  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1824, 256])
m.shape torch.Size([1489, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.694585800170898  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.694585800170898  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1489, 256]), torch.Size([1, 1489, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.697555065155029  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.88344144821167  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1489, 256])
m.shape torch.Size([1262, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.89397668838501  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.89397668838501  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1262, 256]), torch.Size([1, 1262, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 7.896519184112549  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.083225727081299  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1262, 256])
m.shape torch.Size([1125, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.09383249282837  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.09383249282837  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.096006870269775  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.265435695648193  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([952, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.275396347045898  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.275396347045898  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.277212142944336  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.431554794311523  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([763, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.44018030166626  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.44018030166626  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.441635608673096  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.576670169830322  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([682, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.585119724273682  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.585119724273682  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 682, 256]), torch.Size([1, 682, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.58642053604126  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.715219974517822  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 682, 256])
m.shape torch.Size([552, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.722527980804443  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.722527980804443  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 552, 256]), torch.Size([1, 552, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.723580837249756  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.838799953460693  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 552, 256])
m.shape torch.Size([471, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.845516681671143  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.845516681671143  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.846415042877197  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.950191974639893  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([456, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.957193851470947  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.957193851470947  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 8.95806360244751  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.06402063369751  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([366, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.069917678833008  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.069917678833008  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.070615768432617  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.161317825317383  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([307, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.16657543182373  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.16657543182373  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.167160987854004  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.249207496643066  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([322, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.255104541778564  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.255104541778564  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.25571870803833  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.343052387237549  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([279, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.348376750946045  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.348376750946045  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.3489089012146  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.429135799407959  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([191, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.432908535003662  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.432908535003662  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.43327283859253  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.489739894866943  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([203, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.49404525756836  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.49404525756836  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.49443244934082  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.557157516479492  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([180, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.561116218566895  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.561116218566895  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.5614595413208  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.619481086730957  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([2878, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.688462734222412  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.688462734222412  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

 h.shape torch.Size([1, 2878, 256]), torch.Size([1, 2878, 256])
----------------------------------------3
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 9.693959712982178  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.664630889892578  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

rst.shape  torch.Size([1, 2878, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.400601387023926  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.407572746276855  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.414912223815918  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.407601833343506  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

torch.Size([45470, 40])
input nodes number: 110826
output nodes number: 45470
edges number: 317005
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.40896224975586  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 10.408962726593018  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11249876022338867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11249876022338867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.1756591796875 GB
    Memory Allocated: 0.11249876022338867  GigaBytes
Max Memory Allocated: 14.358309745788574  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07161223888397217 |0.0060460567474365234 |0.17898344993591309 |0.000110626220703125 |0.13679134845733643 |0.005043983459472656 |
----------------------------------------------------------pseudo_mini_loss sum 3.0408825874328613
Total (block generation + training)time/epoch 14.523044228553772
Training time/epoch 0.8713974952697754
Training time without block to device /epoch 0.8593053817749023
Training time without total dataloading part /epoch 0.6368148326873779
load block tensor time/epoch 0.14322447776794434
block to device time/epoch 0.012092113494873047
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  538657
Number of first layer input nodes during this epoch:  305221
Number of first layer output nodes during this epoch:  233436
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
