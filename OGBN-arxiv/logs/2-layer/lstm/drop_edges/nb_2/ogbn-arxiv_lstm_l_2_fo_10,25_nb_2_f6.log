[17:44:08] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 2 parts and get 219704 edge cuts
main start at this time 1651599828.2988527
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.034813880920410156
global_2_local spend time (sec) 0.035958051681518555
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004931926727294922
A = g.adjacency_matrix() spent  0.007860183715820312
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07816195487976074
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2998366355895996
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1930983066558838

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.242 seconds
Metis partitioning: 4.775 seconds
Split the graph: 3.971 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.059701204299927
46436
44505
total k batches seeds list generation spend  19.86567234992981
after graph partition
graph partition algorithm spend time 19.970081567764282
46436
44505
partition_len_list
[71115, 101830]
shared_neighbor_graph_partition_s0 selection method  spend 20.055433750152588
time for parepare:  0.017295360565185547
local_output_nid generation:  0.004523277282714844
local_in_edges_tensor generation:  0.006291627883911133
mini_batch_src_global generation:  0.017183303833007812
r_  generation:  0.12172961235046387
local_output_nid generation:  0.0066699981689453125
local_in_edges_tensor generation:  0.0160064697265625
mini_batch_src_global generation:  0.01504826545715332
r_  generation:  0.14551949501037598
----------------------check_connections_block total spend ----------------------------- 0.42061471939086914
generate_one_block  0.15366744995117188
generate_one_block  0.19658637046813965
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.06462264060974121
gen group dst list time:  0.004700899124145508
time for parepare:  0.01916790008544922
local_output_nid generation:  0.008601188659667969
local_in_edges_tensor generation:  0.03144264221191406
mini_batch_src_global generation:  0.012630939483642578
r_  generation:  0.15322589874267578
local_output_nid generation:  0.01453709602355957
local_in_edges_tensor generation:  0.026920795440673828
mini_batch_src_global generation:  0.025845766067504883
r_  generation:  0.2567462921142578
----------------------check_connections_block total spend ----------------------------- 0.645456075668335
generate_one_block  0.18972563743591309
generate_one_block  0.3198554515838623
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.645456075668335
block generation total time  0.5095810890197754
average batch blocks generation time:  0.2547905445098877
pseudo mini batch 0 input nodes size: 91142
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04623746871948242  GigaBytes
Max Memory Allocated: 0.04623746871948242  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04658365249633789  GigaBytes
Max Memory Allocated: 0.04658365249633789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0643310546875 GB
    Memory Allocated: 0.04658365249633789  GigaBytes
Max Memory Allocated: 0.04658365249633789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

torch.Size([91142, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1483154296875 GB
    Memory Allocated: 0.05234193801879883  GigaBytes
Max Memory Allocated: 0.05234193801879883  GigaBytes

m.shape torch.Size([8824, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25603199005126953  GigaBytes
Max Memory Allocated: 0.2575240135192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.25603199005126953  GigaBytes
Max Memory Allocated: 0.2575240135192871  GigaBytes

 h.shape torch.Size([1, 8824, 128]), torch.Size([1, 8824, 128])
----------------------------------------3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.2644472122192383  GigaBytes
Max Memory Allocated: 0.2644472122192383  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3340120315551758  GigaBytes
Max Memory Allocated: 0.33821964263916016  GigaBytes

rst.shape  torch.Size([1, 8824, 128])
m.shape torch.Size([8749, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3381481170654297  GigaBytes
Max Memory Allocated: 0.33834409713745117  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.3381481170654297  GigaBytes
Max Memory Allocated: 0.33834409713745117  GigaBytes

 h.shape torch.Size([1, 8749, 128]), torch.Size([1, 8749, 128])
----------------------------------------3
 Nvidia-smi: 1.5467529296875 GB
    Memory Allocated: 0.34649181365966797  GigaBytes
Max Memory Allocated: 0.34649181365966797  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4769916534423828  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

rst.shape  torch.Size([1, 8749, 128])
m.shape torch.Size([7617, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.48453855514526367  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.48453855514526367  GigaBytes
Max Memory Allocated: 0.4853353500366211  GigaBytes

 h.shape torch.Size([1, 7617, 128]), torch.Size([1, 7617, 128])
----------------------------------------3
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4918026924133301  GigaBytes
Max Memory Allocated: 0.4918026924133301  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.651613712310791  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

rst.shape  torch.Size([1, 7617, 128])
m.shape torch.Size([6383, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.66015625  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.66015625  GigaBytes
Max Memory Allocated: 0.663332462310791  GigaBytes

 h.shape torch.Size([1, 6383, 128]), torch.Size([1, 6383, 128])
----------------------------------------3
 Nvidia-smi: 1.8944091796875 GB
    Memory Allocated: 0.6669235229492188  GigaBytes
Max Memory Allocated: 0.6669235229492188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8441362380981445  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

rst.shape  torch.Size([1, 6383, 128])
m.shape torch.Size([5289, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.8537025451660156  GigaBytes
Max Memory Allocated: 0.8563108444213867  GigaBytes

 h.shape torch.Size([1, 5289, 128]), torch.Size([1, 5289, 128])
----------------------------------------3
 Nvidia-smi: 2.1033935546875 GB
    Memory Allocated: 0.859062671661377  GigaBytes
Max Memory Allocated: 0.859062671661377  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0409321784973145  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

rst.shape  torch.Size([1, 5289, 128])
m.shape torch.Size([4360, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0508842468261719  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0508842468261719  GigaBytes
Max Memory Allocated: 1.053542137145996  GigaBytes

 h.shape torch.Size([1, 4360, 128]), torch.Size([1, 4360, 128])
----------------------------------------3
 Nvidia-smi: 2.3162841796875 GB
    Memory Allocated: 1.0554852485656738  GigaBytes
Max Memory Allocated: 1.0554852485656738  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.241661548614502  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

rst.shape  torch.Size([1, 4360, 128])
m.shape torch.Size([3700, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2519326210021973  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2519326210021973  GigaBytes
Max Memory Allocated: 1.2541356086730957  GigaBytes

 h.shape torch.Size([1, 3700, 128]), torch.Size([1, 3700, 128])
----------------------------------------3
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2556872367858887  GigaBytes
Max Memory Allocated: 1.2556872367858887  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4333715438842773  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

rst.shape  torch.Size([1, 3700, 128])
m.shape torch.Size([3225, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.4439573287963867  GigaBytes
Max Memory Allocated: 1.445845603942871  GigaBytes

 h.shape torch.Size([1, 3225, 128]), torch.Size([1, 3225, 128])
----------------------------------------3
 Nvidia-smi: 2.7205810546875 GB
    Memory Allocated: 1.447218894958496  GigaBytes
Max Memory Allocated: 1.447218894958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6251888275146484  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

rst.shape  torch.Size([1, 3225, 128])
m.shape torch.Size([2740, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6354098320007324  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6354098320007324  GigaBytes
Max Memory Allocated: 1.637491226196289  GigaBytes

 h.shape torch.Size([1, 2740, 128]), torch.Size([1, 2740, 128])
----------------------------------------3
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.638087272644043  GigaBytes
Max Memory Allocated: 1.638087272644043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 1.8094873428344727  GigaBytes
Max Memory Allocated: 1.8212461471557617  GigaBytes

rst.shape  torch.Size([1, 2740, 128])
m.shape torch.Size([20228, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.1600341796875 GB
    Memory Allocated: 1.9040288925170898  GigaBytes
Max Memory Allocated: 1.906290054321289  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1600341796875 GB
    Memory Allocated: 1.9040288925170898  GigaBytes
Max Memory Allocated: 1.906290054321289  GigaBytes

 h.shape torch.Size([1, 20228, 128]), torch.Size([1, 20228, 128])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.9233198165893555  GigaBytes
Max Memory Allocated: 1.9233198165893555  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6639404296875 GB
    Memory Allocated: 3.3100385665893555  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

rst.shape  torch.Size([1, 20228, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.138339042663574  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.6990966796875 GB
    Memory Allocated: 3.2061595916748047  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.2745189666748047  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.2061681747436523  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

torch.Size([71115, 256])
first layer input nodes number: 91142
first layer output nodes number: 71115
edges number: 405950
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.275200366973877  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7674560546875 GB
    Memory Allocated: 3.3430209159851074  GigaBytes
Max Memory Allocated: 3.4064931869506836  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 3.3605151176452637  GigaBytes
Max Memory Allocated: 3.428335666656494  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 3.3605151176452637  GigaBytes
Max Memory Allocated: 3.428335666656494  GigaBytes

m.shape torch.Size([6798, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.6982717514038086  GigaBytes
Max Memory Allocated: 3.6982975006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.6982717514038086  GigaBytes
Max Memory Allocated: 3.6982975006103516  GigaBytes

 h.shape torch.Size([1, 6798, 256]), torch.Size([1, 6798, 256])
----------------------------------------3
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.711237907409668  GigaBytes
Max Memory Allocated: 3.711237907409668  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.814967155456543  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

rst.shape  torch.Size([1, 6798, 256])
m.shape torch.Size([6155, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.8204574584960938  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.8204574584960938  GigaBytes
Max Memory Allocated: 3.8214502334594727  GigaBytes

 h.shape torch.Size([1, 6155, 256]), torch.Size([1, 6155, 256])
----------------------------------------3
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.832810401916504  GigaBytes
Max Memory Allocated: 3.832810401916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3162841796875 GB
    Memory Allocated: 4.008906364440918  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

rst.shape  torch.Size([1, 6155, 256])
m.shape torch.Size([5092, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.01771879196167  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.01771879196167  GigaBytes
Max Memory Allocated: 4.020646095275879  GigaBytes

 h.shape torch.Size([1, 5092, 256]), torch.Size([1, 5092, 256])
----------------------------------------3
 Nvidia-smi: 5.3319091796875 GB
    Memory Allocated: 4.027826309204102  GigaBytes
Max Memory Allocated: 4.027826309204102  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.242563247680664  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

rst.shape  torch.Size([1, 5092, 256])
m.shape torch.Size([4086, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.253347396850586  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.253347396850586  GigaBytes
Max Memory Allocated: 4.257131576538086  GigaBytes

 h.shape torch.Size([1, 4086, 256]), torch.Size([1, 4086, 256])
----------------------------------------3
 Nvidia-smi: 5.5623779296875 GB
    Memory Allocated: 4.261333465576172  GigaBytes
Max Memory Allocated: 4.261333465576172  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.488121032714844  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

rst.shape  torch.Size([1, 4086, 256])
m.shape torch.Size([3379, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.500462532043457  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.500462532043457  GigaBytes
Max Memory Allocated: 4.503746032714844  GigaBytes

 h.shape torch.Size([1, 3379, 256]), torch.Size([1, 3379, 256])
----------------------------------------3
 Nvidia-smi: 5.8065185546875 GB
    Memory Allocated: 4.507497310638428  GigaBytes
Max Memory Allocated: 4.507497310638428  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.755641460418701  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

rst.shape  torch.Size([1, 3379, 256])
m.shape torch.Size([2709, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.768041133880615  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.768041133880615  GigaBytes
Max Memory Allocated: 4.771753787994385  GigaBytes

 h.shape torch.Size([1, 2709, 256]), torch.Size([1, 2709, 256])
----------------------------------------3
 Nvidia-smi: 6.0350341796875 GB
    Memory Allocated: 4.773675441741943  GigaBytes
Max Memory Allocated: 4.773675441741943  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 4.997709274291992  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

rst.shape  torch.Size([1, 2709, 256])
m.shape torch.Size([2282, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.010869979858398  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.010869979858398  GigaBytes
Max Memory Allocated: 5.013334274291992  GigaBytes

 h.shape torch.Size([1, 2282, 256]), torch.Size([1, 2282, 256])
----------------------------------------3
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 5.015614032745361  GigaBytes
Max Memory Allocated: 5.015614032745361  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.234419345855713  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

rst.shape  torch.Size([1, 2282, 256])
m.shape torch.Size([1950, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.247538089752197  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.247538089752197  GigaBytes
Max Memory Allocated: 5.249653339385986  GigaBytes

 h.shape torch.Size([1, 1950, 256]), torch.Size([1, 1950, 256])
----------------------------------------3
 Nvidia-smi: 6.5506591796875 GB
    Memory Allocated: 5.2513604164123535  GigaBytes
Max Memory Allocated: 5.2513604164123535  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.467553615570068  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

rst.shape  torch.Size([1, 1950, 256])
m.shape torch.Size([1653, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.479374885559082  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.479374885559082  GigaBytes
Max Memory Allocated: 5.483178615570068  GigaBytes

 h.shape torch.Size([1, 1653, 256]), torch.Size([1, 1653, 256])
----------------------------------------3
 Nvidia-smi: 6.7811279296875 GB
    Memory Allocated: 5.483428955078125  GigaBytes
Max Memory Allocated: 5.483428955078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.690738677978516  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

rst.shape  torch.Size([1, 1653, 256])
m.shape torch.Size([1427, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.702877521514893  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.702877521514893  GigaBytes
Max Memory Allocated: 5.704926490783691  GigaBytes

 h.shape torch.Size([1, 1427, 256]), torch.Size([1, 1427, 256])
----------------------------------------3
 Nvidia-smi: 6.9725341796875 GB
    Memory Allocated: 5.705646991729736  GigaBytes
Max Memory Allocated: 5.705646991729736  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9001145362854  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

rst.shape  torch.Size([1, 1427, 256])
m.shape torch.Size([1208, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9113850593566895  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.9113850593566895  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 7.1815185546875 GB
    Memory Allocated: 5.913784503936768  GigaBytes
Max Memory Allocated: 5.9137864112854  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.101688385009766  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([1031, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.112404823303223  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.112404823303223  GigaBytes
Max Memory Allocated: 6.114360809326172  GigaBytes

 h.shape torch.Size([1, 1031, 256]), torch.Size([1, 1031, 256])
----------------------------------------3
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 6.114418029785156  GigaBytes
Max Memory Allocated: 6.114418029785156  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.284245491027832  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

rst.shape  torch.Size([1, 1031, 256])
m.shape torch.Size([873, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.294054985046387  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5467529296875 GB
    Memory Allocated: 6.294054985046387  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

 h.shape torch.Size([1, 873, 256]), torch.Size([1, 873, 256])
----------------------------------------3
 Nvidia-smi: 7.5487060546875 GB
    Memory Allocated: 6.295720100402832  GigaBytes
Max Memory Allocated: 6.29604434967041  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.453133583068848  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

rst.shape  torch.Size([1, 873, 256])
m.shape torch.Size([783, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.462837219238281  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.462837219238281  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 7.7049560546875 GB
    Memory Allocated: 6.464330673217773  GigaBytes
Max Memory Allocated: 6.464852333068848  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.61346435546875  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([699, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.622795104980469  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8631591796875 GB
    Memory Allocated: 6.622795104980469  GigaBytes
Max Memory Allocated: 6.623918533325195  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 7.8651123046875 GB
    Memory Allocated: 6.624128341674805  GigaBytes
Max Memory Allocated: 6.624128341674805  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.771245002746582  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([562, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.779221057891846  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.779221057891846  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

 h.shape torch.Size([1, 562, 256]), torch.Size([1, 562, 256])
----------------------------------------3
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 6.780292987823486  GigaBytes
Max Memory Allocated: 6.781244277954102  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.903416156768799  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

rst.shape  torch.Size([1, 562, 256])
m.shape torch.Size([540, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.911703586578369  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.911703586578369  GigaBytes
Max Memory Allocated: 6.911991596221924  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 8.1424560546875 GB
    Memory Allocated: 6.912733554840088  GigaBytes
Max Memory Allocated: 6.912733554840088  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.0366387367248535  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([451, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.043926239013672  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.043926239013672  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 8.2830810546875 GB
    Memory Allocated: 7.04478645324707  GigaBytes
Max Memory Allocated: 7.045393466949463  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.157236099243164  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([384, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.163818359375  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.163818359375  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 8.3924560546875 GB
    Memory Allocated: 7.16455078125  GigaBytes
Max Memory Allocated: 7.16497802734375  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.266070365905762  GigaBytes
Max Memory Allocated: 7.273028373718262  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([385, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.273105144500732  GigaBytes
Max Memory Allocated: 7.273134231567383  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4998779296875 GB
    Memory Allocated: 7.273105144500732  GigaBytes
Max Memory Allocated: 7.273134231567383  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.5018310546875 GB
    Memory Allocated: 7.273839473724365  GigaBytes
Max Memory Allocated: 7.273839473724365  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.379611492156982  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([340, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386106967926025  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386106967926025  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 8.6151123046875 GB
    Memory Allocated: 7.386755466461182  GigaBytes
Max Memory Allocated: 7.3869547843933105  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.48391580581665  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([271, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.489322185516357  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.489322185516357  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.7069091796875 GB
    Memory Allocated: 7.48983907699585  GigaBytes
Max Memory Allocated: 7.490725040435791  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.574192523956299  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([242, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579283714294434  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579283714294434  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.7947998046875 GB
    Memory Allocated: 7.579745292663574  GigaBytes
Max Memory Allocated: 7.579878330230713  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.6545209884643555  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([237, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.659757137298584  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.659757137298584  GigaBytes
Max Memory Allocated: 7.659829139709473  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.6602091789245605  GigaBytes
Max Memory Allocated: 7.6602091789245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.9549560546875 GB
    Memory Allocated: 7.7366042137146  GigaBytes
Max Memory Allocated: 7.742028713226318  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([2899, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.806035995483398  GigaBytes
Max Memory Allocated: 7.8063063621521  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.806035995483398  GigaBytes
Max Memory Allocated: 7.8063063621521  GigaBytes

 h.shape torch.Size([1, 2899, 256]), torch.Size([1, 2899, 256])
----------------------------------------3
 Nvidia-smi: 9.0272216796875 GB
    Memory Allocated: 7.811565399169922  GigaBytes
Max Memory Allocated: 7.811565399169922  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1209716796875 GB
    Memory Allocated: 8.827034950256348  GigaBytes
Max Memory Allocated: 8.89615249633789  GigaBytes

rst.shape  torch.Size([1, 2899, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.541881561279297  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.54880142211914  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.555721282958984  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.548455238342285  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([46436, 40])
input nodes number: 71115
output nodes number: 46436
edges number: 341171
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.556251525878906  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.2108154296875 GB
    Memory Allocated: 8.556252479553223  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.07392501831054688  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

pseudo mini batch 1 input nodes size: 126400
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.056279659271240234  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.056279659271240234  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.11655187606811523  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.11688375473022461  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.07307767868041992  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([126400, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.8709716796875 GB
    Memory Allocated: 0.08147048950195312  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

m.shape torch.Size([8847, 1, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4310579299926758  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4310579299926758  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 8847, 128]), torch.Size([1, 8847, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.4394950866699219  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5091037750244141  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 8847, 128])
m.shape torch.Size([8774, 2, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5132527351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5132527351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 8774, 128]), torch.Size([1, 8774, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.5216202735900879  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6521916389465332  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 8774, 128])
m.shape torch.Size([7464, 3, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6586852073669434  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6586852073669434  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 7464, 128]), torch.Size([1, 7464, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.6662201881408691  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8232378959655762  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 7464, 128])
m.shape torch.Size([6440, 4, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8319621086120605  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8319621086120605  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 6440, 128]), torch.Size([1, 6440, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 0.8385252952575684  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0182085037231445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 6440, 128])
m.shape torch.Size([5763, 5, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0288777351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0288777351379395  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 5763, 128]), torch.Size([1, 5763, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.0346965789794922  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2449884414672852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 5763, 128])
m.shape torch.Size([4879, 6, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2561993598937988  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.2561993598937988  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4879, 128]), torch.Size([1, 4879, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.261164665222168  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.4624509811401367  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4879, 128])
m.shape torch.Size([4451, 7, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.475663185119629  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.475663185119629  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4451, 128]), torch.Size([1, 4451, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.4804887771606445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.694225788116455  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4451, 128])
m.shape torch.Size([4008, 8, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.707728385925293  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.707728385925293  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4008, 128]), torch.Size([1, 4008, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.7115507125854492  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.9304304122924805  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4008, 128])
m.shape torch.Size([3600, 9, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.943892478942871  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.943892478942871  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 3600, 128]), torch.Size([1, 3600, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 1.9479403495788574  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.1734766960144043  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 3600, 128])
m.shape torch.Size([47604, 10, 128])
----------------------------------------1
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.3987536430358887  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.3987536430358887  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 47604, 128]), torch.Size([1, 47604, 128])
----------------------------------------3
 Nvidia-smi: 11.2108154296875 GB
    Memory Allocated: 2.444152355194092  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.667460918426514  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 47604, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.354747772216797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.451860427856445  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.548973083496094  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.451101303100586  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

torch.Size([101830, 256])
first layer input nodes number: 126400
first layer output nodes number: 101830
edges number: 704297
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.549916744232178  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.647029399871826  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.671307563781738  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.1834716796875 GB
    Memory Allocated: 5.671307563781738  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

m.shape torch.Size([6630, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.067834854125977  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.067834854125977  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 6630, 256]), torch.Size([1, 6630, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.081445693969727  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.184541702270508  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 6630, 256])
m.shape torch.Size([5551, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.188406944274902  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.188406944274902  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 5551, 256]), torch.Size([1, 5551, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.200461387634277  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.360010147094727  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 5551, 256])
m.shape torch.Size([4185, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.366783618927002  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.366783618927002  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 4185, 256]), torch.Size([1, 4185, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.374931812286377  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.554792881011963  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 4185, 256])
m.shape torch.Size([3234, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.563152313232422  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.563152313232422  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 3234, 256]), torch.Size([1, 3234, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.569465637207031  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.752399444580078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 3234, 256])
m.shape torch.Size([2843, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.762035846710205  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.762035846710205  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 2843, 256]), torch.Size([1, 2843, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.767590522766113  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.963449478149414  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 2843, 256])
m.shape torch.Size([2159, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.973188877105713  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.973188877105713  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 2159, 256]), torch.Size([1, 2159, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 6.978113651275635  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.161391735076904  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 2159, 256])
m.shape torch.Size([1763, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.170638084411621  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.170638084411621  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1763, 256]), torch.Size([1, 1763, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.174158573150635  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.346950054168701  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1763, 256])
m.shape torch.Size([1522, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.356971740722656  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.356971740722656  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1522, 256]), torch.Size([1, 1522, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.35999059677124  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.530980587005615  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1522, 256])
m.shape torch.Size([1323, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.540973663330078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.540973663330078  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1323, 256]), torch.Size([1, 1323, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.543551445007324  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.706734657287598  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1323, 256])
m.shape torch.Size([1172, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.716610908508301  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.716610908508301  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 1172, 256]), torch.Size([1, 1172, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.719012260437012  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.884860038757324  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 1172, 256])
m.shape torch.Size([995, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.893732070922852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.893732070922852  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 995, 256]), torch.Size([1, 995, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 7.8956298828125  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.052142143249512  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 995, 256])
m.shape torch.Size([906, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.06164264678955  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.06164264678955  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.063370704650879  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.21036434173584  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([783, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.219284057617188  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.219284057617188  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.22077751159668  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.359038352966309  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([651, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.367051601409912  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.367051601409912  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.368293285369873  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.492125988006592  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([590, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.500011444091797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.500011444091797  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 590, 256]), torch.Size([1, 590, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.501136779785156  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.62042236328125  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 590, 256])
m.shape torch.Size([549, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.628302574157715  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.628302574157715  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.629349708557129  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.7506742477417  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([490, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.75815725326538  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.75815725326538  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.759091854095459  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.876006603240967  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([497, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.884137630462646  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.884137630462646  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

 h.shape torch.Size([1, 497, 256]), torch.Size([1, 497, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 8.885085582733154  GigaBytes
Max Memory Allocated: 8.958588123321533  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.008336544036865  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

rst.shape  torch.Size([1, 497, 256])
m.shape torch.Size([452, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016117095947266  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016117095947266  GigaBytes
Max Memory Allocated: 9.016868114471436  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.016979217529297  GigaBytes
Max Memory Allocated: 9.016979217529297  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.135414123535156  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([422, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143095016479492  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143095016479492  GigaBytes
Max Memory Allocated: 9.143604278564453  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.143899917602539  GigaBytes
Max Memory Allocated: 9.143899917602539  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.259289741516113  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([377, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.266496658325195  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.266496658325195  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.267215728759766  GigaBytes
Max Memory Allocated: 9.267338752746582  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.377626419067383  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([285, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.383293151855469  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.383293151855469  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.38383674621582  GigaBytes
Max Memory Allocated: 9.385176658630371  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.469635963439941  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([277, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.47548770904541  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.47548770904541  GigaBytes
Max Memory Allocated: 9.475615501403809  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.4760160446167  GigaBytes
Max Memory Allocated: 9.4760160446167  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.563610076904297  GigaBytes
Max Memory Allocated: 9.569685935974121  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([288, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.569989204406738  GigaBytes
Max Memory Allocated: 9.570014953613281  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.569989204406738  GigaBytes
Max Memory Allocated: 9.570014953613281  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.570538520812988  GigaBytes
Max Memory Allocated: 9.570538520812988  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5682373046875 GB
    Memory Allocated: 9.667092323303223  GigaBytes
Max Memory Allocated: 9.673684120178223  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([6561, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.824466228485107  GigaBytes
Max Memory Allocated: 9.825077533721924  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.824466228485107  GigaBytes
Max Memory Allocated: 9.825077533721924  GigaBytes

 h.shape torch.Size([1, 6561, 256]), torch.Size([1, 6561, 256])
----------------------------------------3
 Nvidia-smi: 13.7264404296875 GB
    Memory Allocated: 9.837282180786133  GigaBytes
Max Memory Allocated: 9.837282180786133  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 12.069976806640625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6561, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.717529773712158  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.724335193634033  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.730977535247803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.723840236663818  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
[17:44:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 2 parts and get 191245 edge cuts

torch.Size([44505, 40])
input nodes number: 101830
output nodes number: 44505
edges number: 403079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.724643230438232  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2557373046875 GB
    Memory Allocated: 11.72464370727539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0977010726928711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325145721435547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325145721435547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07417666912078857 |0.17054903507232666 |0.43787217140197754 |0.00019466876983642578 |0.16275322437286377 |0.0057830810546875 |
----------------------------------------------------------pseudo_mini_loss sum 5.317046165466309
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  390487
Number of first layer input nodes during this epoch:  217542
Number of first layer output nodes during this epoch:  172945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325098037719727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018425941467285156
global_2_local spend time (sec) 0.039939165115356445
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00458073616027832
A = g.adjacency_matrix() spent  0.007677316665649414
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07797002792358398
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3365886211395264
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3453302383422852

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.311 seconds
Metis partitioning: 4.962 seconds
Split the graph: 4.412 seconds
Construct subgraphs: 0.046 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.745650291442871
46524
44417
total k batches seeds list generation spend  21.537130117416382
after graph partition
graph partition algorithm spend time 21.685260772705078
46524
44417
partition_len_list
[71215, 100289]
shared_neighbor_graph_partition_s0 selection method  spend 21.776787757873535
time for parepare:  0.01667642593383789
local_output_nid generation:  0.004588603973388672
local_in_edges_tensor generation:  0.006500959396362305
mini_batch_src_global generation:  0.011110305786132812
r_  generation:  0.12224769592285156
local_output_nid generation:  0.0059053897857666016
local_in_edges_tensor generation:  0.010982036590576172
mini_batch_src_global generation:  0.015873193740844727
r_  generation:  0.14310383796691895
----------------------check_connections_block total spend ----------------------------- 0.40093541145324707
generate_one_block  0.1737673282623291
generate_one_block  0.18588948249816895
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.055495262145996094
gen group dst list time:  0.004610300064086914
time for parepare:  0.01905536651611328
local_output_nid generation:  0.008008956909179688
local_in_edges_tensor generation:  0.02669668197631836
mini_batch_src_global generation:  0.013447284698486328
r_  generation:  0.1559126377105713
local_output_nid generation:  0.013550281524658203
local_in_edges_tensor generation:  0.01853203773498535
mini_batch_src_global generation:  0.024687528610229492
r_  generation:  0.2441844940185547
----------------------check_connections_block total spend ----------------------------- 0.6163148880004883
generate_one_block  0.18831920623779297
generate_one_block  0.3162651062011719
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.10325098037719727  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

connection checking time:  0.6163148880004883
block generation total time  0.5045843124389648
average batch blocks generation time:  0.2522921562194824
block dataloader generation time/epoch 23.83387517929077
pseudo mini batch 0 input nodes size: 91873
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0783390998840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0783390998840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.1221475601196289  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.12249422073364258  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.0618901252746582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06814718246459961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06814718246459961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06814718246459961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([91873, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.06814718246459961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8621, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.27400779724121094  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.27400779724121094  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8621, 128]), torch.Size([1, 8621, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.2822294235229492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.34800243377685547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8621, 128])
m.shape torch.Size([8657, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.35214757919311523  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.35214757919311523  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8657, 128]), torch.Size([1, 8657, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.36040353775024414  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.48424291610717773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8657, 128])
m.shape torch.Size([7488, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.4908266067504883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.4908266067504883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7488, 128]), torch.Size([1, 7488, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.4985165596008301  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6565203666687012  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7488, 128])
m.shape torch.Size([6237, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6648459434509277  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6648459434509277  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6237, 128]), torch.Size([1, 6237, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.6717715263366699  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8468294143676758  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6237, 128])
m.shape torch.Size([5283, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8564510345458984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8564510345458984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5283, 128]), torch.Size([1, 5283, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 0.8619441986083984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.0440540313720703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5283, 128])
m.shape torch.Size([4365, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.054023265838623  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.054023265838623  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4365, 128]), torch.Size([1, 4365, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.0587425231933594  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2377424240112305  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4365, 128])
m.shape torch.Size([3741, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.248147964477539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.248147964477539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3741, 128]), torch.Size([1, 3741, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.2517156600952148  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.4306941032409668  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3741, 128])
m.shape torch.Size([3261, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.441349983215332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.441349983215332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3261, 128]), torch.Size([1, 3261, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.4445629119873047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6232681274414062  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3261, 128])
m.shape torch.Size([2751, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6334319114685059  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6334319114685059  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2751, 128]), torch.Size([1, 2751, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.6360554695129395  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.8095293045043945  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2751, 128])
m.shape torch.Size([20811, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.9074211120605469  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.9074211120605469  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 20811, 128]), torch.Size([1, 20811, 128])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 1.9272680282592773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3363990783691406  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 20811, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.1629557609558105  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.2308716773986816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.2987875938415527  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.2303409576416016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([71215, 256])
first layer input nodes number: 91873
first layer output nodes number: 71215
edges number: 411096
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.2994742393493652  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3673901557922363  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3849682807922363  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.3849682807922363  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6702, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.729179859161377  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.729179859161377  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6702, 256]), torch.Size([1, 6702, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.7419629096984863  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.8442273139953613  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6702, 256])
m.shape torch.Size([6100, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.8495616912841797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.8495616912841797  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6100, 256]), torch.Size([1, 6100, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 3.861196517944336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.037552833557129  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6100, 256])
m.shape torch.Size([4978, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.046089172363281  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.046089172363281  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4978, 256]), torch.Size([1, 4978, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.056246280670166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.273245334625244  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4978, 256])
m.shape torch.Size([3977, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.284241676330566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.284241676330566  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3977, 256]), torch.Size([1, 3977, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.292222023010254  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.51951789855957  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3977, 256])
m.shape torch.Size([3348, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.531247138977051  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.531247138977051  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3348, 256]), torch.Size([1, 3348, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.538229942321777  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.77386999130249  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3348, 256])
m.shape torch.Size([2687, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.7857985496521  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.7857985496521  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2687, 256]), torch.Size([1, 2687, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 4.791202545166016  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.0148539543151855  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2687, 256])
m.shape torch.Size([2298, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.02775239944458  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.02775239944458  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2298, 256]), torch.Size([1, 2298, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.032364368438721  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.264552593231201  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2298, 256])
m.shape torch.Size([1975, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.277619361877441  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.277619361877441  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1975, 256]), torch.Size([1, 1975, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.281617164611816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.5000996589660645  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1975, 256])
m.shape torch.Size([1648, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.511775493621826  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.511775493621826  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1648, 256]), torch.Size([1, 1648, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.515011310577393  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.728522300720215  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1648, 256])
m.shape torch.Size([1456, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.740944862365723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.740944862365723  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1456, 256]), torch.Size([1, 1456, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.743721961975098  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.9422807693481445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1456, 256])
m.shape torch.Size([1230, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.953804969787598  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.953804969787598  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1230, 256]), torch.Size([1, 1230, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 5.956173419952393  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.151375770568848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1230, 256])
m.shape torch.Size([1047, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.162278652191162  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.162278652191162  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1047, 256]), torch.Size([1, 1047, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.1642937660217285  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.342073917388916  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1047, 256])
m.shape torch.Size([919, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.352558135986328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.352558135986328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 919, 256]), torch.Size([1, 919, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.354310989379883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.51630973815918  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 919, 256])
m.shape torch.Size([805, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.526265621185303  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.526265621185303  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.527801036834717  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.679807186126709  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([709, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.689261436462402  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.689261436462402  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.690613746643066  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.836953163146973  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([580, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.84519624710083  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.84519624710083  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.846302509307861  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.971310138702393  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([561, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.979923725128174  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.979923725128174  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 6.980993747711182  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.1108174324035645  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([462, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.118275165557861  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.118275165557861  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.119156360626221  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.233356952667236  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([411, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.240422248840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.240422248840332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.241206169128418  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.349222183227539  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([403, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.356576919555664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.356576919555664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.3573455810546875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.466526031494141  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 403, 256])
m.shape torch.Size([350, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.473206043243408  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.473206043243408  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.473873615264893  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.575430393218994  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([284, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.581101894378662  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.581101894378662  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 284, 256]), torch.Size([1, 284, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.581643581390381  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.666845798492432  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 284, 256])
m.shape torch.Size([256, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.672234058380127  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.672234058380127  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.672722339630127  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.751823902130127  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([243, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.757185459136963  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.757185459136963  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 16.0252685546875 GB
    Memory Allocated: 7.757648944854736  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.835978031158447  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([3095, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.910113334655762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.910113334655762  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3095, 256]), torch.Size([1, 3095, 256])
----------------------------------------3
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 7.916016578674316  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.955284118652344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3095, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.661603450775146  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.669328212738037  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.677052974700928  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.668981552124023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([46524, 40])
input nodes number: 71215
output nodes number: 46524
edges number: 349525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.670951843261719  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0389404296875 GB
    Memory Allocated: 8.670952796936035  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08107185363769531  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

pseudo mini batch 1 input nodes size: 123971
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06298398971557617  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06298398971557617  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12209796905517578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12242937088012695  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07827425003051758  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08633852005004883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08633852005004883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08633852005004883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([123971, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08633852005004883  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8992, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4273338317871094  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4273338317871094  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8992, 128]), torch.Size([1, 8992, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4359092712402344  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5057945251464844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8992, 128])
m.shape torch.Size([8856, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5099525451660156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5099525451660156  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8856, 128]), torch.Size([1, 8856, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.518463134765625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6492691040039062  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8856, 128])
m.shape torch.Size([7524, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6567649841308594  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6567649841308594  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7524, 128]), torch.Size([1, 7524, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6645755767822266  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8253021240234375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7524, 128])
m.shape torch.Size([6456, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8340282440185547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8340282440185547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6456, 128]), torch.Size([1, 6456, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8403148651123047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0203475952148438  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6456, 128])
m.shape torch.Size([5690, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0309410095214844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0309410095214844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5690, 128]), torch.Size([1, 5690, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0369939804077148  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2479314804077148  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5690, 128])
m.shape torch.Size([4836, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.259054183959961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.259054183959961  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4836, 128]), torch.Size([1, 4836, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2642507553100586  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4652090072631836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4836, 128])
m.shape torch.Size([4364, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.477280616760254  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.477280616760254  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4364, 128]), torch.Size([1, 4364, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4822702407836914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.691603660583496  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4364, 128])
m.shape torch.Size([3877, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7051477432250977  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7051477432250977  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3877, 128]), torch.Size([1, 3877, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7088451385498047  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9227294921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3877, 128])
m.shape torch.Size([3540, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9358792304992676  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9358792304992676  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3540, 128]), torch.Size([1, 3540, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9401435852050781  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.1677088737487793  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3540, 128])
m.shape torch.Size([46154, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3851523399353027  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3851523399353027  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 46154, 128]), torch.Size([1, 46154, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.429168224334717  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.554296016693115  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 46154, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.24838399887085  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.344027042388916  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.439670085906982  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.3432793617248535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([100289, 256])
first layer input nodes number: 123971
first layer output nodes number: 100289
edges number: 687530
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.440596103668213  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.536239147186279  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.560150146484375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.560150146484375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6726, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.948261260986328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.948261260986328  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6726, 256]), torch.Size([1, 6726, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.961090087890625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.064296722412109  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6726, 256])
m.shape torch.Size([5606, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.068658828735352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.068658828735352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5606, 256]), torch.Size([1, 5606, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.081212997436523  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.2425665855407715  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5606, 256])
m.shape torch.Size([4299, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.2496161460876465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.2496161460876465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4299, 256]), torch.Size([1, 4299, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.258117198944092  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.440354824066162  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4299, 256])
m.shape torch.Size([3343, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.448883056640625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.448883056640625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3343, 256]), torch.Size([1, 3343, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.455475807189941  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.642333030700684  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3343, 256])
m.shape torch.Size([2874, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.652761936187744  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.652761936187744  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2874, 256]), torch.Size([1, 2874, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.658483982086182  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.857405185699463  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2874, 256])
m.shape torch.Size([2181, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.867110252380371  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.867110252380371  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2181, 256]), torch.Size([1, 2181, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.872241020202637  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.0579729080200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2181, 256])
m.shape torch.Size([1747, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.0676469802856445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.0676469802856445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1747, 256]), torch.Size([1, 1747, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.071407794952393  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.239111423492432  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1747, 256])
m.shape torch.Size([1497, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.248905658721924  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.248905658721924  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1497, 256]), torch.Size([1, 1497, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.251998424530029  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.42747163772583  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1497, 256])
m.shape torch.Size([1328, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.4370269775390625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.4370269775390625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1328, 256]), torch.Size([1, 1328, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.4395751953125  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.602670669555664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1328, 256])
m.shape torch.Size([1143, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.612342357635498  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.612342357635498  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1143, 256]), torch.Size([1, 1143, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.614699840545654  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.775328636169434  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1143, 256])
m.shape torch.Size([973, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.7845258712768555  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.7845258712768555  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 973, 256]), torch.Size([1, 973, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.786381721496582  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.939145088195801  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 973, 256])
m.shape torch.Size([890, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.948482036590576  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.948482036590576  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 890, 256]), torch.Size([1, 890, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.950179576873779  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.095760345458984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 890, 256])
m.shape torch.Size([737, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.104120254516602  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.104120254516602  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.105525970458984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.235751152038574  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([629, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.243512153625488  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.243512153625488  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.244711875915527  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.367045402526855  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([580, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.374807357788086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.374807357788086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.375913619995117  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.494058609008789  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([531, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.501671314239502  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.501671314239502  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 531, 256]), torch.Size([1, 531, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.502684116363525  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.61743974685669  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 531, 256])
m.shape torch.Size([469, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.62459659576416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.62459659576416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.62549114227295  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.733895301818848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([486, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.741856098175049  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.741856098175049  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.742783069610596  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.860702991485596  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([425, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.868000984191895  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.868000984191895  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.86881160736084  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.978221893310547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([404, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.985582828521729  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.985582828521729  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.986353397369385  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.09526777267456  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([367, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.102290153503418  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.102290153503418  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.10299015045166  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.20728874206543  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([272, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.212690353393555  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.212690353393555  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.21320915222168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.298559188842773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([263, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.304113864898682  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.304113864898682  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.304615497589111  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.387939929962158  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([282, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.39419412612915  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.39419412612915  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.394731998443604  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.486303806304932  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([6365, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.6389741897583  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.6389741897583  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6365, 256]), torch.Size([1, 6365, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.651114463806152  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
[17:44:57] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 2 parts and get 192794 edge cuts

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.787802696228027  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6365, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.444528579711914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.451519012451172  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.45813798904419  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.45081615447998  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([44417, 40])
input nodes number: 100289
output nodes number: 44417
edges number: 394725
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.450789451599121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.45078992843628  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10013914108276367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10013914108276367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10013914108276367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055773019790649414 |0.004831910133361816 |0.16616857051849365 |0.0001176595687866211 |0.14094805717468262 |0.006837606430053711 |
----------------------------------------------------------pseudo_mini_loss sum 4.281011581420898
Total (block generation + training)time/epoch 24.654801607131958
Training time/epoch 0.8203871250152588
Training time without block to device /epoch 0.8107233047485352
Training time without total dataloading part /epoch 0.6213061809539795
load block tensor time/epoch 0.11154603958129883
block to device time/epoch 0.009663820266723633
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  387348
Number of first layer input nodes during this epoch:  215844
Number of first layer output nodes during this epoch:  171504
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10013866424560547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.017869949340820312
global_2_local spend time (sec) 0.03838849067687988
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048182010650634766
A = g.adjacency_matrix() spent  0.009422540664672852
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0779426097869873
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3932161331176758
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.21903657913208

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.358 seconds
Metis partitioning: 4.955 seconds
Split the graph: 4.368 seconds
Construct subgraphs: 0.032 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.72696590423584
46500
44441
total k batches seeds list generation spend  21.007915258407593
after graph partition
graph partition algorithm spend time 21.109266757965088
46500
44441
partition_len_list
[71091, 100408]
shared_neighbor_graph_partition_s0 selection method  spend 21.198381662368774
time for parepare:  0.017527341842651367
local_output_nid generation:  0.004804134368896484
local_in_edges_tensor generation:  0.0060651302337646484
mini_batch_src_global generation:  0.010985851287841797
r_  generation:  0.12622952461242676
local_output_nid generation:  0.005690097808837891
local_in_edges_tensor generation:  0.008825302124023438
mini_batch_src_global generation:  0.015703201293945312
r_  generation:  0.15631318092346191
----------------------check_connections_block total spend ----------------------------- 0.4376187324523926
generate_one_block  0.17607784271240234
generate_one_block  0.19073247909545898
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0419003963470459
gen group dst list time:  0.004918098449707031
time for parepare:  0.01987314224243164
local_output_nid generation:  0.008354425430297852
local_in_edges_tensor generation:  0.02485036849975586
mini_batch_src_global generation:  0.012884855270385742
r_  generation:  0.15932631492614746
local_output_nid generation:  0.0164492130279541
local_in_edges_tensor generation:  0.021267414093017578
mini_batch_src_global generation:  0.025364398956298828
r_  generation:  0.24866437911987305
----------------------check_connections_block total spend ----------------------------- 0.6304309368133545
generate_one_block  0.19169235229492188
generate_one_block  0.3562748432159424
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10013866424560547  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

connection checking time:  0.6304309368133545
block generation total time  0.5479671955108643
average batch blocks generation time:  0.27398359775543213
block dataloader generation time/epoch 23.586918354034424
pseudo mini batch 0 input nodes size: 91686
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07716751098632812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07716751098632812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12088680267333984  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12123346328735352  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.061788082122802734  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06745576858520508  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06745576858520508  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06745576858520508  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([91686, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06745576858520508  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([8557, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.27420806884765625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.27420806884765625  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8557, 128]), torch.Size([1, 8557, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.28236865997314453  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3476533889770508  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8557, 128])
m.shape torch.Size([8619, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3517928123474121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3517928123474121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8619, 128]), torch.Size([1, 8619, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.3600125312805176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4833083152770996  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8619, 128])
m.shape torch.Size([7454, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.48986148834228516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.48986148834228516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7454, 128]), torch.Size([1, 7454, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4969778060913086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6548953056335449  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7454, 128])
m.shape torch.Size([6235, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6632332801818848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6632332801818848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6235, 128]), torch.Size([1, 6235, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6702313423156738  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8443326950073242  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6235, 128])
m.shape torch.Size([5278, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8539433479309082  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8539433479309082  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5278, 128]), torch.Size([1, 5278, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8592596054077148  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0412044525146484  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5278, 128])
m.shape torch.Size([4379, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0512161254882812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0512161254882812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4379, 128]), torch.Size([1, 4379, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0558209419250488  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2353949546813965  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4379, 128])
m.shape torch.Size([3731, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.245760440826416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.245760440826416  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3731, 128]), torch.Size([1, 3731, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2493195533752441  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4272327423095703  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3731, 128])
m.shape torch.Size([3243, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4378247261047363  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4378247261047363  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3243, 128]), torch.Size([1, 3243, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4409995079040527  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.619119644165039  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3243, 128])
m.shape torch.Size([2755, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.62929105758667  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.62929105758667  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2755, 128]), torch.Size([1, 2755, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6321063041687012  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.8110947608947754  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2755, 128])
m.shape torch.Size([20840, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9086189270019531  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9086189270019531  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 20840, 128]), torch.Size([1, 20840, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9284934997558594  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.339588165283203  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 20840, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.165588855743408  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.233386516571045  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3011841773986816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.2328567504882812  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([71091, 256])
first layer input nodes number: 91686
first layer output nodes number: 71091
edges number: 411017
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3018693923950195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3696670532226562  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3872451782226562  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.3872451782226562  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6629, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7323317527770996  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7323317527770996  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6629, 256]), torch.Size([1, 6629, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.7449755668640137  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.846435070037842  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6629, 256])
m.shape torch.Size([6047, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8517370223999023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8517370223999023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6047, 256]), torch.Size([1, 6047, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 3.8632707595825195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.039072036743164  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6047, 256])
m.shape torch.Size([5010, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.047750949859619  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.047750949859619  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5010, 256]), torch.Size([1, 5010, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.058087348937988  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.274910926818848  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5010, 256])
m.shape torch.Size([4011, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.2855753898620605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.2855753898620605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4011, 256]), torch.Size([1, 4011, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.2937469482421875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.520496845245361  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4011, 256])
m.shape torch.Size([3347, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.532351016998291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.532351016998291  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3347, 256]), torch.Size([1, 3347, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.539006233215332  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.774813652038574  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3347, 256])
m.shape torch.Size([2698, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.786800861358643  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.786800861358643  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2698, 256]), torch.Size([1, 2698, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 4.7923784255981445  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.015028953552246  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2698, 256])
m.shape torch.Size([2314, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.028024673461914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.028024673461914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2314, 256]), torch.Size([1, 2314, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.032625198364258  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.2623138427734375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2314, 256])
m.shape torch.Size([1960, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.275482654571533  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.275482654571533  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1960, 256]), torch.Size([1, 1960, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.279236316680908  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.49689245223999  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1960, 256])
m.shape torch.Size([1664, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.5094170570373535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.5094170570373535  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1664, 256]), torch.Size([1, 1664, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.512943744659424  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.724258899688721  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1664, 256])
m.shape torch.Size([1473, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.73682975769043  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.73682975769043  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1473, 256]), torch.Size([1, 1473, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.739778518676758  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.940601348876953  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1473, 256])
m.shape torch.Size([1234, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.952243328094482  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.952243328094482  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1234, 256]), torch.Size([1, 1234, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.954641342163086  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.146896839141846  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1234, 256])
m.shape torch.Size([1051, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.157740592956543  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.157740592956543  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1051, 256]), torch.Size([1, 1051, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.159824371337891  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.340859889984131  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1051, 256])
m.shape torch.Size([919, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.351058006286621  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.351058006286621  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 919, 256]), torch.Size([1, 919, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.352810859680176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.514073371887207  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 919, 256])
m.shape torch.Size([808, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.524069309234619  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.524069309234619  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 808, 256]), torch.Size([1, 808, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.525610446929932  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.681066989898682  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 808, 256])
m.shape torch.Size([723, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.690720081329346  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.690720081329346  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.692099094390869  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.839929103851318  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 723, 256])
m.shape torch.Size([582, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.848189830780029  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.848189830780029  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.849299907684326  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.9753031730651855  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([554, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.983800411224365  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.983800411224365  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.984857082366943  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.114213466644287  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([467, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.1227126121521  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.1227126121521  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.123603343963623  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.238383769989014  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([404, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.245316028594971  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.245316028594971  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.246086597442627  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.351644992828369  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([406, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.359064102172852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.359064102172852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.359838485717773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.473756790161133  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([347, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.480373382568359  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.480373382568359  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.481035232543945  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.579448699951172  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([279, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.585017204284668  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.585017204284668  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.585549354553223  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.670567512512207  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([253, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.676040172576904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.676040172576904  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.676522731781006  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.754697322845459  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([245, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.760107517242432  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.760107517242432  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.760574817657471  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.839548587799072  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([3075, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.913201808929443  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.913201808929443  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3075, 256]), torch.Size([1, 3075, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.919066905975342  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.952211856842041  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3075, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.657114505767822  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.66481637954712  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.672617435455322  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.664568901062012  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([46500, 40])
input nodes number: 71091
output nodes number: 46500
edges number: 349525
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.666528224945068  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.666529178619385  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08159208297729492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

pseudo mini batch 1 input nodes size: 124023
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06287193298339844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.06287193298339844  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12201070785522461  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.12234210968017578  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.07827615737915039  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08635187149047852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08635187149047852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08635187149047852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([124023, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.08635187149047852  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([9043, 1, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4289536476135254  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4289536476135254  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 9043, 128]), torch.Size([1, 9043, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.4375777244567871  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5075602531433105  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 9043, 128])
m.shape torch.Size([8817, 2, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5116567611694336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5116567611694336  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 8817, 128]), torch.Size([1, 8817, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.5201730728149414  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6508674621582031  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 8817, 128])
m.shape torch.Size([7532, 3, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6583819389343262  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6583819389343262  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 7532, 128]), torch.Size([1, 7532, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.6661777496337891  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8270378112792969  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 7532, 128])
m.shape torch.Size([6420, 4, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8356914520263672  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8356914520263672  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6420, 128]), torch.Size([1, 6420, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.8418807983398438  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0211029052734375  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6420, 128])
m.shape torch.Size([5672, 5, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0317134857177734  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.0317134857177734  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5672, 128]), torch.Size([1, 5672, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.037459373474121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2482271194458008  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5672, 128])
m.shape torch.Size([4802, 6, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.259261131286621  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.259261131286621  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4802, 128]), torch.Size([1, 4802, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.2642555236816406  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.465224266052246  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4802, 128])
m.shape torch.Size([4320, 7, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4770841598510742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.4770841598510742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4320, 128]), torch.Size([1, 4320, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.482203483581543  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.6891965866088867  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4320, 128])
m.shape torch.Size([3885, 8, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7027616500854492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.7027616500854492  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3885, 128]), torch.Size([1, 3885, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.70650053024292  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9207053184509277  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3885, 128])
m.shape torch.Size([3524, 9, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9338741302490234  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.9338741302490234  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3524, 128]), torch.Size([1, 3524, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 1.938786506652832  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.1663293838500977  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3524, 128])
m.shape torch.Size([46393, 10, 128])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3858680725097656  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.3858680725097656  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 46393, 128]), torch.Size([1, 46393, 128])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 2.430111885070801  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.571422576904297  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 46393, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.263654708862305  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.359411239624023  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.455167770385742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.358663082122803  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([100408, 256])
first layer input nodes number: 124023
first layer output nodes number: 100408
edges number: 689091
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.456093788146973  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.551850318908691  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.575789451599121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.575789451599121  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

m.shape torch.Size([6799, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.964156627655029  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.964156627655029  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6799, 256]), torch.Size([1, 6799, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 5.9779372215271  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.081681728363037  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6799, 256])
m.shape torch.Size([5659, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.086075782775879  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.086075782775879  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 5659, 256]), torch.Size([1, 5659, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.098599433898926  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.261369705200195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 5659, 256])
m.shape torch.Size([4267, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.268276691436768  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.268276691436768  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 4267, 256]), torch.Size([1, 4267, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.276789665222168  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.4577460289001465  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 4267, 256])
m.shape torch.Size([3309, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.4659318923950195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.4659318923950195  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 3309, 256]), torch.Size([1, 3309, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.472439765930176  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.65654182434082  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 3309, 256])
m.shape torch.Size([2875, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.667089462280273  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.667089462280273  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2875, 256]), torch.Size([1, 2875, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.673093795776367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.8739542961120605  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2875, 256])
m.shape torch.Size([2170, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.883407115936279  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.883407115936279  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 2170, 256]), torch.Size([1, 2170, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 6.888651371002197  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.072438716888428  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 2170, 256])
m.shape torch.Size([1731, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.082015514373779  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.082015514373779  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1731, 256]), torch.Size([1, 1731, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.085710525512695  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.252725601196289  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1731, 256])
m.shape torch.Size([1512, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.262692928314209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.262692928314209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1512, 256]), torch.Size([1, 1512, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.265594005584717  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.440019130706787  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1512, 256])
m.shape torch.Size([1312, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.449140548706055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.449140548706055  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1312, 256]), torch.Size([1, 1312, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.451658248901367  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.613766670227051  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1312, 256])
m.shape torch.Size([1126, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.623169898986816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.623169898986816  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 1126, 256]), torch.Size([1, 1126, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.625400066375732  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.785562992095947  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 1126, 256])
m.shape torch.Size([969, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.795156478881836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.795156478881836  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.797004699707031  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.941933631896973  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([886, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.951228618621826  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.951228618621826  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 7.952918529510498  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.097165584564209  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([737, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.105529308319092  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.105529308319092  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.106935024261475  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.244053363800049  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([626, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.251773834228516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.251773834228516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.252967834472656  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.375133514404297  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([566, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.382696628570557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.382696628570557  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.383776187896729  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.499731540679932  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([529, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.50732707977295  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.50732707977295  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.508336067199707  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.622445106506348  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([476, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.62971830368042  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.62971830368042  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.630626201629639  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.74065351486206  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([481, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.748521327972412  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.748521327972412  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.749438762664795  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.866237163543701  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([432, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.87366771697998  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.87366771697998  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 432, 256]), torch.Size([1, 432, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.874491691589355  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.985072135925293  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 432, 256])
m.shape torch.Size([401, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.992368698120117  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.992368698120117  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 8.993133544921875  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.101652145385742  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([370, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.10873794555664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.10873794555664  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.109443664550781  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.214929580688477  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([277, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.220434188842773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.220434188842773  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.220962524414062  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.309762954711914  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([266, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.31537914276123  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.31537914276123  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.315886497497559  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes
Using backend: pytorch

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.399226188659668  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([280, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.405431270599365  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.405431270599365  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.405965328216553  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.49744176864624  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([6385, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.650594711303711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.650594711303711  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

 h.shape torch.Size([1, 6385, 256]), torch.Size([1, 6385, 256])
----------------------------------------3
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 9.662773132324219  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.806175231933594  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

rst.shape  torch.Size([1, 6385, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.463237762451172  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.469860076904297  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.476482391357422  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.469528675079346  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

torch.Size([44441, 40])
input nodes number: 100408
output nodes number: 44441
edges number: 394725
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.469528675079346  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 11.469529151916504  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10057926177978516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10057926177978516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.0408935546875 GB
    Memory Allocated: 0.10057926177978516  GigaBytes
Max Memory Allocated: 12.22640323638916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05778694152832031 |0.005302309989929199 |0.1655874252319336 |0.00010943412780761719 |0.1428583860397339 |0.0068128108978271484 |
----------------------------------------------------------pseudo_mini_loss sum 3.3427610397338867
Total (block generation + training)time/epoch 24.41153585910797
Training time/epoch 0.8279387950897217
Training time without block to device /epoch 0.8173341751098633
Training time without total dataloading part /epoch 0.6239233016967773
load block tensor time/epoch 0.11557388305664062
block to device time/epoch 0.010604619979858398
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  387208
Number of first layer input nodes during this epoch:  215709
Number of first layer output nodes during this epoch:  171499
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
