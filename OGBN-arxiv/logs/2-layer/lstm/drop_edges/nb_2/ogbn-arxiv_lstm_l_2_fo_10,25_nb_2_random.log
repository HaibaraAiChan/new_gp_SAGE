main start at this time 1651599962.9174986
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02833104133605957
number of batches is  2
batch size is  45471
random selection method spend 0.006626129150390625
time for parepare:  0.018483877182006836
local_output_nid generation:  0.01605701446533203
local_in_edges_tensor generation:  0.012758016586303711
mini_batch_src_global generation:  0.011435270309448242
r_  generation:  0.15564513206481934
local_output_nid generation:  0.021364212036132812
local_in_edges_tensor generation:  0.013331174850463867
mini_batch_src_global generation:  0.01602935791015625
r_  generation:  0.1643679141998291
----------------------check_connections_block total spend ----------------------------- 0.5001394748687744
generate_one_block  0.17827463150024414
generate_one_block  0.18216609954833984
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.022272586822509766
gen group dst list time:  0.007216930389404297
time for parepare:  0.01903676986694336
local_output_nid generation:  0.023882150650024414
local_in_edges_tensor generation:  0.03711533546447754
mini_batch_src_global generation:  0.02499246597290039
r_  generation:  0.31226468086242676
local_output_nid generation:  0.030301332473754883
local_in_edges_tensor generation:  0.0343780517578125
mini_batch_src_global generation:  0.031534433364868164
r_  generation:  0.31664085388183594
----------------------check_connections_block total spend ----------------------------- 0.9818651676177979
generate_one_block  0.37827634811401367
generate_one_block  0.40322017669677734
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9818651676177979
block generation total time  0.781496524810791
average batch blocks generation time:  0.3907482624053955
pseudo mini batch 0 input nodes size: 156534
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07741880416870117  GigaBytes
Max Memory Allocated: 0.07741880416870117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.0777578353881836  GigaBytes
Max Memory Allocated: 0.0777578353881836  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.0777578353881836  GigaBytes
Max Memory Allocated: 0.0777578353881836  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08712434768676758  GigaBytes
Max Memory Allocated: 0.08712434768676758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08712434768676758  GigaBytes
Max Memory Allocated: 0.08712434768676758  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08712434768676758  GigaBytes
Max Memory Allocated: 0.08712434768676758  GigaBytes

torch.Size([156534, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.08712434768676758  GigaBytes
Max Memory Allocated: 0.08712434768676758  GigaBytes

m.shape torch.Size([10977, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5165905952453613  GigaBytes
Max Memory Allocated: 0.5240840911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5165905952453613  GigaBytes
Max Memory Allocated: 0.5240840911865234  GigaBytes

 h.shape torch.Size([1, 10977, 128]), torch.Size([1, 10977, 128])
----------------------------------------3
 Nvidia-smi: 1.7303466796875 GB
    Memory Allocated: 0.5270590782165527  GigaBytes
Max Memory Allocated: 0.5270590782165527  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6124491691589355  GigaBytes
Max Memory Allocated: 0.6176834106445312  GigaBytes

rst.shape  torch.Size([1, 10977, 128])
m.shape torch.Size([11878, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6185426712036133  GigaBytes
Max Memory Allocated: 0.6188087463378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6185426712036133  GigaBytes
Max Memory Allocated: 0.6188087463378906  GigaBytes

 h.shape torch.Size([1, 11878, 128]), torch.Size([1, 11878, 128])
----------------------------------------3
 Nvidia-smi: 1.8358154296875 GB
    Memory Allocated: 0.6298704147338867  GigaBytes
Max Memory Allocated: 0.6298704147338867  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.804478645324707  GigaBytes
Max Memory Allocated: 0.8158063888549805  GigaBytes

rst.shape  torch.Size([1, 11878, 128])
m.shape torch.Size([10938, 3, 128])
----------------------------------------1
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8144617080688477  GigaBytes
Max Memory Allocated: 0.8158063888549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8144617080688477  GigaBytes
Max Memory Allocated: 0.8158063888549805  GigaBytes

 h.shape torch.Size([1, 10938, 128]), torch.Size([1, 10938, 128])
----------------------------------------3
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8253412246704102  GigaBytes
Max Memory Allocated: 0.8253412246704102  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3026123046875 GB
    Memory Allocated: 1.0604257583618164  GigaBytes
Max Memory Allocated: 1.0760726928710938  GigaBytes

rst.shape  torch.Size([1, 10938, 128])
m.shape torch.Size([9501, 4, 128])
----------------------------------------1
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.0733318328857422  GigaBytes
Max Memory Allocated: 1.0760726928710938  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.0733318328857422  GigaBytes
Max Memory Allocated: 1.0760726928710938  GigaBytes

 h.shape torch.Size([1, 9501, 128]), torch.Size([1, 9501, 128])
----------------------------------------3
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.0830779075622559  GigaBytes
Max Memory Allocated: 1.0830779075622559  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6151123046875 GB
    Memory Allocated: 1.3458428382873535  GigaBytes
Max Memory Allocated: 1.363964557647705  GigaBytes

rst.shape  torch.Size([1, 9501, 128])
m.shape torch.Size([8381, 5, 128])
----------------------------------------1
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3612942695617676  GigaBytes
Max Memory Allocated: 1.363964557647705  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3612942695617676  GigaBytes
Max Memory Allocated: 1.363964557647705  GigaBytes

 h.shape torch.Size([1, 8381, 128]), torch.Size([1, 8381, 128])
----------------------------------------3
 Nvidia-smi: 2.6365966796875 GB
    Memory Allocated: 1.3698210716247559  GigaBytes
Max Memory Allocated: 1.3698210716247559  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9803466796875 GB
    Memory Allocated: 1.657559871673584  GigaBytes
Max Memory Allocated: 1.677541732788086  GigaBytes

rst.shape  torch.Size([1, 8381, 128])
m.shape torch.Size([7117, 6, 128])
----------------------------------------1
 Nvidia-smi: 2.9803466796875 GB
    Memory Allocated: 1.6739253997802734  GigaBytes
Max Memory Allocated: 1.677541732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9803466796875 GB
    Memory Allocated: 1.6739253997802734  GigaBytes
Max Memory Allocated: 1.677541732788086  GigaBytes

 h.shape torch.Size([1, 7117, 128]), torch.Size([1, 7117, 128])
----------------------------------------3
 Nvidia-smi: 2.9803466796875 GB
    Memory Allocated: 1.6809072494506836  GigaBytes
Max Memory Allocated: 1.6809072494506836  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 1.97723388671875  GigaBytes
Max Memory Allocated: 1.9975957870483398  GigaBytes

rst.shape  torch.Size([1, 7117, 128])
m.shape torch.Size([6215, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 1.9953246116638184  GigaBytes
Max Memory Allocated: 1.9975957870483398  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 1.9953246116638184  GigaBytes
Max Memory Allocated: 1.9975957870483398  GigaBytes

 h.shape torch.Size([1, 6215, 128]), torch.Size([1, 6215, 128])
----------------------------------------3
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.00126314163208  GigaBytes
Max Memory Allocated: 2.00126314163208  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.297671318054199  GigaBytes
Max Memory Allocated: 2.319155693054199  GigaBytes

rst.shape  torch.Size([1, 6215, 128])
m.shape torch.Size([5537, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.316192150115967  GigaBytes
Max Memory Allocated: 2.319155693054199  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.316192150115967  GigaBytes
Max Memory Allocated: 2.319155693054199  GigaBytes

 h.shape torch.Size([1, 5537, 128]), torch.Size([1, 5537, 128])
----------------------------------------3
 Nvidia-smi: 3.6170654296875 GB
    Memory Allocated: 2.32179594039917  GigaBytes
Max Memory Allocated: 2.32179594039917  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.9783935546875 GB
    Memory Allocated: 2.62278413772583  GigaBytes
Max Memory Allocated: 2.64426851272583  GigaBytes

rst.shape  torch.Size([1, 5537, 128])
m.shape torch.Size([4872, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.9783935546875 GB
    Memory Allocated: 2.6416282653808594  GigaBytes
Max Memory Allocated: 2.64426851272583  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9783935546875 GB
    Memory Allocated: 2.6416282653808594  GigaBytes
Max Memory Allocated: 2.64426851272583  GigaBytes

 h.shape torch.Size([1, 4872, 128]), torch.Size([1, 4872, 128])
----------------------------------------3
 Nvidia-smi: 3.9783935546875 GB
    Memory Allocated: 2.646564483642578  GigaBytes
Max Memory Allocated: 2.646564483642578  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2928466796875 GB
    Memory Allocated: 2.958987236022949  GigaBytes
Max Memory Allocated: 2.980471611022949  GigaBytes

rst.shape  torch.Size([1, 4872, 128])
m.shape torch.Size([54416, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.5526123046875 GB
    Memory Allocated: 3.2164297103881836  GigaBytes
Max Memory Allocated: 3.2228074073791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5526123046875 GB
    Memory Allocated: 3.2164297103881836  GigaBytes
Max Memory Allocated: 3.2228074073791504  GigaBytes

 h.shape torch.Size([1, 54416, 128]), torch.Size([1, 54416, 128])
----------------------------------------3
 Nvidia-smi: 4.6072998046875 GB
    Memory Allocated: 3.268324851989746  GigaBytes
Max Memory Allocated: 3.268324851989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.952879905700684  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

rst.shape  torch.Size([1, 54416, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.572543144226074  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.6963605880737305  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.820178031921387  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.695393085479736  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

torch.Size([129832, 256])
first layer input nodes number: 156534
first layer output nodes number: 129832
edges number: 865967
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.821499824523926  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.6326904296875 GB
    Memory Allocated: 6.945317268371582  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.976271629333496  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 6.976271629333496  GigaBytes
Max Memory Allocated: 7.212645530700684  GigaBytes

m.shape torch.Size([6840, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.341409206390381  GigaBytes
Max Memory Allocated: 7.341434955596924  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.341409206390381  GigaBytes
Max Memory Allocated: 7.341434955596924  GigaBytes

 h.shape torch.Size([1, 6840, 256]), torch.Size([1, 6840, 256])
----------------------------------------3
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.354455471038818  GigaBytes
Max Memory Allocated: 7.354455471038818  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.458825588226318  GigaBytes
Max Memory Allocated: 7.465348720550537  GigaBytes

rst.shape  torch.Size([1, 6840, 256])
m.shape torch.Size([5778, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.463409423828125  GigaBytes
Max Memory Allocated: 7.465348720550537  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.463409423828125  GigaBytes
Max Memory Allocated: 7.465348720550537  GigaBytes

 h.shape torch.Size([1, 5778, 256]), torch.Size([1, 5778, 256])
----------------------------------------3
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.474665641784668  GigaBytes
Max Memory Allocated: 7.474665641784668  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.640405178070068  GigaBytes
Max Memory Allocated: 7.651425838470459  GigaBytes

rst.shape  torch.Size([1, 5778, 256])
m.shape torch.Size([4625, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.64823055267334  GigaBytes
Max Memory Allocated: 7.651425838470459  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.64823055267334  GigaBytes
Max Memory Allocated: 7.651425838470459  GigaBytes

 h.shape torch.Size([1, 4625, 256]), torch.Size([1, 4625, 256])
----------------------------------------3
 Nvidia-smi: 9.1131591796875 GB
    Memory Allocated: 7.658578872680664  GigaBytes
Max Memory Allocated: 7.658578872680664  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 7.853475093841553  GigaBytes
Max Memory Allocated: 7.867146968841553  GigaBytes

rst.shape  torch.Size([1, 4625, 256])
m.shape torch.Size([3646, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 7.863081455230713  GigaBytes
Max Memory Allocated: 7.867146968841553  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 7.863081455230713  GigaBytes
Max Memory Allocated: 7.867146968841553  GigaBytes

 h.shape torch.Size([1, 3646, 256]), torch.Size([1, 3646, 256])
----------------------------------------3
 Nvidia-smi: 9.3221435546875 GB
    Memory Allocated: 7.870755195617676  GigaBytes
Max Memory Allocated: 7.870755195617676  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5487060546875 GB
    Memory Allocated: 8.073163032531738  GigaBytes
Max Memory Allocated: 8.087071418762207  GigaBytes

rst.shape  torch.Size([1, 3646, 256])
m.shape torch.Size([3049, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.5487060546875 GB
    Memory Allocated: 8.084338665008545  GigaBytes
Max Memory Allocated: 8.087071418762207  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.5487060546875 GB
    Memory Allocated: 8.084338665008545  GigaBytes
Max Memory Allocated: 8.087071418762207  GigaBytes

 h.shape torch.Size([1, 3049, 256]), torch.Size([1, 3049, 256])
----------------------------------------3
 Nvidia-smi: 9.5487060546875 GB
    Memory Allocated: 8.090542793273926  GigaBytes
Max Memory Allocated: 8.090542793273926  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.7752685546875 GB
    Memory Allocated: 8.302487850189209  GigaBytes
Max Memory Allocated: 8.317026615142822  GigaBytes

rst.shape  torch.Size([1, 3049, 256])
m.shape torch.Size([2463, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.7752685546875 GB
    Memory Allocated: 8.313783645629883  GigaBytes
Max Memory Allocated: 8.317026615142822  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7752685546875 GB
    Memory Allocated: 8.313783645629883  GigaBytes
Max Memory Allocated: 8.317026615142822  GigaBytes

 h.shape torch.Size([1, 2463, 256]), torch.Size([1, 2463, 256])
----------------------------------------3
 Nvidia-smi: 9.7752685546875 GB
    Memory Allocated: 8.31882905960083  GigaBytes
Max Memory Allocated: 8.31882905960083  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.9862060546875 GB
    Memory Allocated: 8.530486583709717  GigaBytes
Max Memory Allocated: 8.544579982757568  GigaBytes

rst.shape  torch.Size([1, 2463, 256])
m.shape torch.Size([2044, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.9862060546875 GB
    Memory Allocated: 8.541889667510986  GigaBytes
Max Memory Allocated: 8.544579982757568  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.9862060546875 GB
    Memory Allocated: 8.541889667510986  GigaBytes
Max Memory Allocated: 8.544579982757568  GigaBytes

 h.shape torch.Size([1, 2044, 256]), torch.Size([1, 2044, 256])
----------------------------------------3
 Nvidia-smi: 9.9862060546875 GB
    Memory Allocated: 8.545829772949219  GigaBytes
Max Memory Allocated: 8.545829772949219  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 8.741894721984863  GigaBytes
Max Memory Allocated: 8.755566596984863  GigaBytes

rst.shape  torch.Size([1, 2044, 256])
m.shape torch.Size([1740, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 8.753683090209961  GigaBytes
Max Memory Allocated: 8.755566596984863  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 8.753683090209961  GigaBytes
Max Memory Allocated: 8.755566596984863  GigaBytes

 h.shape torch.Size([1, 1740, 256]), torch.Size([1, 1740, 256])
----------------------------------------3
 Nvidia-smi: 10.2147216796875 GB
    Memory Allocated: 8.757040023803711  GigaBytes
Max Memory Allocated: 8.757040023803711  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.4627685546875 GB
    Memory Allocated: 8.946554183959961  GigaBytes
Max Memory Allocated: 8.960226058959961  GigaBytes

rst.shape  torch.Size([1, 1740, 256])
m.shape torch.Size([1492, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.4627685546875 GB
    Memory Allocated: 8.957869529724121  GigaBytes
Max Memory Allocated: 8.960226058959961  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.4627685546875 GB
    Memory Allocated: 8.957869529724121  GigaBytes
Max Memory Allocated: 8.960226058959961  GigaBytes

 h.shape torch.Size([1, 1492, 256]), torch.Size([1, 1492, 256])
----------------------------------------3
 Nvidia-smi: 10.4627685546875 GB
    Memory Allocated: 8.960903644561768  GigaBytes
Max Memory Allocated: 8.960903644561768  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.153067111968994  GigaBytes
Max Memory Allocated: 9.166738986968994  GigaBytes

rst.shape  torch.Size([1, 1492, 256])
m.shape torch.Size([1330, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.164171695709229  GigaBytes
Max Memory Allocated: 9.166738986968994  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.164171695709229  GigaBytes
Max Memory Allocated: 9.166738986968994  GigaBytes

 h.shape torch.Size([1, 1330, 256]), torch.Size([1, 1330, 256])
----------------------------------------3
 Nvidia-smi: 10.5740966796875 GB
    Memory Allocated: 9.166964054107666  GigaBytes
Max Memory Allocated: 9.166964054107666  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7694091796875 GB
    Memory Allocated: 9.349962711334229  GigaBytes
Max Memory Allocated: 9.362646579742432  GigaBytes

rst.shape  torch.Size([1, 1330, 256])
m.shape torch.Size([1147, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7694091796875 GB
    Memory Allocated: 9.360680103302002  GigaBytes
Max Memory Allocated: 9.362646579742432  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7694091796875 GB
    Memory Allocated: 9.360680103302002  GigaBytes
Max Memory Allocated: 9.362646579742432  GigaBytes

 h.shape torch.Size([1, 1147, 256]), torch.Size([1, 1147, 256])
----------------------------------------3
 Nvidia-smi: 10.7694091796875 GB
    Memory Allocated: 9.36296033859253  GigaBytes
Max Memory Allocated: 9.36296033859253  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 9.535906314849854  GigaBytes
Max Memory Allocated: 9.547938823699951  GigaBytes

rst.shape  torch.Size([1, 1147, 256])
m.shape torch.Size([958, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 9.545546054840088  GigaBytes
Max Memory Allocated: 9.547938823699951  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.9451904296875 GB
    Memory Allocated: 9.545546054840088  GigaBytes
Max Memory Allocated: 9.547938823699951  GigaBytes

 h.shape torch.Size([1, 958, 256]), torch.Size([1, 958, 256])
----------------------------------------3
 Nvidia-smi: 10.9471435546875 GB
    Memory Allocated: 9.547373294830322  GigaBytes
Max Memory Allocated: 9.547938823699951  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 9.71026086807251  GigaBytes
Max Memory Allocated: 9.721224308013916  GigaBytes

rst.shape  torch.Size([1, 958, 256])
m.shape torch.Size([799, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 9.719330787658691  GigaBytes
Max Memory Allocated: 9.721224308013916  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 9.719330787658691  GigaBytes
Max Memory Allocated: 9.721224308013916  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 9.720854759216309  GigaBytes
Max Memory Allocated: 9.721224308013916  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.2342529296875 GB
    Memory Allocated: 9.86108684539795  GigaBytes
Max Memory Allocated: 9.870992660522461  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([688, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.2342529296875 GB
    Memory Allocated: 9.869582653045654  GigaBytes
Max Memory Allocated: 9.870992660522461  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.2342529296875 GB
    Memory Allocated: 9.869582653045654  GigaBytes
Max Memory Allocated: 9.870992660522461  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 11.2362060546875 GB
    Memory Allocated: 9.87089490890503  GigaBytes
Max Memory Allocated: 9.870992660522461  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 10.000808238983154  GigaBytes
Max Memory Allocated: 10.00999402999878  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([663, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 10.009710788726807  GigaBytes
Max Memory Allocated: 10.00999402999878  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 10.009710788726807  GigaBytes
Max Memory Allocated: 10.00999402999878  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 10.010975360870361  GigaBytes
Max Memory Allocated: 10.010975360870361  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5506591796875 GB
    Memory Allocated: 10.145020008087158  GigaBytes
Max Memory Allocated: 10.154504299163818  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([558, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.5506591796875 GB
    Memory Allocated: 10.152968883514404  GigaBytes
Max Memory Allocated: 10.154504299163818  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5506591796875 GB
    Memory Allocated: 10.152968883514404  GigaBytes
Max Memory Allocated: 10.154504299163818  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 11.5506591796875 GB
    Memory Allocated: 10.154033184051514  GigaBytes
Max Memory Allocated: 10.154504299163818  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.6697998046875 GB
    Memory Allocated: 10.278181552886963  GigaBytes
Max Memory Allocated: 10.286695957183838  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([520, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.6697998046875 GB
    Memory Allocated: 10.28614616394043  GigaBytes
Max Memory Allocated: 10.286695957183838  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6697998046875 GB
    Memory Allocated: 10.28614616394043  GigaBytes
Max Memory Allocated: 10.286695957183838  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 11.6717529296875 GB
    Memory Allocated: 10.287137985229492  GigaBytes
Max Memory Allocated: 10.287137985229492  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.7928466796875 GB
    Memory Allocated: 10.407339096069336  GigaBytes
Max Memory Allocated: 10.415769577026367  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([460, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.7928466796875 GB
    Memory Allocated: 10.414801597595215  GigaBytes
Max Memory Allocated: 10.415769577026367  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.7928466796875 GB
    Memory Allocated: 10.414801597595215  GigaBytes
Max Memory Allocated: 10.415769577026367  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 11.7928466796875 GB
    Memory Allocated: 10.415678977966309  GigaBytes
Max Memory Allocated: 10.415769577026367  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8436279296875 GB
    Memory Allocated: 10.530719757080078  GigaBytes
Max Memory Allocated: 10.538616180419922  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([416, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.8436279296875 GB
    Memory Allocated: 10.537878036499023  GigaBytes
Max Memory Allocated: 10.538616180419922  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.8436279296875 GB
    Memory Allocated: 10.537878036499023  GigaBytes
Max Memory Allocated: 10.538616180419922  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 11.8436279296875 GB
    Memory Allocated: 10.538671493530273  GigaBytes
Max Memory Allocated: 10.538671493530273  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9158935546875 GB
    Memory Allocated: 10.649553298950195  GigaBytes
Max Memory Allocated: 10.65709114074707  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([387, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.9158935546875 GB
    Memory Allocated: 10.656595706939697  GigaBytes
Max Memory Allocated: 10.65709114074707  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9158935546875 GB
    Memory Allocated: 10.656595706939697  GigaBytes
Max Memory Allocated: 10.65709114074707  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 11.9158935546875 GB
    Memory Allocated: 10.657333850860596  GigaBytes
Max Memory Allocated: 10.657333850860596  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0311279296875 GB
    Memory Allocated: 10.762888431549072  GigaBytes
Max Memory Allocated: 10.770269870758057  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([349, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.0311279296875 GB
    Memory Allocated: 10.769563674926758  GigaBytes
Max Memory Allocated: 10.770269870758057  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0311279296875 GB
    Memory Allocated: 10.769563674926758  GigaBytes
Max Memory Allocated: 10.770269870758057  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 12.0311279296875 GB
    Memory Allocated: 10.77022933959961  GigaBytes
Max Memory Allocated: 10.770269870758057  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1190185546875 GB
    Memory Allocated: 10.872556686401367  GigaBytes
Max Memory Allocated: 10.879546165466309  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([292, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.1190185546875 GB
    Memory Allocated: 10.878398418426514  GigaBytes
Max Memory Allocated: 10.879546165466309  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1190185546875 GB
    Memory Allocated: 10.878398418426514  GigaBytes
Max Memory Allocated: 10.879546165466309  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 12.1190185546875 GB
    Memory Allocated: 10.878955364227295  GigaBytes
Max Memory Allocated: 10.879546165466309  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1893310546875 GB
    Memory Allocated: 10.96876859664917  GigaBytes
Max Memory Allocated: 10.974895000457764  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([253, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.1893310546875 GB
    Memory Allocated: 10.974082946777344  GigaBytes
Max Memory Allocated: 10.974895000457764  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1893310546875 GB
    Memory Allocated: 10.974082946777344  GigaBytes
Max Memory Allocated: 10.974895000457764  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 12.1893310546875 GB
    Memory Allocated: 10.974565505981445  GigaBytes
Max Memory Allocated: 10.974895000457764  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 11.052740097045898  GigaBytes
Max Memory Allocated: 11.058924674987793  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([268, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 11.05873155593872  GigaBytes
Max Memory Allocated: 11.058924674987793  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.2674560546875 GB
    Memory Allocated: 11.05873155593872  GigaBytes
Max Memory Allocated: 11.058924674987793  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 12.2694091796875 GB
    Memory Allocated: 11.059242725372314  GigaBytes
Max Memory Allocated: 11.059242725372314  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3612060546875 GB
    Memory Allocated: 11.146234512329102  GigaBytes
Max Memory Allocated: 11.152368545532227  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([4706, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.4764404296875 GB
    Memory Allocated: 11.259055614471436  GigaBytes
Max Memory Allocated: 11.259494304656982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4764404296875 GB
    Memory Allocated: 11.259055614471436  GigaBytes
Max Memory Allocated: 11.259494304656982  GigaBytes

 h.shape torch.Size([1, 4706, 256]), torch.Size([1, 4706, 256])
----------------------------------------3
 Nvidia-smi: 12.4764404296875 GB
    Memory Allocated: 11.268031597137451  GigaBytes
Max Memory Allocated: 11.268031597137451  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3084716796875 GB
    Memory Allocated: 12.847804546356201  GigaBytes
Max Memory Allocated: 12.960004329681396  GigaBytes

rst.shape  torch.Size([1, 4706, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.530286312103271  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.537062168121338  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.543838024139404  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.536723136901855  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

torch.Size([45471, 40])
input nodes number: 129832
output nodes number: 45471
edges number: 371257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.544805526733398  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.3533935546875 GB
    Memory Allocated: 12.544806480407715  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.11344528198242188  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

pseudo mini batch 1 input nodes size: 156522
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.0873098373413086  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.0873098373413086  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.16194534301757812  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.16228437423706055  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.08730411529541016  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.09653949737548828  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.09653949737548828  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.09653949737548828  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

torch.Size([156522, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.09653949737548828  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

m.shape torch.Size([10775, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.5271649360656738  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.5271649360656738  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 10775, 128]), torch.Size([1, 10775, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.5374407768249512  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.6224455833435059  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 10775, 128])
m.shape torch.Size([11977, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.6290264129638672  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.6290264129638672  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 11977, 128]), torch.Size([1, 11977, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.6413183212280273  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.8170995712280273  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 11977, 128])
m.shape torch.Size([10878, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.8267168998718262  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.8267168998718262  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 10878, 128]), torch.Size([1, 10878, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 0.8387322425842285  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.0735878944396973  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 10878, 128])
m.shape torch.Size([9545, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.086606502532959  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.086606502532959  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 9545, 128]), torch.Size([1, 9545, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.0963449478149414  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.3603267669677734  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 9545, 128])
m.shape torch.Size([8427, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.3758668899536133  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.3758668899536133  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 8427, 128]), torch.Size([1, 8427, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.3839035034179688  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.6732215881347656  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 8427, 128])
m.shape torch.Size([7092, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.6894936561584473  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.6894936561584473  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 7092, 128]), torch.Size([1, 7092, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.6968579292297363  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 1.9921340942382812  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 7092, 128])
m.shape torch.Size([6309, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.0102367401123047  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.0102367401123047  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 6309, 128]), torch.Size([1, 6309, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.0165348052978516  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.3194942474365234  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 6309, 128])
m.shape torch.Size([5544, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.3373870849609375  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.3373870849609375  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 5544, 128]), torch.Size([1, 5544, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.3427743911743164  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.645141124725342  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 5544, 128])
m.shape torch.Size([4913, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.6639819145202637  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.6639819145202637  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 4913, 128]), torch.Size([1, 4913, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.6687960624694824  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 2.9806113243103027  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 4913, 128])
m.shape torch.Size([54339, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 3.238034248352051  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 3.238034248352051  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 54339, 128]), torch.Size([1, 54339, 128])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 3.28985595703125  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.9691972732543945  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 54339, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.588691711425781  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.712477684020996  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.836263656616211  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.711510181427002  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

torch.Size([129799, 256])
first layer input nodes number: 156522
first layer output nodes number: 129799
edges number: 866352
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.837459564208984  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.961245536804199  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.992192268371582  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 6.992192268371582  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

m.shape torch.Size([6588, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.359025478363037  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.359025478363037  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 6588, 256]), torch.Size([1, 6588, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.371591091156006  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.472115993499756  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 6588, 256])
m.shape torch.Size([5928, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.478115558624268  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.478115558624268  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 5928, 256]), torch.Size([1, 5928, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.489528656005859  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.659130096435547  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 5928, 256])
m.shape torch.Size([4652, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.666890621185303  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.666890621185303  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 4652, 256]), torch.Size([1, 4652, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.6760125160217285  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.873287200927734  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 4652, 256])
m.shape torch.Size([3674, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.8829755783081055  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.8829755783081055  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 3674, 256]), torch.Size([1, 3674, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 7.89049768447876  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.0937180519104  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 3674, 256])
m.shape torch.Size([3173, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.105462551116943  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.105462551116943  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 3173, 256]), torch.Size([1, 3173, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.112069606781006  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.331088542938232  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 3173, 256])
m.shape torch.Size([2405, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.341931819915771  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.341931819915771  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 2405, 256]), torch.Size([1, 2405, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.346911907196045  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.547728538513184  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 2405, 256])
m.shape torch.Size([2001, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.558897495269775  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.558897495269775  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 2001, 256]), torch.Size([1, 2001, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.562838554382324  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.756758213043213  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 2001, 256])
m.shape torch.Size([1732, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.768167495727539  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.768167495727539  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 1732, 256]), torch.Size([1, 1732, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.771669387817383  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.971796035766602  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 1732, 256])
m.shape torch.Size([1484, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.982807636260986  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.982807636260986  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 1484, 256]), torch.Size([1, 1484, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 8.985673427581787  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.171781539916992  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 1484, 256])
m.shape torch.Size([1269, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.18254566192627  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.18254566192627  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 1269, 256]), torch.Size([1, 1269, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.18510627746582  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.361859798431396  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 1269, 256])
m.shape torch.Size([1056, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.371519565582275  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.371519565582275  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 1056, 256]), torch.Size([1, 1056, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.373670101165771  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.54130506515503  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 1056, 256])
m.shape torch.Size([979, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.55109167098999  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.55109167098999  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 979, 256]), torch.Size([1, 979, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.552958965301514  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.717687129974365  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 979, 256])
m.shape torch.Size([857, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.727461814880371  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.727461814880371  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 857, 256]), torch.Size([1, 857, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.729096412658691  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.880715370178223  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 857, 256])
m.shape torch.Size([746, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.889936447143555  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.889936447143555  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 746, 256]), torch.Size([1, 746, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 9.891359329223633  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.034685134887695  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 746, 256])
m.shape torch.Size([626, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.042998790740967  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.042998790740967  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.044192790985107  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.173879146575928  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([553, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.18178653717041  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.18178653717041  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.182841300964355  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.305015563964844  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([510, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.312821388244629  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.312821388244629  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.313794136047363  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.430829048156738  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([488, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.438785552978516  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.438785552978516  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.439716339111328  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.56255054473877  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([420, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.56975507736206  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.56975507736206  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.570556163787842  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.683655261993408  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([420, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.691328525543213  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.691328525543213  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.692129611968994  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.80691385269165  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([368, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.81394100189209  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.81394100189209  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.814642906188965  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.919526100158691  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([264, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.924757480621338  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.924757480621338  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 10.9252610206604  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.006079196929932  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([266, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.011707782745361  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.011707782745361  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.01221513748169  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.095736026763916  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([257, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.101410865783691  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.101410865783691  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.101901054382324  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.188084602355957  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([4754, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.302069664001465  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.302069664001465  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

 h.shape torch.Size([1, 4754, 256]), torch.Size([1, 4754, 256])
----------------------------------------3
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 11.311797142028809  GigaBytes
Max Memory Allocated: 12.973609924316406  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.907683372497559  GigaBytes
Max Memory Allocated: 13.021027565002441  GigaBytes

rst.shape  torch.Size([1, 4754, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.588492393493652  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.595268249511719  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.602044105529785  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.594929218292236  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([45470, 40])
input nodes number: 129799
output nodes number: 45470
edges number: 372993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.596235752105713  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.0740966796875 GB
    Memory Allocated: 12.596236228942871  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11329221725463867  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11884260177612305  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11884260177612305  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0716773271560669 |0.17055737972259521 |0.4639397859573364 |0.00015091896057128906 |0.15968263149261475 |0.005583286285400391 |
----------------------------------------------------------pseudo_mini_loss sum 5.327683448791504
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  572687
Number of first layer input nodes during this epoch:  313056
Number of first layer output nodes during this epoch:  259631
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11884212493896484  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01411890983581543
number of batches is  2
batch size is  45471
random selection method spend 0.005430459976196289
time for parepare:  0.018861055374145508
local_output_nid generation:  0.01678156852722168
local_in_edges_tensor generation:  0.013025999069213867
mini_batch_src_global generation:  0.0111083984375
r_  generation:  0.15494132041931152
local_output_nid generation:  0.021195650100708008
local_in_edges_tensor generation:  0.010331392288208008
mini_batch_src_global generation:  0.01519775390625
r_  generation:  0.16907334327697754
----------------------check_connections_block total spend ----------------------------- 0.507274866104126
generate_one_block  0.19927024841308594
generate_one_block  0.19024324417114258
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.042400360107421875
gen group dst list time:  0.007949113845825195
time for parepare:  0.01960897445678711
local_output_nid generation:  0.024050474166870117
local_in_edges_tensor generation:  0.050836801528930664
mini_batch_src_global generation:  0.025613069534301758
r_  generation:  0.307938814163208
local_output_nid generation:  0.030129671096801758
local_in_edges_tensor generation:  0.036592960357666016
mini_batch_src_global generation:  0.03159070014953613
r_  generation:  0.31914615631103516
----------------------check_connections_block total spend ----------------------------- 0.998335599899292
generate_one_block  0.38431477546691895
generate_one_block  0.39378929138183594
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11884212493896484  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

connection checking time:  0.998335599899292
block generation total time  0.7781040668487549
average batch blocks generation time:  0.38905203342437744
block dataloader generation time/epoch 2.8471779823303223
pseudo mini batch 0 input nodes size: 156583
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09285354614257812  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09285354614257812  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.16751813888549805  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.16785717010498047  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09288263320922852  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10227584838867188  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10227584838867188  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10227584838867188  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([156583, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10227584838867188  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

m.shape torch.Size([10784, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.530519962310791  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.530519962310791  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 10784, 128]), torch.Size([1, 10784, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.540804386138916  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.625826358795166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 10784, 128])
m.shape torch.Size([11989, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6324028968811035  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6324028968811035  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 11989, 128]), torch.Size([1, 11989, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6446962356567383  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8204774856567383  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 11989, 128])
m.shape torch.Size([10803, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8301005363464355  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8301005363464355  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 10803, 128]), torch.Size([1, 10803, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.842104434967041  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.076673984527588  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 10803, 128])
m.shape torch.Size([9487, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.0896177291870117  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.0896177291870117  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 9487, 128]), torch.Size([1, 9487, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.0992927551269531  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3616704940795898  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 9487, 128])
m.shape torch.Size([8395, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.377161979675293  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.377161979675293  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 8395, 128]), torch.Size([1, 8395, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3851680755615234  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6733875274658203  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 8395, 128])
m.shape torch.Size([7077, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6896319389343262  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6896319389343262  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 7077, 128]), torch.Size([1, 7077, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6970572471618652  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.9923758506774902  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 7077, 128])
m.shape torch.Size([6251, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.0104856491088867  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.0104856491088867  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 6251, 128]), torch.Size([1, 6251, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.01686954498291  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3174986839294434  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 6251, 128])
m.shape torch.Size([5529, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3352808952331543  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3352808952331543  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 5529, 128]), torch.Size([1, 5529, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.340623378753662  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6418070793151855  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 5529, 128])
m.shape torch.Size([4884, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6606550216674805  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6606550216674805  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4884, 128]), torch.Size([1, 4884, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.665463447570801  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.9766416549682617  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4884, 128])
m.shape torch.Size([54189, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.232706069946289  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.232706069946289  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 54189, 128]), torch.Size([1, 54189, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.2843847274780273  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.953569412231445  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 54189, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.57531213760376  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.698706150054932  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.8221001625061035  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.697741985321045  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([129388, 256])
first layer input nodes number: 156583
first layer output nodes number: 129388
edges number: 863391
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.823338985443115  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.946732997894287  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.97758150100708  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.97758150100708  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

m.shape torch.Size([6728, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.342250347137451  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.342250347137451  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 6728, 256]), torch.Size([1, 6728, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.355323314666748  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.457984447479248  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 6728, 256])
m.shape torch.Size([5857, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.462827205657959  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.462827205657959  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 5857, 256]), torch.Size([1, 5857, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.474129676818848  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.64169979095459  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 5857, 256])
m.shape torch.Size([4657, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.650291919708252  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.650291919708252  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4657, 256]), torch.Size([1, 4657, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.659445762634277  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.857046127319336  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4657, 256])
m.shape torch.Size([3667, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.866703033447266  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.866703033447266  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 3667, 256]), torch.Size([1, 3667, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.874282360076904  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.077115535736084  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 3667, 256])
m.shape torch.Size([3132, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.088669776916504  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.088669776916504  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 3132, 256]), torch.Size([1, 3132, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.09546947479248  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.311999320983887  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 3132, 256])
m.shape torch.Size([2468, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.32324504852295  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.32324504852295  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 2468, 256]), torch.Size([1, 2468, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.328356742858887  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.54049015045166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 2468, 256])
m.shape torch.Size([2024, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.551753997802734  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.551753997802734  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 2024, 256]), torch.Size([1, 2024, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.555715560913086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.751001834869385  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 2024, 256])
m.shape torch.Size([1717, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.762092590332031  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.762092590332031  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1717, 256]), torch.Size([1, 1717, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.765449523925781  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.95412826538086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1717, 256])
m.shape torch.Size([1457, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.964982509613037  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.964982509613037  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1457, 256]), torch.Size([1, 1457, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.967833042144775  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.152625560760498  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1457, 256])
m.shape torch.Size([1324, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.163883209228516  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.163883209228516  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1324, 256]), torch.Size([1, 1324, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.16660213470459  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.351613521575928  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1324, 256])
m.shape torch.Size([1118, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.361867904663086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.361867904663086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1118, 256]), torch.Size([1, 1118, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.364999771118164  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.547379493713379  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1118, 256])
m.shape torch.Size([951, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.556581974029541  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.556581974029541  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.558395862579346  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.717947483062744  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([795, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.72697401046753  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.72697401046753  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.728490352630615  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.869076251983643  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([735, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.87820816040039  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.87820816040039  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 735, 256]), torch.Size([1, 735, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.879610061645508  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.018718719482422  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 735, 256])
m.shape torch.Size([620, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.026956558227539  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.026956558227539  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 620, 256]), torch.Size([1, 620, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.028139114379883  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.158506393432617  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 620, 256])
m.shape torch.Size([591, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.167003631591797  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.167003631591797  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.168130874633789  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.295608520507812  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([508, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.303345203399658  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.303345203399658  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.304314136505127  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.425875186920166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([480, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.433694839477539  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.433694839477539  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.434610366821289  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.550882339477539  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([408, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.557875633239746  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.557875633239746  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.558653831481934  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.667140007019043  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([393, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.674305438995361  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.674305438995361  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.675055027008057  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.780914783477783  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([372, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.78804874420166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.78804874420166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.788758277893066  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.894646644592285  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([276, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.90012788772583  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.90012788772583  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.900654315948486  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.987552642822266  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([275, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.99336862564087  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.99336862564087  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.993893146514893  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.081672191619873  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([266, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.08754587173462  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.08754587173462  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.088053226470947  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.175516605377197  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([4652, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.287042140960693  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.287042140960693  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4652, 256]), torch.Size([1, 4652, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.295915126800537  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.858066082000732  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4652, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.540649890899658  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.547425746917725  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.554201602935791  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.547086715698242  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([45471, 40])
input nodes number: 129388
output nodes number: 45471
edges number: 370678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.548389911651611  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 12.548390865325928  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.11903142929077148  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

pseudo mini batch 1 input nodes size: 156583
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09288358688354492  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09288358688354492  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.16754817962646484  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.16788721084594727  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.09288358688354492  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10213613510131836  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10213613510131836  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10213613510131836  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([156583, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.10213613510131836  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

m.shape torch.Size([10878, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.5327615737915039  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.5327615737915039  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 10878, 128]), torch.Size([1, 10878, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.5431356430053711  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6283369064331055  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 10878, 128])
m.shape torch.Size([11883, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6348686218261719  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.6348686218261719  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 11883, 128]), torch.Size([1, 11883, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.647066593170166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.822847843170166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 11883, 128])
m.shape torch.Size([10841, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8324203491210938  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8324203491210938  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 10841, 128]), torch.Size([1, 10841, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8445253372192383  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.079239845275879  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 10841, 128])
m.shape torch.Size([9453, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.0921006202697754  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.0921006202697754  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 9453, 128]), torch.Size([1, 9453, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.1017775535583496  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3632149696350098  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 9453, 128])
m.shape torch.Size([8428, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3788013458251953  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3788013458251953  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 8428, 128]), torch.Size([1, 8428, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.3868389129638672  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6761913299560547  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 8428, 128])
m.shape torch.Size([7104, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6924972534179688  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6924972534179688  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 7104, 128]), torch.Size([1, 7104, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.699859619140625  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.9951839447021484  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 7104, 128])
m.shape torch.Size([6264, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.0132808685302734  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.0132808685302734  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 6264, 128]), torch.Size([1, 6264, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.0196657180786133  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.320828437805176  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 6264, 128])
m.shape torch.Size([5527, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3386354446411133  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3386354446411133  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 5527, 128]), torch.Size([1, 5527, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.3440427780151367  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.644991397857666  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 5527, 128])
m.shape torch.Size([4901, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6638402938842773  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6638402938842773  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4901, 128]), torch.Size([1, 4901, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.6687355041503906  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 2.9801993370056152  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4901, 128])
m.shape torch.Size([54620, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.2383108139038086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.2383108139038086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 54620, 128]), torch.Size([1, 54620, 128])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 3.290400505065918  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.988768577575684  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 54620, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.608177661895752  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.732059001922607  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.855940341949463  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.731091022491455  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

torch.Size([129899, 256])
first layer input nodes number: 156583
first layer output nodes number: 129899
edges number: 868116
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.857231616973877  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 6.981112957000732  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.012083530426025  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.012083530426025  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

m.shape torch.Size([6700, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.379665374755859  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.379665374755859  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 6700, 256]), torch.Size([1, 6700, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.392444610595703  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.494678497314453  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 6700, 256])
m.shape torch.Size([5849, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.499532222747803  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.499532222747803  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 5849, 256]), torch.Size([1, 5849, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.510776519775391  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.678311347961426  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 5849, 256])
m.shape torch.Size([4620, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.686054706573486  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.686054706573486  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4620, 256]), torch.Size([1, 4620, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.6955060958862305  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.890504837036133  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4620, 256])
m.shape torch.Size([3653, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.900143146514893  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.900143146514893  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 3653, 256]), torch.Size([1, 3653, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 7.9076457023620605  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.109704494476318  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 3653, 256])
m.shape torch.Size([3090, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.121070384979248  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.121070384979248  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 3090, 256]), torch.Size([1, 3090, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.127132415771484  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.341163635253906  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 3090, 256])
m.shape torch.Size([2400, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.352056980133057  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.352056980133057  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 2400, 256]), torch.Size([1, 2400, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.357256412506104  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.557912826538086  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 2400, 256])
m.shape torch.Size([2021, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.568585395812988  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.568585395812988  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 2021, 256]), torch.Size([1, 2021, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.572627544403076  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.768730640411377  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 2021, 256])
m.shape torch.Size([1755, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.780297756195068  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.780297756195068  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1755, 256]), torch.Size([1, 1755, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.783746242523193  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.975533962249756  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1755, 256])
m.shape torch.Size([1519, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.986934185028076  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.986934185028076  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1519, 256]), torch.Size([1, 1519, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 8.989936351776123  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.18129587173462  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1519, 256])
m.shape torch.Size([1275, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.192047595977783  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.192047595977783  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1275, 256]), torch.Size([1, 1275, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.194489002227783  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.369060039520264  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1275, 256])
m.shape torch.Size([1085, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.379241943359375  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.379241943359375  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 1085, 256]), torch.Size([1, 1085, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.381402492523193  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.548565864562988  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 1085, 256])
m.shape torch.Size([986, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.55863904953003  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.55863904953003  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 986, 256]), torch.Size([1, 986, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.560519695281982  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.726047992706299  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 986, 256])
m.shape torch.Size([861, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.735865592956543  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.735865592956543  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.737507820129395  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.888592720031738  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([699, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.89717721939087  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.89717721939087  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 699, 256]), torch.Size([1, 699, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.898510456085205  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.038668155670166  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 699, 256])
m.shape torch.Size([669, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.047646522521973  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.047646522521973  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.048922538757324  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.18418025970459  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([520, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.19153881072998  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.19153881072998  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.192530632019043  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.306209564208984  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([522, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.314242839813232  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.314242839813232  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.31523847579956  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.434714794158936  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([468, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.44231367111206  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.44231367111206  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.443206310272217  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.558315753936768  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([428, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.565685749053955  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.565685749053955  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.566502094268799  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.67737627029419  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([414, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.684926509857178  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.684926509857178  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.685716152191162  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.79957628250122  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([345, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.806145191192627  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.806145191192627  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.806803226470947  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.907493114471436  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([280, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.913084983825684  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.913084983825684  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 10.913619041442871  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.001999855041504  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([244, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.007126808166504  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.007126808166504  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.00759220123291  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.082985877990723  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([259, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.088727951049805  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.088727951049805  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.089221954345703  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7947998046875 GB
    Memory Allocated: 11.175298690795898  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([4808, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.290579319000244  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.290579319000244  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

 h.shape torch.Size([1, 4808, 256]), torch.Size([1, 4808, 256])
----------------------------------------3
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.299749851226807  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.913763523101807  GigaBytes
Max Memory Allocated: 13.033440113067627  GigaBytes

rst.shape  torch.Size([1, 4808, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.594648361206055  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.601424217224121  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.608200073242188  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.601085186004639  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([45470, 40])
input nodes number: 129899
output nodes number: 45470
edges number: 373572
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.602392196655273  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 12.602392673492432  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.11931133270263672  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.11931133270263672  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.11931133270263672  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07752645015716553 |0.00653076171875 |0.18677175045013428 |0.00010466575622558594 |0.15923559665679932 |0.004509449005126953 |
----------------------------------------------------------pseudo_mini_loss sum 4.154278755187988
Total (block generation + training)time/epoch 3.7668914794921875
Training time/epoch 0.9191970825195312
Training time without block to device /epoch 0.9061355590820312
Training time without total dataloading part /epoch 0.6967334747314453
load block tensor time/epoch 0.15505290031433105
block to device time/epoch 0.0130615234375
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  572453
Number of first layer input nodes during this epoch:  313166
Number of first layer output nodes during this epoch:  259287
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.11931085586547852  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.024900197982788086
number of batches is  2
batch size is  45471
random selection method spend 0.005372047424316406
time for parepare:  0.019151926040649414
local_output_nid generation:  0.015722274780273438
local_in_edges_tensor generation:  0.012993574142456055
mini_batch_src_global generation:  0.011406660079956055
r_  generation:  0.1512010097503662
local_output_nid generation:  0.021595478057861328
local_in_edges_tensor generation:  0.010526657104492188
mini_batch_src_global generation:  0.015418529510498047
r_  generation:  0.16823816299438477
----------------------check_connections_block total spend ----------------------------- 0.4987635612487793
generate_one_block  0.18399643898010254
generate_one_block  0.18713974952697754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02202892303466797
gen group dst list time:  0.007668495178222656
time for parepare:  0.019289016723632812
local_output_nid generation:  0.023934364318847656
local_in_edges_tensor generation:  0.030146121978759766
mini_batch_src_global generation:  0.02531123161315918
r_  generation:  0.3095669746398926
local_output_nid generation:  0.030364990234375
local_in_edges_tensor generation:  0.028696775436401367
mini_batch_src_global generation:  0.03664898872375488
r_  generation:  0.31829023361206055
----------------------check_connections_block total spend ----------------------------- 0.9749412536621094
generate_one_block  0.39008116722106934
generate_one_block  0.42046594619750977
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.11931085586547852  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

connection checking time:  0.9749412536621094
block generation total time  0.8105471134185791
average batch blocks generation time:  0.40527355670928955
block dataloader generation time/epoch 2.818855404853821
pseudo mini batch 0 input nodes size: 156411
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.09288263320922852  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.09288263320922852  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.1674652099609375  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.16780424118041992  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.09280061721801758  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.1022191047668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.1022191047668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.1022191047668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([156411, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.1022191047668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

m.shape torch.Size([10774, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.53192138671875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.53192138671875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 10774, 128]), torch.Size([1, 10774, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.5421962738037109  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.6271991729736328  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 10774, 128])
m.shape torch.Size([11893, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.6337804794311523  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.6337804794311523  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 11893, 128]), torch.Size([1, 11893, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.6460328102111816  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.8218140602111816  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 11893, 128])
m.shape torch.Size([10895, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.8313913345336914  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.8313913345336914  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 10895, 128]), torch.Size([1, 10895, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 0.8434867858886719  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.0784072875976562  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 10895, 128])
m.shape torch.Size([9415, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.091169834136963  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.091169834136963  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 9415, 128]), torch.Size([1, 9415, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.1008543968200684  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.3612408638000488  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 9415, 128])
m.shape torch.Size([8387, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.3767476081848145  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.3767476081848145  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 8387, 128]), torch.Size([1, 8387, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.3847460746765137  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.6726908683776855  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 8387, 128])
m.shape torch.Size([7073, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.6889276504516602  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.6889276504516602  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 7073, 128]), torch.Size([1, 7073, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.6963682174682617  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 1.9916963577270508  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 7073, 128])
m.shape torch.Size([6197, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.00980806350708  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.00980806350708  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 6197, 128]), torch.Size([1, 6197, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.016268253326416  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.3151350021362305  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 6197, 128])
m.shape torch.Size([5530, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.3336644172668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.3336644172668457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 5530, 128]), torch.Size([1, 5530, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.339144229888916  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.6409268379211426  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 5530, 128])
m.shape torch.Size([4914, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.6597743034362793  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.6597743034362793  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4914, 128]), torch.Size([1, 4914, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.6646552085876465  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 2.975821018218994  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4914, 128])
m.shape torch.Size([54420, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 3.233243465423584  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 3.233243465423584  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 54420, 128]), torch.Size([1, 54420, 128])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 3.2856526374816895  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.970478534698486  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 54420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.591239929199219  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.714738845825195  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.838237762451172  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.713773727416992  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([129498, 256])
first layer input nodes number: 156411
first layer output nodes number: 129498
edges number: 865323
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.8394880294799805  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.962986946105957  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.993861675262451  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 6.993861675262451  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

m.shape torch.Size([6699, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.358502388000488  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.358502388000488  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 6699, 256]), torch.Size([1, 6699, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.371279716491699  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.473498344421387  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 6699, 256])
m.shape torch.Size([5799, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.478257179260254  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.478257179260254  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 5799, 256]), torch.Size([1, 5799, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.4894585609436035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.655369281768799  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 5799, 256])
m.shape torch.Size([4668, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.663990497589111  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.663990497589111  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4668, 256]), torch.Size([1, 4668, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.673453330993652  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.870016098022461  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4668, 256])
m.shape torch.Size([3672, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.879681587219238  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.879681587219238  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 3672, 256]), torch.Size([1, 3672, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 7.887182712554932  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.09029245376587  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 3672, 256])
m.shape torch.Size([3140, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.101880550384521  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.101880550384521  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 3140, 256]), torch.Size([1, 3140, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.108787059783936  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.32595682144165  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 3140, 256])
m.shape torch.Size([2468, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.338045597076416  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.338045597076416  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 2468, 256]), torch.Size([1, 2468, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.343103885650635  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.555025100708008  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 2468, 256])
m.shape torch.Size([2061, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.56640911102295  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.56640911102295  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 2061, 256]), torch.Size([1, 2061, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.570452690124512  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.768744468688965  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 2061, 256])
m.shape torch.Size([1795, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.780580997467041  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.780580997467041  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1795, 256]), torch.Size([1, 1795, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.784029483795166  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 8.989067554473877  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1795, 256])
m.shape torch.Size([1502, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.000208377838135  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.000208377838135  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1502, 256]), torch.Size([1, 1502, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.003096103668213  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.19074535369873  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1502, 256])
m.shape torch.Size([1304, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.20169734954834  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.20169734954834  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1304, 256]), torch.Size([1, 1304, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.204354286193848  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.384363174438477  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1304, 256])
m.shape torch.Size([1030, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.393858909606934  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.393858909606934  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1030, 256]), torch.Size([1, 1030, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.396027565002441  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.571341514587402  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1030, 256])
m.shape torch.Size([975, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.580915927886963  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.580915927886963  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.582775592803955  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.74690866470337  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([844, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.756524562835693  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.756524562835693  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 844, 256]), torch.Size([1, 844, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.758134365081787  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.907517910003662  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 844, 256])
m.shape torch.Size([709, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.916253566741943  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.916253566741943  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 9.917605876922607  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.054479122161865  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([635, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.062957763671875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.062957763671875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 635, 256]), torch.Size([1, 635, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.064168930053711  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.194127082824707  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 635, 256])
m.shape torch.Size([548, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.201948642730713  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.201948642730713  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.202993869781494  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.326330661773682  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([505, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.334059715270996  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.334059715270996  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.335022926330566  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.451759338378906  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([462, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.459270477294922  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.459270477294922  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 462, 256]), torch.Size([1, 462, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.460151672363281  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.574667930603027  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 462, 256])
m.shape torch.Size([418, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.581861019134521  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.581861019134521  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.582658290863037  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.692860126495361  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([408, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.700304508209229  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.700304508209229  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.701082706451416  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.815004825592041  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([369, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.82206392288208  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.82206392288208  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.822767734527588  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.926960468292236  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([283, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.932592868804932  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.932592868804932  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 10.933132648468018  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.018554210662842  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([241, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.023612022399902  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.023612022399902  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.02407169342041  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.098538398742676  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([245, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.103960037231445  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.103960037231445  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 15.7987060546875 GB
    Memory Allocated: 11.104427337646484  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8651123046875 GB
    Memory Allocated: 11.183401107788086  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([4691, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 11.295883655548096  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 11.295883655548096  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4691, 256]), torch.Size([1, 4691, 256])
----------------------------------------3
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 11.30483102798462  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.879568576812744  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4691, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.562713623046875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.569489479064941  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.576265335083008  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.569150447845459  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([45471, 40])
input nodes number: 129498
output nodes number: 45471
edges number: 370739
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.570454597473145  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.8670654296875 GB
    Memory Allocated: 12.570455551147461  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.11956310272216797  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

pseudo mini batch 1 input nodes size: 156572
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.09280157089233398  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.09280157089233398  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.16746091842651367  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.1677999496459961  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.09287834167480469  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.10213088989257812  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.10213088989257812  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.10213088989257812  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([156572, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.10213088989257812  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

m.shape torch.Size([10854, 1, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.5327577590942383  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.5327577590942383  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 10854, 128]), torch.Size([1, 10854, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.5431089401245117  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.6282644271850586  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 10854, 128])
m.shape torch.Size([11842, 2, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.6348075866699219  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.6348075866699219  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 11842, 128]), torch.Size([1, 11842, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.6469974517822266  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.8227787017822266  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 11842, 128])
m.shape torch.Size([10874, 3, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.832331657409668  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.832331657409668  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 10874, 128]), torch.Size([1, 10874, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.8444757461547852  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.0793161392211914  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 10874, 128])
m.shape torch.Size([9487, 4, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.0922260284423828  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.0922260284423828  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 9487, 128]), torch.Size([1, 9487, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.1019349098205566  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.3643126487731934  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 9487, 128])
m.shape torch.Size([8413, 5, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.3798470497131348  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.3798470497131348  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 8413, 128]), torch.Size([1, 8413, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.3878703117370605  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.6767077445983887  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 8413, 128])
m.shape torch.Size([7139, 6, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.6931209564208984  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.6931209564208984  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 7139, 128]), torch.Size([1, 7139, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.7005119323730469  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 1.9960365295410156  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 7139, 128])
m.shape torch.Size([6197, 7, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.0141167640686035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.0141167640686035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 6197, 128]), torch.Size([1, 6197, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.0204834938049316  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.318979263305664  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 6197, 128])
m.shape torch.Size([5560, 8, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.336658477783203  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.336658477783203  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 5560, 128]), torch.Size([1, 5560, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.342000961303711  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.6454286575317383  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 5560, 128])
m.shape torch.Size([4897, 9, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.664261817932129  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.664261817932129  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4897, 128]), torch.Size([1, 4897, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.668999671936035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 2.979665756225586  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4897, 128])
m.shape torch.Size([54616, 10, 128])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 3.237760066986084  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 3.237760066986084  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 54616, 128]), torch.Size([1, 54616, 128])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 3.2898459434509277  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.987943172454834  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 54616, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.606801986694336  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.730664253234863  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.854526519775391  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.729696273803711  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

torch.Size([129879, 256])
first layer input nodes number: 156572
first layer output nodes number: 129879
edges number: 868099
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.855825424194336  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 6.979687690734863  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.010653495788574  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.010653495788574  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

m.shape torch.Size([6729, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.378026008605957  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.378026008605957  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 6729, 256]), torch.Size([1, 6729, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.3910346031188965  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.493710994720459  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 6729, 256])
m.shape torch.Size([5907, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.499423027038574  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.499423027038574  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 5907, 256]), torch.Size([1, 5907, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.510703086853027  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.68035364151001  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 5907, 256])
m.shape torch.Size([4609, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.688779830932617  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.688779830932617  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4609, 256]), torch.Size([1, 4609, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.698209285736084  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.894104480743408  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4609, 256])
m.shape torch.Size([3648, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.903739929199219  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.903739929199219  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 3648, 256]), torch.Size([1, 3648, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 7.911230564117432  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.113012790679932  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 3648, 256])
m.shape torch.Size([3082, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.124344825744629  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.124344825744629  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 3082, 256]), torch.Size([1, 3082, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.130492210388184  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.34388542175293  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 3082, 256])
m.shape torch.Size([2400, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.354786396026611  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.354786396026611  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 2400, 256]), torch.Size([1, 2400, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.359392642974854  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.559098720550537  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 2400, 256])
m.shape torch.Size([1984, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.570158004760742  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.570158004760742  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1984, 256]), torch.Size([1, 1984, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.573975086212158  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.76829195022583  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1984, 256])
m.shape torch.Size([1677, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.779050350189209  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.779050350189209  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1677, 256]), torch.Size([1, 1677, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.782399654388428  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.971986293792725  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1677, 256])
m.shape torch.Size([1474, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.983367443084717  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.983367443084717  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1474, 256]), torch.Size([1, 1474, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 8.986239910125732  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.16768503189087  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1474, 256])
m.shape torch.Size([1295, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.178600311279297  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.178600311279297  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1295, 256]), torch.Size([1, 1295, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.181132316589355  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.358492851257324  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1295, 256])
m.shape torch.Size([1173, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.369597434997559  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.369597434997559  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 1173, 256]), torch.Size([1, 1173, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.371965408325195  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.552072525024414  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 1173, 256])
m.shape torch.Size([962, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.561867237091064  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.561867237091064  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 962, 256]), torch.Size([1, 962, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.56370210647583  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.721840381622314  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 962, 256])
m.shape torch.Size([812, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.73106861114502  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.73106861114502  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.732617378234863  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.880780220031738  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([725, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.889761447906494  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.889761447906494  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 725, 256]), torch.Size([1, 725, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 9.891144275665283  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.029804706573486  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 725, 256])
m.shape torch.Size([654, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.0385422706604  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.0385422706604  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.03978967666626  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.17463731765747  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([563, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.182671546936035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.182671546936035  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.183745384216309  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.306129455566406  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([525, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.314170837402344  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.314170837402344  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 525, 256]), torch.Size([1, 525, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.31517219543457  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.436487197875977  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 525, 256])
m.shape torch.Size([486, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.444394588470459  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.444394588470459  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.445321559906006  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.563111782073975  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([418, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.570281982421875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.570281982421875  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.57107925415039  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.68038558959961  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([399, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.687656879425049  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.687656879425049  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.688417911529541  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.796703815460205  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([348, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.80334758758545  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.80334758758545  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.804011344909668  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.906353950500488  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([273, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.911794662475586  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.911794662475586  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 10.912315368652344  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.000029563903809  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([278, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.006851196289062  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.006851196289062  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.007381439208984  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.094608306884766  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([280, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.100801944732666  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.100801944732666  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.101336002349854  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.19323205947876  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([4769, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.307555198669434  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.307555198669434  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

 h.shape torch.Size([1, 4769, 256]), torch.Size([1, 4769, 256])
----------------------------------------3
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 11.316651344299316  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.917572975158691  GigaBytes
Max Memory Allocated: 13.039468765258789  GigaBytes

rst.shape  torch.Size([1, 4769, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.598443508148193  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.60521936416626  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.611995220184326  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.604880332946777  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

torch.Size([45470, 40])
input nodes number: 129879
output nodes number: 45470
edges number: 373511
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.606187343597412  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 12.60618782043457  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.11904430389404297  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.11904430389404297  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.8690185546875 GB
    Memory Allocated: 0.11904430389404297  GigaBytes
Max Memory Allocated: 13.043313980102539  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07065951824188232 |0.005727529525756836 |0.19176018238067627 |9.870529174804688e-05 |0.1407332420349121 |0.005907297134399414 |
----------------------------------------------------------pseudo_mini_loss sum 3.022437572479248
Total (block generation + training)time/epoch 3.7378079891204834
Training time/epoch 0.9180068969726562
Training time without block to device /epoch 0.9065518379211426
Training time without total dataloading part /epoch 0.6710915565490723
load block tensor time/epoch 0.14131903648376465
block to device time/epoch 0.011455059051513672
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  572360
Number of first layer input nodes during this epoch:  312983
Number of first layer output nodes during this epoch:  259377
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)Using backend: pytorch

total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
