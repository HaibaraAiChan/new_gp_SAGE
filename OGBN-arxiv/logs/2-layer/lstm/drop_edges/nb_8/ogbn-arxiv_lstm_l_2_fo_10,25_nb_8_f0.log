[05:06:33] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 8 parts and get 0 edge cuts
main start at this time 1651554378.9407396
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028972387313842773
global_2_local spend time (sec) 0.034960269927978516
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004701852798461914
A = g.adjacency_matrix() spent  0.0072917938232421875
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08618617057800293
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2956409454345703
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1945514678955078

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.001 seconds
Metis partitioning: 0.043 seconds
Split the graph: 0.025 seconds
Construct subgraphs: 0.027 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.09690093994140625
11366
11368
11368
11368
11367
11368
11368
11368
total k batches seeds list generation spend  10.025285959243774
after graph partition
graph partition algorithm spend time 10.132476806640625
11366
11368
11368
11368
11367
11368
11368
11368
partition_len_list
[63281, 62921, 62510, 62786, 63129, 63016, 62916, 62798]
shared_neighbor_graph_partition_s0 selection method  spend 10.212126970291138
time for parepare:  0.016037464141845703
local_output_nid generation:  0.0015752315521240234
local_in_edges_tensor generation:  0.0019736289978027344
mini_batch_src_global generation:  0.003102540969848633
r_  generation:  0.030144453048706055
local_output_nid generation:  0.0022094249725341797
local_in_edges_tensor generation:  0.0020439624786376953
mini_batch_src_global generation:  0.0035881996154785156
r_  generation:  0.03133964538574219
local_output_nid generation:  0.0024900436401367188
local_in_edges_tensor generation:  0.002056121826171875
mini_batch_src_global generation:  0.002421855926513672
r_  generation:  0.03165864944458008
local_output_nid generation:  0.002541065216064453
local_in_edges_tensor generation:  0.002039670944213867
mini_batch_src_global generation:  0.0024542808532714844
r_  generation:  0.032920122146606445
local_output_nid generation:  0.002556324005126953
local_in_edges_tensor generation:  0.002046346664428711
mini_batch_src_global generation:  0.0026655197143554688
r_  generation:  0.0338742733001709
local_output_nid generation:  0.0025482177734375
local_in_edges_tensor generation:  0.002045869827270508
mini_batch_src_global generation:  0.0028314590454101562
r_  generation:  0.03446602821350098
local_output_nid generation:  0.002611398696899414
local_in_edges_tensor generation:  0.0021152496337890625
mini_batch_src_global generation:  0.0028057098388671875
r_  generation:  0.03400683403015137
local_output_nid generation:  0.0025665760040283203
local_in_edges_tensor generation:  0.0020127296447753906
mini_batch_src_global generation:  0.0030028820037841797
r_  generation:  0.0341646671295166
----------------------check_connections_block total spend ----------------------------- 0.4009394645690918
generate_one_block  0.05361461639404297
generate_one_block  0.052277326583862305
generate_one_block  0.05191969871520996
generate_one_block  0.049652099609375
generate_one_block  0.05021381378173828
generate_one_block  0.049782752990722656
generate_one_block  0.0481724739074707
generate_one_block  0.053340911865234375
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.025969266891479492
gen group dst list time:  0.013951301574707031
time for parepare:  0.01889181137084961
local_output_nid generation:  0.013008594512939453
local_in_edges_tensor generation:  0.018841266632080078
mini_batch_src_global generation:  0.01555180549621582
r_  generation:  0.17824888229370117
local_output_nid generation:  0.016574859619140625
local_in_edges_tensor generation:  0.019255399703979492
mini_batch_src_global generation:  0.01797342300415039
r_  generation:  0.17327427864074707
local_output_nid generation:  0.015616416931152344
local_in_edges_tensor generation:  0.01583099365234375
mini_batch_src_global generation:  0.017084598541259766
r_  generation:  0.17656970024108887
local_output_nid generation:  0.01586174964904785
local_in_edges_tensor generation:  0.016173124313354492
mini_batch_src_global generation:  0.018422603607177734
r_  generation:  0.17555594444274902
local_output_nid generation:  0.01591801643371582
local_in_edges_tensor generation:  0.014835357666015625
mini_batch_src_global generation:  0.0205538272857666
r_  generation:  0.18741130828857422
local_output_nid generation:  0.015858173370361328
local_in_edges_tensor generation:  0.014548540115356445
mini_batch_src_global generation:  0.0198519229888916
r_  generation:  0.17931652069091797
local_output_nid generation:  0.01573038101196289
local_in_edges_tensor generation:  0.01719212532043457
mini_batch_src_global generation:  0.019962072372436523
r_  generation:  0.18038558959960938
local_output_nid generation:  0.015423297882080078
local_in_edges_tensor generation:  0.014189004898071289
mini_batch_src_global generation:  0.019721269607543945
r_  generation:  0.17843008041381836
----------------------check_connections_block total spend ----------------------------- 2.1742684841156006
generate_one_block  0.21744275093078613
generate_one_block  0.21911025047302246
generate_one_block  0.21620559692382812
generate_one_block  0.212752103805542
generate_one_block  0.21633148193359375
generate_one_block  0.21623826026916504
generate_one_block  0.23487234115600586
generate_one_block  0.22762465476989746
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.1742684841156006
block generation total time  1.7605774402618408
average batch blocks generation time:  0.2200721800327301
pseudo mini batch 0 input nodes size: 122965
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.06141185760498047  GigaBytes
Max Memory Allocated: 0.06141185760498047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.061496734619140625  GigaBytes
Max Memory Allocated: 0.061496734619140625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0799560546875 GB
    Memory Allocated: 0.061496734619140625  GigaBytes
Max Memory Allocated: 0.061496734619140625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06586503982543945  GigaBytes
Max Memory Allocated: 0.06586503982543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06586503982543945  GigaBytes
Max Memory Allocated: 0.06586503982543945  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06586503982543945  GigaBytes
Max Memory Allocated: 0.06586503982543945  GigaBytes

torch.Size([122965, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06586503982543945  GigaBytes
Max Memory Allocated: 0.06586503982543945  GigaBytes

m.shape torch.Size([3175, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2980632781982422  GigaBytes
Max Memory Allocated: 0.3036684989929199  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.2980632781982422  GigaBytes
Max Memory Allocated: 0.3036684989929199  GigaBytes

 h.shape torch.Size([1, 3175, 128]), torch.Size([1, 3175, 128])
----------------------------------------3
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.30109119415283203  GigaBytes
Max Memory Allocated: 0.3036684989929199  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.3253145217895508  GigaBytes
Max Memory Allocated: 0.32770872116088867  GigaBytes

rst.shape  torch.Size([1, 3175, 128])
m.shape torch.Size([4002, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.32819223403930664  GigaBytes
Max Memory Allocated: 0.32828235626220703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5213623046875 GB
    Memory Allocated: 0.32819223403930664  GigaBytes
Max Memory Allocated: 0.32828235626220703  GigaBytes

 h.shape torch.Size([1, 4002, 128]), torch.Size([1, 4002, 128])
----------------------------------------3
 Nvidia-smi: 1.5408935546875 GB
    Memory Allocated: 0.33249473571777344  GigaBytes
Max Memory Allocated: 0.33249473571777344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39108848571777344  GigaBytes
Max Memory Allocated: 0.39490509033203125  GigaBytes

rst.shape  torch.Size([1, 4002, 128])
m.shape torch.Size([3997, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39444971084594727  GigaBytes
Max Memory Allocated: 0.39490509033203125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39444971084594727  GigaBytes
Max Memory Allocated: 0.39490509033203125  GigaBytes

 h.shape torch.Size([1, 3997, 128]), torch.Size([1, 3997, 128])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.398712158203125  GigaBytes
Max Memory Allocated: 0.398712158203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.48445844650268555  GigaBytes
Max Memory Allocated: 0.4901762008666992  GigaBytes

rst.shape  torch.Size([1, 3997, 128])
m.shape torch.Size([3986, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.4896831512451172  GigaBytes
Max Memory Allocated: 0.4901762008666992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.4896831512451172  GigaBytes
Max Memory Allocated: 0.4901762008666992  GigaBytes

 h.shape torch.Size([1, 3986, 128]), torch.Size([1, 3986, 128])
----------------------------------------3
 Nvidia-smi: 1.6971435546875 GB
    Memory Allocated: 0.49443912506103516  GigaBytes
Max Memory Allocated: 0.49443912506103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6073007583618164  GigaBytes
Max Memory Allocated: 0.614903450012207  GigaBytes

rst.shape  torch.Size([1, 3986, 128])
m.shape torch.Size([3736, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.614903450012207  GigaBytes
Max Memory Allocated: 0.6151123046875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.614903450012207  GigaBytes
Max Memory Allocated: 0.6151123046875  GigaBytes

 h.shape torch.Size([1, 3736, 128]), torch.Size([1, 3736, 128])
----------------------------------------3
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6192293167114258  GigaBytes
Max Memory Allocated: 0.6192293167114258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7482576370239258  GigaBytes
Max Memory Allocated: 0.7571649551391602  GigaBytes

rst.shape  torch.Size([1, 3736, 128])
m.shape torch.Size([3311, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7559490203857422  GigaBytes
Max Memory Allocated: 0.7571649551391602  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7559490203857422  GigaBytes
Max Memory Allocated: 0.7571649551391602  GigaBytes

 h.shape torch.Size([1, 3311, 128]), torch.Size([1, 3311, 128])
----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7593822479248047  GigaBytes
Max Memory Allocated: 0.7593822479248047  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9003753662109375  GigaBytes
Max Memory Allocated: 0.9098482131958008  GigaBytes

rst.shape  torch.Size([1, 3311, 128])
m.shape torch.Size([3073, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9098482131958008  GigaBytes
Max Memory Allocated: 0.9100894927978516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9098482131958008  GigaBytes
Max Memory Allocated: 0.9100894927978516  GigaBytes

 h.shape torch.Size([1, 3073, 128]), torch.Size([1, 3073, 128])
----------------------------------------3
 Nvidia-smi: 2.1072998046875 GB
    Memory Allocated: 0.9128274917602539  GigaBytes
Max Memory Allocated: 0.9128274917602539  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.0641422271728516  GigaBytes
Max Memory Allocated: 1.074399471282959  GigaBytes

rst.shape  torch.Size([1, 3073, 128])
m.shape torch.Size([2728, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.072601318359375  GigaBytes
Max Memory Allocated: 1.074399471282959  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.072601318359375  GigaBytes
Max Memory Allocated: 1.074399471282959  GigaBytes

 h.shape torch.Size([1, 2728, 128]), torch.Size([1, 2728, 128])
----------------------------------------3
 Nvidia-smi: 2.2830810546875 GB
    Memory Allocated: 1.0757532119750977  GigaBytes
Max Memory Allocated: 1.0757532119750977  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2241525650024414  GigaBytes
Max Memory Allocated: 1.2345590591430664  GigaBytes

rst.shape  torch.Size([1, 2728, 128])
m.shape torch.Size([2552, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2345590591430664  GigaBytes
Max Memory Allocated: 1.234816074371338  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2345590591430664  GigaBytes
Max Memory Allocated: 1.234816074371338  GigaBytes

 h.shape torch.Size([1, 2552, 128]), torch.Size([1, 2552, 128])
----------------------------------------3
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2371797561645508  GigaBytes
Max Memory Allocated: 1.2371797561645508  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.3936395645141602  GigaBytes
Max Memory Allocated: 1.4053583145141602  GigaBytes

rst.shape  torch.Size([1, 2552, 128])
m.shape torch.Size([32721, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5486116409301758  GigaBytes
Max Memory Allocated: 1.5523276329040527  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7557373046875 GB
    Memory Allocated: 1.5486116409301758  GigaBytes
Max Memory Allocated: 1.5523276329040527  GigaBytes

 h.shape torch.Size([1, 32721, 128]), torch.Size([1, 32721, 128])
----------------------------------------3
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5798616409301758  GigaBytes
Max Memory Allocated: 1.5798616409301758  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.798611640930176  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

rst.shape  torch.Size([1, 32721, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.58675479888916  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.647104263305664  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.707453727722168  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.646632671356201  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

torch.Size([63281, 256])
first layer input nodes number: 122965
first layer output nodes number: 63281
edges number: 471173
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.708372116088867  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.768721580505371  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.784346580505371  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1619873046875 GB
    Memory Allocated: 3.784346580505371  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

m.shape torch.Size([1711, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.8771214485168457  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.8771214485168457  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

 h.shape torch.Size([1, 1711, 256]), torch.Size([1, 1711, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.8809356689453125  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.9088096618652344  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

rst.shape  torch.Size([1, 1711, 256])
m.shape torch.Size([1461, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.910463333129883  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.910463333129883  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

 h.shape torch.Size([1, 1461, 256]), torch.Size([1, 1461, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.913442611694336  GigaBytes
Max Memory Allocated: 3.954861640930176  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.9563426971435547  GigaBytes
Max Memory Allocated: 3.9591293334960938  GigaBytes

rst.shape  torch.Size([1, 1461, 256])
m.shape torch.Size([1117, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.9581704139709473  GigaBytes
Max Memory Allocated: 3.9591293334960938  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.9581704139709473  GigaBytes
Max Memory Allocated: 3.9591293334960938  GigaBytes

 h.shape torch.Size([1, 1117, 256]), torch.Size([1, 1117, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 3.960603713989258  GigaBytes
Max Memory Allocated: 3.960603713989258  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.0094895362854  GigaBytes
Max Memory Allocated: 4.012685298919678  GigaBytes

rst.shape  torch.Size([1, 1117, 256])
m.shape torch.Size([899, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.012712478637695  GigaBytes
Max Memory Allocated: 4.012726306915283  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.012712478637695  GigaBytes
Max Memory Allocated: 4.012726306915283  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 5.2537841796875 GB
    Memory Allocated: 4.014427185058594  GigaBytes
Max Memory Allocated: 4.014427185058594  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2635498046875 GB
    Memory Allocated: 4.064153671264648  GigaBytes
Max Memory Allocated: 4.067583084106445  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([759, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2635498046875 GB
    Memory Allocated: 4.066944122314453  GigaBytes
Max Memory Allocated: 4.067583084106445  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2635498046875 GB
    Memory Allocated: 4.066944122314453  GigaBytes
Max Memory Allocated: 4.067583084106445  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 5.2655029296875 GB
    Memory Allocated: 4.068391799926758  GigaBytes
Max Memory Allocated: 4.068391799926758  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 4.120757579803467  GigaBytes
Max Memory Allocated: 4.1243767738342285  GigaBytes

rst.shape  torch.Size([1, 759, 256])
m.shape torch.Size([573, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 4.123338222503662  GigaBytes
Max Memory Allocated: 4.1243767738342285  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 4.123338222503662  GigaBytes
Max Memory Allocated: 4.1243767738342285  GigaBytes

 h.shape torch.Size([1, 573, 256]), torch.Size([1, 573, 256])
----------------------------------------3
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 4.124431133270264  GigaBytes
Max Memory Allocated: 4.124431133270264  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 4.171668529510498  GigaBytes
Max Memory Allocated: 4.174947261810303  GigaBytes

rst.shape  torch.Size([1, 573, 256])
m.shape torch.Size([566, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 4.174930095672607  GigaBytes
Max Memory Allocated: 4.174947261810303  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3826904296875 GB
    Memory Allocated: 4.174930095672607  GigaBytes
Max Memory Allocated: 4.174947261810303  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 5.3846435546875 GB
    Memory Allocated: 4.176009654998779  GigaBytes
Max Memory Allocated: 4.176009654998779  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.230618953704834  GigaBytes
Max Memory Allocated: 4.235036373138428  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([426, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.2333550453186035  GigaBytes
Max Memory Allocated: 4.235036373138428  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.2333550453186035  GigaBytes
Max Memory Allocated: 4.235036373138428  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 5.4334716796875 GB
    Memory Allocated: 4.234167575836182  GigaBytes
Max Memory Allocated: 4.235036373138428  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4979248046875 GB
    Memory Allocated: 4.2809319496154785  GigaBytes
Max Memory Allocated: 4.284182071685791  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([374, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4979248046875 GB
    Memory Allocated: 4.283761024475098  GigaBytes
Max Memory Allocated: 4.284182071685791  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4979248046875 GB
    Memory Allocated: 4.283761024475098  GigaBytes
Max Memory Allocated: 4.284182071685791  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 5.4979248046875 GB
    Memory Allocated: 4.2844743728637695  GigaBytes
Max Memory Allocated: 4.2844743728637695  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.330985069274902  GigaBytes
Max Memory Allocated: 4.334195137023926  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([317, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.333675384521484  GigaBytes
Max Memory Allocated: 4.334195137023926  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.333675384521484  GigaBytes
Max Memory Allocated: 4.334195137023926  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.334280014038086  GigaBytes
Max Memory Allocated: 4.334280014038086  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.377744674682617  GigaBytes
Max Memory Allocated: 4.380767822265625  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([249, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.380074977874756  GigaBytes
Max Memory Allocated: 4.380767822265625  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.380074977874756  GigaBytes
Max Memory Allocated: 4.380767822265625  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 5.5877685546875 GB
    Memory Allocated: 4.380549907684326  GigaBytes
Max Memory Allocated: 4.380767822265625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6248779296875 GB
    Memory Allocated: 4.4175944328308105  GigaBytes
Max Memory Allocated: 4.420206546783447  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([233, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.6248779296875 GB
    Memory Allocated: 4.420044422149658  GigaBytes
Max Memory Allocated: 4.420206546783447  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6248779296875 GB
    Memory Allocated: 4.420044422149658  GigaBytes
Max Memory Allocated: 4.420206546783447  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 5.6248779296875 GB
    Memory Allocated: 4.4204888343811035  GigaBytes
Max Memory Allocated: 4.4204888343811035  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6658935546875 GB
    Memory Allocated: 4.458263874053955  GigaBytes
Max Memory Allocated: 4.460930347442627  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([221, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6658935546875 GB
    Memory Allocated: 4.460803031921387  GigaBytes
Max Memory Allocated: 4.460930347442627  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6658935546875 GB
    Memory Allocated: 4.460803031921387  GigaBytes
Max Memory Allocated: 4.460930347442627  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 5.6658935546875 GB
    Memory Allocated: 4.461224555969238  GigaBytes
Max Memory Allocated: 4.461224555969238  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7069091796875 GB
    Memory Allocated: 4.500004768371582  GigaBytes
Max Memory Allocated: 4.502744674682617  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([183, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.7069091796875 GB
    Memory Allocated: 4.502256870269775  GigaBytes
Max Memory Allocated: 4.502744674682617  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7069091796875 GB
    Memory Allocated: 4.502256870269775  GigaBytes
Max Memory Allocated: 4.502744674682617  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 5.7069091796875 GB
    Memory Allocated: 4.50260591506958  GigaBytes
Max Memory Allocated: 4.502744674682617  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7479248046875 GB
    Memory Allocated: 4.537161350250244  GigaBytes
Max Memory Allocated: 4.539604663848877  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([180, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.7479248046875 GB
    Memory Allocated: 4.539582252502441  GigaBytes
Max Memory Allocated: 4.539604663848877  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7479248046875 GB
    Memory Allocated: 4.539582252502441  GigaBytes
Max Memory Allocated: 4.539604663848877  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.7479248046875 GB
    Memory Allocated: 4.539925575256348  GigaBytes
Max Memory Allocated: 4.539925575256348  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.57631778717041  GigaBytes
Max Memory Allocated: 4.579184532165527  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([121, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.578007221221924  GigaBytes
Max Memory Allocated: 4.579184532165527  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.578007221221924  GigaBytes
Max Memory Allocated: 4.579184532165527  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.7908935546875 GB
    Memory Allocated: 4.578238010406494  GigaBytes
Max Memory Allocated: 4.579184532165527  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8201904296875 GB
    Memory Allocated: 4.6043171882629395  GigaBytes
Max Memory Allocated: 4.606163501739502  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([149, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.8201904296875 GB
    Memory Allocated: 4.6066365242004395  GigaBytes
Max Memory Allocated: 4.6066460609436035  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8201904296875 GB
    Memory Allocated: 4.6066365242004395  GigaBytes
Max Memory Allocated: 4.6066460609436035  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 5.8221435546875 GB
    Memory Allocated: 4.6069207191467285  GigaBytes
Max Memory Allocated: 4.6069207191467285  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8572998046875 GB
    Memory Allocated: 4.641024112701416  GigaBytes
Max Memory Allocated: 4.643439769744873  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([123, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.8572998046875 GB
    Memory Allocated: 4.643010139465332  GigaBytes
Max Memory Allocated: 4.643439769744873  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8572998046875 GB
    Memory Allocated: 4.643010139465332  GigaBytes
Max Memory Allocated: 4.643439769744873  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 5.8572998046875 GB
    Memory Allocated: 4.643244743347168  GigaBytes
Max Memory Allocated: 4.643439769744873  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.673039436340332  GigaBytes
Max Memory Allocated: 4.6751508712768555  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([96, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.674675464630127  GigaBytes
Max Memory Allocated: 4.6751508712768555  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.674675464630127  GigaBytes
Max Memory Allocated: 4.6751508712768555  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 5.8885498046875 GB
    Memory Allocated: 4.674858570098877  GigaBytes
Max Memory Allocated: 4.6751508712768555  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9100341796875 GB
    Memory Allocated: 4.699394702911377  GigaBytes
Max Memory Allocated: 4.701134204864502  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.9100341796875 GB
    Memory Allocated: 4.701417922973633  GigaBytes
Max Memory Allocated: 4.7014265060424805  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9100341796875 GB
    Memory Allocated: 4.701417922973633  GigaBytes
Max Memory Allocated: 4.7014265060424805  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.9100341796875 GB
    Memory Allocated: 4.701627731323242  GigaBytes
Max Memory Allocated: 4.701627731323242  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.731210708618164  GigaBytes
Max Memory Allocated: 4.733308792114258  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.732700347900391  GigaBytes
Max Memory Allocated: 4.733308792114258  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.732700347900391  GigaBytes
Max Memory Allocated: 4.733308792114258  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.732851028442383  GigaBytes
Max Memory Allocated: 4.733308792114258  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9627685546875 GB
    Memory Allocated: 4.755151748657227  GigaBytes
Max Memory Allocated: 4.7567338943481445  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([70, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.9627685546875 GB
    Memory Allocated: 4.756556987762451  GigaBytes
Max Memory Allocated: 4.7567338943481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9627685546875 GB
    Memory Allocated: 4.756556987762451  GigaBytes
Max Memory Allocated: 4.7567338943481445  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 5.9627685546875 GB
    Memory Allocated: 4.756690502166748  GigaBytes
Max Memory Allocated: 4.7567338943481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9822998046875 GB
    Memory Allocated: 4.777385234832764  GigaBytes
Max Memory Allocated: 4.778853893280029  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([55, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9822998046875 GB
    Memory Allocated: 4.778534412384033  GigaBytes
Max Memory Allocated: 4.778853893280029  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9822998046875 GB
    Memory Allocated: 4.778534412384033  GigaBytes
Max Memory Allocated: 4.778853893280029  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 5.9822998046875 GB
    Memory Allocated: 4.778639316558838  GigaBytes
Max Memory Allocated: 4.778853893280029  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9979248046875 GB
    Memory Allocated: 4.795633792877197  GigaBytes
Max Memory Allocated: 4.796840190887451  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.9979248046875 GB
    Memory Allocated: 4.796965599060059  GigaBytes
Max Memory Allocated: 4.796971321105957  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9979248046875 GB
    Memory Allocated: 4.796965599060059  GigaBytes
Max Memory Allocated: 4.796971321105957  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 5.9979248046875 GB
    Memory Allocated: 4.797080039978027  GigaBytes
Max Memory Allocated: 4.797080039978027  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0155029296875 GB
    Memory Allocated: 4.816420555114746  GigaBytes
Max Memory Allocated: 4.817793846130371  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1234, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 4.846014499664307  GigaBytes
Max Memory Allocated: 4.846129894256592  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 4.846014499664307  GigaBytes
Max Memory Allocated: 4.846129894256592  GigaBytes

 h.shape torch.Size([1, 1234, 256]), torch.Size([1, 1234, 256])
----------------------------------------3
 Nvidia-smi: 6.0467529296875 GB
    Memory Allocated: 4.849020481109619  GigaBytes
Max Memory Allocated: 4.849020481109619  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5076904296875 GB
    Memory Allocated: 5.279487133026123  GigaBytes
Max Memory Allocated: 5.308907985687256  GigaBytes

rst.shape  torch.Size([1, 1234, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.198573112487793  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.200451850891113  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.202145576477051  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.20018196105957  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

torch.Size([11366, 40])
input nodes number: 63281
output nodes number: 11366
edges number: 93850
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.202432155609131  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.5194091796875 GB
    Memory Allocated: 5.202433109283447  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07783937454223633  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

pseudo mini batch 1 input nodes size: 122998
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596660614013672  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596660614013672  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12461662292480469  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12470149993896484  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06598234176635742  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07040166854858398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07040166854858398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07040166854858398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

torch.Size([122998, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07040166854858398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

m.shape torch.Size([3109, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3017616271972656  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3017616271972656  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3109, 128]), torch.Size([1, 3109, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.30472660064697266  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3284463882446289  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3109, 128])
m.shape torch.Size([3956, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3312702178955078  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3312702178955078  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3956, 128]), torch.Size([1, 3956, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.33557653427124023  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3946871757507324  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3956, 128])
m.shape torch.Size([4107, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.39845991134643555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.39845991134643555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 4107, 128]), torch.Size([1, 4107, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.402376651763916  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.4885749816894531  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 4107, 128])
m.shape torch.Size([3909, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.49440813064575195  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.49440813064575195  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3909, 128]), torch.Size([1, 3909, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.49818849563598633  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6108822822570801  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3909, 128])
m.shape torch.Size([3678, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6177873611450195  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6177873611450195  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3678, 128]), torch.Size([1, 3678, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6214051246643066  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7479186058044434  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3678, 128])
m.shape torch.Size([3285, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7553238868713379  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7553238868713379  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3285, 128]), torch.Size([1, 3285, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7585129737854004  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.8995180130004883  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3285, 128])
m.shape torch.Size([3053, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.9074077606201172  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.9074077606201172  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 3053, 128]), torch.Size([1, 3053, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.9111642837524414  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0622549057006836  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 3053, 128])
m.shape torch.Size([2809, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0724453926086426  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0724453926086426  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 2809, 128]), torch.Size([1, 2809, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0751609802246094  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.234154224395752  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 2809, 128])
m.shape torch.Size([2540, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.242936134338379  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.242936134338379  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 2540, 128]), torch.Size([1, 2540, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.2463421821594238  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.40264892578125  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 2540, 128])
m.shape torch.Size([32475, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.556290626525879  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.556290626525879  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 32475, 128]), torch.Size([1, 32475, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.5872611999511719  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8023786544799805  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 32475, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.5916991233825684  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.651705265045166  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.7117114067077637  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.651236057281494  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

torch.Size([62921, 256])
first layer input nodes number: 122998
first layer output nodes number: 62921
edges number: 468531
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.712629795074463  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.7726359367370605  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.787637710571289  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.787637710571289  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

m.shape torch.Size([1623, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8803696632385254  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8803696632385254  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 1623, 256]), torch.Size([1, 1623, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8839874267578125  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9112110137939453  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 1623, 256])
m.shape torch.Size([1455, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.911642551422119  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.911642551422119  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 1455, 256]), torch.Size([1, 1455, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.914522171020508  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9571399688720703  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 1455, 256])
m.shape torch.Size([1124, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.959718704223633  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.959718704223633  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 1124, 256]), torch.Size([1, 1124, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9621195793151855  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.010896682739258  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 1124, 256])
m.shape torch.Size([929, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.013898849487305  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.013898849487305  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 929, 256]), torch.Size([1, 929, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.0156707763671875  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.073081970214844  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 929, 256])
m.shape torch.Size([779, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.076271057128906  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.076271057128906  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 779, 256]), torch.Size([1, 779, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.077756881713867  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.13197135925293  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 779, 256])
m.shape torch.Size([649, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.1349711418151855  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.1349711418151855  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.136209011077881  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.189437389373779  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([491, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.192121982574463  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.192121982574463  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 491, 256]), torch.Size([1, 491, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.193058490753174  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.242610931396484  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 491, 256])
m.shape torch.Size([444, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.245556831359863  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.245556831359863  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.246403694152832  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.296483039855957  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([363, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.299200057983398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.299200057983398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.299892425537109  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.344605445861816  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([345, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.3475751876831055  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.3475751876831055  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.348233222961426  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.395058631896973  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.397457599639893  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.397457599639893  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.397949695587158  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.437981128692627  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([234, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.440433979034424  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.440433979034424  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.440880298614502  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.478817462921143  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([192, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.480993270874023  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.480993270874023  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.481359481811523  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.515050888061523  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([175, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.517222881317139  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.517222881317139  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.517556667327881  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.550601482391357  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([147, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.552554130554199  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.552554130554199  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.552834510803223  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.582554817199707  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([158, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.584844589233398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.584844589233398  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.585145950317383  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.619199752807617  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([127, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.621124267578125  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.621124267578125  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.621366500854492  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.650434494018555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([134, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.652631759643555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.652631759643555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.652887344360352  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.685346603393555  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([124, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.687483310699463  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.687483310699463  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.687719821929932  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.719412326812744  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([125, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.7216973304748535  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.7216973304748535  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.721935749053955  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.755552768707275  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.75710916519165  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.75710916519165  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.757267475128174  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.780697345733643  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([74, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.7821831703186035  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.7821831703186035  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.782324314117432  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.804201602935791  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.805811405181885  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.805811405181885  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.8059563636779785  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.829439640045166  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([82, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.831258773803711  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.831258773803711  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.831415176391602  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.857847213745117  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([1177, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.886050224304199  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.886050224304199  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.889121055603027  GigaBytes
Max Memory Allocated: 5.311103820800781  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.29281759262085  GigaBytes
Max Memory Allocated: 5.3208794593811035  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.211407661437988  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.2138471603393555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.215541362762451  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.213016986846924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62921
output nodes number: 11368
edges number: 94380
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.213571548461914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.213572025299072  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07775259017944336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 2 input nodes size: 122954
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06598281860351562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06598281860351562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12461185455322266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12469673156738281  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596183776855469  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122954, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.07029294967651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3166, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.2991909980773926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.2991909980773926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3166, 128]), torch.Size([1, 3166, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.30221033096313477  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.32729625701904297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3166, 128])
m.shape torch.Size([3996, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.32959747314453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.32959747314453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3996, 128]), torch.Size([1, 3996, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.3349189758300781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.39322662353515625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3996, 128])
m.shape torch.Size([4083, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.39716196060180664  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.39716196060180664  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4083, 128]), torch.Size([1, 4083, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.4013543128967285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.4873995780944824  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4083, 128])
m.shape torch.Size([3883, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.4932403564453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.4932403564453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3883, 128]), torch.Size([1, 3883, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.49714231491088867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6096940040588379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3883, 128])
m.shape torch.Size([3656, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6165590286254883  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6165590286254883  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3656, 128]), torch.Size([1, 3656, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.6210746765136719  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7469482421875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3656, 128])
m.shape torch.Size([3273, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7545690536499023  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7545690536499023  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3273, 128]), torch.Size([1, 3273, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.7579259872436523  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.8990569114685059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3273, 128])
m.shape torch.Size([3008, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.907536506652832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.907536506652832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3008, 128]), torch.Size([1, 3008, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.910606861114502  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0620489120483398  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3008, 128])
m.shape torch.Size([2785, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0720891952514648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0720891952514648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2785, 128]), torch.Size([1, 2785, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.0747451782226562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.2336511611938477  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2785, 128])
m.shape torch.Size([2557, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.2432966232299805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.2432966232299805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2557, 128]), torch.Size([1, 2557, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.2459349632263184  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.4021849632263184  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2557, 128])
m.shape torch.Size([32103, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.5540218353271484  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.5540218353271484  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32103, 128]), torch.Size([1, 32103, 128])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 1.5846376419067383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.758359909057617  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32103, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.550323486328125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.6099376678466797  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.6695518493652344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.6094717979431152  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62510, 256])
first layer input nodes number: 122954
first layer output nodes number: 62510
edges number: 464236
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.6704702377319336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.7300844192504883  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.744987964630127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.744987964630127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1630, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8351316452026367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8351316452026367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1630, 256]), torch.Size([1, 1630, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.83872652053833  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.86440372467041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1630, 256])
m.shape torch.Size([1475, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8664307594299316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8664307594299316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1475, 256]), torch.Size([1, 1475, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.8693079948425293  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9118242263793945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1475, 256])
m.shape torch.Size([1169, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.914663791656494  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.914663791656494  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9171504974365234  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9676003456115723  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([950, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9701790809631348  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9701790809631348  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 950, 256]), torch.Size([1, 950, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 3.9719910621643066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.031731128692627  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 950, 256])
m.shape torch.Size([756, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.035077095031738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.035077095031738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 756, 256]), torch.Size([1, 756, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.0365190505981445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.088814735412598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 756, 256])
m.shape torch.Size([626, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.09170389175415  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.09170389175415  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.092897891998291  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.145094394683838  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([517, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.147975921630859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.147975921630859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.148962020874023  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.198266983032227  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([469, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.201380252838135  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.201380252838135  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.202274799346924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.253622531890869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([384, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.256496906280518  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.256496906280518  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.257229328155518  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.306168079376221  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([340, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.309070110321045  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.309070110321045  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 340, 256]), torch.Size([1, 340, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.309718608856201  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.356667518615723  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 340, 256])
m.shape torch.Size([273, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.359229564666748  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.359229564666748  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.359750270843506  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.406158924102783  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([276, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.409081935882568  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.409081935882568  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.409608364105225  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.455594539642334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([209, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.457942962646484  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.457942962646484  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.458341598510742  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.495016098022461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([198, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.497481346130371  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.497481346130371  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.497859001159668  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.535246849060059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.537379264831543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.537379264831543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.537686347961426  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.570237159729004  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([124, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.571990489959717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.571990489959717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.5722270011901855  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.598952770233154  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.600893497467041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.600893497467041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.601133823394775  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.6299729347229  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([99, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.631565570831299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.631565570831299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.631754398345947  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.655735492706299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.657467365264893  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.657467365264893  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.657658100128174  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.683216571807861  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.684716701507568  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.684716701507568  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.684875011444092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.7071967124938965  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.708712100982666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.708712100982666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.708862781524658  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.731163501739502  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.73275899887085  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.73275899887085  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.732909679412842  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.756265163421631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.757665157318115  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.757665157318115  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.757777690887451  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.776008129119873  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.777036190032959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.777036190032959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.777125835418701  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.792275905609131  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([1139, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.819599151611328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.819599151611328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1139, 256]), torch.Size([1, 1139, 256])
----------------------------------------3
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 4.8226728439331055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.207479953765869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1139, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.129344940185547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.131039142608643  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.132733345031738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.130954265594482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62510
output nodes number: 11368
edges number: 91694
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.131505012512207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 5.131505489349365  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.0775613784790039  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 3 input nodes size: 122951
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596183776855469  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596183776855469  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12458944320678711  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.12467432022094727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.06596040725708008  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.0705251693725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.0705251693725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.0705251693725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122951, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.7030029296875 GB
    Memory Allocated: 0.0705251693725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3227, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30076122283935547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30076122283935547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3227, 128]), torch.Size([1, 3227, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30383872985839844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3284587860107422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3227, 128])
m.shape torch.Size([3993, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33072805404663086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33072805404663086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3993, 128]), torch.Size([1, 3993, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3354988098144531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3937978744506836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3993, 128])
m.shape torch.Size([3960, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39760589599609375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39760589599609375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3960, 128]), torch.Size([1, 3960, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4013824462890625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4875164031982422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3960, 128])
m.shape torch.Size([3846, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4931812286376953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4931812286376953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3846, 128]), torch.Size([1, 3846, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4968690872192383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6105937957763672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3846, 128])
m.shape torch.Size([3714, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.61761474609375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.61761474609375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3714, 128]), torch.Size([1, 3714, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6212196350097656  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7488307952880859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3714, 128])
m.shape torch.Size([3291, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7564754486083984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7564754486083984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3291, 128]), torch.Size([1, 3291, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7600021362304688  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.900515079498291  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3291, 128])
m.shape torch.Size([2996, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9082460403442383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9082460403442383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2996, 128]), torch.Size([1, 2996, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9111604690551758  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0625271797180176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2996, 128])
m.shape torch.Size([2816, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0709967613220215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0709967613220215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2816, 128]), torch.Size([1, 2816, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0746121406555176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2339367866516113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2816, 128])
m.shape torch.Size([2569, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2436189651489258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2436189651489258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2569, 128]), torch.Size([1, 2569, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2461867332458496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.4029860496520996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2569, 128])
m.shape torch.Size([32374, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5561323165893555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5561323165893555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32374, 128]), torch.Size([1, 32374, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5870065689086914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8008718490600586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32374, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5897035598754883  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.649580955505371  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.709458351135254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6491127014160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62786, 256])
first layer input nodes number: 122951
first layer output nodes number: 62786
edges number: 467154
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.710376739501953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.770254135131836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7852234840393066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7852234840393066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1699, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8767476081848145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8767476081848145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1699, 256]), torch.Size([1, 1699, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.880514621734619  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9071779251098633  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1699, 256])
m.shape torch.Size([1482, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9084067344665527  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9084067344665527  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1482, 256]), torch.Size([1, 1482, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.911374092102051  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9560303688049316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1482, 256])
m.shape torch.Size([1180, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.958737850189209  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.958737850189209  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1180, 256]), torch.Size([1, 1180, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.961050510406494  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.011934280395508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1180, 256])
m.shape torch.Size([904, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.014395236968994  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.014395236968994  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 904, 256]), torch.Size([1, 904, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.016119480133057  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0738701820373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 904, 256])
m.shape torch.Size([783, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.077131748199463  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.077131748199463  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.078625202178955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1324849128723145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([583, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.135100364685059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.135100364685059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.136212348937988  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1850481033325195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([461, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.188479900360107  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.188479900360107  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 461, 256]), torch.Size([1, 461, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.189359188079834  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.233775615692139  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 461, 256])
m.shape torch.Size([418, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.237065315246582  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.237065315246582  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.237862586975098  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.283848762512207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([376, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.286702632904053  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.286702632904053  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.28741979598999  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.335378170013428  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([312, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.338018417358398  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.338018417358398  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.338613510131836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.382291793823242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([289, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.385049819946289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.385049819946289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.385601043701172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.428625106811523  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([239, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.431106090545654  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.431106090545654  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4315619468688965  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.470309734344482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([228, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.472930908203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.472930908203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.473365783691406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.513374328613281  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([182, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.515605926513672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.515605926513672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.515953063964844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.550319671630859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([170, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5525970458984375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5525970458984375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.552921295166016  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.587291717529297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([156, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.589528560638428  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.589528560638428  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5898261070251465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.623448848724365  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.625522613525391  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.625522613525391  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.625782012939453  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.656909942626953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6586833000183105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6586833000183105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.65889310836792  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6855387687683105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.687132358551025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.687132358551025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.687309741973877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.711079120635986  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.712951183319092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.712951183319092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.713145732879639  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.740577220916748  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.74235725402832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.74235725402832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.742534637451172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.768787384033203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.770071029663086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.770071029663086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.770193099975586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.789113998413086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.790803909301758  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.790803909301758  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7909393310546875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.812877655029297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.814517021179199  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.814517021179199  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.814658164978027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8385114669799805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1163, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.866753101348877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.866753101348877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1163, 256]), torch.Size([1, 1163, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.868971347808838  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.2701497077941895  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1163, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.190910816192627  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.193129062652588  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.194823265075684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.1925201416015625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62786
output nodes number: 11368
edges number: 92856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.193073272705078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.193073749542236  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07795190811157227  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 4 input nodes size: 123067
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06596040725708008  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06596040725708008  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12464332580566406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12472820281982422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06601572036743164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07032632827758789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07032632827758789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07032632827758789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123067, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07032632827758789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3233, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30123186111450195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30123186111450195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3233, 128]), torch.Size([1, 3233, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30431509017944336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33072805404663086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3233, 128])
m.shape torch.Size([4005, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33226966857910156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33226966857910156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4005, 128]), torch.Size([1, 4005, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33628034591674805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39461374282836914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4005, 128])
m.shape torch.Size([4139, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39862489700317383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39862489700317383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4139, 128]), torch.Size([1, 4139, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4026637077331543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4895033836364746  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4139, 128])
m.shape torch.Size([3895, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49526023864746094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49526023864746094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3895, 128]), torch.Size([1, 3895, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49904346466064453  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6115245819091797  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3895, 128])
m.shape torch.Size([3699, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6189537048339844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6189537048339844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3699, 128]), torch.Size([1, 3699, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6225452423095703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7507147789001465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3699, 128])
m.shape torch.Size([3326, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7584667205810547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7584667205810547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3326, 128]), torch.Size([1, 3326, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7618165016174316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.902869701385498  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3326, 128])
m.shape torch.Size([3001, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9113006591796875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9113006591796875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3001, 128]), torch.Size([1, 3001, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9143295288085938  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.06510591506958  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3001, 128])
m.shape torch.Size([2857, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0751228332519531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0751228332519531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2857, 128]), torch.Size([1, 2857, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0778474807739258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2368221282958984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2857, 128])
m.shape torch.Size([2554, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2464203834533691  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2464203834533691  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2554, 128]), torch.Size([1, 2554, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.248960018157959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.405911922454834  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2554, 128])
m.shape torch.Size([32420, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5592846870422363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5592846870422363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32420, 128]), torch.Size([1, 32420, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.590202808380127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.805302143096924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32420, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5936942100524902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6538987159729004  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7141032218933105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.653428077697754  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([63129, 256])
first layer input nodes number: 123067
first layer output nodes number: 63129
edges number: 468740
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.715022087097168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.775226593017578  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7902779579162598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7902779579162598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1712, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.882934093475342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.882934093475342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1712, 256]), torch.Size([1, 1712, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8866844177246094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9134254455566406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1712, 256])
m.shape torch.Size([1465, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.914985179901123  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.914985179901123  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1465, 256]), torch.Size([1, 1465, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.918886184692383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9621076583862305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1465, 256])
m.shape torch.Size([1201, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9648098945617676  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9648098945617676  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1201, 256]), torch.Size([1, 1201, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.967319965362549  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.019163608551025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1201, 256])
m.shape torch.Size([858, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.021731853485107  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.021731853485107  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 858, 256]), torch.Size([1, 858, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0233683586120605  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.080417156219482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 858, 256])
m.shape torch.Size([751, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0836992263793945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0836992263793945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.085131645202637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.136760711669922  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([602, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.139516353607178  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.139516353607178  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 602, 256]), torch.Size([1, 602, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.140664577484131  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.190118312835693  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 602, 256])
m.shape torch.Size([469, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1930251121521  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1930251121521  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.193919658660889  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.238646984100342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([437, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.241559982299805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.241559982299805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.242393493652344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.28990364074707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([343, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.292454242706299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.292454242706299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2931084632873535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.33657169342041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([330, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.33941650390625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.33941650390625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.340045928955078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.385383605957031  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([299, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.388230323791504  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.388230323791504  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.388800621032715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.434627532958984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([239, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.437098979949951  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.437098979949951  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.437554836273193  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.476302623748779  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([204, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.478623867034912  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.478623867034912  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.479012966156006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.514810085296631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517010688781738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517010688781738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517350196838379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.550961494445801  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.552968978881836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.552968978881836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.553256988525391  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5837860107421875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([130, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.585641384124756  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.585641384124756  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5858893394470215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.613908290863037  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616006851196289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616006851196289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616266250610352  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.647394180297852  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([125, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.64942741394043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.64942741394043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.649665832519531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.67994499206543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([121, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.682035446166992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.682035446166992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6822662353515625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.713191986083984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.715210914611816  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.715210914611816  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.715388298034668  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.740399360656738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.742127418518066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.742127418518066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7422990798950195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.767704963684082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.769247531890869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.769247531890869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.769394397735596  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.792158603668213  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.793456077575684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.793456077575684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.793574333190918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.812731742858887  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.813964366912842  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.813964366912842  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.814071178436279  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.832122325897217  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([1238, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.861938953399658  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.861938953399658  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1238, 256]), torch.Size([1, 1238, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.86430025100708  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.290914535522461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1238, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.210502624511719  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.2121968269348145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.21389102935791  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.212111949920654  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11367, 40])
input nodes number: 63129
output nodes number: 11367
edges number: 93881
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.212667465209961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.212667942047119  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07767629623413086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 5 input nodes size: 122916
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06601572036743164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06601572036743164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12462663650512695  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12471151351928711  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06594371795654297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07052803039550781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07052803039550781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07052803039550781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122916, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07052803039550781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3168, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3027067184448242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3027067184448242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3168, 128]), torch.Size([1, 3168, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3057279586791992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3298978805541992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3168, 128])
m.shape torch.Size([4016, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3322172164916992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3322172164916992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4016, 128]), torch.Size([1, 4016, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33728885650634766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3956613540649414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4016, 128])
m.shape torch.Size([4059, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3992476463317871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3992476463317871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4059, 128]), torch.Size([1, 4059, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40340328216552734  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4894728660583496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4059, 128])
m.shape torch.Size([3871, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49527931213378906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3871, 128]), torch.Size([1, 3871, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4990200996398926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6116385459899902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3871, 128])
m.shape torch.Size([3633, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6184544563293457  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6184544563293457  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3633, 128]), torch.Size([1, 3633, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6230044364929199  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7484121322631836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3633, 128])
m.shape torch.Size([3280, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7560639381408691  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7560639381408691  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3280, 128]), torch.Size([1, 3280, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7593603134155273  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.898533821105957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3280, 128])
m.shape torch.Size([3026, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9070701599121094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9070701599121094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3026, 128]), torch.Size([1, 3026, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9101448059082031  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0606231689453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3026, 128])
m.shape torch.Size([2730, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0688209533691406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0688209533691406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2730, 128]), torch.Size([1, 2730, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0723390579223633  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2209415435791016  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2730, 128])
m.shape torch.Size([2583, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.230724811553955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.230724811553955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2583, 128]), torch.Size([1, 2583, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2333331108093262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.3914170265197754  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2583, 128])
m.shape torch.Size([32650, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5464353561401367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5464353561401367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32650, 128]), torch.Size([1, 32650, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5775728225708008  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7948598861694336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32650, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5838189125061035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6443657875061035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7044625282287598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6434459686279297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([63016, 256])
first layer input nodes number: 122916
first layer output nodes number: 63016
edges number: 469475
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.705380439758301  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.765477180480957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.780501365661621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.780501365661621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1657, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8733410835266113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8733410835266113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1657, 256]), torch.Size([1, 1657, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8771915435791016  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.903477191925049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1657, 256])
m.shape torch.Size([1479, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.904740333557129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.904740333557129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1479, 256]), torch.Size([1, 1479, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9078149795532227  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.951181411743164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1479, 256])
m.shape torch.Size([1177, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9537601470947266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9537601470947266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.956043243408203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0081281661987305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
m.shape torch.Size([931, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.010401248931885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.010401248931885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.012176990509033  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.068605899810791  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([751, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.071708679199219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.071708679199219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.073141098022461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.125425338745117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([613, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.128244400024414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.128244400024414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.129413604736328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.181018829345703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([506, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.183838844299316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.183838844299316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1848039627075195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.233288764953613  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([411, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.235966682434082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.235966682434082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.236750602722168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.28230094909668  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([391, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.285788059234619  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.285788059234619  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.286533832550049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.334545612335205  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([304, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.337094783782959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.337094783782959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.337674617767334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.379628658294678  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([303, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.382659912109375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.382659912109375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.383237838745117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.428316116333008  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([268, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.431118488311768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.431118488311768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.431629657745361  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.475471019744873  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([211, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.477851867675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.477851867675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.478254318237305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.515279769897461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([157, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517191410064697  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517191410064697  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517490863800049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5471367835998535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([145, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.54907751083374  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.54907751083374  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.549354076385498  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.578670024871826  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.580454349517822  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.580454349517822  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.580692768096924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6076340675354  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([140, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.609802722930908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.609802722930908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.610069751739502  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.642113208770752  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([106, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643813610076904  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643813610076904  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.644015789031982  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.669692516326904  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([89, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.67121696472168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.67121696472168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.67138671875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.694133758544922  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([85, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.695683002471924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.695683002471924  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.695845127105713  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.718704700469971  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.720460414886475  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.720460414886475  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7206339836120605  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.746322154998779  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.747775077819824  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.747775077819824  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.747899055480957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.767115592956543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.768800258636475  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.768800258636475  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.768950939178467  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.793361186981201  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.795085430145264  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.795085430145264  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.795234203338623  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.820376873016357  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([1206, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.849280834197998  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.849280834197998  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1206, 256]), torch.Size([1, 1206, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.852166652679443  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.258163928985596  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1206, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.177422046661377  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.179361343383789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.181055545806885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.1790313720703125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 63016
output nodes number: 11368
edges number: 93216
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.179585933685303  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.179586410522461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07881975173950195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 6 input nodes size: 123428
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06594371795654297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06594371795654297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12479877471923828  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12488365173339844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06618785858154297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07034492492675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07034492492675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07034492492675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123428, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07034492492675781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3264, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3009510040283203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3009510040283203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3264, 128]), torch.Size([1, 3264, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3040637969970703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3289661407470703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3264, 128])
m.shape torch.Size([4074, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3312950134277344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3312950134277344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4074, 128]), torch.Size([1, 4074, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3356952667236328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39422607421875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4074, 128])
m.shape torch.Size([4108, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3981599807739258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3981599807739258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4108, 128]), torch.Size([1, 4108, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4020967483520508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.48828601837158203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4108, 128])
m.shape torch.Size([3901, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49411678314208984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49411678314208984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3901, 128]), torch.Size([1, 3901, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4979400634765625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6109509468078613  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3901, 128])
m.shape torch.Size([3782, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6173639297485352  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6173639297485352  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3782, 128]), torch.Size([1, 3782, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6217713356018066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7527570724487305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3782, 128])
m.shape torch.Size([3209, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7601346969604492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7601346969604492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3209, 128]), torch.Size([1, 3209, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7632989883422852  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.8952326774597168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3209, 128])
m.shape torch.Size([3032, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9038228988647461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9038228988647461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3032, 128]), torch.Size([1, 3032, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9068174362182617  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0567779541015625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3032, 128])
m.shape torch.Size([2798, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0652694702148438  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0652694702148438  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2798, 128]), torch.Size([1, 2798, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0688176155090332  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.228588581085205  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2798, 128])
m.shape torch.Size([2525, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2380905151367188  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2380905151367188  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2525, 128]), torch.Size([1, 2525, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2404985427856445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.3967485427856445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2525, 128])
m.shape torch.Size([32223, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5491957664489746  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5491957664489746  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32223, 128]), torch.Size([1, 32223, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5799260139465332  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7617735862731934  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32223, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5521397590637207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6121411323547363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.672142505645752  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6116719245910645  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62916, 256])
first layer input nodes number: 123428
first layer output nodes number: 62916
edges number: 466067
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6730642318725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.733065605163574  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.748065948486328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.748065948486328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1690, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8385252952575684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8385252952575684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1690, 256]), torch.Size([1, 1690, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8423280715942383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8695015907287598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1690, 256])
m.shape torch.Size([1471, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8707175254821777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8707175254821777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1471, 256]), torch.Size([1, 1471, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8736934661865234  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9161415100097656  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1471, 256])
m.shape torch.Size([1164, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.918931007385254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.918931007385254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1164, 256]), torch.Size([1, 1164, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.921269416809082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.970773696899414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1164, 256])
m.shape torch.Size([932, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9737701416015625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9737701416015625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 932, 256]), torch.Size([1, 932, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9755477905273438  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.034429550170898  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 932, 256])
m.shape torch.Size([844, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.03773832321167  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.03773832321167  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 844, 256]), torch.Size([1, 844, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.039348125457764  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.10224723815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 844, 256])
m.shape torch.Size([604, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.104925632476807  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.104925632476807  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.106077671051025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.157360076904297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([500, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.160212993621826  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.160212993621826  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.161166667938232  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.209765911102295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([416, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.212487697601318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.212487697601318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.213281154632568  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.259530544281006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([378, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.262403964996338  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.262403964996338  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.263124942779541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.310333728790283  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([330, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.313145160675049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.313145160675049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.313774585723877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.359794616699219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.362207889556885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.362207889556885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.36269998550415  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.403146743774414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([218, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.405415058135986  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.405415058135986  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4058308601379395  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.441174030303955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([212, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.443615436553955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.443615436553955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.444019794464111  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.481220722198486  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([184, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.483494758605957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.483494758605957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4838457107543945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.518589973449707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.521383285522461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.521383285522461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.521690368652344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.554241180419922  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.556286811828613  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.556286811828613  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5565595626831055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.587380409240723  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.58907413482666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.58907413482666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.589287757873535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.614922523498535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616718769073486  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616718769073486  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.616928577423096  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643574237823486  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([98, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.645259380340576  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.645259380340576  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.645446300506592  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6704936027526855  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.672360897064209  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.672360897064209  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.672555446624756  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.699986934661865  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([99, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.701888084411621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.701888084411621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7020769119262695  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.730023384094238  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.731197834014893  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.731197834014893  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.731312274932861  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.749050617218018  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750298023223877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750298023223877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750410556793213  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.768640995025635  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.770015239715576  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.770015239715576  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7701334953308105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.79011869430542  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1161, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.817956447601318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.817956447601318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.820352077484131  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.222480773925781  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.143613338470459  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.145359992980957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.147054195404053  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.1452226638793945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62916
output nodes number: 11368
edges number: 91770
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.145829200744629  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.145829677581787  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07854413986206055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 7 input nodes size: 122814
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06624031066894531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.06624031066894531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.1248025894165039  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.12488746643066406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.0659475326538086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07057571411132812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07057571411132812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07057571411132812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122814, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07057571411132812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3216, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.29975414276123047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.29975414276123047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3216, 128]), torch.Size([1, 3216, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30282115936279297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.32735729217529297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3216, 128])
m.shape torch.Size([4031, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3296680450439453  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3296680450439453  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4031, 128]), torch.Size([1, 4031, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3345036506652832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.392911434173584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4031, 128])
m.shape torch.Size([4160, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3969402313232422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3969402313232422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4160, 128]), torch.Size([1, 4160, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.400909423828125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.488189697265625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4160, 128])
m.shape torch.Size([3897, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.493896484375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.493896484375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3897, 128]), torch.Size([1, 3897, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49761962890625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6098532676696777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3897, 128])
m.shape torch.Size([3722, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.617286205291748  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.617286205291748  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3722, 128]), torch.Size([1, 3722, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6208877563476562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7495603561401367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3722, 128])
m.shape torch.Size([3326, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7573013305664062  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7573013305664062  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3326, 128]), torch.Size([1, 3326, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7607812881469727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9015579223632812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3326, 128])
m.shape torch.Size([3006, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9100055694580078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9100055694580078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3006, 128]), torch.Size([1, 3006, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9129724502563477  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.062591552734375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3006, 128])
m.shape torch.Size([2821, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0719194412231445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0719194412231445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2821, 128]), torch.Size([1, 2821, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.074772834777832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.233346939086914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2821, 128])
m.shape torch.Size([2497, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2427177429199219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2427177429199219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2497, 128]), torch.Size([1, 2497, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.245253562927246  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.401893138885498  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2497, 128])
m.shape torch.Size([32122, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.553391456604004  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.553391456604004  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32122, 128]), torch.Size([1, 32122, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5840253829956055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7590341567993164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32122, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.549455165863037  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.609344005584717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6692328453063965  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6088757514953613  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62798, 256])
first layer input nodes number: 122814
first layer output nodes number: 62798
edges number: 465215
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.670149803161621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.730038642883301  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7450108528137207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7450108528137207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1706, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8361401557922363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8361401557922363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1706, 256]), torch.Size([1, 1706, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.839773178100586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.866464138031006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1706, 256])
m.shape torch.Size([1418, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.867938995361328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.867938995361328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1418, 256]), torch.Size([1, 1418, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.870899200439453  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.913118839263916  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1418, 256])
m.shape torch.Size([1145, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.914496898651123  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.914496898651123  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1145, 256]), torch.Size([1, 1145, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.916961193084717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.967195510864258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1145, 256])
m.shape torch.Size([917, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.970205307006836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.970205307006836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 917, 256]), torch.Size([1, 917, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.971954345703125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.031270980834961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 917, 256])
m.shape torch.Size([799, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.034640789031982  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.034640789031982  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 799, 256]), torch.Size([1, 799, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0361647605896  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.091359615325928  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 799, 256])
m.shape torch.Size([618, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.094161510467529  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.094161510467529  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.095340251922607  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.147202014923096  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([535, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.150212287902832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.150212287902832  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.151232719421387  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.202997207641602  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([451, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2059550285339355  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2059550285339355  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 451, 256]), torch.Size([1, 451, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.206815242767334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.256898403167725  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 451, 256])
m.shape torch.Size([367, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.259643077850342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.259643077850342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.260343074798584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.306069850921631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([321, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.308805465698242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.308805465698242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 321, 256]), torch.Size([1, 321, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.309417724609375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.35324764251709  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 321, 256])
m.shape torch.Size([274, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.355838775634766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.355838775634766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.356361389160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.398941993713379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([230, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.401333808898926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.401333808898926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.401772499084473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.439061164855957  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([179, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4410786628723145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4410786628723145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.441420078277588  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.472830295562744  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.475041389465332  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.475041389465332  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.47537899017334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.508801460266113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([174, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.511141300201416  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.511141300201416  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.511473178863525  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.546652317047119  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.548854827880859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.548854827880859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5491485595703125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.582340240478516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([104, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.584458351135254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.584458351135254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.584656715393066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.608460426330566  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([141, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.610800743103027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.610800743103027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.611069679260254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.645224571228027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.647190570831299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.647190570831299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.647409915924072  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.676802158355713  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6787495613098145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6787495613098145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.678953647613525  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.707729816436768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.709706783294678  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.709706783294678  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])[05:06:51] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 8 parts and get 0 edge cuts

----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.709903240203857  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.738978862762451  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.740297794342041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.740297794342041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7404255867004395  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.760233402252197  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.761451721191406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.761451721191406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.761562347412109  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.779483795166016  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.780951023101807  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.780951023101807  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.781076908111572  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.802351474761963  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1142, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.829729080200195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.829729080200195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1142, 256]), torch.Size([1, 1142, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.83216667175293  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.217141151428223  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1142, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.137455463409424  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.1392998695373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.140994071960449  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.139064788818359  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62798
output nodes number: 11368
edges number: 92603
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.139565467834473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.139565944671631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07781791687011719  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08336830139160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08336830139160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04373517632484436 |0.045659273862838745 |0.20047500729560852 |0.0001074373722076416 |0.07673376798629761 |0.00546574592590332 |
----------------------------------------------------------pseudo_mini_loss sum 5.323719501495361
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1487450
Number of first layer input nodes during this epoch:  984093
Number of first layer output nodes during this epoch:  503357
----------------------------------------before generate dataloader block 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08336782455444336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02002120018005371
global_2_local spend time (sec) 0.04108738899230957
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004481792449951172
A = g.adjacency_matrix() spent  0.007459402084350586
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07895016670227051
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3162367343902588
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2392468452453613

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.001 seconds
Metis partitioning: 0.047 seconds
Split the graph: 0.024 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.07437276840209961
11366
11368
11368
11368
11367
11368
11368
11368
total k batches seeds list generation spend  10.1079261302948
after graph partition
graph partition algorithm spend time 10.22266411781311
11366
11368
11368
11368
11367
11368
11368
11368
partition_len_list
[63100, 62935, 62605, 63134, 63024, 62852, 62738, 62853]
shared_neighbor_graph_partition_s0 selection method  spend 10.313260316848755
time for parepare:  0.01692819595336914
local_output_nid generation:  0.0020055770874023438
local_in_edges_tensor generation:  0.0020122528076171875
mini_batch_src_global generation:  0.0030639171600341797
r_  generation:  0.0305478572845459
local_output_nid generation:  0.002551555633544922
local_in_edges_tensor generation:  0.0019996166229248047
mini_batch_src_global generation:  0.0037355422973632812
r_  generation:  0.032450199127197266
local_output_nid generation:  0.002804994583129883
local_in_edges_tensor generation:  0.0020704269409179688
mini_batch_src_global generation:  0.002520322799682617
r_  generation:  0.03258395195007324
local_output_nid generation:  0.002852916717529297
local_in_edges_tensor generation:  0.0020406246185302734
mini_batch_src_global generation:  0.002659320831298828
r_  generation:  0.035123348236083984
local_output_nid generation:  0.002916097640991211
local_in_edges_tensor generation:  0.0020902156829833984
mini_batch_src_global generation:  0.0026137828826904297
r_  generation:  0.03425741195678711
local_output_nid generation:  0.0028679370880126953
local_in_edges_tensor generation:  0.0020792484283447266
mini_batch_src_global generation:  0.0029685497283935547
r_  generation:  0.03496885299682617
local_output_nid generation:  0.0028595924377441406
local_in_edges_tensor generation:  0.002086162567138672
mini_batch_src_global generation:  0.0029706954956054688
r_  generation:  0.03426170349121094
local_output_nid generation:  0.002792835235595703
local_in_edges_tensor generation:  0.0020377635955810547
mini_batch_src_global generation:  0.003016948699951172
r_  generation:  0.0348663330078125
----------------------check_connections_block total spend ----------------------------- 0.4214766025543213
generate_one_block  0.05095553398132324
generate_one_block  0.0509486198425293
generate_one_block  0.05097460746765137
generate_one_block  0.051146507263183594
generate_one_block  0.050455331802368164
generate_one_block  0.052346229553222656
generate_one_block  0.0522463321685791
generate_one_block  0.0512850284576416
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050676822662353516
gen group dst list time:  0.014425992965698242
time for parepare:  0.022281885147094727
local_output_nid generation:  0.014438390731811523
local_in_edges_tensor generation:  0.03267216682434082
mini_batch_src_global generation:  0.01506805419921875
r_  generation:  0.17934489250183105
local_output_nid generation:  0.0164797306060791
local_in_edges_tensor generation:  0.016911745071411133
mini_batch_src_global generation:  0.018053293228149414
r_  generation:  0.18271183967590332
local_output_nid generation:  0.01622939109802246
local_in_edges_tensor generation:  0.014261960983276367
mini_batch_src_global generation:  0.01783132553100586
r_  generation:  0.19132304191589355
local_output_nid generation:  0.018804311752319336
local_in_edges_tensor generation:  0.016252756118774414
mini_batch_src_global generation:  0.019786834716796875
r_  generation:  0.18713903427124023
local_output_nid generation:  0.01636362075805664
local_in_edges_tensor generation:  0.015177249908447266
mini_batch_src_global generation:  0.019637107849121094
r_  generation:  0.1814565658569336
local_output_nid generation:  0.01613020896911621
local_in_edges_tensor generation:  0.015682220458984375
mini_batch_src_global generation:  0.01951289176940918
r_  generation:  0.1807711124420166
local_output_nid generation:  0.01623678207397461
local_in_edges_tensor generation:  0.01593494415283203
mini_batch_src_global generation:  0.019919157028198242
r_  generation:  0.18269586563110352
local_output_nid generation:  0.01596236228942871
local_in_edges_tensor generation:  0.014929533004760742
mini_batch_src_global generation:  0.021221160888671875
r_  generation:  0.18338751792907715
----------------------check_connections_block total spend ----------------------------- 2.2515511512756348
generate_one_block  0.21756911277770996
generate_one_block  0.21793580055236816
generate_one_block  0.21738553047180176
generate_one_block  0.24113082885742188
generate_one_block  0.21648740768432617
generate_one_block  0.22544431686401367
generate_one_block  0.2193620204925537
generate_one_block  0.2188098430633545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08336782455444336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

connection checking time:  2.2515511512756348
block generation total time  1.7741248607635498
average batch blocks generation time:  0.22176560759544373
block dataloader generation time/epoch 15.398304224014282
pseudo mini batch 0 input nodes size: 123210
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07144451141357422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07144451141357422  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13019561767578125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.1302804946899414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07163333892822266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123210, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07586002349853516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3295, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3061389923095703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3061389923095703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3295, 128]), torch.Size([1, 3295, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3092813491821289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.335817813873291  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3295, 128])
m.shape torch.Size([4072, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33740949630737305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33740949630737305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4072, 128]), torch.Size([1, 4072, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3412928581237793  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39981794357299805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4072, 128])
m.shape torch.Size([4132, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40378713607788086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40378713607788086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4132, 128]), torch.Size([1, 4132, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4077620506286621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49445486068725586  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4132, 128])
m.shape torch.Size([3947, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5002284049987793  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5002284049987793  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3947, 128]), torch.Size([1, 3947, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5040340423583984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.617241382598877  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3947, 128])
m.shape torch.Size([3738, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6247696876525879  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6247696876525879  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3738, 128]), torch.Size([1, 3738, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6284356117248535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7568202018737793  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3738, 128])
m.shape torch.Size([3334, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7645764350891113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7645764350891113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7679905891418457  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9075961112976074  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
m.shape torch.Size([2947, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9158430099487305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9158430099487305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2947, 128]), torch.Size([1, 2947, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9188380241394043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0601849555969238  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2947, 128])
m.shape torch.Size([2803, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.070021629333496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.070021629333496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2803, 128]), torch.Size([1, 2803, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0727529525756836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2311453819274902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2803, 128])
m.shape torch.Size([2521, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2406277656555176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2406277656555176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2521, 128]), torch.Size([1, 2521, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2431540489196777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.4001760482788086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2521, 128])
m.shape torch.Size([32311, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5527472496032715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5527472496032715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32311, 128]), torch.Size([1, 32311, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5835614204406738  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7975172996520996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32311, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.586864948272705  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6470417976379395  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.707218647003174  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.646571636199951  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([63100, 256])
first layer input nodes number: 123210
first layer output nodes number: 63100
edges number: 467169
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.708138942718506  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7683157920837402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.783360004425049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.783360004425049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1719, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8746514320373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8746514320373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1719, 256]), torch.Size([1, 1719, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.878563404083252  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9059276580810547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1719, 256])
m.shape torch.Size([1451, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9070777893066406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9070777893066406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1451, 256]), torch.Size([1, 1451, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.909961223602295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.953120708465576  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1451, 256])
m.shape torch.Size([1156, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9558873176574707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9558873176574707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1156, 256]), torch.Size([1, 1156, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9582152366638184  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.009153366088867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1156, 256])
m.shape torch.Size([963, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.011595726013184  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.011595726013184  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 963, 256]), torch.Size([1, 963, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.013432502746582  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.07210636138916  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 963, 256])
m.shape torch.Size([765, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.075340747833252  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.075340747833252  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0767998695373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.12932825088501  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([611, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.13212251663208  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.13212251663208  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1332879066467285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.185160160064697  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([481, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.187813758850098  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.187813758850098  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1887311935424805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.23529052734375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([423, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.238084316253662  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.238084316253662  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.238891124725342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.285281181335449  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([361, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.288000583648682  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.288000583648682  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.288689136505127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.333439350128174  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([317, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.336142063140869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.336142063140869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.336746692657471  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.380721569061279  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([272, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.383295059204102  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.383295059204102  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.383813858032227  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.425679683685303  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4283037185668945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4283037185668945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.428780555725098  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.469311714172363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([184, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.471372604370117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.471372604370117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.471723556518555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.504011154174805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.506433010101318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.506433010101318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.506801128387451  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5432448387146  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([171, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.545554161071777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.545554161071777  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.545880317687988  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.580452919006348  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.582442760467529  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.582442760467529  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.582709789276123  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.612884044647217  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([117, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6146626472473145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6146626472473145  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6148858070373535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.641664981842041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643387317657471  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643387317657471  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.643589496612549  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.669266223907471  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.670973300933838  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.670973300933838  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.671162128448486  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.696465015411377  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.698254585266113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.698254585266113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.698441505432129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.724797248840332  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726439952850342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726439952850342  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726603984832764  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750880718231201  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.752448081970215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.752448081970215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.752596855163574  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.775656700134277  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([82, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.777395248413086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.777395248413086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.777551651000977  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.802888870239258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.804102420806885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.804102420806885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.804209232330322  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.82226037979126  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([1187, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.850728511810303  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.850728511810303  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.853227138519287  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.2571539878845215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.178189754486084  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.179907321929932  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.18250036239624  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.180697917938232  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11366, 40])
input nodes number: 63100
output nodes number: 11366
edges number: 92658
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.181252479553223  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.181253433227539  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08328390121459961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 1 input nodes size: 122872
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07163381576538086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07163381576538086  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13022375106811523  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.1303086280822754  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.0714726448059082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07650375366210938  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07650375366210938  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07650375366210938  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122872, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07650375366210938  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3271, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3076043128967285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3076043128967285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3271, 128]), torch.Size([1, 3271, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.31072378158569336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3356795310974121  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3271, 128])
m.shape torch.Size([3967, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3379030227661133  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3379030227661133  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3967, 128]), torch.Size([1, 3967, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3424386978149414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4006633758544922  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3967, 128])
m.shape torch.Size([4015, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40451526641845703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40451526641845703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4015, 128]), torch.Size([1, 4015, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40874481201171875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49452781677246094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4015, 128])
m.shape torch.Size([3852, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5002713203430176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5002713203430176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3852, 128]), torch.Size([1, 3852, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5039539337158203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.617466926574707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3852, 128])
m.shape torch.Size([3708, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.623539924621582  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.623539924621582  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3708, 128]), torch.Size([1, 3708, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6271276473999023  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7548704147338867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3708, 128])
m.shape torch.Size([3246, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7623891830444336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7623891830444336  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3246, 128]), torch.Size([1, 3246, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7656455039978027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9064230918884277  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3246, 128])
m.shape torch.Size([3034, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9157099723815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9157099723815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3034, 128]), torch.Size([1, 3034, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9186701774597168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.068509578704834  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3034, 128])
m.shape torch.Size([2801, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.078636646270752  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.078636646270752  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2801, 128]), torch.Size([1, 2801, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0822539329528809  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2411751747131348  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2801, 128])
m.shape torch.Size([2478, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.250473976135254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.250473976135254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2478, 128]), torch.Size([1, 2478, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2531895637512207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.409080982208252  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2478, 128])
m.shape torch.Size([32563, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5631718635559082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5631718635559082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32563, 128]), torch.Size([1, 32563, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.594226360321045  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8104348182678223  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32563, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6003775596618652  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6603970527648926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.72041654586792  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6599278450012207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62935, 256])
first layer input nodes number: 122872
first layer output nodes number: 62935
edges number: 468252
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7213339805603027  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.78135347366333  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.796358585357666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.796358585357666  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1698, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.888054370880127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.888054370880127  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1698, 256]), torch.Size([1, 1698, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.891796112060547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9195661544799805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1698, 256])
m.shape torch.Size([1473, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.920013427734375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.920013427734375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1473, 256]), torch.Size([1, 1473, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9230079650878906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9662632942199707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1473, 256])
m.shape torch.Size([1175, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9688892364501953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9688892364501953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1175, 256]), torch.Size([1, 1175, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.971160888671875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.021945953369141  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1175, 256])
m.shape torch.Size([899, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.02466344833374  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.02466344833374  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.026378154754639  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0829997062683105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([776, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.086175441741943  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.086175441741943  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 776, 256]), torch.Size([1, 776, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.087655544281006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.141103267669678  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 776, 256])
m.shape torch.Size([567, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1436333656311035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1436333656311035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.144714832305908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.192636489868164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([490, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.195392608642578  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.195392608642578  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 490, 256]), torch.Size([1, 490, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.196327209472656  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.243896484375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 490, 256])
m.shape torch.Size([465, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.247004985809326  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.247004985809326  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.247891902923584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.299418926239014  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([346, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.301968574523926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.301968574523926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.302628517150879  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.346383094787598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([331, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.349234580993652  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.349234580993652  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.349865913391113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.395281791687012  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.397694110870361  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.397694110870361  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.398186206817627  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.437486171722412  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([241, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4400200843811035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4400200843811035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.440479755401611  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.479551792144775  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482195854187012  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482195854187012  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482634544372559  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.522994041442871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([189, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.525318145751953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.525318145751953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.525678634643555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.561367034912109  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([150, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.563349723815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.563349723815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.56363582611084  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.593962669372559  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([135, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.595895767211914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.595895767211914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.596153259277344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.625249862670898  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627425193786621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627425193786621  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627694129943848  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.659966468811035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([121, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.661925792694092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.661925792694092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.662156581878662  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.691466808319092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([120, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.693542957305908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.693542957305908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.693771839141846  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.724442005157471  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([123, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726692199707031  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726692199707031  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.726926803588867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.760005950927734  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.761483192443848  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.761483192443848  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.76163387298584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.783934593200684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.785297393798828  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.785297393798828  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.785427093505859  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.805530548095703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([54, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.806659698486328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.806659698486328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8067626953125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.823448181152344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8249192237854  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8249192237854  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.825045108795166  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.846319675445557  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1173, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.874442100524902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.874442100524902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1173, 256]), torch.Size([1, 1173, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.877418518066406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.279019832611084  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1173, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.199443817138672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.201138019561768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.202832221984863  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.201053142547607  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62935
output nodes number: 11368
edges number: 93018
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.201607704162598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.201608180999756  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08425140380859375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 2 input nodes size: 122972
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.0714731216430664  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.0714731216430664  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.1301107406616211  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13019561767578125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07584619522094727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07584619522094727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07584619522094727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([122972, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07584619522094727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3188, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3047504425048828  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3047504425048828  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3188, 128]), torch.Size([1, 3188, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30779075622558594  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33298349380493164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3188, 128])
m.shape torch.Size([4137, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33540868759155273  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33540868759155273  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4137, 128]), torch.Size([1, 4137, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.340604305267334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39978456497192383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4137, 128])
m.shape torch.Size([4058, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40361690521240234  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40361690521240234  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4058, 128]), torch.Size([1, 4058, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4074869155883789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49335193634033203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4058, 128])
m.shape torch.Size([3885, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4991569519042969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4991569519042969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3885, 128]), torch.Size([1, 3885, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5029778480529785  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6161289215087891  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3885, 128])
m.shape torch.Size([3695, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6222810745239258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6222810745239258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3695, 128]), torch.Size([1, 3695, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6259136199951172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7541794776916504  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3695, 128])
m.shape torch.Size([3275, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7617874145507812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7617874145507812  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3275, 128]), torch.Size([1, 3275, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7654614448547363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9060544967651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3275, 128])
m.shape torch.Size([3073, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9139585494995117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9139585494995117  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3073, 128]), torch.Size([1, 3073, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9170083999633789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0694303512573242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3073, 128])
m.shape torch.Size([2776, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.078554630279541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.078554630279541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2776, 128]), torch.Size([1, 2776, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0820631980895996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2329649925231934  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2776, 128])
m.shape torch.Size([2568, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2435545921325684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2435545921325684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2568, 128]), torch.Size([1, 2568, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2460036277770996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.4029135704040527  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2568, 128])
m.shape torch.Size([31950, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5540385246276855  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5540385246276855  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 31950, 128]), torch.Size([1, 31950, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5845084190368652  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.747870922088623  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 31950, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.539754867553711  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5997462272644043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6594510078430176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.5989928245544434  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62605, 256])
first layer input nodes number: 122972
first layer output nodes number: 62605
edges number: 463632
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.660369396209717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.72007417678833  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7350006103515625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7350006103515625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1698, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.825988292694092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.825988292694092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1698, 256]), torch.Size([1, 1698, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8296027183532715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8569421768188477  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1698, 256])
m.shape torch.Size([1477, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8584256172180176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8584256172180176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1477, 256]), torch.Size([1, 1477, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8615059852600098  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9045920372009277  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1477, 256])
m.shape torch.Size([1155, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9064435958862305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9064435958862305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1155, 256]), torch.Size([1, 1155, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9087705612182617  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.961239814758301  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1155, 256])
m.shape torch.Size([883, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9640026092529297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9640026092529297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 883, 256]), torch.Size([1, 883, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.965686798095703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.025663375854492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 883, 256])
m.shape torch.Size([792, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.029147148132324  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.029147148132324  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.030657768249512  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.085040092468262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([596, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.087721824645996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.087721824645996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.088858604431152  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.138449668884277  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([505, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.141279220581055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.141279220581055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.142242431640625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.190670013427734  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([445, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.194334983825684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.194334983825684  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 445, 256]), torch.Size([1, 445, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.195183753967285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.245490074157715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 445, 256])
m.shape torch.Size([395, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.248482704162598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.248482704162598  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.249236106872559  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2987961769104  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([334, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.301630020141602  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.301630020141602  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.302267074584961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.348502159118652  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([264, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.350975036621094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.350975036621094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.351478576660156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.391472816467285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([234, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.394659996032715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.394659996032715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.395106315612793  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.433043479919434  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([204, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.435369491577148  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.435369491577148  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.435758590698242  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.471555709838867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([182, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.473810195922852  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.473810195922852  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.474157333374023  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.508523941040039  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([167, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.510758399963379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.510758399963379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.511076927185059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5448408126831055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.546834468841553  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.546834468841553  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5471014976501465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.57727575302124  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([148, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.57956075668335  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.57956075668335  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.579843044281006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.613717555999756  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.615514278411865  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.615514278411865  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.61572790145874  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.642858028411865  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([95, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.644486427307129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.644486427307129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.644667625427246  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.668948173522949  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([100, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.670780181884766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.670780181884766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.670970916748047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.697864532470703  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.699881553649902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.699881553649902  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.700078010559082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.729153633117676  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.730408668518066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.730408668518066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.730530738830566  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.749451637268066  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750894069671631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.750894069671631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.751023769378662  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.772035121917725  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([79, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.773792743682861  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.773792743682861  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7739434242248535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.799408435821533  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([1128, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.826436996459961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.826436996459961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1128, 256]), torch.Size([1, 1128, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.828588485717773  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.211342811584473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1128, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.131486415863037  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.133767604827881  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.135461807250977  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.133095741271973  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 62605
output nodes number: 11368
edges number: 92400
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.133647441864014  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.133647918701172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08312320709228516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 3 input nodes size: 123120
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13022899627685547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13031387329101562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07159137725830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123120, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07607555389404297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3219, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3080883026123047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3080883026123047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3219, 128]), torch.Size([1, 3219, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3111581802368164  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33756256103515625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3219, 128])
m.shape torch.Size([3996, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3390974998474121  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3390974998474121  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3996, 128]), torch.Size([1, 3996, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3431415557861328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40144920349121094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3996, 128])
m.shape torch.Size([4021, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40529584884643555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40529584884643555  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4021, 128]), torch.Size([1, 4021, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40946435928344727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49525880813598633  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4021, 128])
m.shape torch.Size([3857, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5010108947753906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5010108947753906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3857, 128]), torch.Size([1, 3857, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.504755973815918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6182518005371094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3857, 128])
m.shape torch.Size([3709, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6252555847167969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6252555847167969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3709, 128]), torch.Size([1, 3709, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6288633346557617  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7563552856445312  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3709, 128])
m.shape torch.Size([3275, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7639565467834473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7639565467834473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3275, 128]), torch.Size([1, 3275, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7672867774963379  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9086179733276367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3275, 128])
m.shape torch.Size([2945, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9168863296508789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9168863296508789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2945, 128]), torch.Size([1, 2945, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9198389053344727  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0605554580688477  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2945, 128])
m.shape torch.Size([2821, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0699124336242676  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0699124336242676  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2821, 128]), torch.Size([1, 2821, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0726027488708496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2322421073913574  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2821, 128])
m.shape torch.Size([2570, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2419261932373047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2419261932373047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2570, 128]), torch.Size([1, 2570, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2444772720336914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.402529239654541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2570, 128])
m.shape torch.Size([32721, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.557553768157959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.557553768157959  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32721, 128]), torch.Size([1, 32721, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.588758945465088  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8069262504577637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32721, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.593153953552246  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6533632278442383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7135725021362305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.652892589569092  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([63134, 256])
first layer input nodes number: 123120
first layer output nodes number: 63134
edges number: 470420
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.714491844177246  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7747011184692383  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7897534370422363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7897534370422363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1666, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.881308078765869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.881308078765869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1666, 256]), torch.Size([1, 1666, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8851308822631836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.911294460296631  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1666, 256])
m.shape torch.Size([1455, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.912905216217041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.912905216217041  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1455, 256]), torch.Size([1, 1455, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.915842056274414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.958674430847168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1455, 256])
m.shape torch.Size([1150, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9612412452697754  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9612412452697754  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.963535785675049  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.01532506942749  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
m.shape torch.Size([929, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.017894268035889  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.017894268035889  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 929, 256]), torch.Size([1, 929, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.0196661949157715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.075669765472412  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 929, 256])
m.shape torch.Size([751, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.07874059677124  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.07874059677124  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.080173015594482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.1325602531433105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([642, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.135546684265137  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.135546684265137  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 642, 256]), torch.Size([1, 642, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.136771202087402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.189425468444824  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 642, 256])
m.shape torch.Size([506, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.192217826843262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.192217826843262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.193182945251465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.243149757385254  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([429, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.245965957641602  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.245965957641602  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.246784210205078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.293571472167969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([400, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2966227531433105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2966227531433105  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2973856925964355  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.347178936004639  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([334, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.350008010864258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.350008010864258  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.350645065307617  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.397343635559082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([291, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.400102138519287  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.400102138519287  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4006571769714355  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4453301429748535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([257, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.448017120361328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.448017120361328  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.448507308959961  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.491201400756836  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([205, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.493841171264648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.493841171264648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.494232177734375  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.530204772949219  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5321760177612305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5321760177612305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.532483100891113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.562884330749512  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([146, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.564836025238037  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.564836025238037  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.565114498138428  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.594632625579834  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([135, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.596569538116455  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.596569538116455  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.596827030181885  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6259236335754395  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([115, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627674102783203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627674102783203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.627893447875977  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.654214859008789  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.656302452087402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.656302452087402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.6565446853637695  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.687308311462402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.689177989959717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.689177989959717  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.689385890960693  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.717244625091553  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.718966960906982  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.718966960906982  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7191481590271  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.744697093963623  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.746423244476318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.746423244476318  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7465949058532715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.772000789642334  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.773564338684082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.773564338684082  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.773713111877441  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7967729568481445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([64, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.798672199249268  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.798672199249268  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.798794269561768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.818569660186768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8201003074646  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8201003074646  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.820231914520264  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.84247350692749  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1164, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8703765869140625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.8703765869140625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1164, 256]), torch.Size([1, 1164, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.873369216918945  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.273918151855469  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1164, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.194857597351074  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.19655179977417  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.198246002197266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.19646692276001  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11368, 40])
input nodes number: 63134
output nodes number: 11368
edges number: 92863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.197022438049316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.197022914886475  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.08342313766479492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 4 input nodes size: 123337
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07159137725830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07159137725830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.13127613067626953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.1313610076904297  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07256793975830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07673835754394531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07673835754394531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07673835754394531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123337, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.07673835754394531  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3167, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30716705322265625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.30716705322265625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3167, 128]), torch.Size([1, 3167, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.31018733978271484  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.3350367546081543  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3167, 128])
m.shape torch.Size([4075, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33741283416748047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.33741283416748047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4075, 128]), torch.Size([1, 4075, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.34129905700683594  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.39983272552490234  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4075, 128])
m.shape torch.Size([4112, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40379905700683594  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40379905700683594  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4112, 128]), torch.Size([1, 4112, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.40772056579589844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.49399375915527344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4112, 128])
m.shape torch.Size([4049, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4998149871826172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.4998149871826172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4049, 128]), torch.Size([1, 4049, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.5037064552307129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6167006492614746  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4049, 128])
m.shape torch.Size([3745, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6236987113952637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6236987113952637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3745, 128]), torch.Size([1, 3745, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.6273026466369629  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7572751045227051  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3745, 128])
m.shape torch.Size([3283, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7648820877075195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7648820877075195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3283, 128]), torch.Size([1, 3283, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.7682294845581055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9091534614562988  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3283, 128])
m.shape torch.Size([3015, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.918546199798584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.918546199798584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3015, 128]), torch.Size([1, 3015, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 0.9214215278625488  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0710792541503906  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3015, 128])
m.shape torch.Size([2749, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0801281929016113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.0801281929016113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2749, 128]), torch.Size([1, 2749, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.08280611038208  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2324233055114746  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2749, 128])
m.shape torch.Size([2575, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2421631813049316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2421631813049316  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.2446537017822266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.402421474456787  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
m.shape torch.Size([32254, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.55499267578125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.55499267578125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32254, 128]), torch.Size([1, 32254, 128])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 1.5857524871826172  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7696990966796875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32254, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.559720993041992  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6198253631591797  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.679929733276367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6193556785583496  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([63024, 256])
first layer input nodes number: 123337
first layer output nodes number: 63024
edges number: 467084
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.6808509826660156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.740955352783203  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7559814453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.7559814453125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1628, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8469653129577637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8469653129577637  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1628, 256]), torch.Size([1, 1628, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.850681781768799  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.877869129180908  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1628, 256])
m.shape torch.Size([1561, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8793163299560547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.8793163299560547  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1561, 256]), torch.Size([1, 1561, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.883826732635498  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9296278953552246  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1561, 256])
m.shape torch.Size([1115, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9323158264160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9323158264160156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1115, 256]), torch.Size([1, 1115, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9345245361328125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.985884666442871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1115, 256])
m.shape torch.Size([968, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9888854026794434  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.9888854026794434  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 968, 256]), torch.Size([1, 968, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 3.990731716156006  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.049779415130615  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 968, 256])
m.shape torch.Size([787, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.053037166595459  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.053037166595459  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.054538249969482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.108577251434326  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.111442565917969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.111442565917969  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.112638473510742  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.16485595703125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([481, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.167494297027588  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.167494297027588  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.168411731719971  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.214283466339111  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([452, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2173004150390625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2173004150390625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.218162536621094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.2679901123046875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([374, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.27079439163208  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.27079439163208  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 374, 256]), torch.Size([1, 374, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.271507740020752  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.317442893981934  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 374, 256])
m.shape torch.Size([318, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.32014274597168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.32014274597168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.320749282836914  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.364250659942627  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([255, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.36664342880249  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.36664342880249  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.367129802703857  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.405066967010498  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([220, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4073615074157715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.4073615074157715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.40778112411499  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.443448543548584  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([196, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.445687770843506  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.445687770843506  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.446061611175537  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.480454921722412  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([175, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482623100280762  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482623100280762  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.482956886291504  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.5160017013549805  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([144, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517910957336426  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.517910957336426  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.518185615539551  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.547299385070801  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.549084663391113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.549084663391113  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.549323081970215  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.576264381408691  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.578204154968262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.578204154968262  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.578444480895996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.607283592224121  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([125, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.609326362609863  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.609326362609863  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.609564781188965  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.639843940734863  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.641697406768799  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.641697406768799  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.641903400421143  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.669506549835205  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([105, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.671422004699707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.671422004699707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.671622276306152  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.699860572814941  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.701678276062012  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.701678276062012  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.701859474182129  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.728676795959473  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.729834079742432  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.729834079742432  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.729946613311768  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.747389316558838  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.749283313751221  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.749283313751221  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7494072914123535  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.769491672515869  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7709059715271  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7709059715271  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7710280418396  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.7916579246521  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1194, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.820286750793457  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.820286750793457  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1194, 256]), torch.Size([1, 1194, 256])
----------------------------------------3
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 4.822585105895996  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.227710723876953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1194, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.148053169250488  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.150394439697266  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.152088642120361  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.149662494659424  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([11367, 40])
input nodes number: 63024
output nodes number: 11367
edges number: 92514
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.150217056274414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9276123046875 GB
    Memory Allocated: 5.150217533111572  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.08441305160522461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

pseudo mini batch 5 input nodes size: 123141
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07256793975830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07256793975830078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.1312861442565918  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.13137102127075195  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07160139083862305  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587862014770508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587862014770508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587862014770508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([123141, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587862014770508  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([3119, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30664920806884766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30664920806884766  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3119, 128]), torch.Size([1, 3119, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30962371826171875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3339524269104004  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3119, 128])
m.shape torch.Size([3938, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3367476463317871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3367476463317871  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3938, 128]), torch.Size([1, 3938, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3410301208496094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3994588851928711  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3938, 128])
m.shape torch.Size([4092, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.40283203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.40283203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 4092, 128]), torch.Size([1, 4092, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.40726375579833984  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.49342918395996094  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 4092, 128])
m.shape torch.Size([3806, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4992828369140625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4992828369140625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3806, 128]), torch.Size([1, 3806, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.5029125213623047  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6085977554321289  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3806, 128])
m.shape torch.Size([3660, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.615509033203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.615509033203125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3660, 128]), torch.Size([1, 3660, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6190586090087891  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7456607818603516  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3660, 128])
m.shape torch.Size([3312, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7533912658691406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7533912658691406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3312, 128]), torch.Size([1, 3312, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7567176818847656  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.8978443145751953  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3312, 128])
m.shape torch.Size([3034, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9058122634887695  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9058122634887695  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 3034, 128]), torch.Size([1, 3034, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9094181060791016  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0606765747070312  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 3034, 128])
m.shape torch.Size([2850, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0708036422729492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0708036422729492  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2850, 128]), torch.Size([1, 2850, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.073521614074707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2324895858764648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2850, 128])
m.shape torch.Size([2523, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2419581413269043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2419581413269043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 2523, 128]), torch.Size([1, 2523, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2445158958435059  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.401501178741455  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 2523, 128])
m.shape torch.Size([32518, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5550737380981445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5550737380981445  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 32518, 128]), torch.Size([1, 32518, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.586085319519043  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.802212715148926  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 32518, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.5909996032714844  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.65093994140625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7108802795410156  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.6504712104797363  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

torch.Size([62852, 256])
first layer input nodes number: 123141
first layer output nodes number: 62852
edges number: 468592
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7118000984191895  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.771740436553955  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7867255210876465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7867255210876465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

m.shape torch.Size([1661, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.879631996154785  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.879631996154785  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1661, 256]), torch.Size([1, 1661, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8834609985351562  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9112672805786133  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1661, 256])
m.shape torch.Size([1428, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9115710258483887  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9115710258483887  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1428, 256]), torch.Size([1, 1428, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.914543628692627  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9560818672180176  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1428, 256])
m.shape torch.Size([1170, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9587717056274414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9587717056274414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.961139678955078  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.013494491577148  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
m.shape torch.Size([837, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.016429424285889  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.016429424285889  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.018025875091553  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.074313640594482  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([800, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.077570915222168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.077570915222168  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.079096794128418  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.137961387634277  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([584, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.140566349029541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.140566349029541  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 584, 256]), torch.Size([1, 584, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1416802406311035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1899285316467285  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 584, 256])
m.shape torch.Size([532, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.193336486816406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.193336486816406  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 532, 256]), torch.Size([1, 532, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1943511962890625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.245086669921875  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 532, 256])
m.shape torch.Size([446, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.248008728027344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.248008728027344  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.248859405517578  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.2981719970703125  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([369, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.300938606262207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.300938606262207  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.301642417907715  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.347043991088867  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([334, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.349902629852295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.349902629852295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.350539684295654  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.396190166473389  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.398895740509033  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.398895740509033  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.399441242218018  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.443497180938721  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([255, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.446165561676025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.446165561676025  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.446651935577393  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4879937171936035  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([235, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.490686893463135  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.490686893463135  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.491135120391846  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.532371997833252  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([165, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.534368515014648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.534368515014648  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5346832275390625  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.565839767456055  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([177, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.568234443664551  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.568234443664551  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.568572044372559  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.604357719421387  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([148, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.606625080108643  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.606625080108643  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.606907367706299  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.638805866241455  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.640609264373779  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.640609264373779  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.640836238861084  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6680731773376465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.669897556304932  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.669897556304932  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.670111179351807  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.697241306304932  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699052333831787  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699052333831787  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699252605438232  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.726089000701904  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.727853775024414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.727853775024414  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.728038787841797  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.754125595092773  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([105, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.756152629852295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.756152629852295  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.75635290145874  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.7859930992126465  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.787161827087402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.787161827087402  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.787276268005371  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.805014610290527  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.80650520324707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.80650520324707  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.806638717651367  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.828268051147461  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([55, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.829470157623291  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.829470157623291  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.829575061798096  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.847303867340088  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([1218, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.877381801605225  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.877381801605225  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

 h.shape torch.Size([1, 1218, 256]), torch.Size([1, 1218, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.87970495223999  GigaBytes
Max Memory Allocated: 5.324265003204346  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.3025007247924805  GigaBytes
Max Memory Allocated: 5.331540107727051  GigaBytes

rst.shape  torch.Size([1, 1218, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.2210588455200195  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.223132133483887  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.224826335906982  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.222668170928955  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([11368, 40])
input nodes number: 62852
output nodes number: 11368
edges number: 94305
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.223221778869629  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.223222255706787  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.08322763442993164  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

pseudo mini batch 6 input nodes size: 122502
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07160139083862305  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07160139083862305  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.13001489639282227  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.13009977340698242  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07129669189453125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([122502, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07607841491699219  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([3130, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3065185546875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3065185546875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3130, 128]), torch.Size([1, 3130, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30950355529785156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33338356018066406  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3130, 128])
m.shape torch.Size([3952, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3356599807739258  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3356599807739258  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3952, 128]), torch.Size([1, 3952, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3395242691040039  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3982553482055664  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3952, 128])
m.shape torch.Size([4070, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4021930694580078  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4021930694580078  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4070, 128]), torch.Size([1, 4070, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.40607452392578125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4919624328613281  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4070, 128])
m.shape torch.Size([3806, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4972810745239258  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4972810745239258  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3806, 128]), torch.Size([1, 3806, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.5010366439819336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6076288223266602  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3806, 128])
m.shape torch.Size([3627, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6144614219665527  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6144614219665527  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3627, 128]), torch.Size([1, 3627, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6180481910705566  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7438831329345703  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3627, 128])
m.shape torch.Size([3295, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7515807151794434  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7515807151794434  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3295, 128]), torch.Size([1, 3295, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7549285888671875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.8947896957397461  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3295, 128])
m.shape torch.Size([3029, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9033288955688477  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9033288955688477  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3029, 128]), torch.Size([1, 3029, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9062504768371582  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0558414459228516  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3029, 128])
m.shape torch.Size([2792, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0650477409362793  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0650477409362793  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2792, 128]), torch.Size([1, 2792, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0679302215576172  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2268428802490234  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2792, 128])
m.shape torch.Size([2512, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2362918853759766  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2362918853759766  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2512, 128]), torch.Size([1, 2512, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2388343811035156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.3957138061523438  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2512, 128])
m.shape torch.Size([32525, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.549241065979004  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.549241065979004  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 32525, 128]), torch.Size([1, 32525, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5802593231201172  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.79599666595459  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 32525, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.5851216316223145  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.6449532508850098  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.704784870147705  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.6444854736328125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([62738, 256])
first layer input nodes number: 122502
first layer output nodes number: 62738
edges number: 467770
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.705699920654297  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.765531539916992  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.780489444732666  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.780489444732666  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([1650, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8732967376708984  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8732967376708984  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1650, 256]), torch.Size([1, 1650, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.877473831176758  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.905773162841797  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1650, 256])
m.shape torch.Size([1454, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9069948196411133  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9069948196411133  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1454, 256]), torch.Size([1, 1454, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.910003185272217  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.952092170715332  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1454, 256])
m.shape torch.Size([1179, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9546360969543457  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9546360969543457  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1179, 256]), torch.Size([1, 1179, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.957001209259033  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.008484840393066  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1179, 256])
m.shape torch.Size([909, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.011023044586182  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.011023044586182  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.012756824493408  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.069691181182861  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([769, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.072875499725342  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.072875499725342  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.074342250823975  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.127145290374756  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([633, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.130062580108643  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.130062580108643  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.131269931793213  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.183613300323486  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([529, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.186568737030029  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.186568737030029  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.187577724456787  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.238027095794678  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([410, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.240675449371338  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.240675449371338  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.241457462310791  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.2880778312683105  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([379, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.290965557098389  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.290965557098389  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.291688442230225  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.339510917663574  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([314, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.342167854309082  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.342167854309082  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.342766761779785  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.386469841003418  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([291, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.389247417449951  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.389247417449951  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.3898024559021  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.435234546661377  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([233, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4376444816589355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4376444816589355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.438088893890381  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.475863933563232  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([191, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.478028297424316  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.478028297424316  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.478392601013184  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.511908531188965  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5141215324401855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5141215324401855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.514461040496826  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.548072338104248  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([174, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.550411224365234  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.550411224365234  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.550743103027344  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5859222412109375  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([145, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.587986469268799  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.587986469268799  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.588263034820557  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6195149421691895  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.621680736541748  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.621680736541748  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.621949672698975  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.654222011566162  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([123, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.656215667724609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.656215667724609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.656450271606445  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.686244964599609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.687899112701416  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.687899112701416  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.688084125518799  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.712875843048096  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.71455192565918  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.71455192565918  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.714727401733398  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.739469528198242  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.740915775299072  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.740915775299072  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.741060733795166  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.762514591217041  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.764133930206299  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.764133930206299  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.764286518096924  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.787937641143799  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([55, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.789134502410889  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.789134502410889  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.789239406585693  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.806233882904053  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.807888507843018  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.807888507843018  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.808029651641846  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.831882953643799  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1192, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.860454082489014  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.860454082489014  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1192, 256]), torch.Size([1, 1192, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.863183498382568  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.2674880027771  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1192, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.186244964599609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.188693523406982  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.190387725830078  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.187854290008545  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([11368, 40])
input nodes number: 62738
output nodes number: 11368
edges number: 93301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.188406944274902  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.1884074211120605  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.08339881896972656  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

pseudo mini batch 7 input nodes size: 123108
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07129669189453125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07129669189453125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.12999916076660156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.13008403778076172  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07158565521240234  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587194442749023  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587194442749023  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587194442749023  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([123108, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07587194442749023  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([3140, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3067488670349121  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3067488670349121  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3140, 128]), torch.Size([1, 3140, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30974340438842773  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33369970321655273  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3140, 128])
m.shape torch.Size([3958, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33643484115600586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33643484115600586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3958, 128]), torch.Size([1, 3958, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3406672477722168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3990654945373535  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3958, 128])
m.shape torch.Size([4013, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4023923873901367  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4023923873901367  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4013, 128]), torch.Size([1, 4013, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4067196846008301  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.49289417266845703  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4013, 128])
m.shape torch.Size([3877, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.49863481521606445  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.49863481521606445  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3877, 128]), torch.Size([1, 3877, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.5023446083068848  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6159281730651855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3877, 128])
m.shape torch.Size([3694, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6228866577148438  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6228866577148438  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3694, 128]), torch.Size([1, 3694, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6264967918395996  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7536311149597168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3694, 128])
m.shape torch.Size([3217, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7610735893249512  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7610735893249512  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3217, 128]), torch.Size([1, 3217, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.764369010925293  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.8971295356750488  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3217, 128])
m.shape torch.Size([2995, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9063334465026855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.9063334465026855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2995, 128]), torch.Size([1, 2995, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.909400463104248  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0593938827514648  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2995, 128])
m.shape torch.Size([2790, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.067643165588379  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.067643165588379  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2790, 128]), torch.Size([1, 2790, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0703039169311523  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2301206588745117  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2790, 128])
m.shape torch.Size([2561, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2397809028625488  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2397809028625488  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2561, 128]), torch.Size([1, 2561, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.242300033569336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.398611068725586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2561, 128])
m.shape torch.Size([32608, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5536398887634277  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5536398887634277  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 32608, 128]), torch.Size([1, 32608, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5847373008728027  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8018088340759277  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 32608, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.589815616607666  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.649756908416748  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.70969820022583  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.6492881774902344  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([62853, 256])
first layer input nodes number: 123108
first layer output nodes number: 62853
edges number: 468789
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7106175422668457  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7705588340759277  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7855443954467773  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7855443954467773  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([1708, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8784232139587402  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8784232139587402  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1708, 256]), torch.Size([1, 1708, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.882253646850586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9091267585754395  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1708, 256])
m.shape torch.Size([1407, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.910202980041504  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.910202980041504  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1407, 256]), torch.Size([1, 1407, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9130420684814453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.955517292022705  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1407, 256])
m.shape torch.Size([1177, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9574389457702637  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9574389457702637  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.959685802459717  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.010876655578613  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
m.shape torch.Size([932, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.013673782348633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.013673782348633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 932, 256]), torch.Size([1, 932, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.015451431274414  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.07213020324707  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 932, 256])
m.shape torch.Size([782, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.075253486633301  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.075253486633301  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.07674503326416  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.130440711975098  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([608, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1332011222839355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1332011222839355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1343607902526855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.1865010261535645  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([521, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.189426422119141  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.189426422119141  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.190420150756836  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.240360260009766  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([402, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.242954730987549  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.242954730987549  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.2437214851379395  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.2879414558410645  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([352, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.290603160858154  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.290603160858154  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.291274547576904  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.334990978240967  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([317, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.33770227432251  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.33770227432251  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.338306903839111  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.381801605224609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.384523391723633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.384523391723633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.385068893432617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.428241729736328  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([247, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.43115758895874  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.43115758895874  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.431628704071045  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.471673488616943  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([211, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.474074363708496  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.474074363708496  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4744768142700195  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.511502265930176  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([191, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.513871192932129  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.513871192932129  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.514235496520996  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.550301551818848  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([160, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.552426338195801  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.552426338195801  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.552731513977051  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.585080146789551  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.587126731872559  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.587126731872559  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.587399482727051  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.618220329284668  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([123, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.620093822479248  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.620093822479248  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.620328426361084  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6484808921813965  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.650474548339844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.650474548339844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.650707244873047  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.680259704589844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6820244789123535  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6820244789123535  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.682220935821533  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.708546161651611  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.710312843322754  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.710312843322754  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.710497856140137  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.736584663391113  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.738595008850098  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.738595008850098  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.738753318786621  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.76218318939209  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.76356315612793  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.76356315612793  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.763694763183594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.784093856811523  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.78537654876709  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.78537654876709  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.785492897033691  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.8043413162231445  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.805713653564453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.805713653564453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.8058319091796875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.825817108154297  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1204, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.8546881675720215  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.8546881675720215  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes
[05:07:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 0 edges into 8 parts and get 0 edge cuts

 h.shape torch.Size([1, 1204, 256]), torch.Size([1, 1204, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.8570332527160645  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.2620530128479  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1204, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.181583881378174  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.18388032913208  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.185574531555176  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.183193206787109  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([11368, 40])
input nodes number: 62853
output nodes number: 11368
edges number: 93191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.183746814727783  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 5.183747291564941  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0832071304321289  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0832071304321289  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0832071304321289  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04669976234436035 |0.0028651654720306396 |0.13111311197280884 |9.03010368347168e-05 |0.07643860578536987 |0.005053043365478516 |
----------------------------------------------------------pseudo_mini_loss sum 4.12263822555542
Total (block generation + training)time/epoch 17.524614572525024
Training time/epoch 2.125845432281494
Training time without block to device /epoch 2.102924108505249
Training time without total dataloading part /epoch 1.666189193725586
load block tensor time/epoch 0.3735980987548828
block to device time/epoch 0.022921323776245117
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1487503
Number of first layer input nodes during this epoch:  984262
Number of first layer output nodes during this epoch:  503241
----------------------------------------before generate dataloader block 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0832066535949707  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.016786813735961914
global_2_local spend time (sec) 0.044882774353027344
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004061460494995117
A = g.adjacency_matrix() spent  0.012303829193115234
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08656835556030273
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3009121417999268
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1760318279266357

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter()
Convert a graph into a bidirected graph: 0.001 seconds
Metis partitioning: 0.047 seconds
Split the graph: 0.024 seconds
Construct subgraphs: 0.002 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.07544803619384766
11366
11368
11368
11368
11367
11368
11368
11368
total k batches seeds list generation spend  9.993359565734863
after graph partition
graph partition algorithm spend time 10.102445840835571
11366
11368
11368
11368
11367
11368
11368
11368
partition_len_list
[61871, 63337, 63128, 62965, 63189, 63237, 62638, 62557]
shared_neighbor_graph_partition_s0 selection method  spend 10.19519305229187
time for parepare:  0.016299009323120117
local_output_nid generation:  0.0018734931945800781
local_in_edges_tensor generation:  0.0020401477813720703
mini_batch_src_global generation:  0.003063678741455078
r_  generation:  0.030634403228759766
local_output_nid generation:  0.0025827884674072266
local_in_edges_tensor generation:  0.0020177364349365234
mini_batch_src_global generation:  0.003669261932373047
r_  generation:  0.032941341400146484
local_output_nid generation:  0.0028302669525146484
local_in_edges_tensor generation:  0.002064228057861328
mini_batch_src_global generation:  0.0027425289154052734
r_  generation:  0.0339202880859375
local_output_nid generation:  0.0028486251831054688
local_in_edges_tensor generation:  0.0021467208862304688
mini_batch_src_global generation:  0.0027208328247070312
r_  generation:  0.03413677215576172
local_output_nid generation:  0.0028710365295410156
local_in_edges_tensor generation:  0.002279043197631836
mini_batch_src_global generation:  0.0028285980224609375
r_  generation:  0.03484487533569336
local_output_nid generation:  0.0028052330017089844
local_in_edges_tensor generation:  0.002315044403076172
mini_batch_src_global generation:  0.0029239654541015625
r_  generation:  0.03489065170288086
local_output_nid generation:  0.0028433799743652344
local_in_edges_tensor generation:  0.0021538734436035156
mini_batch_src_global generation:  0.0029523372650146484
r_  generation:  0.034459590911865234
local_output_nid generation:  0.002788543701171875
local_in_edges_tensor generation:  0.0021047592163085938
mini_batch_src_global generation:  0.002886056900024414
r_  generation:  0.03479337692260742
----------------------check_connections_block total spend ----------------------------- 0.41663432121276855
generate_one_block  0.05725216865539551
generate_one_block  0.0517117977142334
generate_one_block  0.051819801330566406
generate_one_block  0.05138754844665527
generate_one_block  0.05257534980773926
generate_one_block  0.052153825759887695
generate_one_block  0.053513288497924805
generate_one_block  0.05393815040588379
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.021007299423217773
gen group dst list time:  0.014538049697875977
time for parepare:  0.019057512283325195
local_output_nid generation:  0.01214456558227539
local_in_edges_tensor generation:  0.01686239242553711
mini_batch_src_global generation:  0.014338254928588867
r_  generation:  0.16181516647338867
local_output_nid generation:  0.018275022506713867
local_in_edges_tensor generation:  0.013180017471313477
mini_batch_src_global generation:  0.01839137077331543
r_  generation:  0.1738290786743164
local_output_nid generation:  0.017856836318969727
local_in_edges_tensor generation:  0.014128923416137695
mini_batch_src_global generation:  0.01749134063720703
r_  generation:  0.17749834060668945
local_output_nid generation:  0.017894983291625977
local_in_edges_tensor generation:  0.01580023765563965
mini_batch_src_global generation:  0.018756628036499023
r_  generation:  0.1767597198486328
local_output_nid generation:  0.017984867095947266
local_in_edges_tensor generation:  0.014807939529418945
mini_batch_src_global generation:  0.020062923431396484
r_  generation:  0.17801475524902344
local_output_nid generation:  0.017694950103759766
local_in_edges_tensor generation:  0.012793302536010742
mini_batch_src_global generation:  0.021891117095947266
r_  generation:  0.17969107627868652
local_output_nid generation:  0.01791524887084961
local_in_edges_tensor generation:  0.012938499450683594
mini_batch_src_global generation:  0.02266073226928711
r_  generation:  0.17828130722045898
local_output_nid generation:  0.018671274185180664
local_in_edges_tensor generation:  0.014781475067138672
mini_batch_src_global generation:  0.02344036102294922
r_  generation:  0.18069148063659668
----------------------check_connections_block total spend ----------------------------- 2.190821886062622
generate_one_block  0.21785235404968262
generate_one_block  0.22827744483947754
generate_one_block  0.22806930541992188
generate_one_block  0.2232074737548828
generate_one_block  0.22263288497924805
generate_one_block  0.22516369819641113
generate_one_block  0.21643280982971191
generate_one_block  0.21621227264404297
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0832066535949707  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

connection checking time:  2.190821886062622
block generation total time  1.777848243713379
average batch blocks generation time:  0.22223103046417236
block dataloader generation time/epoch 15.297157526016235
pseudo mini batch 0 input nodes size: 122147
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07158470153808594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07158470153808594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.12982892990112305  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.1299138069152832  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.07112646102905273  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0760641098022461  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0760641098022461  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0760641098022461  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([122147, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.0760641098022461  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([3175, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30298757553100586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.30298757553100586  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3175, 128]), torch.Size([1, 3175, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3060154914855957  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33023881912231445  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3175, 128])
m.shape torch.Size([4001, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33254051208496094  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.33254051208496094  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4001, 128]), torch.Size([1, 4001, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3371100425720215  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.3954319953918457  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4001, 128])
m.shape torch.Size([4049, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.39931631088256836  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.39931631088256836  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4049, 128]), torch.Size([1, 4049, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.40349435806274414  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.48952150344848633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4049, 128])
m.shape torch.Size([3814, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4946861267089844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4946861267089844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3814, 128]), torch.Size([1, 3814, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.4983806610107422  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6045336723327637  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3814, 128])
m.shape torch.Size([3667, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6114578247070312  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.6114578247070312  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3667, 128]), torch.Size([1, 3667, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.614954948425293  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7417259216308594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3667, 128])
m.shape torch.Size([3192, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7491097450256348  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.7491097450256348  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3192, 128]), torch.Size([1, 3192, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.752382755279541  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.8850045204162598  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3192, 128])
m.shape torch.Size([2971, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.894136905670166  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.894136905670166  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2971, 128]), torch.Size([1, 2971, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 0.8970675468444824  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0387964248657227  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2971, 128])
m.shape torch.Size([2824, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0481524467468262  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0481524467468262  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2824, 128]), torch.Size([1, 2824, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.0511741638183594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.2100472450256348  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2824, 128])
m.shape torch.Size([2497, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.219416618347168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.219416618347168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2497, 128]), torch.Size([1, 2497, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.221949577331543  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.3788108825683594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2497, 128])
m.shape torch.Size([31681, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5282063484191895  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5282063484191895  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 31681, 128]), torch.Size([1, 31681, 128])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 1.5584197044372559  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.703688144683838  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 31681, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.4977025985717773  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.5567073822021484  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.6157121658325195  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.556246280670166  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([61871, 256])
first layer input nodes number: 122147
first layer output nodes number: 61871
edges number: 458739
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.616624355316162  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.675629138946533  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.690380573272705  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.690380573272705  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([1687, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7808218002319336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.7808218002319336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1687, 256]), torch.Size([1, 1687, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.784548282623291  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.812119960784912  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1687, 256])
m.shape torch.Size([1464, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.813302516937256  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.813302516937256  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1464, 256]), torch.Size([1, 1464, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8162331581115723  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.861556053161621  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1464, 256])
m.shape torch.Size([1206, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.864375591278076  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.864375591278076  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1206, 256]), torch.Size([1, 1206, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.8669028282165527  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9250741004943848  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1206, 256])
m.shape torch.Size([888, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.926414966583252  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.926414966583252  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 888, 256]), torch.Size([1, 888, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9281086921691895  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.977226734161377  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 888, 256])
m.shape torch.Size([806, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.980834484100342  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.980834484100342  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 806, 256]), torch.Size([1, 806, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 3.9823718070983887  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.037715435028076  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 806, 256])
m.shape torch.Size([604, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.040430068969727  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.040430068969727  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.041582107543945  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.091592788696289  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([533, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.094603061676025  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.094603061676025  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.0956196784973145  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.147418022155762  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([443, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.15031623840332  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.15031623840332  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.151161193847656  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.200686454772949  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([368, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.203447341918945  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.203447341918945  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 368, 256]), torch.Size([1, 368, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.20414924621582  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.24940299987793  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 368, 256])
m.shape torch.Size([314, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.252070426940918  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.252070426940918  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.252669334411621  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.296726226806641  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([252, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.299091339111328  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.299091339111328  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.299571990966797  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.337062835693359  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([219, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.339348793029785  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.339348793029785  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.339766502380371  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.375271797180176  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([223, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.377849578857422  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.377849578857422  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.378274917602539  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.41740608215332  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4197235107421875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4197235107421875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.420082092285156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4555816650390625  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([192, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.458170413970947  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.458170413970947  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.458536624908447  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.497354984283447  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4994635581970215  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4994635581970215  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.4997477531433105  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.531861782073975  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.533827781677246  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.533827781677246  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.534073829650879  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.563599586486816  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([124, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.565621852874756  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.565621852874756  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.565858364105225  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.595895290374756  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([85, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5977091789245605  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.5977091789245605  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.59787130355835  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.619596004486084  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6213603019714355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6213603019714355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6215434074401855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6473612785339355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.649005889892578  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.649005889892578  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.649169921875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6734466552734375  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.675014019012451  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.675014019012451  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.6751627922058105  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.698222637176514  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699496746063232  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699496746063232  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.699613094329834  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.718461513519287  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.719833850860596  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.719833850860596  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 6.9295654296875 GB
    Memory Allocated: 4.71995210647583  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 4.7399373054504395  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1109, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 4.766525745391846  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 4.766525745391846  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1109, 256]), torch.Size([1, 1109, 256])
----------------------------------------3
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 4.768677234649658  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.150013446807861  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1109, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.069680690765381  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.071753978729248  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.073827266693115  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.071669101715088  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([11366, 40])
input nodes number: 61871
output nodes number: 11366
edges number: 91459
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.072594165802002  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9393310546875 GB
    Memory Allocated: 5.072595119476318  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.08364725112915039  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

pseudo mini batch 1 input nodes size: 123245
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07150650024414062  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07150650024414062  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.13027429580688477  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.13035917282104492  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07203006744384766  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07625293731689453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07625293731689453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07625293731689453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([123245, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.07625293731689453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([3094, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.31036853790283203  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.31036853790283203  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3094, 128]), torch.Size([1, 3094, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.31331920623779297  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.33716392517089844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3094, 128])
m.shape torch.Size([4022, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.3400306701660156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.3400306701660156  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4022, 128]), torch.Size([1, 4022, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.3443727493286133  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.4028892517089844  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4022, 128])
m.shape torch.Size([4058, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.406494140625  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.406494140625  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 4058, 128]), torch.Size([1, 4058, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.4106292724609375  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.4966907501220703  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 4058, 128])
m.shape torch.Size([3862, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.5024957656860352  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.5024957656860352  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3862, 128]), torch.Size([1, 3862, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.5062379837036133  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.6197214126586914  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3862, 128])
m.shape torch.Size([3670, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.6266298294067383  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.6266298294067383  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3670, 128]), torch.Size([1, 3670, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.6302213668823242  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.7567834854125977  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3670, 128])
m.shape torch.Size([3276, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.7644062042236328  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.7644062042236328  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 3276, 128]), torch.Size([1, 3276, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.7676563262939453  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.9087839126586914  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 3276, 128])
m.shape torch.Size([2939, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.9170317649841309  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.9170317649841309  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2939, 128]), torch.Size([1, 2939, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 0.9199953079223633  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.0601377487182617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2939, 128])
m.shape torch.Size([2821, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.0699477195739746  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.0699477195739746  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2821, 128]), torch.Size([1, 2821, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.0726380348205566  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.2316584587097168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2821, 128])
m.shape torch.Size([2576, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.2406692504882812  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.2406692504882812  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 2576, 128]), torch.Size([1, 2576, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.2432947158813477  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.4028329849243164  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 2576, 128])
m.shape torch.Size([33019, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.559051513671875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.559051513671875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 33019, 128]), torch.Size([1, 33019, 128])
----------------------------------------3
 Nvidia-smi: 6.9432373046875 GB
    Memory Allocated: 1.590540885925293  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8262863159179688  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 33019, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6111245155334473  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6716713905334473  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.73207426071167  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.671055316925049  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

torch.Size([63337, 256])
first layer input nodes number: 123245
first layer output nodes number: 63337
edges number: 473281
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.732994556427002  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7933974266052246  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8084983825683594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8084983825683594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

m.shape torch.Size([1664, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9006118774414062  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9006118774414062  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1664, 256]), torch.Size([1, 1664, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.90457820892334  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9309892654418945  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1664, 256])
m.shape torch.Size([1495, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.932987689971924  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.932987689971924  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1495, 256]), torch.Size([1, 1495, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.935936450958252  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9790005683898926  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1495, 256])
m.shape torch.Size([1166, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9813389778137207  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9813389778137207  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1166, 256]), torch.Size([1, 1166, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9838171005249023  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.0369439125061035  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 1166, 256])
m.shape torch.Size([931, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.039175033569336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.039175033569336  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 931, 256]), torch.Size([1, 931, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.040950775146484  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.095268249511719  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 931, 256])
m.shape torch.Size([783, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.098196506500244  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.098196506500244  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 783, 256]), torch.Size([1, 783, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.099689960479736  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.159851551055908  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 783, 256])
m.shape torch.Size([571, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.162397861480713  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.162397861480713  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.163486957550049  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.211287975311279  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([488, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.214026927947998  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.214026927947998  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.2149577140808105  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.2635722160339355  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([441, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.26649808883667  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.26649808883667  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.26733922958374  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.315429210662842  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([390, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.318382263183594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.318382263183594  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.319126129150391  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.367841720581055  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([307, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.370420455932617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.370420455932617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.371006011962891  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.416720867156982  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.419399261474609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.419399261474609  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.41993522644043  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4625654220581055  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([228, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4649271965026855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4649271965026855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.465362071990967  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.502326488494873  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([187, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.504445552825928  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.504445552825928  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.504802227020264  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.53761625289917  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([167, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.539685249328613  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.539685249328613  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.540003776550293  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.571537971496582  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([167, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.574124336242676  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.574124336242676  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5744428634643555  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.608206748962402  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.610246658325195  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.610246658325195  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6105194091796875  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.641340255737305  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([121, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.643181324005127  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.643181324005127  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.643412113189697  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.671106815338135  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.673033237457275  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.673033237457275  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.673258304595947  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.701841831207275  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([116, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.703847885131836  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.703847885131836  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.704069137573242  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.73371696472168  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([104, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.735605716705322  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.735605716705322  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.735804080963135  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.763773441314697  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([80, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.765289306640625  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.765289306640625  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.76544189453125  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.78802490234375  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.789365768432617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.789365768432617  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.789493560791016  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.809301376342773  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.810807228088379  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.810807228088379  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.810942649841309  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.832880973815918  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.834197521209717  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.834197521209717  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8343119621276855  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.853652477264404  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1222, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.882957935333252  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.882957935333252  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

 h.shape torch.Size([1, 1222, 256]), torch.Size([1, 1222, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.885288715362549  GigaBytes
Max Memory Allocated: 5.33390998840332  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.3099141120910645  GigaBytes
Max Memory Allocated: 5.339048862457275  GigaBytes

rst.shape  torch.Size([1, 1222, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.2299041748046875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.231598377227783  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.233292579650879  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.231513500213623  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 63337
output nodes number: 11368
edges number: 93372
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.231691360473633  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.231691837310791  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08325481414794922  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 2 input nodes size: 123090
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07165098190307617  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07165098190307617  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13034486770629883  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13042974472045898  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07157707214355469  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07589006423950195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07589006423950195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07589006423950195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([123090, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07589006423950195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3090, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.308042049407959  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.308042049407959  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3090, 128]), torch.Size([1, 3090, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3109889030456543  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3345637321472168  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3090, 128])
m.shape torch.Size([3999, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33744192123413086  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33744192123413086  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3999, 128]), torch.Size([1, 3999, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3417935371398926  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40030670166015625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3999, 128])
m.shape torch.Size([4088, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40387773513793945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40387773513793945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4088, 128]), torch.Size([1, 4088, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40810394287109375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4941840171813965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4088, 128])
m.shape torch.Size([3924, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5000319480895996  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5000319480895996  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5037741661071777  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6171565055847168  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([3586, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6231789588928223  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6231789588928223  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3586, 128]), torch.Size([1, 3586, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.627570629119873  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7539525032043457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3586, 128])
m.shape torch.Size([3298, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7625021934509277  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7625021934509277  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3298, 128]), torch.Size([1, 3298, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7656474113464355  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9055113792419434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3298, 128])
m.shape torch.Size([2981, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9132289886474609  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9132289886474609  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2981, 128]), torch.Size([1, 2981, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9168829917907715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0599350929260254  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2981, 128])
m.shape torch.Size([2796, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.06988525390625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.06988525390625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2796, 128]), torch.Size([1, 2796, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.072634220123291  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.231550693511963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2796, 128])
m.shape torch.Size([2522, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2410407066345215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2410407066345215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2522, 128]), torch.Size([1, 2522, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.243445873260498  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.399461269378662  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2522, 128])
m.shape torch.Size([32844, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5548710823059082  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5548710823059082  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32844, 128]), torch.Size([1, 32844, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.586193561553955  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.810089588165283  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.5988259315490723  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.659029483795166  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7192330360412598  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6585588455200195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([63128, 256])
first layer input nodes number: 123090
first layer output nodes number: 63128
edges number: 471139
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7201523780822754  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.780355930328369  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7954068183898926  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7954068183898926  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1623, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8882408142089844  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8882408142089844  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1623, 256]), torch.Size([1, 1623, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8916397094726562  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9184036254882812  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1623, 256])
m.shape torch.Size([1450, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9193830490112305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9193830490112305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1450, 256]), torch.Size([1, 1450, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9226646423339844  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9667015075683594  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1450, 256])
m.shape torch.Size([1157, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.968789577484131  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.968789577484131  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9710211753845215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.023338794708252  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
m.shape torch.Size([905, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.02542781829834  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.02542781829834  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 905, 256]), torch.Size([1, 905, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.027153968811035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.0822248458862305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 905, 256])
m.shape torch.Size([769, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.08526086807251  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.08526086807251  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 769, 256]), torch.Size([1, 769, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.086727619171143  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.145580768585205  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 769, 256])
m.shape torch.Size([611, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.14837121963501  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.14837121963501  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 611, 256]), torch.Size([1, 611, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.149536609649658  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.200955867767334  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 611, 256])
m.shape torch.Size([498, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.203723907470703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.203723907470703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.204673767089844  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.253413677215576  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([455, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.256437301635742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.256437301635742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.257305145263672  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.308139801025391  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([386, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.311045169830322  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.311045169830322  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.311781406402588  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.359289646148682  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([302, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3618245124816895  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3618245124816895  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.362400531768799  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.403828144073486  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([290, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.406606197357178  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.406606197357178  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.407159328460693  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.451892375946045  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([253, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.45453405380249  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.45453405380249  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.455016613006592  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.496034145355225  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.498366832733154  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.498366832733154  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.498759746551514  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.534907817840576  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([171, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.537012577056885  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.537012577056885  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.537338733673096  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5696282386779785  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([160, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.57177209854126  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.57177209854126  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.57207727432251  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.60442590713501  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.606410980224609  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.606410980224609  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.60667610168457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.636634826660156  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6387248039245605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6387248039245605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.638984203338623  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.670112133026123  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.672179698944092  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.672179698944092  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.672421932220459  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.703185558319092  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.705018520355225  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.705018520355225  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7052226066589355  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.732570171356201  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([108, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.734544277191162  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.734544277191162  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.734750270843506  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.763795375823975  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.765892505645752  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.765892505645752  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7661004066467285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.79686975479126  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.798635005950928  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.798635005950928  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.798766613006592  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8191657066345215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.820581436157227  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.820581436157227  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.820709228515625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.841411590576172  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([79, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.843170166015625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.843170166015625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.843320846557617  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.868785858154297  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([1191, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8973283767700195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8973283767700195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1191, 256]), torch.Size([1, 1191, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.899892807006836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.30310583114624  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1191, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.221088886260986  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.222897052764893  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.224705219268799  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.222812175750732  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 63128
output nodes number: 11368
edges number: 94477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.22348165512085  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.223482131958008  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08353185653686523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 3 input nodes size: 123056
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07169103622436523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07169103622436523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13036870956420898  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13045358657836914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07167482376098633  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07619237899780273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07619237899780273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07619237899780273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([123056, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07619237899780273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3251, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3066368103027344  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3066368103027344  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3251, 128]), torch.Size([1, 3251, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3097372055053711  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33617639541625977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3251, 128])
m.shape torch.Size([4077, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3385143280029297  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3385143280029297  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4077, 128]), torch.Size([1, 4077, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.34240245819091797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4009418487548828  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4077, 128])
m.shape torch.Size([4096, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40490245819091797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40490245819091797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4096, 128]), torch.Size([1, 4096, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40880870819091797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.49474620819091797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4096, 128])
m.shape torch.Size([3819, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.500605583190918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.500605583190918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3819, 128]), torch.Size([1, 3819, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5044846534729004  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.610105037689209  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3819, 128])
m.shape torch.Size([3649, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6173892021179199  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6173892021179199  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3649, 128]), torch.Size([1, 3649, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6208691596984863  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7469305992126465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3649, 128])
m.shape torch.Size([3248, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7544832229614258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7544832229614258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3248, 128]), torch.Size([1, 3248, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7577610015869141  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.8991332054138184  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3248, 128])
m.shape torch.Size([3044, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9067988395690918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9067988395690918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3044, 128]), torch.Size([1, 3044, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9097018241882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0607295036315918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3044, 128])
m.shape torch.Size([2803, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.070889949798584  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.070889949798584  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2803, 128]), torch.Size([1, 2803, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0736589431762695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2325820922851562  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2803, 128])
m.shape torch.Size([2540, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2421460151672363  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2421460151672363  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2540, 128]), torch.Size([1, 2540, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2446293830871582  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.4007267951965332  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2540, 128])
m.shape torch.Size([32438, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.554039478302002  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.554039478302002  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32438, 128]), torch.Size([1, 32438, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.584974765777588  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.800407886505127  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32438, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.5892534255981445  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.649301528930664  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7093496322631836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.648832321166992  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([62965, 256])
first layer input nodes number: 123056
first layer output nodes number: 62965
edges number: 467674
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.710268497467041  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7703166007995605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7853288650512695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7853288650512695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1739, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8780627250671387  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8780627250671387  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1739, 256]), torch.Size([1, 1739, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8818278312683105  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.909369468688965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1739, 256])
m.shape torch.Size([1490, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9105753898620605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9105753898620605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1490, 256]), torch.Size([1, 1490, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9136977195739746  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9572529792785645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1490, 256])
m.shape torch.Size([1161, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9599218368530273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9599218368530273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.962338924407959  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.0139689445495605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
m.shape torch.Size([862, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.016951084136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.016951084136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.018595218658447  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.0755791664123535  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([751, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.078848838806152  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.078848838806152  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 751, 256]), torch.Size([1, 751, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.0802812576293945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.132363319396973  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 751, 256])
m.shape torch.Size([600, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.135107517242432  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.135107517242432  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 600, 256]), torch.Size([1, 600, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.136251926422119  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.185591220855713  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 600, 256])
m.shape torch.Size([486, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.188289165496826  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.188289165496826  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.189216136932373  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.23615026473999  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([439, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.239062309265137  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.239062309265137  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.239899635314941  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.287840843200684  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([367, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.290596961975098  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.290596961975098  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.29129695892334  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.336517333984375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([328, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.339320182800293  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.339320182800293  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3399457931518555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.385265350341797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([263, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.388239860534668  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.388239860534668  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.388741493225098  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.42958927154541  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([222, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.431899070739746  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.431899070739746  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4323225021362305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.468314170837402  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4709014892578125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4709014892578125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4713287353515625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5106353759765625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([183, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.512884616851807  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.512884616851807  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.513233661651611  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.547789096832275  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.549950122833252  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.549950122833252  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.550259113311768  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.583012104034424  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([153, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585210800170898  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585210800170898  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585502624511719  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.618478775024414  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([115, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.620289325714111  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.620289325714111  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.620508670806885  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.646830081939697  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.648831367492676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.648831367492676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.649064064025879  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.678616523742676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([95, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.680235385894775  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.680235385894775  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.680416584014893  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.704697132110596  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.706432819366455  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.706432819366455  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.706614017486572  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.732162952423096  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([83, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.733747959136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.733747959136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.733906269073486  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.757336139678955  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([72, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.759637832641602  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.759637832641602  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.759775161743164  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.781061172485352  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.782252788543701  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.782252788543701  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7823615074157715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.799973964691162  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.801695823669434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.801695823669434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.80184268951416  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.826663017272949  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([1222, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.855952262878418  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.855952262878418  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1222, 256]), torch.Size([1, 1222, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.858505725860596  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.282622814178467  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1222, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.201226711273193  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.203075885772705  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.205406665802002  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.20347261428833  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 62965
output nodes number: 11368
edges number: 93303
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.204067707061768  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.204068183898926  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08356046676635742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 4 input nodes size: 122794
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0717158317565918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0717158317565918  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13026857376098633  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13035345077514648  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07159090042114258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07603311538696289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07603311538696289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07603311538696289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([122794, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07603311538696289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3248, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30706787109375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30706787109375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3248, 128]), torch.Size([1, 3248, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3101654052734375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3361053466796875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3248, 128])
m.shape torch.Size([4047, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33765411376953125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33765411376953125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4047, 128]), torch.Size([1, 4047, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3416290283203125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4000825881958008  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4047, 128])
m.shape torch.Size([4140, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40407514572143555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40407514572143555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4140, 128]), torch.Size([1, 4140, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4080328941345215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.49489355087280273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4140, 128])
m.shape torch.Size([3899, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.500648021697998  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.500648021697998  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3899, 128]), torch.Size([1, 3899, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5044283866882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6169033050537109  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3899, 128])
m.shape torch.Size([3737, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6243400573730469  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6243400573730469  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3737, 128]), torch.Size([1, 3737, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6279873847961426  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7571158409118652  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3737, 128])
m.shape torch.Size([3337, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7648811340332031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7648811340332031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3337, 128]), torch.Size([1, 3337, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7682366371154785  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.908635139465332  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3337, 128])
m.shape torch.Size([2950, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9170279502868652  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9170279502868652  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2950, 128]), torch.Size([1, 2950, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9200258255004883  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.061568260192871  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2950, 128])
m.shape torch.Size([2756, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0706748962402344  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0706748962402344  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2756, 128]), torch.Size([1, 2756, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0734138488769531  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2235097885131836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2756, 128])
m.shape torch.Size([2530, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.233053207397461  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.233053207397461  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2530, 128]), torch.Size([1, 2530, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2355422973632812  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.3929100036621094  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2530, 128])
m.shape torch.Size([32545, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5468902587890625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5468902587890625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32545, 128]), torch.Size([1, 32545, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.577927589416504  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7943382263183594  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32545, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.5839076042175293  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.644169330596924  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7044310569763184  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.643698215484619  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([63189, 256])
first layer input nodes number: 122794
first layer output nodes number: 63189
edges number: 468983
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.705348014831543  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7656097412109375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7806754112243652  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7806754112243652  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1629, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8732638359069824  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8732638359069824  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1629, 256]), torch.Size([1, 1629, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8770527839660645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9041290283203125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1629, 256])
m.shape torch.Size([1422, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9055233001708984  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9055233001708984  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1422, 256]), torch.Size([1, 1422, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9084787368774414  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9499053955078125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1422, 256])
m.shape torch.Size([1137, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.952587604522705  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.952587604522705  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1137, 256]), torch.Size([1, 1137, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9548187255859375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.003398895263672  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1137, 256])
m.shape torch.Size([939, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.006139278411865  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.006139278411865  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.007930278778076  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.065036296844482  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.068182945251465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.068182945251465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.069695472717285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.124215126037598  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([629, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.127086162567139  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.127086162567139  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.128285884857178  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.1804938316345215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.1835808753967285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.1835808753967285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.18462610244751  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.238413333892822  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([427, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.241174221038818  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.241174221038818  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.241988658905029  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.289102077484131  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([351, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.291731357574463  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.291731357574463  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.29240083694458  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.336495876312256  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([334, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.339371681213379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.339371681213379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.340008735656738  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.386353015899658  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([283, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.389026641845703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.389026641845703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.389566421508789  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.433000564575195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([252, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.435637474060059  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.435637474060059  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.436118125915527  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.476973533630371  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([200, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.479232311248779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.479232311248779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.479613780975342  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.514708995819092  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([201, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.517222881317139  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.517222881317139  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.517606258392334  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.55556058883667  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([139, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.557373046875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.557373046875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.557638168334961  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.58574104309082  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([112, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.587560653686523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.587560653686523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.587774276733398  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.611913681030273  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([132, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.613964080810547  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.613964080810547  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.614215850830078  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.644428253173828  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6461710929870605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6461710929870605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.646377086639404  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6725382804870605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.674407958984375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.674407958984375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.674613952636719  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.702217102050781  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7043633460998535  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7043633460998535  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.704586505889893  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7360520362854  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.737777233123779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.737777233123779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.737950801849365  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.763638973236084  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.764800071716309  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.764800071716309  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7649126052856445  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.782355308532715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.783581256866455  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.783581256866455  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.783691883087158  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8016133308410645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.80296516418457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.80296516418457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.803081512451172  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.822744369506836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([1237, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.852409362792969  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.852409362792969  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1237, 256]), torch.Size([1, 1237, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8553466796875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.2815470695495605  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1237, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.199958801269531  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.20231819152832  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.204012393951416  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.201568126678467  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11367, 40])
input nodes number: 63189
output nodes number: 11367
edges number: 94070
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.202634334564209  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.202634811401367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08389520645141602  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 5 input nodes size: 123271
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07210111618041992  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07210111618041992  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13088130950927734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.1309661865234375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07232856750488281  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([123271, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07674551010131836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3157, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30872297286987305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30872297286987305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3157, 128]), torch.Size([1, 3157, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3117337226867676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3367958068847656  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3157, 128])
m.shape torch.Size([3987, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33948230743408203  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33948230743408203  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3987, 128]), torch.Size([1, 3987, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3436741828918457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40195608139038086  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3987, 128])
m.shape torch.Size([4154, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40599727630615234  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40599727630615234  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 4154, 128]), torch.Size([1, 4154, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.41005611419677734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4972105026245117  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 4154, 128])
m.shape torch.Size([3885, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5029315948486328  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5029315948486328  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3885, 128]), torch.Size([1, 3885, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5066719055175781  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.618959903717041  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3885, 128])
m.shape torch.Size([3824, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6263699531555176  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6263699531555176  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3824, 128]), torch.Size([1, 3824, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6308507919311523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7621374130249023  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3824, 128])
m.shape torch.Size([3366, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7699441909790039  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7699441909790039  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3366, 128]), torch.Size([1, 3366, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7734456062316895  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9133744239807129  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3366, 128])
m.shape torch.Size([3066, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9220032691955566  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9220032691955566  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3066, 128]), torch.Size([1, 3066, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.924980640411377  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.076225757598877  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3066, 128])
m.shape torch.Size([2847, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0864596366882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0864596366882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2847, 128]), torch.Size([1, 2847, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.089174747467041  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2481398582458496  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2847, 128])
m.shape torch.Size([2633, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.259000301361084  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.259000301361084  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2633, 128]), torch.Size([1, 2633, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2615771293640137  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.426546573638916  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2633, 128])
m.shape torch.Size([32318, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5793952941894531  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5793952941894531  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32318, 128]), torch.Size([1, 32318, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.6102161407470703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8233871459960938  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32318, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6118111610412598  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6723580360412598  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.732665538787842  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.671647071838379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([63237, 256])
first layer input nodes number: 123271
first layer output nodes number: 63237
edges number: 469564
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.733586311340332  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.793893814086914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8089709281921387  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8089709281921387  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1660, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.901817798614502  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.901817798614502  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1660, 256]), torch.Size([1, 1660, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9056758880615234  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9323415756225586  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1660, 256])
m.shape torch.Size([1444, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9336957931518555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9336957931518555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1444, 256]), torch.Size([1, 1444, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.937346935272217  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.979163646697998  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1444, 256])
m.shape torch.Size([1133, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9816813468933105  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9816813468933105  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1133, 256]), torch.Size([1, 1133, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.983999729156494  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.033901214599609  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1133, 256])
m.shape torch.Size([903, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.03696870803833  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.03696870803833  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 903, 256]), torch.Size([1, 903, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.03869104385376  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.096752643585205  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 903, 256])
m.shape torch.Size([763, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.100040912628174  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.100040912628174  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.10149621963501  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.154543399810791  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([649, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.157558441162109  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.157558441162109  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.158796310424805  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.212118148803711  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([498, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.214849948883057  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.214849948883057  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.215799808502197  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.264429569244385  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([427, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.267238140106201  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.267238140106201  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.268052577972412  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3144755363464355  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([385, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.317399024963379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.317399024963379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.318133354187012  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.366453170776367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([335, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3693060874938965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3693060874938965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.369945049285889  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.416491985321045  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([301, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4193549156188965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4193549156188965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.419929027557373  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.465286731719971  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([240, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.467767715454102  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.467767715454102  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.468225479125977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.507135391235352  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([208, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.509505748748779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.509505748748779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.509902477264404  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.546401500701904  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([182, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.548652172088623  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.548652172088623  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.548999309539795  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5833659172058105  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([180, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585787773132324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585787773132324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5861310958862305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.622523307800293  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([155, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.624735355377197  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.624735355377197  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.625030994415283  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.658438205718994  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([123, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.660617828369141  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.660617828369141  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.660852432250977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.689004898071289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.690998554229736  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.690998554229736  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6912312507629395  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.720783710479736  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([116, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.722785949707031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.722785949707031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7230072021484375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.752655029296875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.754312992095947  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.754312992095947  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.754488468170166  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.77923059463501  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.781000137329102  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.781000137329102  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.78117561340332  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.807146072387695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([75, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8086442947387695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8086442947387695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8087873458862305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.830960273742676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.832347869873047  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.832347869873047  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8324737548828125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.852867126464844  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.85430383682251  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.85430383682251  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.854427814483643  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.875380039215088  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([1154, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.903046607971191  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.903046607971191  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1154, 256]), torch.Size([1, 1154, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.905247688293457  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.305665016174316  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1154, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.224750518798828  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.226444721221924  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.2281389236450195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.226359844207764  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 63237
output nodes number: 11368
edges number: 93449
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.226251125335693  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.226251602172852  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08343505859375  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 6 input nodes size: 123160
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07166337966918945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07166337966918945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13039064407348633  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13047552108764648  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0716104507446289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07654142379760742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07654142379760742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07654142379760742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([123160, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07654142379760742  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3194, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3067502975463867  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3067502975463867  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3194, 128]), torch.Size([1, 3194, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3097963333129883  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3341646194458008  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3194, 128])
m.shape torch.Size([3976, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33643341064453125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33643341064453125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3976, 128]), torch.Size([1, 3976, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3413834571838379  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.39963388442993164  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3976, 128])
m.shape torch.Size([3981, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40343284606933594  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40343284606933594  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3981, 128]), torch.Size([1, 3981, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.40767765045166016  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4933958053588867  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3981, 128])
m.shape torch.Size([3860, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.49909067153930664  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.49909067153930664  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3860, 128]), torch.Size([1, 3860, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5028223991394043  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6164326667785645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3860, 128])
m.shape torch.Size([3718, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.622556209564209  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.622556209564209  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3718, 128]), torch.Size([1, 3718, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6271319389343262  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7551093101501465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3718, 128])
m.shape torch.Size([3361, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7629523277282715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7629523277282715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3361, 128]), torch.Size([1, 3361, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7664599418640137  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9063839912414551  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3361, 128])
m.shape torch.Size([3043, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9149384498596191  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9149384498596191  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3043, 128]), torch.Size([1, 3043, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9180641174316406  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0675387382507324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3043, 128])
m.shape torch.Size([2781, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0766963958740234  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0766963958740234  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2781, 128]), torch.Size([1, 2781, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.079580307006836  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.237931728363037  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2781, 128])
m.shape torch.Size([2541, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2475104331970215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2475104331970215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2541, 128]), torch.Size([1, 2541, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2500481605529785  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.4065942764282227  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2541, 128])
m.shape torch.Size([32183, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5588431358337402  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5588431358337402  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32183, 128]), torch.Size([1, 32183, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5895352363586426  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.768674373626709  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32183, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.559042453765869  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.618778705596924  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6785149574279785  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.618311882019043  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([62638, 256])
first layer input nodes number: 123160
first layer output nodes number: 62638
edges number: 465533
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6794347763061523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.739171028137207  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7541050910949707  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7541050910949707  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1670, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8443799018859863  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8443799018859863  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1670, 256]), torch.Size([1, 1670, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.848022937774658  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8752527236938477  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1670, 256])
m.shape torch.Size([1482, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8767433166503906  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8767433166503906  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1482, 256]), torch.Size([1, 1482, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8797173500061035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9238948822021484  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1482, 256])
m.shape torch.Size([1183, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9266934394836426  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9266934394836426  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1183, 256]), torch.Size([1, 1183, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.929008960723877  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.980750560760498  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1183, 256])
m.shape torch.Size([904, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9835495948791504  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.9835495948791504  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 904, 256]), torch.Size([1, 904, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.985273838043213  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.044117450714111  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 904, 256])
m.shape torch.Size([807, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.047471046447754  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.047471046447754  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 807, 256]), torch.Size([1, 807, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.049010276794434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.104422569274902  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 807, 256])
m.shape torch.Size([634, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.107820510864258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.107820510864258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.109029769897461  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.161680221557617  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([514, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.164534091949463  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.164534091949463  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 514, 256]), torch.Size([1, 514, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.1655144691467285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.21453332901001  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 514, 256])
m.shape torch.Size([424, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.217303276062012  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.217303276062012  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.218111991882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.264897346496582  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([366, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.2676591873168945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.2676591873168945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.268357276916504  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3137102127075195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([352, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.31756067276001  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.31756067276001  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.31823205947876  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.367403507232666  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([264, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.369859218597412  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.369859218597412  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.370362758636475  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4131598472595215  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.41583776473999  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.41583776473999  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.416322231292725  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.4575018882751465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([195, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.459696292877197  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.459696292877197  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.460068225860596  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.494286060333252  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([162, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.496280193328857  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.496280193328857  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.496589183807373  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.52717924118042  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([143, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.529086589813232  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.529086589813232  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.529359340667725  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5582709312438965  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5599493980407715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5599493980407715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.560174465179443  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.585607051849365  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([142, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.587814807891846  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.587814807891846  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.588085651397705  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.62058687210083  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.622372150421143  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.622372150421143  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.622583866119385  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.649471759796143  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6513566970825195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6513566970825195  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.651564598083496  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6794233322143555  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([99, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.681222438812256  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.681222438812256  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.681411266326904  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.708035945892334  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([94, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7098388671875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7098388671875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.710018157958984  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.736553192138672  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7382588386535645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7382588386535645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.738396167755127  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7596821784973145  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.761072635650635  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.761072635650635  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7611985206604  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.781591892242432  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7829132080078125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7829132080078125  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.783027648925781  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8023681640625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1143, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.829775333404541  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.829775333404541  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1143, 256]), torch.Size([1, 1143, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.832006931304932  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.217823505401611  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.139460563659668  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.141154766082764  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.142848968505859  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.1410698890686035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 62638
output nodes number: 11368
edges number: 91784
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.1416215896606445  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.141622066497803  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0847172737121582  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

pseudo mini batch 7 input nodes size: 122645
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0716104507446289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0716104507446289  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13009214401245117  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.13017702102661133  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.0713648796081543  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07607173919677734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07607173919677734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07607173919677734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([122645, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.07607173919677734  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([3277, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30631589889526367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30631589889526367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3277, 128]), torch.Size([1, 3277, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.30944108963012695  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.3354949951171875  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3277, 128])
m.shape torch.Size([3959, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33705759048461914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.33705759048461914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3959, 128]), torch.Size([1, 3959, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.34096336364746094  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.39916515350341797  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3959, 128])
m.shape torch.Size([3933, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4029407501220703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4029407501220703  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3933, 128]), torch.Size([1, 3933, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4072389602661133  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.49286556243896484  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3933, 128])
m.shape torch.Size([3864, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4984917640686035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.4984917640686035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3864, 128]), torch.Size([1, 3864, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.5028314590454102  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6158914566040039  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3864, 128])
m.shape torch.Size([3656, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6232614517211914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6232614517211914  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3656, 128]), torch.Size([1, 3656, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.6267480850219727  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7529764175415039  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3656, 128])
m.shape torch.Size([3277, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7606086730957031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7606086730957031  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 3277, 128]), torch.Size([1, 3277, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.7639656066894531  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9053001403808594  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 3277, 128])
m.shape torch.Size([2937, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9135408401489258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9135408401489258  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2937, 128]), torch.Size([1, 2937, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.9163417816162109  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.0563888549804688  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2937, 128])
m.shape torch.Size([2758, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.06550931930542  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.06550931930542  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2758, 128]), torch.Size([1, 2758, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.068159580230713  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.2182183265686035  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2758, 128])
m.shape torch.Size([2515, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.227696418762207  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.227696418762207  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.230210781097412  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.3875656127929688  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 2515, 128])
m.shape torch.Size([32381, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5407710075378418  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5407710075378418  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 32381, 128]), torch.Size([1, 32381, 128])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 1.5716519355773926  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7856040000915527  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 32381, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.575737476348877  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.636284351348877  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.6959433555603027  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.63493013381958  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([62557, 256])
first layer input nodes number: 122645
first layer output nodes number: 62557
edges number: 465460
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.696859359741211  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7565183639526367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7714333534240723  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.7714333534240723  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

m.shape torch.Size([1756, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8624205589294434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8624205589294434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1756, 256]), torch.Size([1, 1756, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8661084175109863  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8933167457580566  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1756, 256])
m.shape torch.Size([1459, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8949027061462402  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.8949027061462402  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1459, 256]), torch.Size([1, 1459, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.89772367477417  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.941016674041748  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1459, 256])
m.shape torch.Size([1134, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.943741798400879  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.943741798400879  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1134, 256]), torch.Size([1, 1134, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.945981025695801  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.995500087738037  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1134, 256])
m.shape torch.Size([988, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.998457431793213  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 3.998457431793213  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 988, 256]), torch.Size([1, 988, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.000341892242432  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.058853626251221  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 988, 256])
m.shape torch.Size([750, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.06203031539917  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.06203031539917  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 750, 256]), torch.Size([1, 750, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.063460826873779  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.115859508514404  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 750, 256])
m.shape torch.Size([570, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.118431568145752  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.118431568145752  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.119518756866455  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.1662678718566895  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([480, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.168953895568848  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.168953895568848  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.169869422912598  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.215970039367676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([416, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.218710899353027  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.218710899353027  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.219504356384277  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.265507698059082  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([363, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.268797874450684  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.268797874450684  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.2694902420043945  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.314011573791504  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([327, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.316808700561523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.316808700561523  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.317432403564453  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.363151550292969  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3656840324401855  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.3656840324401855  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.366197109222412  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.408468723297119  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([269, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.411314964294434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.411314964294434  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.41182804107666  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.455508232116699  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.457913398742676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.457913398742676  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.458319664001465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.495696067810059  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([180, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.497915267944336  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.497915267944336  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.498258590698242  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.532247543334961  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([146, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.534181118011475  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.534181118011475  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.534459590911865  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5639777183532715  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([142, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5660223960876465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.5660223960876465  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.566293239593506  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.596898555755615  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([132, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.599829196929932  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.599829196929932  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.600080966949463  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.630293369293213  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([116, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.632174491882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.632174491882324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.6323957443237305  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.660494804382324  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.662210464477539  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.662210464477539  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.66240119934082  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.687959671020508  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.689709663391113  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.689709663391113  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.689892768859863  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.715710639953613  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.717274188995361  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.717274188995361  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.717430591583252  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7405781745910645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7418532371521  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7418532371521  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7419753074646  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7608962059021  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.762449264526367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.762449264526367  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7625885009765625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.785144805908203  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.786482334136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.786482334136963  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.7865986824035645  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.8062615394592285  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([1182, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.834604740142822  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.834604740142822  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

 h.shape torch.Size([1, 1182, 256]), torch.Size([1, 1182, 256])
----------------------------------------3
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 4.837673664093018  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.239840984344482  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

rst.shape  torch.Size([1, 1182, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.160572528839111  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.16265869140625  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.164352893829346  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.162181854248047  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

torch.Size([11368, 40])
input nodes number: 62557
output nodes number: 11368
edges number: 92336
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.16273307800293  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 5.162733554840088  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08428430557250977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08428430557250977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.5194091796875 GB
    Memory Allocated: 0.08428430557250977  GigaBytes
Max Memory Allocated: 5.341319561004639  GigaBytes
Using backend: pytorch

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04434400796890259 |0.0031448006629943848 |0.13144195079803467 |9.22083854675293e-05 |0.07614457607269287 |0.0045375823974609375 |
----------------------------------------------------------pseudo_mini_loss sum 3.084718704223633
Total (block generation + training)time/epoch 17.413565754890442
Training time/epoch 2.1062724590301514
Training time without block to device /epoch 2.0811140537261963
Training time without total dataloading part /epoch 1.6659674644470215
load block tensor time/epoch 0.3547520637512207
block to device time/epoch 0.025158405303955078
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1486330
Number of first layer input nodes during this epoch:  983408
Number of first layer output nodes during this epoch:  502922
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
