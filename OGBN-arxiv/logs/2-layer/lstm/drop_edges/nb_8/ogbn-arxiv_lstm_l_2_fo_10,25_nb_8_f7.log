[05:15:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510562 edges into 8 parts and get 5048 edge cuts
main start at this time 1651554928.7414908
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03429675102233887
global_2_local spend time (sec) 0.034992218017578125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004525661468505859
A = g.adjacency_matrix() spent  0.0075380802154541016
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0850827693939209
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2816007137298584
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1688282489776611

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 0.019 seconds
Metis partitioning: 0.072 seconds
Split the graph: 0.060 seconds
Construct subgraphs: 0.102 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2545197010040283
11513
11563
11483
11539
11559
11097
11101
11086
total k batches seeds list generation spend  10.424620151519775
after graph partition
graph partition algorithm spend time 10.501168966293335
11513
11563
11483
11539
11559
11097
11101
11086
partition_len_list
[48905, 51932, 45482, 44291, 39441, 43357, 44306, 44209]
shared_neighbor_graph_partition_s0 selection method  spend 10.58107590675354
time for parepare:  0.01630377769470215
local_output_nid generation:  0.0018706321716308594
local_in_edges_tensor generation:  0.002145051956176758
mini_batch_src_global generation:  0.0036895275115966797
r_  generation:  0.03723025321960449
local_output_nid generation:  0.002668619155883789
local_in_edges_tensor generation:  0.002423524856567383
mini_batch_src_global generation:  0.00552678108215332
r_  generation:  0.05039191246032715
local_output_nid generation:  0.0027031898498535156
local_in_edges_tensor generation:  0.002065896987915039
mini_batch_src_global generation:  0.0027379989624023438
r_  generation:  0.02677130699157715
local_output_nid generation:  0.0027289390563964844
local_in_edges_tensor generation:  0.002166271209716797
mini_batch_src_global generation:  0.002815723419189453
r_  generation:  0.03359365463256836
local_output_nid generation:  0.0026874542236328125
local_in_edges_tensor generation:  0.00222015380859375
mini_batch_src_global generation:  0.003723621368408203
r_  generation:  0.037180185317993164
local_output_nid generation:  0.002633810043334961
local_in_edges_tensor generation:  0.0019485950469970703
mini_batch_src_global generation:  0.002544403076171875
r_  generation:  0.02460622787475586
local_output_nid generation:  0.002523183822631836
local_in_edges_tensor generation:  0.0018796920776367188
mini_batch_src_global generation:  0.0020914077758789062
r_  generation:  0.023420095443725586
local_output_nid generation:  0.0024771690368652344
local_in_edges_tensor generation:  0.001847982406616211
mini_batch_src_global generation:  0.0019621849060058594
r_  generation:  0.02305769920349121
----------------------check_connections_block total spend ----------------------------- 0.3977837562561035
generate_one_block  0.05194711685180664
generate_one_block  0.06659913063049316
generate_one_block  0.037925004959106445
generate_one_block  0.047178030014038086
generate_one_block  0.05214977264404297
generate_one_block  0.035739898681640625
generate_one_block  0.03356432914733887
generate_one_block  0.03756904602050781
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02017354965209961
gen group dst list time:  0.010278463363647461
time for parepare:  0.019383907318115234
local_output_nid generation:  0.009176254272460938
local_in_edges_tensor generation:  0.013027191162109375
mini_batch_src_global generation:  0.011072635650634766
r_  generation:  0.13327646255493164
local_output_nid generation:  0.013741493225097656
local_in_edges_tensor generation:  0.009946584701538086
mini_batch_src_global generation:  0.0156857967376709
r_  generation:  0.15491294860839844
local_output_nid generation:  0.012130022048950195
local_in_edges_tensor generation:  0.009057044982910156
mini_batch_src_global generation:  0.01201939582824707
r_  generation:  0.1257767677307129
local_output_nid generation:  0.01147150993347168
local_in_edges_tensor generation:  0.008823156356811523
mini_batch_src_global generation:  0.012540102005004883
r_  generation:  0.11959266662597656
local_output_nid generation:  0.010079622268676758
local_in_edges_tensor generation:  0.008037567138671875
mini_batch_src_global generation:  0.011240243911743164
r_  generation:  0.1088247299194336
local_output_nid generation:  0.011128902435302734
local_in_edges_tensor generation:  0.00859212875366211
mini_batch_src_global generation:  0.011893987655639648
r_  generation:  0.11300539970397949
local_output_nid generation:  0.011539459228515625
local_in_edges_tensor generation:  0.00883340835571289
mini_batch_src_global generation:  0.012038707733154297
r_  generation:  0.11618876457214355
local_output_nid generation:  0.01154947280883789
local_in_edges_tensor generation:  0.008627176284790039
mini_batch_src_global generation:  0.01246190071105957
r_  generation:  0.11730647087097168
----------------------check_connections_block total spend ----------------------------- 1.5023396015167236
generate_one_block  0.16398048400878906
generate_one_block  0.18933606147766113
generate_one_block  0.14139294624328613
generate_one_block  0.1417381763458252
generate_one_block  0.12670040130615234
generate_one_block  0.13363099098205566
generate_one_block  0.1365950107574463
generate_one_block  0.136216402053833
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.5023396015167236
block generation total time  1.1695904731750488
average batch blocks generation time:  0.1461988091468811
pseudo mini batch 0 input nodes size: 105862
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0701904296875 GB
    Memory Allocated: 0.0535588264465332  GigaBytes
Max Memory Allocated: 0.0535588264465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0701904296875 GB
    Memory Allocated: 0.053644657135009766  GigaBytes
Max Memory Allocated: 0.053644657135009766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0701904296875 GB
    Memory Allocated: 0.053644657135009766  GigaBytes
Max Memory Allocated: 0.053644657135009766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1541748046875 GB
    Memory Allocated: 0.05715799331665039  GigaBytes
Max Memory Allocated: 0.05715799331665039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1541748046875 GB
    Memory Allocated: 0.05715799331665039  GigaBytes
Max Memory Allocated: 0.05715799331665039  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1541748046875 GB
    Memory Allocated: 0.05715799331665039  GigaBytes
Max Memory Allocated: 0.05715799331665039  GigaBytes

torch.Size([105862, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1541748046875 GB
    Memory Allocated: 0.05715799331665039  GigaBytes
Max Memory Allocated: 0.05715799331665039  GigaBytes

m.shape torch.Size([2799, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.23352622985839844  GigaBytes
Max Memory Allocated: 0.2375502586364746  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.23352622985839844  GigaBytes
Max Memory Allocated: 0.2375502586364746  GigaBytes

 h.shape torch.Size([1, 2799, 128]), torch.Size([1, 2799, 128])
----------------------------------------3
 Nvidia-smi: 1.4354248046875 GB
    Memory Allocated: 0.23619556427001953  GigaBytes
Max Memory Allocated: 0.2375502586364746  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.25841474533081055  GigaBytes
Max Memory Allocated: 0.2597494125366211  GigaBytes

rst.shape  torch.Size([1, 2799, 128])
m.shape torch.Size([3416, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.26033782958984375  GigaBytes
Max Memory Allocated: 0.26041460037231445  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.26033782958984375  GigaBytes
Max Memory Allocated: 0.26041460037231445  GigaBytes

 h.shape torch.Size([1, 3416, 128]), torch.Size([1, 3416, 128])
----------------------------------------3
 Nvidia-smi: 1.4569091796875 GB
    Memory Allocated: 0.2635955810546875  GigaBytes
Max Memory Allocated: 0.2635955810546875  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.31246185302734375  GigaBytes
Max Memory Allocated: 0.3157196044921875  GigaBytes

rst.shape  torch.Size([1, 3416, 128])
m.shape torch.Size([3412, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.31571388244628906  GigaBytes
Max Memory Allocated: 0.3158283233642578  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.31571388244628906  GigaBytes
Max Memory Allocated: 0.3158283233642578  GigaBytes

 h.shape torch.Size([1, 3412, 128]), torch.Size([1, 3412, 128])
----------------------------------------3
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.3189678192138672  GigaBytes
Max Memory Allocated: 0.3189678192138672  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3905773162841797  GigaBytes
Max Memory Allocated: 0.3954582214355469  GigaBytes

rst.shape  torch.Size([1, 3412, 128])
m.shape torch.Size([3169, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3954582214355469  GigaBytes
Max Memory Allocated: 0.3956007957458496  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3954582214355469  GigaBytes
Max Memory Allocated: 0.3956007957458496  GigaBytes

 h.shape torch.Size([1, 3169, 128]), torch.Size([1, 3169, 128])
----------------------------------------3
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.39868927001953125  GigaBytes
Max Memory Allocated: 0.39868927001953125  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.48656463623046875  GigaBytes
Max Memory Allocated: 0.49260902404785156  GigaBytes

rst.shape  torch.Size([1, 3169, 128])
m.shape torch.Size([2924, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.49260902404785156  GigaBytes
Max Memory Allocated: 0.49277305603027344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.49260902404785156  GigaBytes
Max Memory Allocated: 0.49277305603027344  GigaBytes

 h.shape torch.Size([1, 2924, 128]), torch.Size([1, 2924, 128])
----------------------------------------3
 Nvidia-smi: 1.6912841796875 GB
    Memory Allocated: 0.4954051971435547  GigaBytes
Max Memory Allocated: 0.4954051971435547  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.5958499908447266  GigaBytes
Max Memory Allocated: 0.6028213500976562  GigaBytes

rst.shape  torch.Size([1, 2924, 128])
m.shape torch.Size([2451, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6014566421508789  GigaBytes
Max Memory Allocated: 0.6028213500976562  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6014566421508789  GigaBytes
Max Memory Allocated: 0.6028213500976562  GigaBytes

 h.shape torch.Size([1, 2451, 128]), torch.Size([1, 2451, 128])
----------------------------------------3
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6042680740356445  GigaBytes
Max Memory Allocated: 0.6042680740356445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.7089366912841797  GigaBytes
Max Memory Allocated: 0.7167806625366211  GigaBytes

rst.shape  torch.Size([1, 2451, 128])
m.shape torch.Size([2270, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.7156119346618652  GigaBytes
Max Memory Allocated: 0.7167806625366211  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.7156119346618652  GigaBytes
Max Memory Allocated: 0.7167806625366211  GigaBytes

 h.shape torch.Size([1, 2270, 128]), torch.Size([1, 2270, 128])
----------------------------------------3
 Nvidia-smi: 1.9256591796875 GB
    Memory Allocated: 0.7178630828857422  GigaBytes
Max Memory Allocated: 0.7178630828857422  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.8272533416748047  GigaBytes
Max Memory Allocated: 0.8348302841186523  GigaBytes

rst.shape  torch.Size([1, 2270, 128])
m.shape torch.Size([2035, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.8339338302612305  GigaBytes
Max Memory Allocated: 0.8348302841186523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.8339338302612305  GigaBytes
Max Memory Allocated: 0.8348302841186523  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.8358745574951172  GigaBytes
Max Memory Allocated: 0.8358745574951172  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.9476118087768555  GigaBytes
Max Memory Allocated: 0.9553747177124023  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
m.shape torch.Size([1845, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.954559326171875  GigaBytes
Max Memory Allocated: 0.9553747177124023  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1580810546875 GB
    Memory Allocated: 0.954559326171875  GigaBytes
Max Memory Allocated: 0.9553747177124023  GigaBytes

 h.shape torch.Size([1, 1845, 128]), torch.Size([1, 1845, 128])
----------------------------------------3
 Nvidia-smi: 2.1600341796875 GB
    Memory Allocated: 0.9563188552856445  GigaBytes
Max Memory Allocated: 0.9563188552856445  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2967529296875 GB
    Memory Allocated: 1.0689287185668945  GigaBytes
Max Memory Allocated: 1.0768465995788574  GigaBytes

rst.shape  torch.Size([1, 1845, 128])
m.shape torch.Size([24584, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.4178466796875 GB
    Memory Allocated: 1.185274600982666  GigaBytes
Max Memory Allocated: 1.188126564025879  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4178466796875 GB
    Memory Allocated: 1.185274600982666  GigaBytes
Max Memory Allocated: 1.188126564025879  GigaBytes

 h.shape torch.Size([1, 24584, 128]), torch.Size([1, 24584, 128])
----------------------------------------3
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2087197303771973  GigaBytes
Max Memory Allocated: 1.2087197303771973  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.873323917388916  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

rst.shape  torch.Size([1, 24584, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.7140183448791504  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.760657787322998  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.8072972297668457  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.7602930068969727  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

torch.Size([48905, 256])
first layer input nodes number: 105862
first layer output nodes number: 48905
edges number: 356484
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.8080883026123047  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.8547277450561523  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.8663878440856934  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3162841796875 GB
    Memory Allocated: 2.8663878440856934  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

m.shape torch.Size([1446, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 2.978646755218506  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 2.978646755218506  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

 h.shape torch.Size([1, 1446, 256]), torch.Size([1, 1446, 256])
----------------------------------------3
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 2.9817848205566406  GigaBytes
Max Memory Allocated: 2.9905495643615723  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.0056114196777344  GigaBytes
Max Memory Allocated: 3.007526397705078  GigaBytes

rst.shape  torch.Size([1, 1446, 256])
m.shape torch.Size([1231, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.0060691833496094  GigaBytes
Max Memory Allocated: 3.007526397705078  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.0060691833496094  GigaBytes
Max Memory Allocated: 3.007526397705078  GigaBytes

 h.shape torch.Size([1, 1231, 256]), torch.Size([1, 1231, 256])
----------------------------------------3
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.009920120239258  GigaBytes
Max Memory Allocated: 3.009920120239258  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.050477981567383  GigaBytes
Max Memory Allocated: 3.0531177520751953  GigaBytes

rst.shape  torch.Size([1, 1231, 256])
m.shape torch.Size([927, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.051213264465332  GigaBytes
Max Memory Allocated: 3.0531177520751953  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.051213264465332  GigaBytes
Max Memory Allocated: 3.0531177520751953  GigaBytes

 h.shape torch.Size([1, 927, 256]), torch.Size([1, 927, 256])
----------------------------------------3
 Nvidia-smi: 4.4276123046875 GB
    Memory Allocated: 3.052981376647949  GigaBytes
Max Memory Allocated: 3.0531177520751953  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 3.092496871948242  GigaBytes
Max Memory Allocated: 3.095149040222168  GigaBytes

rst.shape  torch.Size([1, 927, 256])
m.shape torch.Size([761, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 3.094538688659668  GigaBytes
Max Memory Allocated: 3.095149040222168  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4334716796875 GB
    Memory Allocated: 3.094538688659668  GigaBytes
Max Memory Allocated: 3.095149040222168  GigaBytes

 h.shape torch.Size([1, 761, 256]), torch.Size([1, 761, 256])
----------------------------------------3
 Nvidia-smi: 4.4354248046875 GB
    Memory Allocated: 3.0959901809692383  GigaBytes
Max Memory Allocated: 3.0959901809692383  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 3.1380834579467773  GigaBytes
Max Memory Allocated: 3.140986442565918  GigaBytes

rst.shape  torch.Size([1, 761, 256])
m.shape torch.Size([687, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 3.1406593322753906  GigaBytes
Max Memory Allocated: 3.140986442565918  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 3.1406593322753906  GigaBytes
Max Memory Allocated: 3.140986442565918  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 4.4451904296875 GB
    Memory Allocated: 3.141969680786133  GigaBytes
Max Memory Allocated: 3.141969680786133  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 3.1891613006591797  GigaBytes
Max Memory Allocated: 3.192437171936035  GigaBytes

rst.shape  torch.Size([1, 687, 256])
m.shape torch.Size([540, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 3.191620349884033  GigaBytes
Max Memory Allocated: 3.192437171936035  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 3.191620349884033  GigaBytes
Max Memory Allocated: 3.192437171936035  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 4.5155029296875 GB
    Memory Allocated: 3.192650318145752  GigaBytes
Max Memory Allocated: 3.192650318145752  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 3.237276554107666  GigaBytes
Max Memory Allocated: 3.2403664588928223  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([471, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 3.2399306297302246  GigaBytes
Max Memory Allocated: 3.2403664588928223  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 3.2399306297302246  GigaBytes
Max Memory Allocated: 3.2403664588928223  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 4.5584716796875 GB
    Memory Allocated: 3.2408289909362793  GigaBytes
Max Memory Allocated: 3.2408289909362793  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.2886571884155273  GigaBytes
Max Memory Allocated: 3.2918014526367188  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([438, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.2915759086608887  GigaBytes
Max Memory Allocated: 3.2918014526367188  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.2915759086608887  GigaBytes
Max Memory Allocated: 3.2918014526367188  GigaBytes

 h.shape torch.Size([1, 438, 256]), torch.Size([1, 438, 256])
----------------------------------------3
 Nvidia-smi: 4.5662841796875 GB
    Memory Allocated: 3.2924113273620605  GigaBytes
Max Memory Allocated: 3.2924113273620605  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5740966796875 GB
    Memory Allocated: 3.3466334342956543  GigaBytes
Max Memory Allocated: 3.349975109100342  GigaBytes

rst.shape  torch.Size([1, 438, 256])
m.shape torch.Size([405, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.5740966796875 GB
    Memory Allocated: 3.3497190475463867  GigaBytes
Max Memory Allocated: 3.349975109100342  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5740966796875 GB
    Memory Allocated: 3.3497190475463867  GigaBytes
Max Memory Allocated: 3.349975109100342  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 4.5740966796875 GB
    Memory Allocated: 3.350491523742676  GigaBytes
Max Memory Allocated: 3.350491523742676  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.4027905464172363  GigaBytes
Max Memory Allocated: 3.406266689300537  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([338, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.4056529998779297  GigaBytes
Max Memory Allocated: 3.406266689300537  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.4056529998779297  GigaBytes
Max Memory Allocated: 3.406266689300537  GigaBytes

 h.shape torch.Size([1, 338, 256]), torch.Size([1, 338, 256])
----------------------------------------3
 Nvidia-smi: 4.6209716796875 GB
    Memory Allocated: 3.4062976837158203  GigaBytes
Max Memory Allocated: 3.4062976837158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6678466796875 GB
    Memory Allocated: 3.452329635620117  GigaBytes
Max Memory Allocated: 3.4555530548095703  GigaBytes

rst.shape  torch.Size([1, 338, 256])
m.shape torch.Size([331, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.6678466796875 GB
    Memory Allocated: 3.4555068016052246  GigaBytes
Max Memory Allocated: 3.4555530548095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6678466796875 GB
    Memory Allocated: 3.4555068016052246  GigaBytes
Max Memory Allocated: 3.4555530548095703  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 4.6678466796875 GB
    Memory Allocated: 3.4561381340026855  GigaBytes
Max Memory Allocated: 3.4561381340026855  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.5067200660705566  GigaBytes
Max Memory Allocated: 3.511099338531494  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([306, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.5108113288879395  GigaBytes
Max Memory Allocated: 3.511099338531494  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.5108113288879395  GigaBytes
Max Memory Allocated: 3.511099338531494  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.7147216796875 GB
    Memory Allocated: 3.51139497756958  GigaBytes
Max Memory Allocated: 3.51139497756958  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.562753677368164  GigaBytes
Max Memory Allocated: 3.566255569458008  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([256, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5656604766845703  GigaBytes
Max Memory Allocated: 3.566255569458008  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5656604766845703  GigaBytes
Max Memory Allocated: 3.566255569458008  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 4.7830810546875 GB
    Memory Allocated: 3.5661487579345703  GigaBytes
Max Memory Allocated: 3.566255569458008  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.6110706329345703  GigaBytes
Max Memory Allocated: 3.6142444610595703  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([194, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.6134371757507324  GigaBytes
Max Memory Allocated: 3.6142444610595703  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.6134371757507324  GigaBytes
Max Memory Allocated: 3.6142444610595703  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 4.8260498046875 GB
    Memory Allocated: 3.613807201385498  GigaBytes
Max Memory Allocated: 3.6142444610595703  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.650439739227295  GigaBytes
Max Memory Allocated: 3.6530299186706543  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([177, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.6528067588806152  GigaBytes
Max Memory Allocated: 3.6530299186706543  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.6528067588806152  GigaBytes
Max Memory Allocated: 3.6530299186706543  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 4.8670654296875 GB
    Memory Allocated: 3.653144359588623  GigaBytes
Max Memory Allocated: 3.653144359588623  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9100341796875 GB
    Memory Allocated: 3.688930034637451  GigaBytes
Max Memory Allocated: 3.6914620399475098  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([161, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.9100341796875 GB
    Memory Allocated: 3.691237449645996  GigaBytes
Max Memory Allocated: 3.6914620399475098  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9100341796875 GB
    Memory Allocated: 3.691237449645996  GigaBytes
Max Memory Allocated: 3.6914620399475098  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 4.9100341796875 GB
    Memory Allocated: 3.691544532775879  GigaBytes
Max Memory Allocated: 3.691544532775879  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9412841796875 GB
    Memory Allocated: 3.7262449264526367  GigaBytes
Max Memory Allocated: 3.728701591491699  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([168, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.9412841796875 GB
    Memory Allocated: 3.7288365364074707  GigaBytes
Max Memory Allocated: 3.7288475036621094  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9412841796875 GB
    Memory Allocated: 3.7288365364074707  GigaBytes
Max Memory Allocated: 3.7288475036621094  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 4.9412841796875 GB
    Memory Allocated: 3.729156970977783  GigaBytes
Max Memory Allocated: 3.729156970977783  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.767609119415283  GigaBytes
Max Memory Allocated: 3.7703328132629395  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([149, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.770026683807373  GigaBytes
Max Memory Allocated: 3.7703328132629395  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.770026683807373  GigaBytes
Max Memory Allocated: 3.7703328132629395  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 4.9764404296875 GB
    Memory Allocated: 3.770310878753662  GigaBytes
Max Memory Allocated: 3.7703328132629395  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0330810546875 GB
    Memory Allocated: 3.806403636932373  GigaBytes
Max Memory Allocated: 3.8089613914489746  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0330810546875 GB
    Memory Allocated: 3.809019088745117  GigaBytes
Max Memory Allocated: 3.809030055999756  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0330810546875 GB
    Memory Allocated: 3.809019088745117  GigaBytes
Max Memory Allocated: 3.809030055999756  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 5.0330810546875 GB
    Memory Allocated: 3.809307098388672  GigaBytes
Max Memory Allocated: 3.809307098388672  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0740966796875 GB
    Memory Allocated: 3.847900390625  GigaBytes
Max Memory Allocated: 3.8506364822387695  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([136, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0740966796875 GB
    Memory Allocated: 3.8503708839416504  GigaBytes
Max Memory Allocated: 3.8506364822387695  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0740966796875 GB
    Memory Allocated: 3.8503708839416504  GigaBytes
Max Memory Allocated: 3.8506364822387695  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.0740966796875 GB
    Memory Allocated: 3.850630283355713  GigaBytes
Max Memory Allocated: 3.8506364822387695  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1112060546875 GB
    Memory Allocated: 3.8872056007385254  GigaBytes
Max Memory Allocated: 3.8897995948791504  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([121, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1112060546875 GB
    Memory Allocated: 3.8895182609558105  GigaBytes
Max Memory Allocated: 3.8897995948791504  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1112060546875 GB
    Memory Allocated: 3.8895182609558105  GigaBytes
Max Memory Allocated: 3.8897995948791504  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 5.1112060546875 GB
    Memory Allocated: 3.889749050140381  GigaBytes
Max Memory Allocated: 3.8897995948791504  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 3.923905849456787  GigaBytes
Max Memory Allocated: 3.9263291358947754  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([106, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 3.926137924194336  GigaBytes
Max Memory Allocated: 3.9263291358947754  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 3.926137924194336  GigaBytes
Max Memory Allocated: 3.9263291358947754  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.1424560546875 GB
    Memory Allocated: 3.926340103149414  GigaBytes
Max Memory Allocated: 3.926340103149414  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 3.9576778411865234  GigaBytes
Max Memory Allocated: 3.959901809692383  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 3.9593677520751953  GigaBytes
Max Memory Allocated: 3.959901809692383  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 3.9593677520751953  GigaBytes
Max Memory Allocated: 3.959901809692383  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 5.1756591796875 GB
    Memory Allocated: 3.959522247314453  GigaBytes
Max Memory Allocated: 3.959901809692383  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.9845504760742188  GigaBytes
Max Memory Allocated: 3.9863271713256836  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([113, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.9870800971984863  GigaBytes
Max Memory Allocated: 3.987090587615967  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.9870800971984863  GigaBytes
Max Memory Allocated: 3.987090587615967  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 5.1912841796875 GB
    Memory Allocated: 3.987295627593994  GigaBytes
Max Memory Allocated: 3.987295627593994  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2283935546875 GB
    Memory Allocated: 4.0237202644348145  GigaBytes
Max Memory Allocated: 4.026306629180908  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([1819, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.2752685546875 GB
    Memory Allocated: 4.067319869995117  GigaBytes
Max Memory Allocated: 4.0674896240234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2752685546875 GB
    Memory Allocated: 4.067319869995117  GigaBytes
Max Memory Allocated: 4.0674896240234375  GigaBytes

 h.shape torch.Size([1, 1819, 256]), torch.Size([1, 1819, 256])
----------------------------------------3
 Nvidia-smi: 5.2752685546875 GB
    Memory Allocated: 4.070789337158203  GigaBytes
Max Memory Allocated: 4.070789337158203  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.689078330993652  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 1819, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.587219715118408  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.589155673980713  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.590871334075928  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.5888495445251465  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

torch.Size([11513, 40])
input nodes number: 48905
output nodes number: 11513
edges number: 114872
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.591236114501953  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0623779296875 GB
    Memory Allocated: 4.5912370681762695  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.06881427764892578  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

pseudo mini batch 1 input nodes size: 103217
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.05835676193237305  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.05835676193237305  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.107574462890625  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.10766077041625977  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.0567936897277832  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.06095266342163086  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.06095266342163086  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.06095266342163086  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

torch.Size([103217, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.2869873046875 GB
    Memory Allocated: 0.06095266342163086  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

m.shape torch.Size([2150, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.2627115249633789  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.2627115249633789  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.26476192474365234  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.2820549011230469  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2705, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.28360939025878906  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.28360939025878906  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2705, 128]), torch.Size([1, 2705, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.2870292663574219  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.3280448913574219  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2705, 128])
m.shape torch.Size([2752, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.3306918144226074  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.3306918144226074  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2752, 128]), torch.Size([1, 2752, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.3333163261413574  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.3932528495788574  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2752, 128])
m.shape torch.Size([2644, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.39698362350463867  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.39698362350463867  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2644, 128]), torch.Size([1, 2644, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.39955663681030273  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.473538875579834  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2644, 128])
m.shape torch.Size([2484, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.47820043563842773  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.47820043563842773  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2484, 128]), torch.Size([1, 2484, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.48062992095947266  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.5672292709350586  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2484, 128])
m.shape torch.Size([2228, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.5724191665649414  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.5724191665649414  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2228, 128]), torch.Size([1, 2228, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.5745477676391602  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.6681032180786133  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2228, 128])
m.shape torch.Size([2102, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.6736488342285156  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.6736488342285156  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 2102, 128]), torch.Size([1, 2102, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.6770687103271484  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.7799701690673828  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 2102, 128])
m.shape torch.Size([1949, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.786402702331543  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.786402702331543  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 1949, 128]), torch.Size([1, 1949, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.7882614135742188  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.8997077941894531  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 1949, 128])
m.shape torch.Size([1814, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.9065632820129395  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.9065632820129395  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 1814, 128]), torch.Size([1, 1814, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 0.9082932472229004  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 1.0190110206604004  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 1814, 128])
m.shape torch.Size([31104, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 1.16646146774292  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 1.16646146774292  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 31104, 128]), torch.Size([1, 31104, 128])
----------------------------------------3
 Nvidia-smi: 6.4842529296875 GB
    Memory Allocated: 1.19612455368042  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.30318021774292  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 31104, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.116156578063965  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.165682792663574  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.2152090072631836  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.1652956008911133  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

torch.Size([51932, 256])
first layer input nodes number: 103217
first layer output nodes number: 51932
edges number: 409852
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.215980052947998  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.2655062675476074  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.2778878211975098  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.2778878211975098  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

m.shape torch.Size([1058, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.421851634979248  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.421851634979248  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.424293041229248  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.443274974822998  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
m.shape torch.Size([911, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.443929672241211  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.443929672241211  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 911, 256]), torch.Size([1, 911, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.445667266845703  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.471731185913086  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 911, 256])
m.shape torch.Size([744, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.4731106758117676  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.4731106758117676  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.47452974319458  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.505749225616455  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([641, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.507534980773926  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.507534980773926  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.5087575912475586  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.545353412628174  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([521, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.547245979309082  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.547245979309082  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.5482397079467773  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.586362838745117  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([429, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.5883402824401855  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.5883402824401855  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 429, 256]), torch.Size([1, 429, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.589158535003662  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.6264939308166504  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 429, 256])
m.shape torch.Size([390, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.628708839416504  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.628708839416504  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.629452705383301  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.667717933654785  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([313, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.669753074645996  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.669753074645996  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.6703500747680664  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.705042839050293  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([346, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.7085213661193848  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.7085213661193848  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.709181308746338  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.751464366912842  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([307, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.754849910736084  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.754849910736084  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.7554354667663574  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.798095703125  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.8005309104919434  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.8005309104919434  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.801023006439209  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.8403124809265137  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([267, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.843146324157715  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.843146324157715  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.843655586242676  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.88761043548584  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([271, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.890742301940918  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.890742301940918  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.89125919342041  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.940553665161133  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([222, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.9433093070983887  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.9433093070983887  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.943732738494873  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.985652446746826  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([224, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.9886703491210938  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.9886703491210938  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 3.9890975952148438  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.034385681152344  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([208, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.037370681762695  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.037370681762695  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.03776741027832  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.082597732543945  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([200, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.085667610168457  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.085667610168457  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.0860490798950195  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.1318254470825195  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([222, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.1354756355285645  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.1354756355285645  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.135899066925049  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.1896748542785645  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([187, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.192878246307373  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.192878246307373  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.193234920501709  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.241029262542725  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([179, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.24429178237915  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.24429178237915  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.244633197784424  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.2927727699279785  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([184, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.296316146850586  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.296316146850586  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.296667098999023  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.348608016967773  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([135, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.351287364959717  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.351287364959717  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.3515448570251465  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.391456127166748  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([136, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.394333839416504  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.394333839416504  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.0252685546875 GB
    Memory Allocated: 4.394593238830566  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0701904296875 GB
    Memory Allocated: 4.436615943908691  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([137, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0701904296875 GB
    Memory Allocated: 4.4396467208862305  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0701904296875 GB
    Memory Allocated: 4.4396467208862305  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 8.0701904296875 GB
    Memory Allocated: 4.439908027648926  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 4.484068870544434  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([3073, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 4.557776927947998  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 4.557776927947998  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

 h.shape torch.Size([1, 3073, 256]), torch.Size([1, 3073, 256])
----------------------------------------3
 Nvidia-smi: 8.1170654296875 GB
    Memory Allocated: 4.564188480377197  GigaBytes
Max Memory Allocated: 4.732446670532227  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.596508502960205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3073, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.462784290313721  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.464722156524658  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.466660022735596  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.464635848999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11563, 40])
input nodes number: 51932
output nodes number: 11563
edges number: 148238
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.465111255645752  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1912841796875 GB
    Memory Allocated: 5.46511173248291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06858539581298828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 2 input nodes size: 105980
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.056795597076416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.056795597076416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10757684707641602  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10766267776489258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05835866928100586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06109952926635742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06109952926635742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06109952926635742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105980, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06109952926635742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3659, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20712518692016602  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20712518692016602  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3659, 128]), torch.Size([1, 3659, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.21061468124389648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23853063583374023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3659, 128])
m.shape torch.Size([4423, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.24100399017333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.24100399017333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4423, 128]), torch.Size([1, 4423, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.24623441696166992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3095059394836426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4423, 128])
m.shape torch.Size([4259, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3140897750854492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3140897750854492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4259, 128]), torch.Size([1, 4259, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.31815147399902344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40750885009765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4259, 128])
m.shape torch.Size([3625, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.41239213943481445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.41239213943481445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3625, 128]), torch.Size([1, 3625, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4161677360534668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5175113677978516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3625, 128])
m.shape torch.Size([3439, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5236191749572754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5236191749572754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3439, 128]), torch.Size([1, 3439, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5273504257202148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6486396789550781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3439, 128])
m.shape torch.Size([2733, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6548190116882324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6548190116882324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6579456329345703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7723169326782227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2262, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7788329124450684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7788329124450684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2262, 128]), torch.Size([1, 2262, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7810230255126953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8912501335144043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2262, 128])
m.shape torch.Size([2049, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8979878425598145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8979878425598145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9000840187072754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.015721321105957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1764, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0223145484924316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0223145484924316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1764, 128]), torch.Size([1, 1764, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0239968299865723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1332650184631348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1764, 128])
m.shape torch.Size([17269, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.214768886566162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.214768886566162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 17269, 128]), torch.Size([1, 17269, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.2312378883361816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4005370140075684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 17269, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.2721199989318848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.315495014190674  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.358870029449463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3151559829711914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([45482, 256])
first layer input nodes number: 105980
first layer output nodes number: 45482
edges number: 294167
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.35966157913208  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.403036594390869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4138803482055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4138803482055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1969, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4870729446411133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4870729446411133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1969, 256]), torch.Size([1, 1969, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.491450786590576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.524420738220215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1969, 256])
m.shape torch.Size([1769, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5254883766174316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5254883766174316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1769, 256]), torch.Size([1, 1769, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.528961658477783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.585724353790283  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1769, 256])
m.shape torch.Size([1362, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5879664421081543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5879664421081543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1362, 256]), torch.Size([1, 1362, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5905933380126953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.649170398712158  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1362, 256])
m.shape torch.Size([1033, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6518430709838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6518430709838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.653885841369629  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.713179111480713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([899, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7165145874023438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7165145874023438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.718229293823242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.78082275390625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([723, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.784134864807129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.784134864807129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 723, 256]), torch.Size([1, 723, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7855138778686523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.846043109893799  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 723, 256])
m.shape torch.Size([511, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8487915992736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8487915992736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.849766254425049  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.899775981903076  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([467, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9028797149658203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9028797149658203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9037704467773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9546737670898438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([375, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.957472324371338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.957472324371338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9581875801086426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0065722465515137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.009002208709717  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.009002208709717  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0095553398132324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0495524406433105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([255, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.051971912384033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.051971912384033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0524582862854004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.090395450592041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([230, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0928053855895996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0928053855895996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0932440757751465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.130532741546631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.132350444793701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.132350444793701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1326613426208496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.161263942718506  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([146, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1630730628967285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1630730628967285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.163351535797119  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.190920352935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([129, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.192641258239746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.192641258239746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.192887306213379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.218968391418457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2205371856689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2205371856689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2207469940185547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.244455337524414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([82, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2466659545898438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2466659545898438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2468223571777344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2655906677246094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2666196823120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2666196823120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2667417526245117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2822446823120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([76, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.283571720123291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.283571720123291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2837166786193848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3031411170959473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.304164409637451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.304164409637451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3042712211608887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.319331645965576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3203682899475098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3203682899475098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3204712867736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.335714817047119  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3366360664367676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3366360664367676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.336723804473877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.35032320022583  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.351141929626465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.351141929626465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3512163162231445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.363266944885254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.364060401916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.364060401916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.364129066467285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3757333755493164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([599, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.390091896057129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.390091896057129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3912343978881836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5923147201538086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 599, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5311293601989746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5328545570373535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5352330207824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5334219932556152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11483, 40])
input nodes number: 45482
output nodes number: 11483
edges number: 73561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5336341857910156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.533634662628174  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06622791290283203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 3 input nodes size: 100670
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.058145999908447266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.058145999908447266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10697412490844727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10706043243408203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05619335174560547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05916881561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05916881561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05916881561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([100670, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05916881561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3139, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20712995529174805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20712995529174805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3139, 128]), torch.Size([1, 3139, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.21012353897094727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2345142364501953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3139, 128])
m.shape torch.Size([3851, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2364487648010254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2364487648010254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3851, 128]), torch.Size([1, 3851, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2408003807067871  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2967071533203125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3851, 128])
m.shape torch.Size([3741, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30119752883911133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30119752883911133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3741, 128]), torch.Size([1, 3741, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30568790435791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.38705015182495117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3741, 128])
m.shape torch.Size([3506, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3919534683227539  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3919534683227539  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3506, 128]), torch.Size([1, 3506, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.39540910720825195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.49386072158813477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3506, 128])
m.shape torch.Size([3021, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4993915557861328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4993915557861328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3021, 128]), torch.Size([1, 3021, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5024337768554688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.613523006439209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3021, 128])
m.shape torch.Size([2584, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6194753646850586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6194753646850586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2584, 128]), torch.Size([1, 2584, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6220455169677734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7285823822021484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2584, 128])
m.shape torch.Size([2247, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7348504066467285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7348504066467285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2247, 128]), torch.Size([1, 2247, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7370100021362305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8460097312927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2247, 128])
m.shape torch.Size([2021, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8535099029541016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8535099029541016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2021, 128]), torch.Size([1, 2021, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8554372787475586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9663276672363281  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2021, 128])
m.shape torch.Size([1794, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9730629920959473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9730629920959473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1794, 128]), torch.Size([1, 1794, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9747738838195801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0849719047546387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1794, 128])
m.shape torch.Size([18387, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1717925071716309  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1717925071716309  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 18387, 128]), torch.Size([1, 18387, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1893277168273926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4343276023864746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 18387, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3022913932800293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3445305824279785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3867697715759277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3442001342773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44291, 256])
first layer input nodes number: 100670
first layer output nodes number: 44291
edges number: 298610
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.387521743774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4297609329223633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4403209686279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4403209686279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1532, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.539027214050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.539027214050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1532, 256]), torch.Size([1, 1532, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5425353050231934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.569150924682617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1532, 256])
m.shape torch.Size([1365, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5694470405578613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5694470405578613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5721893310546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6118364334106445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1033, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6139016151428223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6139016151428223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.615999698638916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.659860610961914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([901, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6622753143310547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6622753143310547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 901, 256]), torch.Size([1, 901, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6639938354492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7138404846191406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 901, 256])
m.shape torch.Size([745, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.716561794281006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.716561794281006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.717982769012451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.770141124725342  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([594, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7728562355041504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7728562355041504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.773989200592041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8237719535827637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([539, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.826831817626953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.826831817626953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 539, 256]), torch.Size([1, 539, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.827859878540039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8800840377807617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 539, 256])
m.shape torch.Size([493, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8833608627319336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8833608627319336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.88430118560791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9388227462768555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([420, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.941986083984375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.941986083984375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9427871704101562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.995105743408203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([384, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9983959197998047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9983959197998047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9991283416748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.053312301635742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([297, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.056086540222168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.056086540222168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0566530227661133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1017584800720215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([289, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.104808807373047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.104808807373047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1053600311279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1533823013305664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1559805870056152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1559805870056152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.156419277191162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1967787742614746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([226, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1996006965637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1996006965637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2000317573547363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.242706775665283  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([210, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2455191612243652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2455191612243652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.245919704437256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.288377285003662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([172, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2908220291137695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2908220291137695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2911500930786133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.328221321105957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([153, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.330557346343994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.330557346343994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3308491706848145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.365868091583252  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([141, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.368161678314209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.368161678314209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3684306144714355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.402585506439209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([126, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.405601978302002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.405601978302002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4058423042297363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4380459785461426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([104, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.439925193786621  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.439925193786621  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4401235580444336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.468092918395996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([108, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4701738357543945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4701738357543945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4703798294067383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5008668899536133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([95, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.502772808074951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.502772808074951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5029540061950684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5310397148132324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.532855987548828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.532855987548828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.53302001953125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5595932006835938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.561102867126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.561102867126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.561234474182129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5834760665893555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1227, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6128931045532227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6128931045532227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1227, 256]), torch.Size([1, 1227, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6152334213256836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.04509162902832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1227, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9565415382385254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.958437442779541  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9601569175720215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.958174705505371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11539, 40])
input nodes number: 44291
output nodes number: 11539
edges number: 100662
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9587621688842773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9587626457214355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06493711471557617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 4 input nodes size: 91698
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05636405944824219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05636405944824219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10008907318115234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10017538070678711  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.051260948181152344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.054316043853759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.054316043853759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.054316043853759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([91698, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.054316043853759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2579, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.18733501434326172  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.18733501434326172  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2579, 128]), torch.Size([1, 2579, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.18979454040527344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.21044063568115234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2579, 128])
m.shape torch.Size([3245, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.21216106414794922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.21216106414794922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3245, 128]), torch.Size([1, 3245, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2152557373046875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.26173925399780273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3245, 128])
m.shape torch.Size([3393, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2650456428527832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2650456428527832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3393, 128]), torch.Size([1, 3393, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2682814598083496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.344052791595459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3393, 128])
m.shape torch.Size([2997, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3489065170288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3489065170288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2997, 128]), torch.Size([1, 2997, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.35181236267089844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4395599365234375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2997, 128])
m.shape torch.Size([2727, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.44527626037597656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.44527626037597656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2727, 128]), torch.Size([1, 2727, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4478769302368164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5435328483581543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2727, 128])
m.shape torch.Size([2361, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5489873886108398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5489873886108398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2361, 128]), torch.Size([1, 2361, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5514063835144043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6519880294799805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2361, 128])
m.shape torch.Size([2078, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6577982902526855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6577982902526855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2078, 128]), torch.Size([1, 2078, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6599807739257812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7620515823364258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2078, 128])
m.shape torch.Size([1787, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7678775787353516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7678775787353516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1787, 128]), torch.Size([1, 1787, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7695817947387695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8669910430908203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1787, 128])
m.shape torch.Size([1543, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8727607727050781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8727607727050781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1543, 128]), torch.Size([1, 1543, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.874232292175293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.968409538269043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1543, 128])
m.shape torch.Size([16731, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0474534034729004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0474534034729004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16731, 128]), torch.Size([1, 16731, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0634093284606934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.205883502960205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16731, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.0875768661499023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.1251907348632812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.16280460357666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.12489652633667  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([39441, 256])
first layer input nodes number: 91698
first layer output nodes number: 39441
edges number: 269076
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.163489818572998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.201103687286377  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.210507392883301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.210507392883301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1287, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.322503089904785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.322503089904785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1287, 256]), torch.Size([1, 1287, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.325258731842041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.346958637237549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1287, 256])
m.shape torch.Size([1079, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.347297191619873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.347297191619873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1079, 256]), torch.Size([1, 1079, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3501100540161133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3859505653381348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1079, 256])
m.shape torch.Size([946, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3875656127929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3875656127929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 946, 256]), torch.Size([1, 946, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3893699645996094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4301910400390625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 946, 256])
m.shape torch.Size([709, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4320149421691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4320149421691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4333672523498535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4739537239074707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([649, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4766950607299805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4766950607299805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.477932929992676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.522555351257324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([596, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5253734588623047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5253734588623047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.526510238647461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5753917694091797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([547, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5785036087036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5785036087036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 547, 256]), torch.Size([1, 547, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5795469284057617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.632343292236328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 547, 256])
m.shape torch.Size([488, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6355738639831543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6355738639831543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.636504650115967  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.69020414352417  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([442, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6935625076293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6935625076293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 442, 256]), torch.Size([1, 442, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6944055557250977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.748471260070801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 442, 256])
m.shape torch.Size([437, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7522501945495605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7522501945495605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7530837059020996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8126235008239746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([392, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8163514137268066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8163514137268066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.817099094390869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8760533332824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([319, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8793587684631348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8793587684631348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.879967212677002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9326205253601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([313, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.936227321624756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.936227321624756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.936824321746826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.992434024810791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([288, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9960107803344727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9960107803344727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9965600967407227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.053483009338379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([232, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.056553363800049  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.056553363800049  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0569958686828613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1039013862609863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([204, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1068172454833984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1068172454833984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.107206344604492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.151174545288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([217, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1545257568359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1545257568359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.154939651489258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2046070098876953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([188, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2076525688171387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2076525688171387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2080111503601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2535510063171387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([141, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.255946636199951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.255946636199951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2562155723571777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.292253017425537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([188, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2957324981689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2957324981689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.296091079711914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.346651077270508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([141, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.349318027496338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.349318027496338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3495869636535645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3893895149230957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([104, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3919730186462402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3919730186462402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3921713829040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4229178428649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([97, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4249629974365234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4249629974365234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4251480102539062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.455120086669922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([105, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4574499130249023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4574499130249023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4576501846313477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4914960861206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([1450, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5262370109558105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5262370109558105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1450, 256]), torch.Size([1, 1450, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5290026664733887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.020171642303467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1450, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9193105697631836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9211835861206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9229063987731934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9209470748901367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11559, 40])
input nodes number: 39441
output nodes number: 11559
edges number: 114768
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.921154499053955  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9211549758911133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0595555305480957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 5 input nodes size: 103110
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05108785629272461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05108785629272461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10025453567504883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10033750534057617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05652618408203125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.059676170349121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.059676170349121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.059676170349121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([103110, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.059676170349121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3667, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19758081436157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.19758081436157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3667, 128]), torch.Size([1, 3667, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20107793807983398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.22923040390014648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3667, 128])
m.shape torch.Size([4382, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2316608428955078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2316608428955078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4382, 128]), torch.Size([1, 4382, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23583984375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2985248565673828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4382, 128])
m.shape torch.Size([4089, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30228471755981445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30228471755981445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4089, 128]), torch.Size([1, 4089, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3063240051269531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3921380043029785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4089, 128])
m.shape torch.Size([3636, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3971233367919922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3971233367919922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3636, 128]), torch.Size([1, 3636, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4007868766784668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5031528472900391  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3636, 128])
m.shape torch.Size([3270, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5092153549194336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5092153549194336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3270, 128]), torch.Size([1, 3270, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5125083923339844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6303558349609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3270, 128])
m.shape torch.Size([2539, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6360607147216797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6360607147216797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2539, 128]), torch.Size([1, 2539, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6388893127441406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7452106475830078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2539, 128])
m.shape torch.Size([2186, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.751136302947998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.751136302947998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2186, 128]), torch.Size([1, 2186, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7533621788024902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8613395690917969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2186, 128])
m.shape torch.Size([1899, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8667726516723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8667726516723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1899, 128]), torch.Size([1, 1899, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8685836791992188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9726858139038086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1899, 128])
m.shape torch.Size([1572, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9785265922546387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9785265922546387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9800257682800293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0759730339050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([16117, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1520752906799316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1520752906799316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16117, 128]), torch.Size([1, 16117, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1674456596374512  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.258741855621338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16117, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.1385226249694824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.179871082305908  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.221219539642334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.1795477867126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([43357, 256])
first layer input nodes number: 103110
first layer output nodes number: 43357
edges number: 276638
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.2219901084899902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.263338565826416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.273740768432617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.273740768432617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1972, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3412184715270996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3412184715270996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1972, 256]), torch.Size([1, 1972, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.34550142288208  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.377866744995117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1972, 256])
m.shape torch.Size([1723, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.378911018371582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.378911018371582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1723, 256]), torch.Size([1, 1723, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3824706077575684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.433572292327881  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1723, 256])
m.shape torch.Size([1365, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4361205101013184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4361205101013184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1365, 256]), torch.Size([1, 1365, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.438962459564209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.498335838317871  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1365, 256])
m.shape torch.Size([1038, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.500767230987549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.500767230987549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1038, 256]), torch.Size([1, 1038, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5027990341186523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5609664916992188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1038, 256])
m.shape torch.Size([914, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.564258575439453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.564258575439453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 914, 256]), torch.Size([1, 914, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5660018920898438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.630478858947754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 914, 256])
m.shape torch.Size([647, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.633338451385498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.633338451385498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6345725059509277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6905694007873535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([560, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6937203407287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6937203407287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6947884559631348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7492871284484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([413, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7519288063049316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7519288063049316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.752716541290283  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7991318702697754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([329, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.801584243774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.801584243774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8022117614746094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8434009552001953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([298, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.845951557159424  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.845951557159424  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.846519947052002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.88814115524292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([245, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8904476165771484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8904476165771484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8909149169921875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9273643493652344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([191, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9296274185180664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9296274185180664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9299917221069336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9609575271606445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([162, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.962799549102783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.962799549102783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.963108539581299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9915356636047363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([132, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.993157386779785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.993157386779785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9934091567993164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.01833438873291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([113, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0198378562927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0198378562927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0200533866882324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0428996086120605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0443453788757324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0443453788757324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0445380210876465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0663065910339355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.067615509033203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.067615509033203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.067779541015625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.08746337890625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0887136459350586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0887136459350586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.088860511779785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1075124740600586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([54, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.108429431915283  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.108429431915283  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.108532428741455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1223340034484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1234169006347656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1234169006347656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1235294342041016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1393966674804688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1402487754821777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1402487754821777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1403346061706543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1530375480651855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1535234451293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1535234451293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.153571128845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1609621047973633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.161667823791504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.161667823791504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1617307662963867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1719274520874023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.172542095184326  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.172542095184326  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.172595500946045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1816210746765137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([487, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.193296432495117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.193296432495117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.194225311279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.364537239074707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 487, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3088669776916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.311333179473877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3129868507385254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3104376792907715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11097, 40])
input nodes number: 43357
output nodes number: 11097
edges number: 67689
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.311587333679199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3115878105163574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0653533935546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 6 input nodes size: 105222
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05726957321166992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05726957321166992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10744333267211914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10752630233764648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05827665328979492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06086301803588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06086301803588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06086301803588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105222, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06086301803588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3739, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2016592025756836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2016592025756836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3739, 128]), torch.Size([1, 3739, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2058858871459961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23441219329833984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3739, 128])
m.shape torch.Size([4362, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23678922653198242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23678922653198242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4362, 128]), torch.Size([1, 4362, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2420806884765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3053741455078125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4362, 128])
m.shape torch.Size([4248, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30983448028564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.30983448028564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4248, 128]), torch.Size([1, 4248, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3138856887817383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4030122756958008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4248, 128])
m.shape torch.Size([3733, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40810680389404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40810680389404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3733, 128]), torch.Size([1, 3733, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.41191530227661133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5153865814208984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3733, 128])
m.shape torch.Size([3208, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5212550163269043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5212550163269043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3208, 128]), torch.Size([1, 3208, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.524716854095459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6379227638244629  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3208, 128])
m.shape torch.Size([2665, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6440176963806152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6440176963806152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2665, 128]), torch.Size([1, 2665, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6466193199157715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7609472274780273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2665, 128])
m.shape torch.Size([2190, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7665166854858398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7665166854858398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2190, 128]), torch.Size([1, 2190, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7688665390014648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.877805233001709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2190, 128])
m.shape torch.Size([1924, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8833661079406738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8833661079406738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1924, 128]), torch.Size([1, 1924, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8852009773254395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9904637336730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1924, 128])
m.shape torch.Size([1646, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.996610164642334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.996610164642334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9981799125671387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1014208793640137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([16591, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1797480583190918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1797480583190918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16591, 128]), torch.Size([1, 16591, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.195570468902588  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.319532871246338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16591, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.1966748237609863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.2389283180236816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.281181812286377  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.238597869873047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44306, 256])
first layer input nodes number: 105222
first layer output nodes number: 44306
edges number: 283615
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.281968116760254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.324221611022949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.334784984588623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.334784984588623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2088, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3982768058776855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3982768058776855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2088, 256]), torch.Size([1, 2088, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.40317964553833  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.43503999710083  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2088, 256])
m.shape torch.Size([1763, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4364380836486816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4364380836486816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1763, 256]), torch.Size([1, 1763, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.439934253692627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.492405414581299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1763, 256])
m.shape torch.Size([1460, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.494612216949463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.494612216949463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1460, 256]), torch.Size([1, 1460, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.49814510345459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5632948875427246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1460, 256])
m.shape torch.Size([1125, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5657529830932617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5657529830932617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.568118095397949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6327223777770996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([879, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6355857849121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6355857849121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 879, 256]), torch.Size([1, 879, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6372623443603516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.698453903198242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 879, 256])
m.shape torch.Size([651, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7013702392578125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7013702392578125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7026119232177734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.756453514099121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([505, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.759230613708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.759230613708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.7601938247680664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.810606002807617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([435, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.813469409942627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.813469409942627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 435, 256]), torch.Size([1, 435, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8142991065979004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8618111610412598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 435, 256])
m.shape torch.Size([322, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8641819953918457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8641819953918457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8647961616516113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9058151245117188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([266, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.908064842224121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.908064842224121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.908572196960449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.945160388946533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([233, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9473705291748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9473705291748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.94781494140625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9824790954589844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([177, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9842987060546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9842987060546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9846363067626953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0133323669433594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([133, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0148258209228516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0148258209228516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0150794982910156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0384178161621094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0398788452148438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0398788452148438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0401039123535156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0623855590820312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([102, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0637435913085938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0637435913085938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0639381408691406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0845603942871094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([91, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.085862636566162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.085862636566162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.086036205291748  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.105649471282959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1065268516540527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1065268516540527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1066393852233887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.120143413543701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1211600303649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1211600303649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1212782859802246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1362967491149902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1372604370117188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1372604370117188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1373672485351562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1516799926757812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.152472496032715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.152472496032715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1525564193725586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1643896102905273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1650948524475098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1650948524475098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.165165424346924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.175610065460205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1761460304260254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1761460304260254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1761975288391113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1841797828674316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1847290992736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1847290992736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1847786903381348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.192812442779541  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1932029724121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1932029724121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1932373046875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1990394592285156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([424, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2092103958129883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2092103958129883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.210019111633301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.352992057800293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 424, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.300356864929199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3023481369018555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3048410415649414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.302766799926758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11101, 40])
input nodes number: 44306
output nodes number: 11101
edges number: 63486
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3027052879333496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.302705764770508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06534814834594727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 7 input nodes size: 105418
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05780172348022461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05780172348022461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10858297348022461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.10866594314575195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.05840921401977539  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0612945556640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0612945556640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0612945556640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105418, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.0612945556640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3804, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20105981826782227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20105981826782227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3804, 128]), torch.Size([1, 3804, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.20552778244018555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.23552465438842773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3804, 128])
m.shape torch.Size([4583, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2380814552307129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2380814552307129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4583, 128]), torch.Size([1, 4583, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.24245214462280273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.3096919059753418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4583, 128])
m.shape torch.Size([4206, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.31296348571777344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.31296348571777344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4206, 128]), torch.Size([1, 4206, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.31775426864624023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40857791900634766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4206, 128])
m.shape torch.Size([3733, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4142274856567383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4142274856567383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3733, 128]), torch.Size([1, 3733, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.41787147521972656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5211973190307617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3733, 128])
m.shape torch.Size([3195, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5270347595214844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5270347595214844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3195, 128]), torch.Size([1, 3195, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5304965972900391  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6429085731506348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3195, 128])
m.shape torch.Size([2616, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.648869514465332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.648869514465332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2616, 128]), torch.Size([1, 2616, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6513681411743164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7661194801330566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2616, 128])
m.shape torch.Size([2183, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7721586227416992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7721586227416992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2183, 128]), torch.Size([1, 2183, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7743167877197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.883781909942627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2183, 128])
m.shape torch.Size([1868, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8890724182128906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8890724182128906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1868, 128]), torch.Size([1, 1868, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8908538818359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9930729866027832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1868, 128])
m.shape torch.Size([1612, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9991002082824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9991002082824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1612, 128]), torch.Size([1, 1612, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0006375312805176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.0993409156799316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1612, 128])
m.shape torch.Size([16409, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.176816463470459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.176816463470459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16409, 128]), torch.Size([1, 16409, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1924653053283691  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3035330772399902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16409, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.1801652908325195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.2223262786865234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.2644872665405273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.221996784210205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44209, 256])
first layer input nodes number: 105418
first layer output nodes number: 44209
edges number: 281014
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.265275001525879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.307435989379883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.317976474761963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.317976474761963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2076, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3790245056152344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3790245056152344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2076, 256]), torch.Size([1, 2076, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.3830976486206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.416459560394287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2076, 256])
m.shape torch.Size([1865, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.41794490814209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.41794490814209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1865, 256]), torch.Size([1, 1865, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.421511173248291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4756054878234863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1865, 256])
m.shape torch.Size([1440, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4778761863708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.4778761863708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1440, 256]), torch.Size([1, 1440, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.481079578399658  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.544501304626465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1440, 256])
m.shape torch.Size([1112, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5468950271606445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5468950271606445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1112, 256]), torch.Size([1, 1112, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.5490617752075195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6144304275512695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1112, 256])
m.shape torch.Size([928, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6182093620300293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6182093620300293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 928, 256]), torch.Size([1, 928, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.6199793815612793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.683713436126709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 928, 256])
m.shape torch.Size([688, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.686796188354492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.686796188354492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.688108444213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.748126983642578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([522, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.751906394958496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.751906394958496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 522, 256]), torch.Size([1, 522, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.752902030944824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8031482696533203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 522, 256])
m.shape torch.Size([425, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8059186935424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8059186935424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 425, 256]), torch.Size([1, 425, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.806729316711426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8538665771484375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 425, 256])
m.shape torch.Size([337, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8563766479492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8563766479492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.8570194244384766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.898867607116699  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9012279510498047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9012279510498047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9017601013183594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9405384063720703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([192, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9423022270202637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9423022270202637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9426684379577637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9712328910827637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([158, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.972872257232666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.972872257232666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9731736183166504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 2.9987893104553223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0002379417419434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0002379417419434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0004820823669434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0229430198669434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([108, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0242743492126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0242743492126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0244803428649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0448737144470215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([102, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.046241283416748  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.046241283416748  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.046435832977295  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0670580863952637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0679450035095215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0679450035095215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0680670738220215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0818610191345215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.082869052886963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.082869052886963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0829930305480957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.097870349884033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0985870361328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0985870361328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.098672866821289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1095733642578125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([45, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1103525161743164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1103525161743164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.110438346862793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1219396591186523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.122684955596924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.122684955596924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.122763156890869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.133789539337158  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1342954635620117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1342954635620117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1343469619750977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1419687271118164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1423239707946777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1423239707946777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1423583030700684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1476798057556152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1481270790100098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1481270790100098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.148167133331299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.154655933380127  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1550745964050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1550745964050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1551108360290527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1612353324890137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([381, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1703720092773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1703720092773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1710987091064453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3018198013305664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 381, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.251859188079834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2537407875061035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.255831241607666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.253866672515869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11086, 40])
input nodes number: 44209
output nodes number: 11086
edges number: 60974
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.254169464111328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2541699409484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06629228591918945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.07184267044067383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.07184267044067383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03498318791389465 |0.046132802963256836 |0.19347932934761047 |0.00010523200035095215 |0.07885625958442688 |0.003877878189086914 |
----------------------------------------------------------pseudo_mini_loss sum 5.316211700439453
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1183100
Number of first layer input nodes during this epoch:  821177
Number of first layer output nodes during this epoch:  361923
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.07184219360351562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.026276588439941406
global_2_local spend time (sec) 0.043706417083740234
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004221200942993164
A = g.adjacency_matrix() spent  0.00886678695678711
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0826423168182373
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3148303031921387
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1566541194915771

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})[05:16:00] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 512748 edges into 8 parts and get 4756 edge cuts

28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 0.018 seconds
Metis partitioning: 0.074 seconds
Split the graph: 0.053 seconds
Construct subgraphs: 0.046 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.19185876846313477
11477
11433
11540
11422
11601
11149
11153
11166
total k batches seeds list generation spend  10.37224268913269
after graph partition
graph partition algorithm spend time 10.45318603515625
11477
11433
11540
11422
11601
11149
11153
11166
partition_len_list
[51406, 48838, 43715, 45639, 38092, 44724, 44330, 44075]
shared_neighbor_graph_partition_s0 selection method  spend 10.551633358001709
time for parepare:  0.018534183502197266
local_output_nid generation:  0.0027213096618652344
local_in_edges_tensor generation:  0.002845287322998047
mini_batch_src_global generation:  0.0050373077392578125
r_  generation:  0.04635810852050781
local_output_nid generation:  0.0036351680755615234
local_in_edges_tensor generation:  0.002562284469604492
mini_batch_src_global generation:  0.004659891128540039
r_  generation:  0.034694671630859375
local_output_nid generation:  0.003747701644897461
local_in_edges_tensor generation:  0.0025947093963623047
mini_batch_src_global generation:  0.0034301280975341797
r_  generation:  0.03603410720825195
local_output_nid generation:  0.003664731979370117
local_in_edges_tensor generation:  0.002469301223754883
mini_batch_src_global generation:  0.002512216567993164
r_  generation:  0.028033018112182617
local_output_nid generation:  0.003727436065673828
local_in_edges_tensor generation:  0.0026488304138183594
mini_batch_src_global generation:  0.003674030303955078
r_  generation:  0.03976035118103027
local_output_nid generation:  0.003609895706176758
local_in_edges_tensor generation:  0.0022618770599365234
mini_batch_src_global generation:  0.0025408267974853516
r_  generation:  0.02442622184753418
local_output_nid generation:  0.0034389495849609375
local_in_edges_tensor generation:  0.002284526824951172
mini_batch_src_global generation:  0.0021173954010009766
r_  generation:  0.02424001693725586
local_output_nid generation:  0.0032644271850585938
local_in_edges_tensor generation:  0.002195596694946289
mini_batch_src_global generation:  0.002120494842529297
r_  generation:  0.02499675750732422
----------------------check_connections_block total spend ----------------------------- 0.4168696403503418
generate_one_block  0.07999467849731445
generate_one_block  0.05230140686035156
generate_one_block  0.05262351036071777
generate_one_block  0.040566444396972656
generate_one_block  0.0554962158203125
generate_one_block  0.03661203384399414
generate_one_block  0.03528285026550293
generate_one_block  0.036545515060424805
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.019188880920410156
gen group dst list time:  0.010617971420288086
time for parepare:  0.020340681076049805
local_output_nid generation:  0.009092569351196289
local_in_edges_tensor generation:  0.022602319717407227
mini_batch_src_global generation:  0.017027616500854492
r_  generation:  0.14276957511901855
local_output_nid generation:  0.018558740615844727
local_in_edges_tensor generation:  0.012306451797485352
mini_batch_src_global generation:  0.014093160629272461
r_  generation:  0.13086533546447754
local_output_nid generation:  0.014927148818969727
local_in_edges_tensor generation:  0.009541511535644531
mini_batch_src_global generation:  0.012056350708007812
r_  generation:  0.11643528938293457
local_output_nid generation:  0.01744365692138672
local_in_edges_tensor generation:  0.009705543518066406
mini_batch_src_global generation:  0.012040376663208008
r_  generation:  0.1208655834197998
local_output_nid generation:  0.012846708297729492
local_in_edges_tensor generation:  0.008145570755004883
mini_batch_src_global generation:  0.011388063430786133
r_  generation:  0.10387659072875977
local_output_nid generation:  0.01587653160095215
local_in_edges_tensor generation:  0.01029658317565918
mini_batch_src_global generation:  0.012323141098022461
r_  generation:  0.11696481704711914
local_output_nid generation:  0.016955137252807617
local_in_edges_tensor generation:  0.015466690063476562
mini_batch_src_global generation:  0.014064788818359375
r_  generation:  0.13014531135559082
local_output_nid generation:  0.02059459686279297
local_in_edges_tensor generation:  0.010410785675048828
mini_batch_src_global generation:  0.01299595832824707
r_  generation:  0.1170654296875
----------------------check_connections_block total spend ----------------------------- 1.5681159496307373
generate_one_block  0.19226336479187012
generate_one_block  0.17026877403259277
generate_one_block  0.15247464179992676
generate_one_block  0.18837881088256836
generate_one_block  0.13260293006896973
generate_one_block  0.14370512962341309
generate_one_block  0.14079570770263672
generate_one_block  0.14049887657165527
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.07184219360351562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

connection checking time:  1.5681159496307373
block generation total time  1.2609882354736328
average batch blocks generation time:  0.1576235294342041
block dataloader generation time/epoch 14.373167037963867
pseudo mini batch 0 input nodes size: 102644
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06384897232055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06384897232055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.1127934455871582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.11287927627563477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06201505661010742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06610631942749023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06610631942749023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06610631942749023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([102644, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.06610631942749023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2209, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.26529502868652344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.26529502868652344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2209, 128]), torch.Size([1, 2209, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.26740169525146484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.2844200134277344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2209, 128])
m.shape torch.Size([2770, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.286008358001709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.286008358001709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2770, 128]), torch.Size([1, 2770, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.29020023345947266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.33121585845947266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2770, 128])
m.shape torch.Size([2765, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.33385753631591797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.33385753631591797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2765, 128]), torch.Size([1, 2765, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.33649444580078125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.39693355560302734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2765, 128])
m.shape torch.Size([2651, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40067148208618164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40067148208618164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2651, 128]), torch.Size([1, 2651, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.40325403213500977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.47657155990600586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2651, 128])
m.shape torch.Size([2518, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4813108444213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.4813108444213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2518, 128]), torch.Size([1, 2518, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.48371219635009766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5717649459838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2518, 128])
m.shape torch.Size([2224, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5764627456665039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5764627456665039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2224, 128]), torch.Size([1, 2224, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.5786514282226562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6738576889038086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2224, 128])
m.shape torch.Size([1954, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6793193817138672  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.6793193817138672  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1954, 128]), torch.Size([1, 1954, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.681182861328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7781219482421875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1954, 128])
m.shape torch.Size([1837, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7841978073120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.7841978073120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.78594970703125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.885807991027832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1709, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8922662734985352  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8922662734985352  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.8938961029052734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 0.9982051849365234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([30769, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1441082954406738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1441082954406738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 30769, 128]), torch.Size([1, 30769, 128])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 1.1734519004821777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2577075958251953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 30769, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.0725560188293457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1215806007385254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.170605182647705  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.12119722366333  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([51406, 256])
first layer input nodes number: 102644
first layer output nodes number: 51406
edges number: 404027
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.1713719367980957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2203965187072754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2326526641845703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.2326526641845703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1142, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3736610412597656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3736610412597656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1142, 256]), torch.Size([1, 1142, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3762383460998535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3972601890563965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1142, 256])
m.shape torch.Size([974, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3973779678344727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.3973779678344727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 974, 256]), torch.Size([1, 974, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.399235725402832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4276914596557617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 974, 256])
m.shape torch.Size([763, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.42978572845459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.42978572845459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.431241035461426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.466280937194824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([644, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.468029499053955  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.468029499053955  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.4692578315734863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5048794746398926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([512, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.506725788116455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.506725788116455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.507702350616455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5480003356933594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([431, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5499978065490723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5499978065490723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 431, 256]), torch.Size([1, 431, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5508198738098145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5895872116088867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 431, 256])
m.shape torch.Size([334, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.591423511505127  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.591423511505127  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.5920605659484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6306028366088867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([304, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6326217651367188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6326217651367188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6332015991210938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.6668853759765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([299, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.669182300567627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.669182300567627  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.669752597808838  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.707158088684082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([293, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.709689140319824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.709689140319824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7102479934692383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7504568099975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([280, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7531380653381348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7531380653381348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7536721229553223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7960572242736816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.798673629760742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.798673629760742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.7991504669189453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.839681625366211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([246, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.8425168991088867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.8425168991088867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.8429861068725586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.886153221130371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([221, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.888892650604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.888892650604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.8893141746520996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9310450553894043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([217, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.933962821960449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.933962821960449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9343767166137695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9782495498657227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([209, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9812569618225098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9812569618225098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 3.9816555976867676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.0267014503479  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([192, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.02963924407959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.02963924407959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.03000545501709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.07395076751709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([207, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.0773491859436035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.0773491859436035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.077744007110596  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.1278862953186035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([177, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.130921363830566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.130921363830566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.131258964538574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.176497459411621  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([172, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.179635047912598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.179635047912598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.179963111877441  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.22622013092041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([182, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.229729652404785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.229729652404785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.230076789855957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.2814531326293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([130, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.284033298492432  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.284033298492432  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.284281253814697  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.322714328765869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([134, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.325552940368652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.325552940368652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 8.3397216796875 GB
    Memory Allocated: 4.325808525085449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 4.367213249206543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([130, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 4.370084285736084  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 4.370084285736084  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.3670654296875 GB
    Memory Allocated: 4.37033224105835  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 4.41223669052124  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([3034, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 4.48501443862915  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 4.48501443862915  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3034, 256]), torch.Size([1, 3034, 256])
----------------------------------------3
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 4.4908013343811035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.5092949867248535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3034, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.3781657218933105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.379931926727295  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.3821024894714355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.380250453948975  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11477, 40])
input nodes number: 51406
output nodes number: 11477
edges number: 144990
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.380604267120361  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4139404296875 GB
    Memory Allocated: 5.380605220794678  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07320737838745117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 1 input nodes size: 106722
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06190061569213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06190061569213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11278963088989258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11287498474121094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06384468078613281  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0672006607055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0672006607055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0672006607055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([106722, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0672006607055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3012, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23928546905517578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23928546905517578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3012, 128]), torch.Size([1, 3012, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2421579360961914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26638174057006836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3012, 128])
m.shape torch.Size([3800, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26807117462158203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26807117462158203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3800, 128]), torch.Size([1, 3800, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2716951370239258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32605457305908203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3800, 128])
m.shape torch.Size([3620, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3294210433959961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3294210433959961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3620, 128]), torch.Size([1, 3620, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3329591751098633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.40890979766845703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3620, 128])
m.shape torch.Size([3397, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41395092010498047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41395092010498047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3397, 128]), torch.Size([1, 3397, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4172968864440918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5156903266906738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3397, 128])
m.shape torch.Size([3016, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5221695899963379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5221695899963379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3016, 128]), torch.Size([1, 3016, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5260615348815918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.634406566619873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3016, 128])
m.shape torch.Size([2565, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6403069496154785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6403069496154785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2565, 128]), torch.Size([1, 2565, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6427979469299316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7489757537841797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2565, 128])
m.shape torch.Size([2185, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7550458908081055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7550458908081055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7571744918823242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.866943359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([2029, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8728642463684082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8728642463684082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2029, 128]), torch.Size([1, 2029, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8747992515563965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9860005378723145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2029, 128])
m.shape torch.Size([1842, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9929380416870117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9929380416870117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1842, 128]), torch.Size([1, 1842, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.994694709777832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.107121467590332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1842, 128])
m.shape torch.Size([23372, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2176895141601562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2176895141601562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 23372, 128]), torch.Size([1, 23372, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2399787902832031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8232040405273438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 23372, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6687965393066406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.715372085571289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7619476318359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.715007781982422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([48838, 256])
first layer input nodes number: 106722
first layer output nodes number: 48838
edges number: 347355
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.762744903564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8093204498291016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8209643363952637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8209643363952637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1585, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9220199584960938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9220199584960938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1585, 256]), torch.Size([1, 1585, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.925558090209961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9514098167419434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1585, 256])
m.shape torch.Size([1435, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9522037506103516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9522037506103516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1435, 256]), torch.Size([1, 1435, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.955078125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0005626678466797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1435, 256])
m.shape torch.Size([1082, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0013551712036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0013551712036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1082, 256]), torch.Size([1, 1082, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.003483295440674  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.050960063934326  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1082, 256])
m.shape torch.Size([846, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.053058624267578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.053058624267578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0546722412109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1014671325683594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([744, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.10493803024292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.10493803024292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1063570976257324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.157741069793701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([581, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1603822708129883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1603822708129883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1614904403686523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2106313705444336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([459, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2140555381774902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2140555381774902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.214931011199951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.258704662322998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([385, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.261227607727051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.261227607727051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2619619369506836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3064088821411133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([360, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3091559410095215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3091559410095215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.309842586517334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3539881706237793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([332, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3568358421325684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3568358421325684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.357469081878662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4030919075012207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.405799388885498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.405799388885498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4063448905944824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.449927806854248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([252, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4528441429138184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4528441429138184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.453324794769287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.494180202484131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4966015815734863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4966015815734863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4970078468322754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.534384250640869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([171, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.536482334136963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.536482334136963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.536808490753174  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5690979957580566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.571227550506592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.571227550506592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.571530818939209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.603677272796631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([150, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.605832576751709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.605832576751709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.606118679046631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6384482383728027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([132, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6404623985290527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6404623985290527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.640714168548584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.670926570892334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([136, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.673153877258301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.673153877258301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6734132766723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.706357002258301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([124, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.708491802215576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.708491802215576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.708728313446045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7404208183288574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.742340564727783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.742340564727783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7425427436828613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.771049976348877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7728867530822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7728867530822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7730698585510254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8001694679260254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.801769733428955  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.801769733428955  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.80192232131958  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.825573444366455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.826808452606201  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.826808452606201  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.826920986175537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.845151424407959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([82, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.846986770629883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.846986770629883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8471431732177734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.873575210571289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([1578, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9114136695861816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9114136695861816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1578, 256]), torch.Size([1, 1578, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9144234657287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.444656848907471  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1578, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.354187965393066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.356152534484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.358760833740234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.356710910797119  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11433, 40])
input nodes number: 48838
output nodes number: 11433
edges number: 102981
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.357358932495117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.357359409332275  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07413816452026367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 2 input nodes size: 99431
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06404304504394531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06404304504394531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11145544052124023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.111541748046875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.060567378997802734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06386852264404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06386852264404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06386852264404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([99431, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06386852264404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3033, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21063661575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21063661575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3033, 128]), torch.Size([1, 3033, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21352910995483398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23732471466064453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3033, 128])
m.shape torch.Size([3710, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23941659927368164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23941659927368164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3710, 128]), torch.Size([1, 3710, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24295473098754883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.29683732986450195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3710, 128])
m.shape torch.Size([3687, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3003425598144531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3003425598144531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3687, 128]), torch.Size([1, 3687, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.30385875701904297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.38121509552001953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3687, 128])
m.shape torch.Size([3342, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.38605260848999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.38605260848999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3342, 128]), torch.Size([1, 3342, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.389404296875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4867229461669922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3342, 128])
m.shape torch.Size([2960, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.49309730529785156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.49309730529785156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2960, 128]), torch.Size([1, 2960, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.49603843688964844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5992603302001953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2960, 128])
m.shape torch.Size([2577, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6052217483520508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6052217483520508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2577, 128]), torch.Size([1, 2577, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6077976226806641  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.714444637298584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2577, 128])
m.shape torch.Size([2231, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7206625938415527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7206625938415527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2231, 128]), torch.Size([1, 2231, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7228851318359375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8337306976318359  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2231, 128])
m.shape torch.Size([2049, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8401007652282715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8401007652282715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2049, 128]), torch.Size([1, 2049, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8425240516662598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9589357376098633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2049, 128])
m.shape torch.Size([1808, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9657654762268066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9657654762268066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1808, 128]), torch.Size([1, 1808, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9674897193908691  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0778412818908691  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1808, 128])
m.shape torch.Size([18318, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1643261909484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1643261909484863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 18318, 128]), torch.Size([1, 18318, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.181795597076416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.422123432159424  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 18318, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.291978359222412  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3336682319641113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3753581047058105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3333420753479004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([43715, 256])
first layer input nodes number: 99431
first layer output nodes number: 43715
edges number: 296605
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.376101016998291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4177908897399902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.428213596343994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.428213596343994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1472, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5306906700134277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5306906700134277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1472, 256]), torch.Size([1, 1472, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5337305068969727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5582079887390137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1472, 256])
m.shape torch.Size([1252, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5593013763427734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5593013763427734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1252, 256]), torch.Size([1, 1252, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.561798095703125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.601332664489746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1252, 256])
m.shape torch.Size([967, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6036272048950195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6036272048950195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 967, 256]), torch.Size([1, 967, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.605471611022949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6464691162109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 967, 256])
m.shape torch.Size([818, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6490478515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6490478515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6506080627441406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6958541870117188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([718, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6985249519348145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6985249519348145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 718, 256]), torch.Size([1, 718, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.699894428253174  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.74961519241333  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 718, 256])
m.shape torch.Size([631, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7525696754455566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7525696754455566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7537732124328613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.806702136993408  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([554, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8098278045654297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8098278045654297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 554, 256]), torch.Size([1, 554, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.810884475708008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.86492919921875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 554, 256])
m.shape torch.Size([498, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8682303428649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8682303428649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.869180202484131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.925349712371826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([471, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9289493560791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9289493560791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9298477172851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9879541397094727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([406, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9914073944091797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9914073944091797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9921817779541016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0491161346435547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([325, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0527992248535156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0527992248535156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0534191131591797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.10445499420166  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([323, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.107870578765869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.107870578765869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1084866523742676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.161825656890869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([280, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1650161743164062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1650161743164062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1655502319335938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.215696334838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([209, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2182416915893555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2182416915893555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2186403274536133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2581052780151367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([223, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2611212730407715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2611212730407715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2615466117858887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3066325187683105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([164, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3089418411254883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3089418411254883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3092546463012695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.344601631164551  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.347075939178467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.347075939178467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3473830223083496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.384232997894287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([131, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.386345863342285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.386345863342285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3865957260131836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.418328285217285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([146, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.420869827270508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.420869827270508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4211483001708984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.458463668823242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([135, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4609198570251465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4609198570251465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.461177349090576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.497483730316162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([108, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.499535083770752  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.499535083770752  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4997410774230957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5302281379699707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([99, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5322189331054688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5322189331054688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.532407760620117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.561676025390625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.563624858856201  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.563624858856201  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5637736320495605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5878748893737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.589738368988037  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.589738368988037  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5898985862731934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6169753074645996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([1287, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6478195190429688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6478195190429688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1287, 256]), torch.Size([1, 1287, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6502742767333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.082311630249023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1287, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9911460876464844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9934349060058594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.995154857635498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9927797317504883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11540, 40])
input nodes number: 43715
output nodes number: 11540
edges number: 104672
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.992947578430176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.992948055267334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06928443908691406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 3 input nodes size: 105514
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06032276153564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06032276153564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11110401153564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11118936538696289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0636906623840332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06733512878417969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06733512878417969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06733512878417969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105514, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06733512878417969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3677, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21447992324829102  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21447992324829102  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3677, 128]), torch.Size([1, 3677, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2179865837097168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24633312225341797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3677, 128])
m.shape torch.Size([4239, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24862241744995117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24862241744995117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4239, 128]), torch.Size([1, 4239, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.25266504287719727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31330442428588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4239, 128])
m.shape torch.Size([4296, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3174285888671875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3174285888671875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4296, 128]), torch.Size([1, 4296, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32152557373046875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41165924072265625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4296, 128])
m.shape torch.Size([3735, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41713714599609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41713714599609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3735, 128]), torch.Size([1, 3735, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4212069511413574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5252547264099121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3735, 128])
m.shape torch.Size([3314, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5313749313354492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5313749313354492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3314, 128]), torch.Size([1, 3314, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5348176956176758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6534299850463867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3314, 128])
m.shape torch.Size([2659, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6590137481689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6590137481689453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2659, 128]), torch.Size([1, 2659, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6617755889892578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7742080688476562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2659, 128])
m.shape torch.Size([2380, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7803716659545898  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7803716659545898  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2380, 128]), torch.Size([1, 2380, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7833452224731445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9006266593933105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2380, 128])
m.shape torch.Size([2102, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9075102806091309  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9075102806091309  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2102, 128]), torch.Size([1, 2102, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9096903800964355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0271072387695312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2102, 128])
m.shape torch.Size([1718, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0329904556274414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0329904556274414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0346288681030273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.139704704284668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
m.shape torch.Size([17519, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2224225997924805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2224225997924805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 17519, 128]), torch.Size([1, 17519, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2391300201416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.425356864929199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 17519, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.296462059020996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.339986801147461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.383511543273926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.339646339416504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([45639, 256])
first layer input nodes number: 105514
first layer output nodes number: 45639
edges number: 296635
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3842997550964355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4278244972229004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4387059211730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4387059211730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1965, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.513639450073242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.513639450073242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1965, 256]), torch.Size([1, 1965, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5180158615112305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.549370765686035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1965, 256])
m.shape torch.Size([1693, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.551016330718994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.551016330718994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1693, 256]), torch.Size([1, 1693, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5545506477355957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.606595516204834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1693, 256])
m.shape torch.Size([1381, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.609543800354004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.609543800354004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1381, 256]), torch.Size([1, 1381, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6125659942626953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.673758029937744  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1381, 256])
m.shape torch.Size([1050, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6760034561157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6760034561157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1050, 256]), torch.Size([1, 1050, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6782941818237305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7412052154541016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1050, 256])
m.shape torch.Size([868, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.744375228881836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.744375228881836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 868, 256]), torch.Size([1, 868, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.746030807495117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8064041137695312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 868, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8092846870422363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8092846870422363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8105111122131348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.867551326751709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([485, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.870201587677002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.870201587677002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.871126651763916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9192633628845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([513, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.922745704650879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.922745704650879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 513, 256]), torch.Size([1, 513, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9237241744995117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9802064895629883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 513, 256])
m.shape torch.Size([346, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.982710361480713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.982710361480713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.983370304107666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0270028114318848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([300, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0295562744140625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0295562744140625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0301284790039062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.071746826171875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([237, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0739665031433105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0739665031433105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.074418544769287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.109677791595459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1117701530456543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1117701530456543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1121535301208496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.144740581512451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1465859413146973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1465859413146973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1468968391418457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.175499439239502  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([170, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1776318550109863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1776318550109863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1779561042785645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.210056781768799  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([126, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2117114067077637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2117114067077637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.211951732635498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.237426280975342  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2389979362487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2389979362487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2392077445983887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.262916088104248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2643961906433105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2643961906433105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2645812034606934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.286782741546631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2880916595458984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2880916595458984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2882461547851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3078670501708984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3090505599975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3090505599975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.309176445007324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.326045036315918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3272318840026855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3272318840026855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3273558616638184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.344836711883545  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3459253311157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3459253311157227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.346034049987793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.362124443054199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.36307954788208  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.36307954788208  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3631691932678223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3770642280578613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.378080368041992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.378080368041992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3781700134277344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3926925659179688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.393524646759033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.393524646759033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.39359712600708  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.405846118927002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([673, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.421980857849121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.421980857849121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.423264503479004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.650104522705078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 673, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5876874923706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5894789695739746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5911812782287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5893044471740723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11422, 40])
input nodes number: 45639
output nodes number: 11422
edges number: 75383
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.589801788330078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5898022651672363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07270288467407227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 4 input nodes size: 88706
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06376218795776367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06376218795776367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10606050491333008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10614728927612305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.05528068542480469  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.058803558349609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.058803558349609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.058803558349609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([88706, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.058803558349609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2334, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.18873834609985352  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.18873834609985352  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2334, 128]), torch.Size([1, 2334, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.1909642219543457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2087712287902832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2334, 128])
m.shape torch.Size([3012, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21053075790405273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21053075790405273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3012, 128]), torch.Size([1, 3012, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21366167068481445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2589859962463379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3012, 128])
m.shape torch.Size([3099, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26123714447021484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26123714447021484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3099, 128]), torch.Size([1, 3099, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26489686965942383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3324413299560547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3099, 128])
m.shape torch.Size([2877, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33645105361938477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33645105361938477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2877, 128]), torch.Size([1, 2877, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3393235206604004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41889142990112305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2877, 128])
m.shape torch.Size([2682, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42391395568847656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42391395568847656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2682, 128]), torch.Size([1, 2682, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42656421661376953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5213456153869629  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2682, 128])
m.shape torch.Size([2261, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5256524085998535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5256524085998535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2261, 128]), torch.Size([1, 2261, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5278716087341309  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6213083267211914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2261, 128])
m.shape torch.Size([2060, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6268997192382812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6268997192382812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2060, 128]), torch.Size([1, 2060, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6291666030883789  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7330880165100098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2060, 128])
m.shape torch.Size([1830, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7382187843322754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7382187843322754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1830, 128]), torch.Size([1, 1830, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7399640083312988  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8394417762756348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1830, 128])
m.shape torch.Size([1515, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8450708389282227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8450708389282227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1515, 128]), torch.Size([1, 1515, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8465156555175781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9397492408752441  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1515, 128])
m.shape torch.Size([16422, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0173330307006836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0173330307006836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16422, 128]), torch.Size([1, 16422, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.032994270324707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1449952125549316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16422, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.028514862060547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.0648422241210938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1011695861816406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.0645580291748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([38092, 256])
first layer input nodes number: 88706
first layer output nodes number: 38092
edges number: 263054
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.101832866668701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.138160228729248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1478352546691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1478352546691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1167, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.265338897705078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.265338897705078  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1167, 256]), torch.Size([1, 1167, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.267819404602051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2866673469543457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1167, 256])
m.shape torch.Size([983, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2873892784118652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2873892784118652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.28926420211792  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.317866802215576  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([835, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.320152759552002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.320152759552002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 835, 256]), torch.Size([1, 835, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3217453956604004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3571953773498535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 835, 256])
m.shape torch.Size([687, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3590402603149414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3590402603149414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 687, 256]), torch.Size([1, 687, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3603506088256836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.398350715637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 687, 256])
m.shape torch.Size([649, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4008145332336426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4008145332336426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.402052402496338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.446791172027588  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([557, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4493846893310547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4493846893310547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 557, 256]), torch.Size([1, 557, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4504470825195312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4974637031555176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 557, 256])
m.shape torch.Size([578, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.500821590423584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.500821590423584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5019240379333496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.557544231414795  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([517, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5609683990478516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5609683990478516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5619544982910156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.618741035461426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([470, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.622313976287842  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.622313976287842  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6232104301452637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6810526847839355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([473, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.685150623321533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.685150623321533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6860527992248535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.750471591949463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([427, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.75453519821167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.75453519821167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.755349636077881  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8193602561950684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([354, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8230361938476562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8230361938476562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 354, 256]), torch.Size([1, 354, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.823711395263672  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.882538318634033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 354, 256])
m.shape torch.Size([313, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8861117362976074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8861117362976074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8867087364196777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9427103996276855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([299, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9464354515075684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9464354515075684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9470057487487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.004851818084717  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([249, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0081567764282227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0081567764282227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.008631706237793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.058974266052246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([227, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.062227725982666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.062227725982666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0626606941223145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.111586093902588  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([240, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.115291118621826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.115291118621826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.115748882293701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.170680522918701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([190, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.173738956451416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.173738956451416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1741013526916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.220125675201416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([162, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.222903251647949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.222903251647949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.223212242126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2646169662475586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([184, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2679996490478516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2679996490478516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.268350601196289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3178348541259766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3208889961242676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3208889961242676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3211941719055176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3663601875305176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([115, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3689560890197754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3689560890197754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.369175434112549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4031739234924316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([112, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4055404663085938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4055404663085938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4057540893554688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4403610229492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([111, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.442814826965332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.442814826965332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.443026542663574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.478806495666504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([1542, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5157523155212402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5157523155212402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1542, 256]), torch.Size([1, 1542, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.518693447113037  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.0469794273376465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1542, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.940983772277832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9427127838134766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.944441795349121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9426259994506836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11601, 40])
input nodes number: 38092
output nodes number: 11601
edges number: 120620
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.942934513092041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.942934989929199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06414461135864258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 5 input nodes size: 105559
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.05521821975708008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.05521821975708008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10599946975708008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10608291625976562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06369781494140625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06727790832519531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06727790832519531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06727790832519531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105559, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06727790832519531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3740, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20968294143676758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20968294143676758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3740, 128]), torch.Size([1, 3740, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21331453323364258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24184846878051758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3740, 128])
m.shape torch.Size([4442, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24430131912231445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24430131912231445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4442, 128]), torch.Size([1, 4442, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24872159957885742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3151545524597168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4442, 128])
m.shape torch.Size([4269, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31914329528808594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31914329528808594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4269, 128]), torch.Size([1, 4269, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32329702377319336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41286420822143555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4269, 128])
m.shape torch.Size([3668, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.418393611907959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.418393611907959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3668, 128]), torch.Size([1, 3668, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4218916893005371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5248961448669434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3668, 128])
m.shape torch.Size([3281, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5306873321533203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5306873321533203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3281, 128]), torch.Size([1, 3281, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5341768264770508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6543107032775879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3281, 128])
m.shape torch.Size([2644, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6603107452392578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6603107452392578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2644, 128]), torch.Size([1, 2644, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6633238792419434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7768683433532715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2644, 128])
m.shape torch.Size([2258, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7825522422790527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7825522422790527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2258, 128]), torch.Size([1, 2258, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7848086357116699  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8944058418273926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2258, 128])
m.shape torch.Size([1909, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.900611400604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.900611400604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9024319648742676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0062041282653809  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1672, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0124692916870117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0124692916870117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.014063835144043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.117701530456543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([16841, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1972084045410156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1972084045410156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16841, 128]), torch.Size([1, 16841, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2132692337036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.35939884185791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16841, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2319798469543457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.274631977081299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.317284107208252  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.274298667907715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44724, 256])
first layer input nodes number: 105559
first layer output nodes number: 44724
edges number: 286908
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.31807279586792  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.360724925994873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3713879585266113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3713879585266113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1995, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.436223030090332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.436223030090332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1995, 256]), torch.Size([1, 1995, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4410314559936523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.47231388092041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1995, 256])
m.shape torch.Size([1851, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4739694595336914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4739694595336914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1851, 256]), torch.Size([1, 1851, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.477633476257324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.533167839050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1851, 256])
m.shape torch.Size([1415, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5362043380737305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5362043380737305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1415, 256]), torch.Size([1, 1415, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5393028259277344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6028213500976562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1415, 256])
m.shape torch.Size([1051, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6055126190185547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6055126190185547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1051, 256]), torch.Size([1, 1051, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6076526641845703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6702942848205566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1051, 256])
m.shape torch.Size([886, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6743369102478027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6743369102478027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6760268211364746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.736863613128662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([679, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7399344444274902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7399344444274902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 679, 256]), torch.Size([1, 679, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.74122953414917  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.798884868621826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 679, 256])
m.shape torch.Size([587, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.802186965942383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.802186965942383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8033065795898438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8592872619628906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([427, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.862010955810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.862010955810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.862825393676758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9092483520507812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([346, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.912106990814209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.912106990814209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.912766933441162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9553732872009277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([276, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9576964378356934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9576964378356934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9582228660583496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9968667030334473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([199, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9987077713012695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9987077713012695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.999087333679199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.028693199157715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([196, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.030764102935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.030764102935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0311379432678223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0629143714904785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([132, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0643768310546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0643768310546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0646286010742188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0877914428710938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([126, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0893611907958984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0893611907958984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.089601516723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.113393783569336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.114816665649414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.114816665649414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.115020751953125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1366539001464844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1378746032714844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1378746032714844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1380386352539062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.156574249267578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1576523780822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1576523780822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.157787799835205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1740384101867676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.175551414489746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.175551414489746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1756906509399414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.193373680114746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([48, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.194180965423584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.194180965423584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.194272518157959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.206540584564209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.207437038421631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.207437038421631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2075304985046387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2207083702087402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.221388339996338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.221388339996338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.221457004547119  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.231619358062744  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.232219696044922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.232219696044922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2322769165039062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2411460876464844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2417807579040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2417807579040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.241837978363037  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.251107692718506  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.251678943634033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.251678943634033  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2517285346984863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2601094245910645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([427, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2703447341918945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2703447341918945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2711591720581055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4145002365112305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 427, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.36263370513916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.364398956298828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3667821884155273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.364933490753174  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11149, 40])
input nodes number: 44724
output nodes number: 11149
edges number: 64869
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.365386486053467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.365386962890625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07233190536499023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 6 input nodes size: 105588
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06373405456542969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06373405456542969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11408233642578125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.1141657829284668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06330108642578125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06615400314331055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06615400314331055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06615400314331055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105588, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06615400314331055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3697, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20792150497436523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20792150497436523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3697, 128]), torch.Size([1, 3697, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21215343475341797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24069881439208984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3697, 128])
m.shape torch.Size([4457, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24318647384643555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24318647384643555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4457, 128]), torch.Size([1, 4457, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2474370002746582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31395578384399414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4457, 128])
m.shape torch.Size([4213, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3178572654724121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3178572654724121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4213, 128]), torch.Size([1, 4213, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3219914436340332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4103837013244629  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4213, 128])
m.shape torch.Size([3695, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4154224395751953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4154224395751953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3695, 128]), torch.Size([1, 3695, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4190497398376465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5216445922851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3695, 128])
m.shape torch.Size([3233, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5275907516479492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5275907516479492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3233, 128]), torch.Size([1, 3233, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5312647819519043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6453609466552734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3233, 128])
m.shape torch.Size([2625, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.651329517364502  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.651329517364502  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2625, 128]), torch.Size([1, 2625, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6539306640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7674503326416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2625, 128])
m.shape torch.Size([2185, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7727360725402832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7727360725402832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2185, 128]), torch.Size([1, 2185, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7750420570373535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8846707344055176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2185, 128])
m.shape torch.Size([1955, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8910865783691406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8910865783691406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1955, 128]), torch.Size([1, 1955, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8929510116577148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0027809143066406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1955, 128])
m.shape torch.Size([1661, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.008976936340332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.008976936340332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0105609893798828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1140308380126953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([16609, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.192436695098877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.192436695098877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16609, 128]), torch.Size([1, 16609, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2082762718200684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3333373069763184  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16609, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2086429595947266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2509193420410156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2931957244873047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.250588893890381  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44330, 256])
first layer input nodes number: 105588
first layer output nodes number: 44330
edges number: 283919
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2939844131469727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3362607955932617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.346829891204834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.346829891204834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2091, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4110031127929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4110031127929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2091, 256]), torch.Size([1, 2091, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.415663242340088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4484362602233887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2091, 256])
m.shape torch.Size([1784, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.450160503387451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.450160503387451  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1784, 256]), torch.Size([1, 1784, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4536852836608887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.505819797515869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1784, 256])
m.shape torch.Size([1412, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.508190155029297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.508190155029297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1412, 256]), torch.Size([1, 1412, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5118117332458496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.572824001312256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1412, 256])
m.shape torch.Size([1096, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5756912231445312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5756912231445312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1096, 256]), torch.Size([1, 1096, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5779080390930176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.642277717590332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1096, 256])
m.shape torch.Size([893, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6452598571777344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6452598571777344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.646963119506836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7085132598876953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([688, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7116293907165527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7116293907165527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7129416465759277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7703566551208496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([519, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7731924057006836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7731924057006836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7741823196411133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.824130058288574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([427, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.826918601989746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.826918601989746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.827733039855957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8743324279785156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([366, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.877091407775879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.877091407775879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8777894973754883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9230222702026367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([250, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.925076484680176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.925076484680176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.925553321838379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.959408760070801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([229, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9615917205810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9615917205810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9620285034179688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9960975646972656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([160, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9977245330810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9977245330810547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9980297088623047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0239696502685547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([160, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0258164405822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0258164405822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0261216163635254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0541977882385254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([117, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.055846691131592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.055846691131592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.056069850921631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.078162670135498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([111, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0796518325805664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0796518325805664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0798635482788086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1023054122924805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([82, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1035189628601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1035189628601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.103675365447998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1213488578796387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.122401714324951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.122401714324951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.122527599334717  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.137633800506592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1388888359069824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1388888359069824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1390089988708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1542696952819824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1552352905273438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1552352905273438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1553421020507812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1696548461914062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.17044734954834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.17044734954834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1705312728881836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1823644638061523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1829886436462402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1829886436462402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.183051586151123  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1923670768737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1929702758789062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1929702758789062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1930274963378906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2018966674804688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.202620029449463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.202620029449463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2026848793029785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2131905555725098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.213688850402832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.213688850402832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2137327194213867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.221146583557129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([419, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2311925888061523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2311925888061523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.231991767883301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3748912811279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 419, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3234028816223145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.325104236602783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3267664909362793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.324981689453125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11153, 40])
input nodes number: 44330
output nodes number: 11153
edges number: 64211
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.325331687927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3253321647644043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0719146728515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 7 input nodes size: 104351
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06323719024658203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06323719024658203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11299562454223633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11307907104492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06264734268188477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06610536575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06610536575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06610536575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([104351, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06610536575317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3806, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20589733123779297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20589733123779297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3806, 128]), torch.Size([1, 3806, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21033382415771484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2403392791748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3806, 128])
m.shape torch.Size([4510, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24282550811767578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24282550811767578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4510, 128]), torch.Size([1, 4510, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24712657928466797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3139486312866211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4510, 128])
m.shape torch.Size([4180, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31700897216796875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31700897216796875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4180, 128]), torch.Size([1, 4180, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3220396041870117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41066551208496094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4180, 128])
m.shape torch.Size([3729, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4163646697998047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4163646697998047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3729, 128]), torch.Size([1, 3729, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4200706481933594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5233516693115234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3729, 128])
m.shape torch.Size([3324, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5294985771179199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5294985771179199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3324, 128]), torch.Size([1, 3324, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.532989501953125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6516642570495605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3324, 128])
m.shape torch.Size([2625, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6575894355773926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6575894355773926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2625, 128]), torch.Size([1, 2625, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6610684394836426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7759804725646973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2625, 128])
m.shape torch.Size([2225, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7821555137634277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7821555137634277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2225, 128]), torch.Size([1, 2225, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7843222618103027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8933439254760742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2225, 128])
m.shape torch.Size([1878, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.899446964263916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.899446964263916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1878, 128]), torch.Size([1, 1878, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.901237964630127  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0033249855041504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1878, 128])
m.shape torch.Size([1607, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0093259811401367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0093259811401367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0108585357666016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1089420318603516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
m.shape torch.Size([16191, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.185380458831787  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.185380458831787  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16191, 128]), torch.Size([1, 16191, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2008213996887207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.297128200531006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16191, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.17453670501709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2165699005126953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.258603096008301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2162413597106934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44075, 256])
first layer input nodes number: 104351
first layer output nodes number: 44075
edges number: 279624
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.259382724761963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3014159202575684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.311924457550049  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.311924457550049  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2011, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.378307819366455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.378307819366455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2011, 256]), torch.Size([1, 2011, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3824658393859863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.415501117706299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2011, 256])
m.shape torch.Size([1734, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4166388511657715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4166388511657715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1734, 256]), torch.Size([1, 1734, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.42092227935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.476743698120117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1734, 256])
m.shape torch.Size([1422, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.478987216949463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.478987216949463  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1422, 256]), torch.Size([1, 1422, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4821934700012207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5444517135620117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1422, 256])
m.shape torch.Size([1128, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5478463172912598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5478463172912598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1128, 256]), torch.Size([1, 1128, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5501275062561035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6160130500793457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1128, 256])
m.shape torch.Size([952, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6193675994873047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6193675994873047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.621183395385742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.686552047729492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([658, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.689438819885254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.689438819885254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 658, 256]), torch.Size([1, 658, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6906938552856445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.749868392944336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 658, 256])
m.shape torch.Size([529, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7527999877929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7527999877929688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7538089752197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.804258346557617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([401, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.806837558746338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.806837558746338  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8076024055480957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.853517532348633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([318, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8558859825134277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8558859825134277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.856492519378662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.895432949066162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([269, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8977155685424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8977155685424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.898228645324707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.934657096862793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([220, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9367265701293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9367265701293945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9371461868286133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.969876289367676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.97198486328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.97198486328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9723682403564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.004955291748047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([149, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0066256523132324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0066256523132324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0069098472595215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0330557823181152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([121, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0345420837402344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0345420837402344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0347728729248047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0576210021972656  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0589041709899902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0589041709899902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.059089183807373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.078700542449951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0798845291137695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0798845291137695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.080042839050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0979318618774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.099012851715088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.099012851715088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0991482734680176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.11539888381958  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([67, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.116490364074707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.116490364074707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1166181564331055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.132847785949707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.133852481842041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.133852481842041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1339612007141113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.148529529571533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.149496078491211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.149496078491211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.149595260620117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1635799407958984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1644387245178223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1644387245178223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.164524555206299  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.17722749710083  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.177713394165039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.177713394165039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1777610778808594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.185152053833008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.185680866241455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes
[05:16:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 510472 edges into 8 parts and get 5434 edge cuts

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.185680866241455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1857285499572754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.193453311920166  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1941447257995605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1941447257995605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1942038536071777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2041964530944824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([500, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2161812782287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2161812782287598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.217134952545166  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3885111808776855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 500, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3334755897521973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3353638648986816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.337869167327881  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.335897445678711  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11166, 40])
input nodes number: 44075
output nodes number: 11166
edges number: 66524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.336496353149414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3364968299865723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07216501235961914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07216501235961914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07216501235961914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0372660756111145 |0.0033068954944610596 |0.1287897527217865 |9.876489639282227e-05 |0.07691401243209839 |0.005261421203613281 |
----------------------------------------------------------pseudo_mini_loss sum 4.250729560852051
Total (block generation + training)time/epoch 16.403262853622437
Training time/epoch 2.029611349105835
Training time without block to device /epoch 2.0031561851501465
Training time without total dataloading part /epoch 1.651681661605835
load block tensor time/epoch 0.298128604888916
block to device time/epoch 0.026455163955688477
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1179334
Number of first layer input nodes during this epoch:  818515
Number of first layer output nodes during this epoch:  360819
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07216453552246094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.021782636642456055
global_2_local spend time (sec) 0.04761958122253418
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004448652267456055
A = g.adjacency_matrix() spent  0.010698080062866211
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08229398727416992
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3092756271362305
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1689927577972412

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f7

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 0.025 seconds
Metis partitioning: 0.080 seconds
Split the graph: 0.053 seconds
Construct subgraphs: 0.048 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.2063133716583252
11514
11512
11554
11548
11513
11101
11100
11099
total k batches seeds list generation spend  11.070157051086426
after graph partition
graph partition algorithm spend time 11.158849477767944
11514
11512
11554
11548
11513
11101
11100
11099
partition_len_list
[51291, 50652, 38658, 43581, 44276, 44423, 45286, 44727]
shared_neighbor_graph_partition_s0 selection method  spend 11.258949756622314
time for parepare:  0.016694068908691406
local_output_nid generation:  0.0021283626556396484
local_in_edges_tensor generation:  0.0025856494903564453
mini_batch_src_global generation:  0.00678706169128418
r_  generation:  0.05516648292541504
local_output_nid generation:  0.003408670425415039
local_in_edges_tensor generation:  0.002316713333129883
mini_batch_src_global generation:  0.0050640106201171875
r_  generation:  0.04433703422546387
local_output_nid generation:  0.0038814544677734375
local_in_edges_tensor generation:  0.003134489059448242
mini_batch_src_global generation:  0.003954410552978516
r_  generation:  0.04134631156921387
local_output_nid generation:  0.003152608871459961
local_in_edges_tensor generation:  0.0022873878479003906
mini_batch_src_global generation:  0.003123760223388672
r_  generation:  0.03195977210998535
local_output_nid generation:  0.003000020980834961
local_in_edges_tensor generation:  0.002146005630493164
mini_batch_src_global generation:  0.0027947425842285156
r_  generation:  0.031273603439331055
local_output_nid generation:  0.002923250198364258
local_in_edges_tensor generation:  0.002057313919067383
mini_batch_src_global generation:  0.0023040771484375
r_  generation:  0.02525496482849121
local_output_nid generation:  0.0029761791229248047
local_in_edges_tensor generation:  0.0020220279693603516
mini_batch_src_global generation:  0.002278566360473633
r_  generation:  0.025284290313720703
local_output_nid generation:  0.002811431884765625
local_in_edges_tensor generation:  0.001989126205444336
mini_batch_src_global generation:  0.001965761184692383
r_  generation:  0.023253202438354492
----------------------check_connections_block total spend ----------------------------- 0.44161415100097656
generate_one_block  0.08929967880249023
generate_one_block  0.058511972427368164
generate_one_block  0.05726289749145508
generate_one_block  0.04688572883605957
generate_one_block  0.04384636878967285
generate_one_block  0.03777956962585449
generate_one_block  0.06388711929321289
generate_one_block  0.03361153602600098
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03145575523376465
gen group dst list time:  0.010193347930908203
time for parepare:  0.019175052642822266
local_output_nid generation:  0.008773326873779297
local_in_edges_tensor generation:  0.021651744842529297
mini_batch_src_global generation:  0.012457847595214844
r_  generation:  0.14264154434204102
local_output_nid generation:  0.012929677963256836
local_in_edges_tensor generation:  0.013046979904174805
mini_batch_src_global generation:  0.015077352523803711
r_  generation:  0.14030957221984863
local_output_nid generation:  0.010324239730834961
local_in_edges_tensor generation:  0.008429765701293945
mini_batch_src_global generation:  0.01163339614868164
r_  generation:  0.10771512985229492
local_output_nid generation:  0.01201772689819336
local_in_edges_tensor generation:  0.009182929992675781
mini_batch_src_global generation:  0.011961936950683594
r_  generation:  0.12082934379577637
local_output_nid generation:  0.011323213577270508
local_in_edges_tensor generation:  0.009228706359863281
mini_batch_src_global generation:  0.018948078155517578
r_  generation:  0.1215355396270752
local_output_nid generation:  0.0113677978515625
local_in_edges_tensor generation:  0.009285449981689453
mini_batch_src_global generation:  0.012451171875
r_  generation:  0.12494778633117676
local_output_nid generation:  0.011742353439331055
local_in_edges_tensor generation:  0.009300470352172852
mini_batch_src_global generation:  0.012688398361206055
r_  generation:  0.11949038505554199
local_output_nid generation:  0.011605978012084961
local_in_edges_tensor generation:  0.009000062942504883
mini_batch_src_global generation:  0.012933015823364258
r_  generation:  0.1181344985961914
----------------------check_connections_block total spend ----------------------------- 1.534698486328125
generate_one_block  0.1829662322998047
generate_one_block  0.17285561561584473
generate_one_block  0.12506794929504395
generate_one_block  0.13811802864074707
generate_one_block  0.14372682571411133
generate_one_block  0.13899731636047363
generate_one_block  0.1418006420135498
generate_one_block  0.14090275764465332
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07216453552246094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

connection checking time:  1.534698486328125
block generation total time  1.1844353675842285
average batch blocks generation time:  0.14805442094802856
block dataloader generation time/epoch 14.704443573951721
pseudo mini batch 0 input nodes size: 102960
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06283330917358398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06283330917358398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11192846298217773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.1120142936706543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06217241287231445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06627321243286133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06627321243286133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06627321243286133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([102960, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06627321243286133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2150, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2654585838317871  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2654585838317871  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2150, 128]), torch.Size([1, 2150, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26750898361206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.28415536880493164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2150, 128])
m.shape torch.Size([2776, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.28577756881713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.28577756881713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2776, 128]), torch.Size([1, 2776, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.289151668548584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.330167293548584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2776, 128])
m.shape torch.Size([2732, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33281469345092773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33281469345092773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2732, 128]), torch.Size([1, 2732, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3354201316833496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.39587926864624023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2732, 128])
m.shape torch.Size([2636, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.39960432052612305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.39960432052612305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2636, 128]), torch.Size([1, 2636, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4021639823913574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4750666618347168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2636, 128])
m.shape torch.Size([2455, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4796628952026367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4796628952026367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2455, 128]), torch.Size([1, 2455, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4820222854614258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5683655738830566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2455, 128])
m.shape torch.Size([2206, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5735063552856445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5735063552856445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2206, 128]), torch.Size([1, 2206, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5756797790527344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6698527336120605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2206, 128])
m.shape torch.Size([2089, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6751766204833984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6751766204833984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2089, 128]), torch.Size([1, 2089, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6778216361999512  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7807931900024414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2089, 128])
m.shape torch.Size([1823, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7867512702941895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7867512702941895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1823, 128]), torch.Size([1, 1823, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.788489818572998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8875870704650879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1823, 128])
m.shape torch.Size([1817, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8945155143737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8945155143737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1817, 128]), torch.Size([1, 1817, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8962483406066895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0071492195129395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1817, 128])
m.shape torch.Size([30607, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1522283554077148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1522283554077148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 30607, 128]), torch.Size([1, 30607, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.181417465209961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2538442611694336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 30607, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0690503120422363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1179652214050293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1668801307678223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1175827980041504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([51291, 256])
first layer input nodes number: 102960
first layer output nodes number: 51291
edges number: 403583
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.167649269104004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.216564178466797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.228793144226074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.228793144226074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1083, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.371377468109131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.371377468109131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1083, 256]), torch.Size([1, 1083, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3737940788269043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.394998550415039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1083, 256])
m.shape torch.Size([981, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3952927589416504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3952927589416504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 981, 256]), torch.Size([1, 981, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3971638679504395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.425816059112549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 981, 256])
m.shape torch.Size([732, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4270429611206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4270429611206055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 732, 256]), torch.Size([1, 732, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.428439140319824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4591550827026367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 732, 256])
m.shape torch.Size([603, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4608592987060547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4608592987060547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4620094299316406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.497575283050537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([486, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.499335765838623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.499335765838623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.50026273727417  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.537764549255371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([390, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.539937973022461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.539937973022461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.540681838989258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5849246978759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([370, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5870423316955566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5870423316955566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5877480506896973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6291041374206543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([324, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6312427520751953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6312427520751953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6318607330322266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6674723625183105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([335, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6700615882873535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6700615882873535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6707005500793457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7122931480407715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([327, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7151169776916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7151169776916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.71574068069458  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.760857105255127  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([287, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.763579845428467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.763579845428467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.764127254486084  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.808143138885498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([282, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.811121940612793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.811121940612793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.811659812927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.85758113861084  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([262, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.860586166381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.860586166381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.861085891723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.908224105834961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([216, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9108810424804688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9108810424804688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9112930297851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9520797729492188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([229, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9555540084838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9555540084838867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.955990791320801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.002289772033691  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([215, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.005377769470215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.005377769470215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.0057878494262695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.052126884460449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([202, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.055222511291504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.055222511291504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.055607795715332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.101841926574707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([217, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.105403900146484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.105403900146484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.105817794799805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.158382415771484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([188, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.161608695983887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.161608695983887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.1619672775268555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.210017204284668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([182, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.21333646774292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.21333646774292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.213683605194092  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.262629985809326  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([187, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.266231060028076  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.266231060028076  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.266587734222412  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.319375514984131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([136, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.322072982788086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.322072982788086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.322332382202148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.362539291381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([148, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.3656816482543945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.3656816482543945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.365963935852051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.411694526672363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([128, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.414505958557129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.414505958557129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.414750099182129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.456009864807129  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([3004, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.528068542480469  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.528068542480469  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3004, 256]), torch.Size([1, 3004, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.5337982177734375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.543102264404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3004, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.410087585449219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.41203498840332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.414377212524414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.412343978881836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11514, 40])
input nodes number: 51291
output nodes number: 11514
edges number: 146783
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.412871360778809  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 5.412872314453125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07357120513916016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 1 input nodes size: 107576
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06223249435424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06223249435424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11352872848510742  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11361455917358398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06443357467651367  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06804037094116211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06804037094116211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06804037094116211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([107576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06804037094116211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2832, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.25078248977661133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.25078248977661133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2832, 128]), torch.Size([1, 2832, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.25348329544067383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.27617883682250977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2832, 128])
m.shape torch.Size([3574, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.27823686599731445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.27823686599731445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3574, 128]), torch.Size([1, 3574, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2816452980041504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33292436599731445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3574, 128])
m.shape torch.Size([3517, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3362131118774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3362131118774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3517, 128]), torch.Size([1, 3517, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.339632511138916  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4149284362792969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3517, 128])
m.shape torch.Size([3182, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41995954513549805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41995954513549805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3182, 128]), torch.Size([1, 3182, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42340946197509766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5119891166687012  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3182, 128])
m.shape torch.Size([2998, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5180583000183105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5180583000183105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2998, 128]), torch.Size([1, 2998, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5209174156188965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6293835639953613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2998, 128])
m.shape torch.Size([2551, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.634305477142334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.634305477142334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2551, 128]), torch.Size([1, 2551, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6367383003234863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.742063045501709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2551, 128])
m.shape torch.Size([2244, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7483367919921875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7483367919921875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2244, 128]), torch.Size([1, 2244, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7505669593811035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.859870433807373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2244, 128])
m.shape torch.Size([2112, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8665862083435059  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8665862083435059  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8686370849609375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9860720634460449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([1935, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9933691024780273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9933691024780273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1935, 128]), torch.Size([1, 1935, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9952144622802734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1134724617004395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1935, 128])
m.shape torch.Size([25707, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2351303100585938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2351303100585938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 25707, 128]), torch.Size([1, 25707, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2596464157104492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0002899169921875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 25707, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8335776329040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8824057579040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9312338829040527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.882028102874756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([50652, 256])
first layer input nodes number: 107576
first layer output nodes number: 50652
edges number: 370644
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.932037353515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.980865478515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9929418563842773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9929418563842773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1457, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1037497520446777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1037497520446777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1457, 256]), torch.Size([1, 1457, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1069440841674805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1305017471313477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1457, 256])
m.shape torch.Size([1296, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1320743560791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1320743560791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1296, 256]), torch.Size([1, 1296, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.135504722595215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.17258358001709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1296, 256])
m.shape torch.Size([1045, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1747889518737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1747889518737793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1045, 256]), torch.Size([1, 1045, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.17680025100708  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2225418090820312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1045, 256])
m.shape torch.Size([763, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2247581481933594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2247581481933594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2262134552001953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.271182060241699  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([722, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.274844169616699  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.274844169616699  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 722, 256]), torch.Size([1, 722, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.27622127532959  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.326840400695801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 722, 256])
m.shape torch.Size([588, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.329543113708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.329543113708496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 588, 256]), torch.Size([1, 588, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.33066463470459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.380784511566162  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 588, 256])
m.shape torch.Size([434, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.383143901824951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.383143901824951  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.383971691131592  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4259915351867676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([376, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.428468704223633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.428468704223633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4291858673095703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4712839126586914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([377, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.474186897277832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.474186897277832  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4749059677124023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5209550857543945  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([311, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5235848426818848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5235848426818848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5241780281066895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5682430267333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([288, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5709915161132812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5709915161132812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5715408325195312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.615896224975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([257, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6185860633850098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6185860633850098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6190762519836426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6629157066345215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([216, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6653695106506348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6653695106506348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6657814979553223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7036843299865723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([205, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7062368392944336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7062368392944336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.70662784576416  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.74533748626709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([174, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.747650623321533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.747650623321533  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7479825019836426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7831616401672363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([170, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7856101989746094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7856101989746094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7859344482421875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8225746154785156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.824716567993164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.824716567993164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8249855041503906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.857257843017578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([159, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8598742485046387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8598742485046387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.860177516937256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8986926078796387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([138, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9010610580444336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9010610580444336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9013242721557617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9365949630737305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([124, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.938847064971924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.938847064971924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9390835762023926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9724316596984863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9745006561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9745006561279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.974702835083008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.00462532043457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([101, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.006659984588623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.006659984588623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.006852626800537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.036712169647217  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([77, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.038318157196045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.038318157196045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.0384650230407715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.062257289886475  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([112, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.064767360687256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.064767360687256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.064980983734131  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.101083278656006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([1875, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.146247863769531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.146247863769531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1875, 256]), torch.Size([1, 1875, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.149824142456055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.77924919128418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1875, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.679675579071045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.681424617767334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.683146953582764  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.681312084197998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11512, 40])
input nodes number: 50652
output nodes number: 11512
edges number: 113326
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.681543827056885  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.681544303894043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07432365417480469  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 2 input nodes size: 89832
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06420183181762695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06420183181762695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10703706741333008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10712337493896484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.055741310119628906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.059329986572265625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.059329986572265625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.059329986572265625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([89832, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.059329986572265625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2471, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.19036483764648438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.19036483764648438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2471, 128]), torch.Size([1, 2471, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.19272136688232422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21157360076904297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2471, 128])
m.shape torch.Size([3095, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2133469581604004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2133469581604004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3095, 128]), torch.Size([1, 3095, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2173166275024414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2627596855163574  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3095, 128])
m.shape torch.Size([3246, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26553773880004883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.26553773880004883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3246, 128]), torch.Size([1, 3246, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2689509391784668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.33730030059814453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3246, 128])
m.shape torch.Size([2940, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.34136009216308594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.34136009216308594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2940, 128]), torch.Size([1, 2940, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3441658020019531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4255094528198242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2940, 128])
m.shape torch.Size([2733, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.43062353134155273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.43062353134155273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.43401145935058594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5314745903015137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2325, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5368232727050781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5368232727050781  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2325, 128]), torch.Size([1, 2325, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5391688346862793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6392097473144531  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2325, 128])
m.shape torch.Size([2041, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6458616256713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6458616256713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2041, 128]), torch.Size([1, 2041, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6478080749511719  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7453975677490234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2041, 128])
m.shape torch.Size([1816, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7513518333435059  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7513518333435059  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1816, 128]), torch.Size([1, 1816, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7530837059020996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8518004417419434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1816, 128])
m.shape torch.Size([1584, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8577322959899902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8577322959899902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1584, 128]), torch.Size([1, 1584, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8592429161071777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9559226036071777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1584, 128])
m.shape torch.Size([16407, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0334019660949707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0334019660949707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16407, 128]), torch.Size([1, 16407, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.049048900604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1599812507629395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16407, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.042858600616455  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.079725742340088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1165928840637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.079437255859375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([38658, 256])
first layer input nodes number: 89832
first layer output nodes number: 38658
edges number: 264915
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1172642707824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1541314125061035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1633481979370117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.1633481979370117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1217, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.278383731842041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.278383731842041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1217, 256]), torch.Size([1, 1217, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2810888290405273  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3003897666931152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1217, 256])
m.shape torch.Size([1021, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3009800910949707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3009800910949707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1021, 256]), torch.Size([1, 1021, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3029274940490723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3321385383605957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1021, 256])
m.shape torch.Size([851, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.333928108215332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.333928108215332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 851, 256]), torch.Size([1, 851, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3355512619018555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.371898651123047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 851, 256])
m.shape torch.Size([688, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.373892307281494  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.373892307281494  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.375204563140869  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4138035774230957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([672, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.416377067565918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.416377067565918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 672, 256]), torch.Size([1, 672, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.417658805847168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.463841438293457  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 672, 256])
m.shape torch.Size([598, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4666495323181152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4666495323181152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.467790126800537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5168356895446777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5199522972106934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5199522972106934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5209975242614746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5753302574157715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([488, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5785598754882812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5785598754882812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5794906616210938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6335573196411133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([479, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.637235641479492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.637235641479492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6381492614746094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6970815658569336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([436, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7014012336730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7014012336730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.702232837677002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7635912895202637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([415, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7675633430480957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7675633430480957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 415, 256]), torch.Size([1, 415, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.768354892730713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.831613063812256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 415, 256])
m.shape torch.Size([341, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8351502418518066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8351502418518066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8358006477355957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.893477439880371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([317, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.89711332321167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.89711332321167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8977179527282715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.954153537750244  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([281, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.957632541656494  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.957632541656494  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9581685066223145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0120491981506348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([257, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.015486717224121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.015486717224121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.015976905822754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.069746494293213  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([209, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0727157592773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0727157592773438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0731143951416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1181602478027344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([226, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.122567653656006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.122567653656006  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1229987144470215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1747260093688965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([193, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.177849769592285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.177849769592285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.178217887878418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.224968910217285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2275424003601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2275424003601074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.227830410003662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2664237022399902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([184, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2698168754577637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2698168754577637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.270167827606201  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3196520805358887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([147, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.322443962097168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.322443962097168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3227243423461914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.36422061920166  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([115, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3665122985839844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3665122985839844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.366731643676758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4007301330566406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([112, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4030966758728027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4030966758728027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4033102989196777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4379172325134277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.440279006958008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.440279006958008  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4404830932617188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.474973678588867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([1501, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5109381675720215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.5109381675720215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1501, 256]), torch.Size([1, 1501, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.514528751373291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 4.0416178703308105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1501, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9382095336914062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9399313926696777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.941653251647949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.939845085144043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11554, 40])
input nodes number: 38658
output nodes number: 11554
edges number: 117985
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9402260780334473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.9402265548706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06484651565551758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 3 input nodes size: 101523
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.05574750900268555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.05574750900268555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10457563400268555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.10466194152832031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06174039840698242  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06511640548706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06511640548706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06511640548706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([101523, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06511640548706055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3259, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20932674407958984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20932674407958984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3259, 128]), torch.Size([1, 3259, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2124347686767578  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23746109008789062  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3259, 128])
m.shape torch.Size([3932, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23965692520141602  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23965692520141602  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3932, 128]), torch.Size([1, 3932, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2434067726135254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3007493019104004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3932, 128])
m.shape torch.Size([3799, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.30449914932250977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.30449914932250977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3799, 128]), torch.Size([1, 3799, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.30879640579223633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.38997793197631836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3799, 128])
m.shape torch.Size([3541, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.39492034912109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.39492034912109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3541, 128]), torch.Size([1, 3541, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3984203338623047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.49717235565185547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3541, 128])
m.shape torch.Size([3026, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5026984214782715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5026984214782715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3026, 128]), torch.Size([1, 3026, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.505897045135498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6160321235656738  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3026, 128])
m.shape torch.Size([2628, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.622107982635498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.622107982635498  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2628, 128]), torch.Size([1, 2628, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6248288154602051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7355351448059082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2628, 128])
m.shape torch.Size([2202, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7416319847106934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7416319847106934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2202, 128]), torch.Size([1, 2202, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7438530921936035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8529171943664551  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2202, 128])
m.shape torch.Size([2010, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.859534740447998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.859534740447998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2010, 128]), torch.Size([1, 2010, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8614516258239746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9721636772155762  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2010, 128])
m.shape torch.Size([1645, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9792351722717285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9792351722717285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1645, 128]), torch.Size([1, 1645, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9808039665222168  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0847220420837402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1645, 128])
m.shape torch.Size([17539, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1675701141357422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1675701141357422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 17539, 128]), torch.Size([1, 17539, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1842966079711914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.371877670288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 17539, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2448058128356934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.286367893218994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.327929973602295  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.286043167114258  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([43581, 256])
first layer input nodes number: 101523
first layer output nodes number: 43581
edges number: 289271
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.328688621520996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.370250701904297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.380641460418701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.380641460418701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1725, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.469578742980957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.469578742980957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1725, 256]), torch.Size([1, 1725, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4732651710510254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.501126289367676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1725, 256])
m.shape torch.Size([1424, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.502608299255371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.502608299255371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1424, 256]), torch.Size([1, 1424, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5056052207946777  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5476765632629395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1424, 256])
m.shape torch.Size([1153, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.549421787261963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.549421787261963  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1153, 256]), torch.Size([1, 1153, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.55216121673584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6028666496276855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1153, 256])
m.shape torch.Size([941, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6053848266601562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6053848266601562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 941, 256]), torch.Size([1, 941, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.607179641723633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.659316062927246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 941, 256])
m.shape torch.Size([828, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.662397861480713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.662397861480713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 828, 256]), torch.Size([1, 828, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6639771461486816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.721095085144043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 828, 256])
m.shape torch.Size([668, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7241578102111816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7241578102111816  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 668, 256]), torch.Size([1, 668, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7254319190979004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.78157377243042  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 668, 256])
m.shape torch.Size([564, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.784731388092041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.784731388092041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 564, 256]), torch.Size([1, 564, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7858071327209473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.840223789215088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 564, 256])
m.shape torch.Size([507, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8436408042907715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8436408042907715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 507, 256]), torch.Size([1, 507, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8446078300476074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9001851081848145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 507, 256])
m.shape torch.Size([406, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9032139778137207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9032139778137207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9039883613586426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.954524517059326  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([380, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.957789897918701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.957789897918701  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.95851469039917  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0120654106140137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([314, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0150227546691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0150227546691895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0156216621398926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0634751319885254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([272, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.066312789916992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.066312789916992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.066831588745117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.11221981048584  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([219, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.114696979522705  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.114696979522705  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.115114688873291  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1535439491271973  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([183, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1557979583740234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1557979583740234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.156147003173828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.190702438354492  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1927051544189453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1927051544189453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1929931640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.223522186279297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([128, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.225346565246582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.225346565246582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.225590705871582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.253178596496582  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.255279064178467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.255279064178467  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2555384635925293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2866663932800293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.288301467895508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.288301467895508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2884960174560547  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.313203811645508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3150973320007324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3150973320007324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.315305233001709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3431639671325684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.344886302947998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.344886302947998  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3450675010681152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3706164360046387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.372342586517334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.372342586517334  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.372514247894287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3979201316833496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.399441719055176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.399441719055176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3995866775512695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.422055244445801  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.422933578491211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.422933578491211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.423015594482422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4363021850585938  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.437760829925537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.437760829925537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.43788480758667  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4588370323181152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([969, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.482058525085449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.482058525085449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4839067459106445  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.8091936111450195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 969, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7322998046875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7344112396240234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.736156940460205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.733959197998047  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11548, 40])
input nodes number: 43581
output nodes number: 11548
edges number: 90297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7343692779541016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7343697547912598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07047843933105469  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 4 input nodes size: 102519
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.061739444732666016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.061739444732666016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11062431335449219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11071014404296875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.061795711517333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06606721878051758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06606721878051758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06606721878051758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([102519, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06606721878051758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3491, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20886802673339844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20886802673339844  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3491, 128]), torch.Size([1, 3491, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21219730377197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.23954105377197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3491, 128])
m.shape torch.Size([4217, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2418980598449707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2418980598449707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4217, 128]), torch.Size([1, 4217, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24591970443725586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.30687904357910156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4217, 128])
m.shape torch.Size([4074, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3106961250305176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3106961250305176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4074, 128]), torch.Size([1, 4074, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31458139419555664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4001307487487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4074, 128])
m.shape torch.Size([3622, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.40509653091430664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.40509653091430664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3622, 128]), torch.Size([1, 3622, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4085831642150879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5108628273010254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3622, 128])
m.shape torch.Size([3211, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5167913436889648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5167913436889648  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3211, 128]), torch.Size([1, 3211, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.520073413848877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6338491439819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3211, 128])
m.shape torch.Size([2650, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.639899730682373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.639899730682373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2650, 128]), torch.Size([1, 2650, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6426501274108887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7587547302246094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2650, 128])
m.shape torch.Size([2291, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7645611763000488  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7645611763000488  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2291, 128]), torch.Size([1, 2291, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7668399810791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8826808929443359  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2291, 128])
m.shape torch.Size([2047, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8884372711181641  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8884372711181641  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2047, 128]), torch.Size([1, 2047, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8903894424438477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0017108917236328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2047, 128])
m.shape torch.Size([1721, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0081205368041992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0081205368041992  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1721, 128]), torch.Size([1, 1721, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0097618103027344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1152634620666504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1721, 128])
m.shape torch.Size([16952, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1952762603759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1952762603759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16952, 128]), torch.Size([1, 16952, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2114429473876953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3622303009033203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16952, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.236233711242676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.278458595275879  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.320683479309082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2781286239624023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44276, 256])
first layer input nodes number: 102519
first layer output nodes number: 44276
edges number: 288012
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3214492797851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3636741638183594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.37423038482666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.37423038482666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1799, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4578232765197754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4578232765197754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1799, 256]), torch.Size([1, 1799, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.461886405944824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4904637336730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1799, 256])
m.shape torch.Size([1594, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4918904304504395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4918904304504395  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1594, 256]), torch.Size([1, 1594, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4949703216552734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5419230461120605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1594, 256])
m.shape torch.Size([1245, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5446863174438477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5446863174438477  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1245, 256]), torch.Size([1, 1245, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5473527908325195  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.602104663848877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1245, 256])
m.shape torch.Size([970, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.604707717895508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.604707717895508  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.606557846069336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6610164642333984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([821, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6640372276306152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6640372276306152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 821, 256]), torch.Size([1, 821, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6656031608581543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.724067211151123  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 821, 256])
m.shape torch.Size([657, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.727281093597412  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.727281093597412  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.72853422164917  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.782418727874756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([538, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.785411834716797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.785411834716797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.78643798828125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.838536262512207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([474, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8422327041625977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8422327041625977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.843136787414551  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.895254135131836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([370, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.898003101348877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.898003101348877  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 370, 256]), torch.Size([1, 370, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8987088203430176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9455008506774902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 370, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.948493003845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.948493003845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9491567611694336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.997260093688965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([268, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9997620582580566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9997620582580566  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0002732276916504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0407567024230957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([224, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0430846214294434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0430846214294434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0435118675231934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0798277854919434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0824131965637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0824131965637207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0828404426574707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1221470832824707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([186, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.124436378479004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.124436378479004  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.124791145324707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1599130630493164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([160, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1620426177978516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1620426177978516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1623477935791016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1946964263916016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([155, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.196927547454834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.196927547454834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.19722318649292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.230630397796631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([121, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2324600219726562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2324600219726562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2326908111572266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.260385513305664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([116, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.262277126312256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.262277126312256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.262498378753662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.290597438812256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.292550563812256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.292550563812256  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2927660942077637  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3216471672058105  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3233847618103027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3233847618103027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3235678672790527  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3493857383728027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([70, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3507070541381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3507070541381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3508405685424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.370600700378418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.371908664703369  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.371908664703369  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.372032642364502  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.391249179840088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.392425537109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.392425537109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3925323486328125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4098358154296875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.410935878753662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.410935878753662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4110312461853027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4271483421325684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([793, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.446779727935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.446779727935791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4482922554016113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.7144970893859863  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 793, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.643928050994873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.645643711090088  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6473593711853027  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6455578804016113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11513, 40])
input nodes number: 44276
output nodes number: 11513
edges number: 84474
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.645968437194824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.6459689140319824  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07135009765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 5 input nodes size: 105164
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06179046630859375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06179046630859375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11193656921386719  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11201953887939453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0630488395690918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06600761413574219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06600761413574219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06600761413574219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105164, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06600761413574219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3590, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20788192749023438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20788192749023438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3590, 128]), torch.Size([1, 3590, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21196269989013672  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2401280403137207  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3590, 128])
m.shape torch.Size([4290, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2425074577331543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2425074577331543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4290, 128]), torch.Size([1, 4290, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2465987205505371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3079676628112793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4290, 128])
m.shape torch.Size([4276, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3120388984680176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3120388984680176  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4276, 128]), torch.Size([1, 4276, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31612348556518555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4058375358581543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4276, 128])
m.shape torch.Size([3722, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41135358810424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41135358810424805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3722, 128]), torch.Size([1, 3722, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4149031639099121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5186724662780762  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3722, 128])
m.shape torch.Size([3250, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5246462821960449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5246462821960449  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3250, 128]), torch.Size([1, 3250, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5280508995056152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6462759971618652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3250, 128])
m.shape torch.Size([2692, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6515612602233887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6515612602233887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2692, 128]), torch.Size([1, 2692, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6542716026306152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.767183780670166  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2692, 128])
m.shape torch.Size([2275, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.773493766784668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.773493766784668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2275, 128]), torch.Size([1, 2275, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7759103775024414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8852877616882324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2275, 128])
m.shape torch.Size([1930, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8915653228759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8915653228759766  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1930, 128]), torch.Size([1, 1930, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8934059143066406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9992122650146484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1930, 128])
m.shape torch.Size([1653, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0053858757019043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0053858757019043  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0069622993469238  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1103100776672363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([16745, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1893682479858398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1893682479858398  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16745, 128]), torch.Size([1, 16745, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2053375244140625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3474388122558594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16745, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.22222900390625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.264594078063965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3069591522216797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2642626762390137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44423, 256])
first layer input nodes number: 105164
first layer output nodes number: 44423
edges number: 285980
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3077449798583984  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3501100540161133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.360701560974121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.360701560974121  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([1914, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4263343811035156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4263343811035156  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1914, 256]), torch.Size([1, 1914, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4304680824279785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4601502418518066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1914, 256])
m.shape torch.Size([1741, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4619131088256836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4619131088256836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1741, 256]), torch.Size([1, 1741, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4654083251953125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.515955924987793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1741, 256])
m.shape torch.Size([1410, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.519040107727051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.519040107727051  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1410, 256]), torch.Size([1, 1410, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5219836235046387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.585569381713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1410, 256])
m.shape torch.Size([1125, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.58925724029541  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.58925724029541  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.591425895690918  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6546683311462402  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([893, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6578869819641113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6578869819641113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.659590244293213  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7221245765686035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([683, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7252120971679688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7252120971679688  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 683, 256]), torch.Size([1, 683, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7265148162841797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7848052978515625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 683, 256])
m.shape torch.Size([559, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7879152297973633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7879152297973633  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7889814376831055  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.842571258544922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 559, 256])
m.shape torch.Size([460, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8455753326416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8455753326416016  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8464527130126953  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.897627830505371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([361, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9003119468688965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9003119468688965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.901000499725342  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9455103874206543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([278, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.947838306427002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.947838306427002  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.948368549346924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9873032569885254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([248, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9896602630615234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9896602630615234  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.990133285522461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.027029037475586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([212, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.029237747192383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.029237747192383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.029642105102539  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0640125274658203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([133, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0654726028442383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0654726028442383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0657262802124023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.089064598083496  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.090458393096924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.090458393096924  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0906739234924316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.112011432647705  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([114, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1135473251342773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1135473251342773  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.113764762878418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.136813163757324  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.137904167175293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.137904167175293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1380529403686523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1548643112182617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1558194160461426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1558194160461426  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1559395790100098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1703591346740723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.171233654022217  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.171233654022217  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1713366508483887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.184417247772217  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1852059364318848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1852059364318848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.185293674468994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1970505714416504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1975646018981934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1975646018981934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.197619915008545  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2054190635681152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.20621919631958  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.20621919631958  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2062973976135254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2178711891174316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2184243202209473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2184243202209473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.218477725982666  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2267556190490723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.227259635925293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.227259635925293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2273054122924805  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2347211837768555  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2352981567382812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2352981567382812  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2353477478027344  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2437286376953125  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([468, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2549490928649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2549490928649902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2558417320251465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4129462242126465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 468, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3597278594970703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3613882064819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.3630666732788086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.361323356628418  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11101, 40])
input nodes number: 44423
output nodes number: 11101
edges number: 65702
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.361682415008545  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.361682891845703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07096719741821289  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 6 input nodes size: 106327
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06299352645874023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06299352645874023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11377477645874023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11385774612426758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.0636286735534668  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06671667098999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06671667098999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06671667098999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([106327, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06671667098999023  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3779, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21131372451782227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21131372451782227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3779, 128]), torch.Size([1, 3779, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21491765975952148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24374914169311523  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3779, 128])
m.shape torch.Size([4521, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24625873565673828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.24625873565673828  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4521, 128]), torch.Size([1, 4521, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.25197887420654297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.31960105895996094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4521, 128])
m.shape torch.Size([4208, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32346487045288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32346487045288086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4208, 128]), torch.Size([1, 4208, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32762718200683594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.41591453552246094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4208, 128])
m.shape torch.Size([3758, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42156028747558594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.42156028747558594  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3758, 128]), torch.Size([1, 3758, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4251542091369629  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.529198169708252  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3758, 128])
m.shape torch.Size([3360, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5354170799255371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5354170799255371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3360, 128]), torch.Size([1, 3360, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5386404991149902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.656867504119873  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3360, 128])
m.shape torch.Size([2635, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6624369621276855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6624369621276855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2635, 128]), torch.Size([1, 2635, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6651701927185059  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7790627479553223  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2635, 128])
m.shape torch.Size([2174, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7850627899169922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7850627899169922  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2174, 128]), torch.Size([1, 2174, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7873058319091797  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8955483436584473  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2174, 128])
m.shape torch.Size([1915, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9018168449401855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9018168449401855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1915, 128]), torch.Size([1, 1915, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9036431312561035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0077414512634277  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1915, 128])
m.shape torch.Size([1628, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.013814926147461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.013814926147461  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0153675079345703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1183338165283203  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([17308, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2000885009765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2000885009765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 17308, 128]), torch.Size([1, 17308, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2165946960449219  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3885345458984375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 17308, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.260674476623535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3038625717163086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.347050666809082  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.303524971008301  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([45286, 256])
first layer input nodes number: 106327
first layer output nodes number: 45286
edges number: 291357
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3478450775146484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.391033172607422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4018301963806152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4018301963806152  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2098, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4673471450805664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4673471450805664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2098, 256]), torch.Size([1, 2098, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.471506118774414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.504411220550537  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2098, 256])
m.shape torch.Size([1718, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5060925483703613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5060925483703613  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1718, 256]), torch.Size([1, 1718, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5096864700317383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5613746643066406  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1718, 256])
m.shape torch.Size([1377, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.563554286956787  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.563554286956787  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1377, 256]), torch.Size([1, 1377, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5665359497070312  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.625091552734375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1377, 256])
m.shape torch.Size([1145, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.628180503845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.628180503845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1145, 256]), torch.Size([1, 1145, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6305770874023438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6952199935913086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1145, 256])
m.shape torch.Size([891, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.698000907897949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.698000907897949  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 891, 256]), torch.Size([1, 891, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.699700355529785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7615585327148438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 891, 256])
m.shape torch.Size([650, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7644572257995605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7644572257995605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 650, 256]), torch.Size([1, 650, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7656970024108887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.824460506439209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 650, 256])
m.shape torch.Size([492, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.827150821685791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.827150821685791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 492, 256]), torch.Size([1, 492, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8280892372131348  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8765206336975098  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 492, 256])
m.shape torch.Size([400, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.879127025604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.879127025604248  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.879889965057373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.923734188079834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 400, 256])
m.shape torch.Size([351, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.926389217376709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.926389217376709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 351, 256]), torch.Size([1, 351, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.927058696746826  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.970691204071045  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 351, 256])
m.shape torch.Size([266, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9729132652282715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9729132652282715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9734206199645996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0100817680358887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([194, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0118794441223145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0118794441223145  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.01224946975708  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.041111469268799  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([181, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0430140495300293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0430140495300293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0433592796325684  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0727038383483887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([158, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0745058059692383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0745058059692383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0748071670532227  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.102532386779785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([124, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.104050636291504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.104050636291504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1042871475219727  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.127701759338379  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([118, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1292848587036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1292848587036133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.129509925842285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.153367042541504  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([85, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.154561996459961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.154561996459961  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.15472412109375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.173044204711914  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1743197441101074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1743197441101074  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.174478054046631  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1934752464294434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1946234703063965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1946234703063965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1947455406188965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2102484703063965  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2111191749572754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2111191749572754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.211216449737549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2242512702941895  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([49, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.225144863128662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.225144863128662  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.22523832321167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2384161949157715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.239197254180908  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.239197254180908  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2392754554748535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2508492469787598  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2512331008911133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2512331008911133  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2512712478637695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2571840286254883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2578725814819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2578725814819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2579336166381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2678213119506836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2683215141296387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2683215141296387  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2683653831481934  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2757792472839355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([489, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2875075340270996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2875075340270996  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.288440227508545  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4586634635925293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 489, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4056053161621094  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4076061248779297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4092602729797363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.4071764945983887  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11100, 40])
input nodes number: 45286
output nodes number: 11100
edges number: 65615
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.407937526702881  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.407938003540039  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07213687896728516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

pseudo mini batch 7 input nodes size: 105956
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06396913528442383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06396913528442383  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11449289321899414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.11457586288452148  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06371164321899414  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06717777252197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06717777252197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06717777252197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([105956, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.06717777252197266  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([3867, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20806455612182617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.20806455612182617  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3867, 128]), torch.Size([1, 3867, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.21229267120361328  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2425990104675293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3867, 128])
m.shape torch.Size([4637, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2451772689819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2451772689819336  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4637, 128]), torch.Size([1, 4637, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.2503938674926758  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3183479309082031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4637, 128])
m.shape torch.Size([4312, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32230520248413086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.32230520248413086  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 4312, 128]), torch.Size([1, 4312, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.3265724182128906  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4184722900390625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 4312, 128])
m.shape torch.Size([3751, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.423919677734375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.423919677734375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3751, 128]), torch.Size([1, 3751, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.4275522232055664  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5313735008239746  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3751, 128])
m.shape torch.Size([3307, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5374693870544434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5374693870544434  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 3307, 128]), torch.Size([1, 3307, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.5406746864318848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.658935546875  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 3307, 128])
m.shape torch.Size([2621, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6648573875427246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6648573875427246  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2621, 128]), torch.Size([1, 2621, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.6675310134887695  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7797636985778809  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2621, 128])
m.shape torch.Size([2213, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7859005928039551  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.7859005928039551  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2213, 128]), torch.Size([1, 2213, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.788205623626709  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.8970398902893066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2213, 128])
m.shape torch.Size([1894, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9032096862792969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9032096862792969  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1894, 128]), torch.Size([1, 1894, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.9050159454345703  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.0079727172851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1894, 128])
m.shape torch.Size([1585, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.013871669769287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.013871669769287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.015383243560791  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.1127605438232422  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([16540, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.190873622894287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.190873622894287  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 16540, 128]), torch.Size([1, 16540, 128])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 1.2066473960876465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3274970054626465  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 16540, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2029361724853516  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.245591163635254  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2882461547851562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.24525785446167  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([44727, 256])
first layer input nodes number: 105956
first layer output nodes number: 44727
edges number: 283650
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.2890377044677734  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.331692695617676  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3423566818237305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.3423566818237305  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

m.shape torch.Size([2135, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.402592182159424  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.402592182159424  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 2135, 256]), torch.Size([1, 2135, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4069437980651855  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.4401016235351562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 2135, 256])
m.shape torch.Size([1931, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.44185209274292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.44185209274292  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1931, 256]), torch.Size([1, 1931, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.445730209350586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.503140926361084  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1931, 256])
m.shape torch.Size([1464, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5053396224975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5053396224975586  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1464, 256]), torch.Size([1, 1464, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.50827693939209  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.5721588134765625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1464, 256])
m.shape torch.Size([1085, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.575014114379883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.575014114379883  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 1085, 256]), torch.Size([1, 1085, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.577488899230957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6431851387023926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 1085, 256])
m.shape torch.Size([909, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.646519184112549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.646519184112549  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.6482529640197754  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7106690406799316  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([634, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.71345853805542  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.71345853805542  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.714667797088623  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.767334461212158  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([540, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7703633308410645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.7703633308410645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.771393299102783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8238492012023926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([443, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8267407417297363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8267407417297363  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8275856971740723  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8779654502868652  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([297, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8801121711730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.8801121711730957  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.880678653717041  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9185023307800293  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([253, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9206509590148926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9206509590148926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.921133518218994  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.955395221710205  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([189, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9571523666381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9571523666381836  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.957512855529785  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.985630989074707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([168, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9873886108398438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9873886108398438  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 2.9877090454101562  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0149459838867188  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([127, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0163726806640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0163726806640625  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0166149139404297  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.038900375366211  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([126, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0404748916625977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0404748916625977  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.040715217590332  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.064507484436035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([86, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0656542778015137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0656542778015137  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0658183097839355  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0832056999206543  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0842156410217285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.0842156410217285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.084351062774658  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.099653720855713  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([58, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.100533962249756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.100533962249756  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.100644588470459  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.113919734954834  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1146087646484375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1146087646484375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1146907806396484  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1251068115234375  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.125796318054199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.125796318054199  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1258726119995117  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1360960006713867  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([48, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1369805335998535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1369805335998535  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1370720863342285  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1499810218811035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.150641918182373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.150641918182373  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1507086753845215  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1605887413024902  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1608729362487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1608729362487793  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1609015464782715  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1653361320495605  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([27, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1659188270568848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1659188270568848  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1659703254699707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1743130683898926  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1746106147766113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1746106147766113  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])Using backend: pytorch

----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1746373176574707  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.179150104522705  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([361, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1878113746643066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.1878113746643066  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.188499927520752  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.310944080352783  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

rst.shape  torch.Size([1, 361, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.263566493988037  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2656025886535645  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.267256736755371  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2651376724243164  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

torch.Size([11099, 40])
input nodes number: 44727
output nodes number: 11099
edges number: 60068
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2653369903564453  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 3.2653374671936035  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07188606262207031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07188606262207031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.4178466796875 GB
    Memory Allocated: 0.07188606262207031  GigaBytes
Max Memory Allocated: 5.670727252960205  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.03504648804664612 |0.0033062398433685303 |0.12630262970924377 |9.354948997497559e-05 |0.07681897282600403 |0.004674196243286133 |
----------------------------------------------------------pseudo_mini_loss sum 3.149003267288208
Total (block generation + training)time/epoch 16.712758779525757
Training time/epoch 1.9862661361694336
Training time without block to device /epoch 1.9598162174224854
Training time without total dataloading part /epoch 1.6303954124450684
load block tensor time/epoch 0.28037190437316895
block to device time/epoch 0.026449918746948242
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1184751
Number of first layer input nodes during this epoch:  821857
Number of first layer output nodes during this epoch:  362894
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
