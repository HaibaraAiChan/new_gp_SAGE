[05:10:30] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 8 parts and get 4581936 edge cuts
main start at this time 1651554609.443051
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.028671979904174805
global_2_local spend time (sec) 0.03783559799194336
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004368782043457031
A = g.adjacency_matrix() spent  0.0076138973236083984
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07648658752441406
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2971155643463135
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1907927989959717

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.221 seconds
Metis partitioning: 5.246 seconds
Split the graph: 1.827 seconds
Construct subgraphs: 0.099 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.416769981384277
11624
11617
11633
11636
11035
11107
11035
11254
total k batches seeds list generation spend  18.225387811660767
after graph partition
graph partition algorithm spend time 18.323280811309814
11624
11617
11633
11636
11035
11107
11035
11254
partition_len_list
[19825, 20986, 25664, 21915, 34531, 23873, 47601, 42113]
shared_neighbor_graph_partition_s0 selection method  spend 18.414019346237183
time for parepare:  0.016908884048461914
local_output_nid generation:  0.001964569091796875
local_in_edges_tensor generation:  0.0026743412017822266
mini_batch_src_global generation:  0.0029997825622558594
r_  generation:  0.028128862380981445
local_output_nid generation:  0.0022430419921875
local_in_edges_tensor generation:  0.0025773048400878906
mini_batch_src_global generation:  0.0037004947662353516
r_  generation:  0.035425662994384766
local_output_nid generation:  0.0037910938262939453
local_in_edges_tensor generation:  0.0027544498443603516
mini_batch_src_global generation:  0.003216981887817383
r_  generation:  0.030725717544555664
local_output_nid generation:  0.002542734146118164
local_in_edges_tensor generation:  0.002380847930908203
mini_batch_src_global generation:  0.0027856826782226562
r_  generation:  0.029183149337768555
local_output_nid generation:  0.0024361610412597656
local_in_edges_tensor generation:  0.002703428268432617
mini_batch_src_global generation:  0.004224538803100586
r_  generation:  0.031470298767089844
local_output_nid generation:  0.0025458335876464844
local_in_edges_tensor generation:  0.002126455307006836
mini_batch_src_global generation:  0.0026328563690185547
r_  generation:  0.025235652923583984
local_output_nid generation:  0.002432107925415039
local_in_edges_tensor generation:  0.0029304027557373047
mini_batch_src_global generation:  0.004825592041015625
r_  generation:  0.03616452217102051
local_output_nid generation:  0.0026082992553710938
local_in_edges_tensor generation:  0.003341197967529297
mini_batch_src_global generation:  0.0052073001861572266
r_  generation:  0.049361228942871094
----------------------check_connections_block total spend ----------------------------- 0.4217979907989502
generate_one_block  0.04528474807739258
generate_one_block  0.04164695739746094
generate_one_block  0.038860321044921875
generate_one_block  0.034490346908569336
generate_one_block  0.04489755630493164
generate_one_block  0.03377962112426758
generate_one_block  0.05115318298339844
generate_one_block  0.06942057609558105
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04839801788330078
gen group dst list time:  0.006583452224731445
time for parepare:  0.02211284637451172
local_output_nid generation:  0.003409147262573242
local_in_edges_tensor generation:  0.020837783813476562
mini_batch_src_global generation:  0.0037882328033447266
r_  generation:  0.04381060600280762
local_output_nid generation:  0.005289793014526367
local_in_edges_tensor generation:  0.004723310470581055
mini_batch_src_global generation:  0.005367755889892578
r_  generation:  0.04710745811462402
local_output_nid generation:  0.006731510162353516
local_in_edges_tensor generation:  0.009889364242553711
mini_batch_src_global generation:  0.005866527557373047
r_  generation:  0.0591278076171875
local_output_nid generation:  0.006366252899169922
local_in_edges_tensor generation:  0.008920669555664062
mini_batch_src_global generation:  0.004766702651977539
r_  generation:  0.04715371131896973
local_output_nid generation:  0.00832819938659668
local_in_edges_tensor generation:  0.0074803829193115234
mini_batch_src_global generation:  0.008878231048583984
r_  generation:  0.09237360954284668
local_output_nid generation:  0.00626063346862793
local_in_edges_tensor generation:  0.009392023086547852
mini_batch_src_global generation:  0.00646209716796875
r_  generation:  0.05394768714904785
local_output_nid generation:  0.010783910751342773
local_in_edges_tensor generation:  0.011955738067626953
mini_batch_src_global generation:  0.014375448226928711
r_  generation:  0.1345510482788086
local_output_nid generation:  0.009357690811157227
local_in_edges_tensor generation:  0.009895801544189453
mini_batch_src_global generation:  0.018858909606933594
r_  generation:  0.12049269676208496
----------------------check_connections_block total spend ----------------------------- 0.9879045486450195
generate_one_block  0.05475354194641113
generate_one_block  0.058400630950927734
generate_one_block  0.07300949096679688
generate_one_block  0.05893826484680176
generate_one_block  0.14833307266235352
generate_one_block  0.06310534477233887
generate_one_block  0.169511079788208
generate_one_block  0.1589059829711914
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9879045486450195
block generation total time  0.7849574089050293
average batch blocks generation time:  0.09811967611312866
pseudo mini batch 0 input nodes size: 34460
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01920938491821289  GigaBytes
Max Memory Allocated: 0.01920938491821289  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01929616928100586  GigaBytes
Max Memory Allocated: 0.01929616928100586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01929616928100586  GigaBytes
Max Memory Allocated: 0.01929616928100586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

torch.Size([34460, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

m.shape torch.Size([2138, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.08046913146972656  GigaBytes
Max Memory Allocated: 0.08102035522460938  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.08046913146972656  GigaBytes
Max Memory Allocated: 0.08102035522460938  GigaBytes

 h.shape torch.Size([1, 2138, 128]), torch.Size([1, 2138, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08322429656982422  GigaBytes
Max Memory Allocated: 0.08322429656982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09953594207763672  GigaBytes
Max Memory Allocated: 0.100555419921875  GigaBytes

rst.shape  torch.Size([1, 2138, 128])
m.shape torch.Size([2236, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10064888000488281  GigaBytes
Max Memory Allocated: 0.10069894790649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10064888000488281  GigaBytes
Max Memory Allocated: 0.10069894790649414  GigaBytes

 h.shape torch.Size([1, 2236, 128]), torch.Size([1, 2236, 128])
----------------------------------------3
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10386848449707031  GigaBytes
Max Memory Allocated: 0.10386848449707031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13619422912597656  GigaBytes
Max Memory Allocated: 0.13832664489746094  GigaBytes

rst.shape  torch.Size([1, 2236, 128])
m.shape torch.Size([2004, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 0.13839387893676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 0.13839387893676758  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.14023780822753906  GigaBytes
Max Memory Allocated: 0.14023780822753906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18270301818847656  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1684, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18495941162109375  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18495941162109375  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18656539916992188  GigaBytes
Max Memory Allocated: 0.18656539916992188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2336578369140625  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1419, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2362380027770996  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2362380027770996  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

 h.shape torch.Size([1, 1419, 128]), torch.Size([1, 1419, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.23759126663208008  GigaBytes
Max Memory Allocated: 0.23759126663208008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2868943214416504  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

rst.shape  torch.Size([1, 1419, 128])
m.shape torch.Size([1223, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2897167205810547  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2897167205810547  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.29088306427001953  GigaBytes
Max Memory Allocated: 0.29088306427001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.34324216842651367  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1062, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3462038040161133  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3462038040161133  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3472166061401367  GigaBytes
Max Memory Allocated: 0.3472166061401367  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3981285095214844  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([907, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.40108203887939453  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.40108203887939453  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.401947021484375  GigaBytes
Max Memory Allocated: 0.401947021484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45195865631103516  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([761, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4547920227050781  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4547920227050781  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4555177688598633  GigaBytes
Max Memory Allocated: 0.4555177688598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5029854774475098  GigaBytes
Max Memory Allocated: 0.506251335144043  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([6391, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5338726043701172  GigaBytes
Max Memory Allocated: 0.5345873832702637  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5338726043701172  GigaBytes
Max Memory Allocated: 0.5345873832702637  GigaBytes

 h.shape torch.Size([1, 6391, 128]), torch.Size([1, 6391, 128])
----------------------------------------3
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5403404235839844  GigaBytes
Max Memory Allocated: 0.5403404235839844  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9730806350708008  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

rst.shape  torch.Size([1, 6391, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9222517013549805  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9411582946777344  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9602031707763672  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9411487579345703  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

torch.Size([19825, 256])
first layer input nodes number: 34460
first layer output nodes number: 19825
edges number: 119240
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9604620933532715  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9793686866760254  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.9847202301025391  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.9847202301025391  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

m.shape torch.Size([1645, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0698442459106445  GigaBytes
Max Memory Allocated: 1.0698504447937012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0698442459106445  GigaBytes
Max Memory Allocated: 1.0698504447937012  GigaBytes

 h.shape torch.Size([1, 1645, 256]), torch.Size([1, 1645, 256])
----------------------------------------3
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.072981834411621  GigaBytes
Max Memory Allocated: 1.072981834411621  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0989885330200195  GigaBytes
Max Memory Allocated: 1.1005573272705078  GigaBytes

rst.shape  torch.Size([1, 1645, 256])
m.shape torch.Size([1511, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1005802154541016  GigaBytes
Max Memory Allocated: 1.1005916595458984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1005802154541016  GigaBytes
Max Memory Allocated: 1.1005916595458984  GigaBytes

 h.shape torch.Size([1, 1511, 256]), torch.Size([1, 1511, 256])
----------------------------------------3
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1035442352294922  GigaBytes
Max Memory Allocated: 1.1035442352294922  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1476125717163086  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

rst.shape  torch.Size([1, 1511, 256])
m.shape torch.Size([1246, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1497235298156738  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1497235298156738  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1522164344787598  GigaBytes
Max Memory Allocated: 1.1522164344787598  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2060580253601074  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([1038, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2092809677124023  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2092809677124023  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

 h.shape torch.Size([1, 1038, 256]), torch.Size([1, 1038, 256])
----------------------------------------3
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2113304138183594  GigaBytes
Max Memory Allocated: 1.2113304138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2726731300354004  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

rst.shape  torch.Size([1, 1038, 256])
m.shape torch.Size([830, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2751798629760742  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2751798629760742  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2767629623413086  GigaBytes
Max Memory Allocated: 1.2767629623413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.335341453552246  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([719, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.3386964797973633  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.3386964797973633  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.3400678634643555  GigaBytes
Max Memory Allocated: 1.3400678634643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.399867057800293  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([565, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4029827117919922  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4029827117919922  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4040603637695312  GigaBytes
Max Memory Allocated: 1.4040603637695312  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.458160400390625  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([469, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4620938301086426  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4620938301086426  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4629883766174316  GigaBytes
Max Memory Allocated: 1.4629883766174316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5143036842346191  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([428, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5175590515136719  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5175590515136719  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5183753967285156  GigaBytes
Max Memory Allocated: 1.5183753967285156  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5713510513305664  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([359, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5743937492370605  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5743937492370605  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5750784873962402  GigaBytes
Max Memory Allocated: 1.5750784873962402  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6260085105895996  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([332, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6291766166687012  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6291766166687012  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.629809856414795  GigaBytes
Max Memory Allocated: 1.629809856414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6803812980651855  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6831097602844238  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6831097602844238  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6836133003234863  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7271466255187988  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7297687530517578  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7297687530517578  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7302074432373047  GigaBytes
Max Memory Allocated: 1.7302074432373047  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7705669403076172  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7731733322143555  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7731733322143555  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.773573875427246  GigaBytes
Max Memory Allocated: 1.773573875427246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.813227653503418  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([155, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.815843105316162  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.815843105316162  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.816138744354248  GigaBytes
Max Memory Allocated: 1.816138744354248  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8474764823913574  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([153, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8496818542480469  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8496818542480469  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8499736785888672  GigaBytes
Max Memory Allocated: 1.8499736785888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8829498291015625  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8851079940795898  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8851079940795898  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8853769302368164  GigaBytes
Max Memory Allocated: 1.8853769302368164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.917649269104004  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([133, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.919816017150879  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.919816017150879  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.920069694519043  GigaBytes
Max Memory Allocated: 1.920069694519043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.952286720275879  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9539313316345215  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9539313316345215  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9541163444519043  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.9789080619812012  GigaBytes
Max Memory Allocated: 1.980665683746338  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.98085355758667  GigaBytes
Max Memory Allocated: 1.9808616638183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.98085355758667  GigaBytes
Max Memory Allocated: 1.9808616638183594  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.981055736541748  GigaBytes
Max Memory Allocated: 1.981055736541748  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.0095629692077637  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011399745941162  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011399745941162  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011582851409912  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.038682460784912  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040261745452881  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040261745452881  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040412425994873  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.063767910003662  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0651960372924805  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0651960372924805  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0653257369995117  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.086337089538574  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0877718925476074  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0877718925476074  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0878958702087402  GigaBytes
Max Memory Allocated: 2.0878958702087402  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1088480949401855  GigaBytes
Max Memory Allocated: 2.1111369132995605  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([685, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 2.1252455711364746  GigaBytes
Max Memory Allocated: 2.125309467315674  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 2.1252455711364746  GigaBytes
Max Memory Allocated: 2.125309467315674  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.126552104949951  GigaBytes
Max Memory Allocated: 2.126552104949951  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6014404296875 GB
    Memory Allocated: 2.356502056121826  GigaBytes
Max Memory Allocated: 2.372833728790283  GigaBytes

rst.shape  torch.Size([1, 685, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.28424072265625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.286529541015625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.288261890411377  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.285886287689209  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([11624, 40])
input nodes number: 19825
output nodes number: 11624
edges number: 86450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.287853240966797  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.2878541946411133  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.028347015380859375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

pseudo mini batch 1 input nodes size: 32727
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.03941011428833008  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.03949689865112305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.02297830581665039  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([32727, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

m.shape torch.Size([2076, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09039068222045898  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09039068222045898  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09237051010131836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.10981273651123047  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([2107, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11083221435546875  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11083221435546875  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11381673812866211  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1452946662902832  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([1950, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1470794677734375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1470794677734375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1489391326904297  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1898517608642578  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1646, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.19363117218017578  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.23968791961669922  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1526, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24254131317138672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24254131317138672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24399662017822266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.29723167419433594  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([1253, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.30008888244628906  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.30008888244628906  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1253, 128]), torch.Size([1, 1253, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.3012838363647461  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35291481018066406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1253, 128])
m.shape torch.Size([1121, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35605907440185547  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35605907440185547  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.3571281433105469  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41226768493652344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([976, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41545629501342773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41545629501342773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41638708114624023  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.4713935852050781  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([827, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.47447729110717773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.47447729110717773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.4752659797668457  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5270066261291504  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([7504, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5623941421508789  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5623941421508789  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 7504, 128]), torch.Size([1, 7504, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5695505142211914  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.077652931213379  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 7504, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0199079513549805  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.039921760559082  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0599355697631836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0397653579711914  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([20986, 256])
first layer input nodes number: 32727
first layer output nodes number: 20986
edges number: 132010
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0601816177368164  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.080195426940918  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.085413932800293  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.085413932800293  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

m.shape torch.Size([1549, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1802473068237305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1802473068237305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1549, 256]), torch.Size([1, 1549, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.183527946472168  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2078161239624023  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1549, 256])
m.shape torch.Size([1361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2089943885803223  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2089943885803223  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1361, 256]), torch.Size([1, 1361, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.211806297302246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2529592514038086  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1361, 256])
m.shape torch.Size([1207, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2549614906311035  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2549614906311035  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1207, 256]), torch.Size([1, 1207, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2578840255737305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3150110244750977  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1207, 256])
m.shape torch.Size([909, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3178114891052246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3178114891052246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3195452690124512  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3698248863220215  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([815, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3728747367858887  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3728747367858887  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3744292259216309  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.432145595550537  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4350767135620117  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4350767135620117  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4363031387329102  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4894371032714844  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([558, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4925785064697266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4925785064697266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.493642807006836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5479555130004883  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([485, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5511527061462402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5511527061462402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5520777702331543  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6049656867980957  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([402, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.607980728149414  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.607980728149414  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6087474822998047  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6590518951416016  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([372, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6622443199157715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6622443199157715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6629538536071777  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7135443687438965  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([315, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7165203094482422  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7165203094482422  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7171211242675781  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7645750045776367  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([274, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.767435073852539  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.767435073852539  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7679576873779297  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8144512176513672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([238, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8171639442443848  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8171639442443848  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8176178932189941  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8593811988830566  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([214, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8620338439941406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8620338439941406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8624420166015625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9028511047363281  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([200, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9055304527282715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9055304527282715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.905911922454834  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.946347713470459  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9484944343566895  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9484944343566895  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.948784351348877  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9815449714660645  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([174, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.984243392944336  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.984243392944336  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9845752716064453  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0244007110595703  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026477336883545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026477336883545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026710033416748  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.056262493133545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.058246612548828  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.058246612548828  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0584659576416016  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.087858200073242  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([130, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.090247631072998  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.090247631072998  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0904955863952637  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.125457286834717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.127654552459717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.127654552459717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1278738975524902  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.160336971282959  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161559581756592  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161559581756592  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161679744720459  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.180305004119873  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1818809509277344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1818809509277344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1820220947265625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2048873901367188  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2065482139587402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2065482139587402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2066855430603027  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2298941612243652  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([1058, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2552475929260254  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2552475929260254  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.257307529449463  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.6167187690734863  GigaBytes
Max Memory Allocated: 2.6419434547424316  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5335488319396973  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.535280227661133  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5370116233825684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.53519344329834  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([11617, 40])
input nodes number: 20986
output nodes number: 11617
edges number: 96480
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.535435676574707  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5354361534118652  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.02794647216796875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

pseudo mini batch 2 input nodes size: 50550
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.022977352142333984  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.022977352142333984  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.04708147048950195  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.04716825485229492  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.03147602081298828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([50550, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

m.shape torch.Size([2462, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11297941207885742  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11297941207885742  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2462, 128]), torch.Size([1, 2462, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11532735824584961  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1341109275817871  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2462, 128])
m.shape torch.Size([2709, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2709, 128]), torch.Size([1, 2709, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1385955810546875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17819547653198242  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2709, 128])
m.shape torch.Size([2409, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18034982681274414  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18034982681274414  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2409, 128]), torch.Size([1, 2409, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1826767921447754  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23366785049438477  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2409, 128])
m.shape torch.Size([2140, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2370014190673828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2370014190673828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23919057846069336  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3014531135559082  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1851, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3044395446777344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3044395446777344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1851, 128]), torch.Size([1, 1851, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30620479583740234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37093114852905273  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1851, 128])
m.shape torch.Size([1528, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.374420166015625  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.374420166015625  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1528, 128]), torch.Size([1, 1528, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37587738037109375  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43920135498046875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1528, 128])
m.shape torch.Size([1364, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4430255889892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4430255889892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1364, 128]), torch.Size([1, 1364, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44432640075683594  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5096206665039062  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1364, 128])
m.shape torch.Size([1250, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5137386322021484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5137386322021484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5149307250976562  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5842533111572266  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1070, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5882492065429688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5882492065429688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5892696380615234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6545772552490234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([8881, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6964149475097656  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6964149475097656  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 8881, 128]), torch.Size([1, 8881, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7057418823242188  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.307082176208496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 8881, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.238269329071045  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.262744426727295  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.287219524383545  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2625532150268555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([25664, 256])
first layer input nodes number: 50550
first layer output nodes number: 25664
edges number: 160078
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2875981330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3120732307434082  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3188481330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3188481330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

m.shape torch.Size([1727, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4059157371520996  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4059157371520996  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1727, 256]), torch.Size([1, 1727, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4098525047302246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4396557807922363  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1727, 256])
m.shape torch.Size([1554, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.441206455230713  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.441206455230713  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1554, 256]), torch.Size([1, 1554, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.445234775543213  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4905872344970703  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1554, 256])
m.shape torch.Size([1212, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4925999641418457  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4925999641418457  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.494926929473877  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5467700958251953  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([1025, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5495553016662598  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5495553016662598  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1025, 256]), torch.Size([1, 1025, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.551577091217041  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6097822189331055  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1025, 256])
m.shape torch.Size([862, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6129474639892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6129474639892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6145915985107422  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6755404472351074  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([625, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6783227920532227  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6783227920532227  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6795148849487305  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7345170974731445  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([553, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7376418113708496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7376418113708496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.738696575164795  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7963147163391113  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([520, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8007774353027344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8582344055175781  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([398, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8611812591552734  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8611812591552734  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8619403839111328  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9109687805175781  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([371, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9141550064086914  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9141550064086914  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9148626327514648  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.966017723083496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([267, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9684867858886719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9684867858886719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9689960479736328  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0095033645629883  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([248, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0121092796325684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0121092796325684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.012582302093506  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0527892112731934  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0552144050598145  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0552144050598145  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0556206703186035  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0929970741271973  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([203, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0955257415771484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0955257415771484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0959129333496094  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.134244918823242  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([198, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.136906147003174  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.136906147003174  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1372838020324707  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1773152351379395  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([132, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1791563034057617  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1791563034057617  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.179408073425293  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.207858085632324  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2099709510803223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2099709510803223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2102322578430176  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.241589069366455  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2434134483337402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2434134483337402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.243628978729248  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2710013389587402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([94, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2732415199279785  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2732415199279785  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.273420810699463  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.297445774078369  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2989516258239746  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2989516258239746  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.299109935760498  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3214316368103027  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3228864669799805  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3228864669799805  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.323031425476074  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.344485282897949  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.346083641052246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.346083641052246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3462343215942383  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3695898056030273  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3707218170166016  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3707218170166016  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3708229064941406  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3871994018554688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3885560035705566  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3885560035705566  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.388672351837158  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.4083352088928223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([829, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.428591251373291  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.428591251373291  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.4301724433898926  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.710299015045166  GigaBytes
Max Memory Allocated: 2.7300639152526855  GigaBytes

rst.shape  torch.Size([1, 829, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.634647846221924  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.636688709259033  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.639153003692627  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.6370253562927246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([11633, 40])
input nodes number: 25664
output nodes number: 11633
edges number: 87111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.637612819671631  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.637613296508789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.037200927734375  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

pseudo mini batch 3 input nodes size: 36495
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.03178548812866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.03178548812866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.04936361312866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.04945039749145508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02525949478149414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([36495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([2547, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2547, 128]), torch.Size([1, 2547, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.09205198287963867  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.11227226257324219  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2547, 128])
m.shape torch.Size([2668, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.1136021614074707  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.1136021614074707  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2668, 128]), torch.Size([1, 2668, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.11687707901000977  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15694284439086914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2668, 128])
m.shape torch.Size([2364, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15810251235961914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15810251235961914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2364, 128]), torch.Size([1, 2364, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.16070175170898438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21102523803710938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2364, 128])
m.shape torch.Size([1975, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21440696716308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21440696716308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1975, 128]), torch.Size([1, 1975, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21629047393798828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.27091217041015625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1975, 128])
m.shape torch.Size([1703, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.2740306854248047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.2740306854248047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.27565479278564453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33629322052001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1432, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33957815170288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33957815170288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1432, 128]), torch.Size([1, 1432, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.3409438133239746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.4000816345214844  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1432, 128])
m.shape torch.Size([1210, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40343761444091797  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40343761444091797  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1210, 128]), torch.Size([1, 1210, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40459156036376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.4633808135986328  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1210, 128])
m.shape torch.Size([1073, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46689701080322266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46689701080322266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46792030334472656  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5262479782104492  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([901, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5296030044555664  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5296030044555664  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5304622650146484  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5869369506835938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([6042, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6153178215026855  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6153178215026855  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 6042, 128]), torch.Size([1, 6042, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6210799217224121  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.030189037322998  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 6042, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9774689674377441  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9983687400817871  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.01926851272583  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9982051849365234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([21915, 256])
first layer input nodes number: 36495
first layer output nodes number: 21915
edges number: 125565
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0195426940917969  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0404424667358398  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0456676483154297  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0456676483154297  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([1806, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1230812072753906  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1230812072753906  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1806, 256]), torch.Size([1, 1806, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1275711059570312  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1572189331054688  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1806, 256])
m.shape torch.Size([1656, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1581573486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1581573486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1656, 256]), torch.Size([1, 1656, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1620688438415527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.210111141204834  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1656, 256])
m.shape torch.Size([1332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2122621536254883  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2122621536254883  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1332, 256]), torch.Size([1, 1332, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2148065567016602  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.274306297302246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1332, 256])
m.shape torch.Size([1046, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2770576477050781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2770576477050781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1046, 256]), torch.Size([1, 1046, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.279160499572754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3397250175476074  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1046, 256])
m.shape torch.Size([882, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3428363800048828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3428363800048828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3445186614990234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.405080795288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([712, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4083456993103027  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4083456993103027  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4097037315368652  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.470567226409912  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([617, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4740395545959473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4740395545959473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4752163887023926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5364365577697754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([508, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5397543907165527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5397543907165527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5407233238220215  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5971007347106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([408, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.600924015045166  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6523699760437012  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([344, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.655287265777588  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.655287265777588  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6559433937072754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7035670280456543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([306, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7064743041992188  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7064743041992188  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7070579528808594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7536344528198242  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.756272315979004  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.756272315979004  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7567567825317383  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7979364395141602  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([208, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8002934455871582  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8002934455871582  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8006901741027832  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8371891975402832  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([175, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.839345932006836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.839345932006836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8396797180175781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8727245330810547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([169, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8749942779541016  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8749942779541016  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8753166198730469  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.90948486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([145, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9115538597106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9115538597106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9118304252624512  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.943082332611084  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9445290565490723  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9445290565490723  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.944714069366455  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9669156074523926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9683113098144531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9683113098144531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.968475341796875  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9893074035644531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9907960891723633  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9907960891723633  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9909601211547852  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0129404067993164  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([82, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.014434814453125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.014434814453125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0145912170410156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0366439819335938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.037837505340576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.037837505340576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0379576683044434  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.055741786956787  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.056896686553955  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.056896686553955  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0570054054260254  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.073856830596924  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.074965476989746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.074965476989746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0750646591186523  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.091132164001465  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920052528381348  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920052528381348  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920815467834473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1049752235412598  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([505, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1170716285705566  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1170716285705566  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.118034839630127  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.289429187774658  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 505, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2248363494873047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.227081298828125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2288155555725098  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264838218688965  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([11636, 40])
input nodes number: 21915
output nodes number: 11636
edges number: 77727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264275550842285  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264280319213867  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02945709228515625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

pseudo mini batch 4 input nodes size: 66740
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02495288848876953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02495288848876953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.056777000427246094  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.056859493255615234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.039194583892822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([66740, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([2575, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1659865379333496  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1659865379333496  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1684422492980957  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18869495391845703  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
m.shape torch.Size([2609, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18992280960083008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18992280960083008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2609, 128]), torch.Size([1, 2609, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.19241094589233398  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23085832595825195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2609, 128])
m.shape torch.Size([2193, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23333358764648438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23333358764648438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2358088493347168  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.282900333404541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
m.shape torch.Size([1966, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2860374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2860374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1966, 128]), torch.Size([1, 1966, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.28791236877441406  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34228515625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1966, 128])
m.shape torch.Size([1850, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34575843811035156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34575843811035156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.3475227355957031  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4110374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1572, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.41465282440185547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.41465282440185547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4161520004272461  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4811840057373047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([1430, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.48520755767822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.48520755767822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4865713119506836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.5555095672607422  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1378, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.560084342956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.560084342956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1378, 128]), torch.Size([1, 1378, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.5613985061645508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6363248825073242  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1378, 128])
m.shape torch.Size([1223, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6409163475036621  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6409163475036621  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.642082691192627  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.7191133499145508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([17735, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8030972480773926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8030972480773926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 17735, 128]), torch.Size([1, 17735, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8207368850708008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0215892791748047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 17735, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.909590244293213  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.942521572113037  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9754528999328613  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9422640800476074  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([34531, 256])
first layer input nodes number: 66740
first layer output nodes number: 34531
edges number: 250309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9759521484375  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.008883476257324  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0171165466308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0171165466308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([1775, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.105952739715576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.105952739715576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.110034465789795  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1408190727233887  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1491, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.141289234161377  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.141289234161377  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1491, 256]), torch.Size([1, 1491, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1443963050842285  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1875672340393066  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1491, 256])
m.shape torch.Size([1131, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1894068717956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1894068717956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.191612720489502  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2398571968078613  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([837, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2425107955932617  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2425107955932617  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.244107246398926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.291152000427246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([768, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2940444946289062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2940444946289062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2955093383789062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.348379611968994  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([580, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.350992202758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.350992202758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.3520984649658203  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4023590087890625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([439, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4047598838806152  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4047598838806152  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.40559720993042  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4478983879089355  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([406, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.450601577758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.450601577758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.451375961303711  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.497407913208008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([320, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.499788761138916  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.499788761138916  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.500399112701416  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.541982650756836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5444650650024414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5444650650024414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.545018196105957  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5851221084594727  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([255, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5875415802001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5875415802001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5880279541015625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.625965118408203  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([225, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628317356109619  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628317356109619  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628746509552002  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.665224552154541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([160, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6670093536376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6670093536376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6673145294189453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6953907012939453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6970815658569336  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6970815658569336  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.697342872619629  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.723212242126465  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([133, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.72499942779541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.72499942779541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.725253105163574  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.752142906188965  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([119, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7538461685180664  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7538461685180664  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.754073143005371  GigaBytes
Max Memory Allocated: 2.754073143005371  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.779721260070801  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7812910079956055  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7812910079956055  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.781487464904785  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8050622940063477  GigaBytes
Max Memory Allocated: 2.806732177734375  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.806884765625  GigaBytes
Max Memory Allocated: 2.8068923950195312  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.806884765625  GigaBytes
Max Memory Allocated: 2.8068923950195312  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.807096481323242  GigaBytes
Max Memory Allocated: 2.807096481323242  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.833984375  GigaBytes
Max Memory Allocated: 2.8358898162841797  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8358874320983887  GigaBytes
Max Memory Allocated: 2.835895538330078  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8358874320983887  GigaBytes
Max Memory Allocated: 2.835895538330078  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.836097240447998  GigaBytes
Max Memory Allocated: 2.836097240447998  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8642115592956543  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.865856170654297  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.865856170654297  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.866029739379883  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8905029296875  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8919100761413574  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8919100761413574  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8920512199401855  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.912940502166748  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9140982627868652  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9140982627868652  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9142088890075684  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9313559532165527  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.932405948638916  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.932405948638916  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9325013160705566  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.947950839996338  GigaBytes
Max Memory Allocated: 2.949047565460205  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9494948387145996  GigaBytes
Max Memory Allocated: 2.9495010375976562  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9494948387145996  GigaBytes
Max Memory Allocated: 2.9495010375976562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9496264457702637  GigaBytes
Max Memory Allocated: 2.9496264457702637  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9718680381774902  GigaBytes
Max Memory Allocated: 2.973447322845459  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1303, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0032949447631836  GigaBytes
Max Memory Allocated: 3.0034165382385254  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0032949447631836  GigaBytes
Max Memory Allocated: 3.0034165382385254  GigaBytes

 h.shape torch.Size([1, 1303, 256]), torch.Size([1, 1303, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0057802200317383  GigaBytes
Max Memory Allocated: 3.0057802200317383  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.45896053314209  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1303, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3800406455993652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3821749687194824  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.383819580078125  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3816027641296387  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([11035, 40])
input nodes number: 34531
output nodes number: 11035
edges number: 90191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.38234281539917  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.382343292236328  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

pseudo mini batch 5 input nodes size: 49175
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.06304311752319336  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.0631260871887207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.031219482421875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([49175, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2916, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2916, 128]), torch.Size([1, 2916, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.10399961471557617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.12684202194213867  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2916, 128])
m.shape torch.Size([2952, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1282668113708496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1282668113708496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2952, 128]), torch.Size([1, 2952, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.13165998458862305  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1738886833190918  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2952, 128])
m.shape torch.Size([2595, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1761932373046875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1761932373046875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2595, 128]), torch.Size([1, 2595, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.17909765243530273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23366403579711914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2595, 128])
m.shape torch.Size([2164, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23649358749389648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23649358749389648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2164, 128]), torch.Size([1, 2164, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23865890502929688  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3000655174255371  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2164, 128])
m.shape torch.Size([1872, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3034968376159668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3034968376159668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1872, 128]), torch.Size([1, 1872, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3052821159362793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3695521354675293  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1872, 128])
m.shape torch.Size([1485, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1485, 128]), torch.Size([1, 1485, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.37432432174682617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.43592023849487305  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1485, 128])
m.shape torch.Size([1235, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4393343925476074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4393343925476074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.44051218032836914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4994015693664551  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1080, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.503962516784668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5640230178833008  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([944, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5675592422485352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5675592422485352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5684595108032227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.6262211799621582  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([6630, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.657595157623291  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.657595157623291  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 6630, 128]), torch.Size([1, 6630, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.6639180183410645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1188483238220215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 6630, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.0610108375549316  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.083777904510498  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1065449714660645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.08359956741333  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([23873, 256])
first layer input nodes number: 49175
first layer output nodes number: 23873
edges number: 135612
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1069135665893555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1296806335449219  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1353726387023926  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1353726387023926  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2128, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.20097017288208  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.20097017288208  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2128, 256]), torch.Size([1, 2128, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2058444023132324  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2395377159118652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2128, 256])
m.shape torch.Size([1755, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2400846481323242  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2400846481323242  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1755, 256]), torch.Size([1, 1755, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2435226440429688  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2948780059814453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1755, 256])
m.shape torch.Size([1341, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2970709800720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2970709800720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1341, 256]), torch.Size([1, 1341, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2998690605163574  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.3587708473205566  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1341, 256])
m.shape torch.Size([1084, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.361168384552002  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.361168384552002  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1084, 256]), torch.Size([1, 1084, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.3633465766906738  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4288783073425293  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1084, 256])
m.shape torch.Size([864, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.431260585784912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.431260585784912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.432908535003662  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.494091510772705  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 864, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4968833923339844  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4968833923339844  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4980792999267578  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5534248352050781  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([506, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5562314987182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5562314987182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5571966171264648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.605910301208496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([413, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6086034774780273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6086034774780273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.609391212463379  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6556272506713867  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([387, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.658581256866455  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.658581256866455  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6593194007873535  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7069001197814941  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7092223167419434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7092223167419434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7097563743591309  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7486329078674316  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([208, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7505650520324707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7505650520324707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7509617805480957  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7819066047668457  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([196, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7839689254760742  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7839689254760742  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7843427658081055  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8161191940307617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([180, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8181815147399902  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8181815147399902  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8185248374938965  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8501105308532715  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([141, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8518362045288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8518362045288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8521051406860352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8787298202514648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880051612854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880051612854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880244255065918  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9006643295288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.902029037475586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.902029037475586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9022102355957031  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9226856231689453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9240655899047852  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9240655899047852  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9242372512817383  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9448366165161133  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.945927619934082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.945927619934082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9460573196411133  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.962529182434082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.963669776916504  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.963669776916504  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9637956619262695  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9806642532348633  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9817166328430176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9817166328430176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9818272590637207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9974255561828613  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9981374740600586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9981374740600586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9982099533081055  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.008936882019043  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0095772743225098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0095772743225098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0096383094787598  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0190987586975098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019775867462158  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019775867462158  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019836902618408  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.029724597930908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305018424987793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305018424987793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305685997009277  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0418505668640137  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([382, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0509963035583496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0509963035583496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.051724910736084  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1837639808654785  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 382, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1305580139160156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1322317123413086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1340017318725586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1322450637817383  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([11107, 40])
input nodes number: 23873
output nodes number: 11107
edges number: 64993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1320457458496094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1320462226867676  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03526020050048828  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

pseudo mini batch 6 input nodes size: 87478
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03075885772705078  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03075885772705078  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.07247161865234375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.07255411148071289  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.049022674560546875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([87478, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2521, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23632240295410156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23632240295410156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2521, 128]), torch.Size([1, 2521, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23872661590576172  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.25886011123657227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2521, 128])
m.shape torch.Size([2795, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2611265182495117  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2611265182495117  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2795, 128]), torch.Size([1, 2795, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2637920379638672  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.30446338653564453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2795, 128])
m.shape torch.Size([2550, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3067784309387207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3067784309387207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2550, 128]), torch.Size([1, 2550, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3093271255493164  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36429595947265625  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2550, 128])
m.shape torch.Size([2229, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36733150482177734  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36733150482177734  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2229, 128]), torch.Size([1, 2229, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36960935592651367  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.4361395835876465  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2229, 128])
m.shape torch.Size([2132, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44039106369018555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44039106369018555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44242429733276367  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5180783271789551  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([1987, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5231614112854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5231614112854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1987, 128]), torch.Size([1, 1987, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5250563621520996  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.606539249420166  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1987, 128])
m.shape torch.Size([1866, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6118202209472656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6118202209472656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6135997772216797  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7025775909423828  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1787, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7085046768188477  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7085046768188477  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1787, 128]), torch.Size([1, 1787, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7102088928222656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8073492050170898  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1787, 128])
m.shape torch.Size([1661, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8136253356933594  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8136253356933594  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8152093887329102  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.9186792373657227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([28073, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.0526528358459473  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.0526528358459473  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 28073, 128]), torch.Size([1, 28073, 128])
----------------------------------------3
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.07942533493042  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9808902740478516  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 28073, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.8124423027038574  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.8578381538391113  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9032340049743652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.857483386993408  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([47601, 256])
first layer input nodes number: 87478
first layer output nodes number: 47601
edges number: 370296
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9038877487182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9492835998535156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.960632801055908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.960632801055908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([1582, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0616002082824707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0616002082824707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1582, 256]), torch.Size([1, 1582, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0650715827941895  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0921406745910645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1582, 256])
m.shape torch.Size([1408, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.092625141143799  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.092625141143799  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1408, 256]), torch.Size([1, 1408, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.096177577972412  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.142063617706299  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1408, 256])
m.shape torch.Size([1060, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.143777370452881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.143777370452881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1060, 256]), torch.Size([1, 1060, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.1458568572998047  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.1913223266601562  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1060, 256])
m.shape torch.Size([763, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.19315242767334  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.19315242767334  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.194607734680176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2377829551696777  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([657, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.240212917327881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.240212917327881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2414660453796387  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2870655059814453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([516, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.289414882659912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.289414882659912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2903990745544434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3348965644836426  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([428, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3372840881347656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3372840881347656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3381004333496094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3794655799865723  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([362, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3822836875915527  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3822836875915527  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.382974147796631  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4225287437438965  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([306, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.424830913543701  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.424830913543701  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.425414562225342  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4646029472351074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4669928550720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4669928550720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.467525005340576  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5068583488464355  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5093202590942383  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5093202590942383  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.509812355041504  GigaBytes
Max Memory Allocated: 3.509812355041504  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5497045516967773  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.551927089691162  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.551927089691162  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.552335262298584  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5870299339294434  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([191, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.589212417602539  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.589212417602539  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5895767211914062  GigaBytes
Max Memory Allocated: 3.5895767211914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6230926513671875  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.625077247619629  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.625077247619629  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6253843307495117  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.65578556060791  GigaBytes
Max Memory Allocated: 3.65793514251709  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6579675674438477  GigaBytes
Max Memory Allocated: 3.6579766273498535  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6579675674438477  GigaBytes
Max Memory Allocated: 3.6579766273498535  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6582765579223633  GigaBytes
Max Memory Allocated: 3.6582765579223633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6910295486450195  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.692997455596924  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.692997455596924  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.693260669708252  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.72300386428833  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7248167991638184  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7248167991638184  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.725043773651123  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7522807121276855  GigaBytes
Max Memory Allocated: 3.7542099952697754  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([138, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7554454803466797  GigaBytes
Max Memory Allocated: 3.7554550170898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7554454803466797  GigaBytes
Max Memory Allocated: 3.7554550170898438  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.755708694458008  GigaBytes
Max Memory Allocated: 3.755708694458008  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7891368865966797  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.791032314300537  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.791032314300537  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7912440299987793  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8196139335632324  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8213534355163574  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8213534355163574  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8215365409851074  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8473544120788574  GigaBytes
Max Memory Allocated: 3.8491854667663574  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.849362373352051  GigaBytes
Max Memory Allocated: 3.8493709564208984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.849362373352051  GigaBytes
Max Memory Allocated: 3.8493709564208984  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8495607376098633  GigaBytes
Max Memory Allocated: 3.8495607376098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8789186477661133  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8807015419006348  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8807015419006348  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.880871295928955  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9071831703186035  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908623695373535  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908623695373535  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908755302429199  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9300756454467773  GigaBytes
Max Memory Allocated: 3.931589126586914  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931763172149658  GigaBytes
Max Memory Allocated: 3.9317703247070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931763172149658  GigaBytes
Max Memory Allocated: 3.9317703247070312  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931908130645752  GigaBytes
Max Memory Allocated: 3.931908130645752  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9564061164855957  GigaBytes
Max Memory Allocated: 3.9581456184387207  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1748, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9989309310913086  GigaBytes
Max Memory Allocated: 3.999094009399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9989309310913086  GigaBytes
Max Memory Allocated: 3.999094009399414  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.002264976501465  GigaBytes
Max Memory Allocated: 4.002264976501465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.590806007385254  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.500152587890625  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.502571105957031  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.504215717315674  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.501714706420898  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([11035, 40])
input nodes number: 47601
output nodes number: 11035
edges number: 103017
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.50212287902832  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.5021233558654785  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.06011676788330078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

pseudo mini batch 7 input nodes size: 68973
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.08188247680664062  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.08196640014648438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.040171146392822266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([68973, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

m.shape torch.Size([1857, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1857, 128]), torch.Size([1, 1857, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21510791778564453  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.22927570343017578  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1857, 128])
m.shape torch.Size([1853, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23015737533569336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23015737533569336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1853, 128]), torch.Size([1, 1853, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23192453384399414  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.25843191146850586  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1853, 128])
m.shape torch.Size([1765, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26045751571655273  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26045751571655273  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26214075088500977  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.29941606521606445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1662, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3017444610595703  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3017444610595703  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3033294677734375  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1603, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35326290130615234  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35326290130615234  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1603, 128]), torch.Size([1, 1603, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35479164123535156  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.40982627868652344  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1603, 128])
m.shape torch.Size([1541, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4135613441467285  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4135613441467285  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.41503095626831055  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4782242774963379  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1503, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48250627517700195  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48250627517700195  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48393964767456055  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5556082725524902  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([1406, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5602550506591797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5602550506591797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1406, 128]), torch.Size([1, 1406, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5615959167480469  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6381983757019043  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1406, 128])
m.shape torch.Size([1367, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6433944702148438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6433944702148438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1367, 128]), torch.Size([1, 1367, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6446981430053711  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7281332015991211  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1367, 128])
m.shape torch.Size([27556, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8588786125183105  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8588786125183105  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 27556, 128]), torch.Size([1, 27556, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8851580619812012  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7509989738464355  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 27556, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.592926502227783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.6330885887145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.673250675201416  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.6327743530273438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([42113, 256])
first layer input nodes number: 68973
first layer output nodes number: 42113
edges number: 344399
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.673766613006592  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.713928699493408  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7239694595336914  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7239694595336914  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

m.shape torch.Size([1216, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.858600616455078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.858600616455078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1216, 256]), torch.Size([1, 1216, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8611602783203125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8808441162109375  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1216, 256])
m.shape torch.Size([970, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8813319206237793  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8813319206237793  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8831820487976074  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.911120891571045  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([748, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9124178886413574  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9124178886413574  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.913844585418701  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.947838306427002  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([618, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9498348236083984  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9498348236083984  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9510135650634766  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.986532211303711  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([544, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9885573387145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9885573387145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9895949363708496  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.027749538421631  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([446, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.0298027992248535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.0298027992248535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.030653476715088  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.072136402130127  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([379, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.07426118850708  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.07426118850708  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.074984073638916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.114945411682129  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([309, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.116960048675537  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.116960048675537  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.117549419403076  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.153008460998535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([327, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1555423736572266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1555423736572266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1561660766601562  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.197617530822754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([304, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200227737426758  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200227737426758  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200807571411133  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.243173599243164  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2456541061401367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2456541061401367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2461538314819336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.285900115966797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([262, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.28867244720459  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.28867244720459  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2891721725463867  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3327322006225586  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([236, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.336045265197754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.336045265197754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3364953994750977  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3779077529907227  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380280017852783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380280017852783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380648136138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4170918464660645  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([171, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4193735122680664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4193735122680664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4196996688842773  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4542722702026367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([177, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.456831455230713  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.456831455230713  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4571690559387207  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4953179359436035  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.497910499572754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.497910499572754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.498232841491699  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5369138717651367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([177, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5398149490356445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5398149490356445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5401525497436523  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5830278396606445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([157, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.585726261138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.585726261138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5860257148742676  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.626152515411377  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([161, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.62921142578125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.62921142578125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.629518508911133  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6728172302246094  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([151, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6757116317749023  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6757116317749023  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.675999641418457  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.718625068664551  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([99, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.7205748558044434  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.7205748558044434  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.720763683319092  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.7500319480895996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.752612590789795  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.752612590789795  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.7528433799743652  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.790231227874756  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.7925844192504883  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.7925844192504883  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.792788505554199  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8272790908813477  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([2950, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8980603218078613  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8980603218078613  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 2950, 256]), torch.Size([1, 2950, 256])
----------------------------------------3
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.903687000274658  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.894869327545166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2950, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.770498275756836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.77293586730957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.77558708190918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.773065567016602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11254, 40])
input nodes number: 42113
output nodes number: 11254
edges number: 138281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.774256706237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.774257183074951  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05108976364135742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0566401481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0566401481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02344048023223877 |0.043378204107284546 |0.18525946140289307 |0.00010070204734802246 |0.08063855767250061 |0.005682706832885742 |
----------------------------------------------------------pseudo_mini_loss sum 5.337371349334717
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  663106
Number of first layer input nodes during this epoch:  426598
Number of first layer output nodes during this epoch:  236508
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.056639671325683594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes
[05:10:54] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 8 parts and get 4611602 edge cuts

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02226710319519043
global_2_local spend time (sec) 0.04741239547729492
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004250049591064453
A = g.adjacency_matrix() spent  0.008306741714477539
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.10531735420227051
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.3354754447937012
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1710805892944336

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.326 seconds
Metis partitioning: 5.191 seconds
Split the graph: 1.814 seconds
Construct subgraphs: 0.131 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.476800918579102
11519
11420
11594
11593
11189
11168
11423
11035
total k batches seeds list generation spend  18.68264102935791
after graph partition
graph partition algorithm spend time 18.767014026641846
11519
11420
11594
11593
11189
11168
11423
11035
partition_len_list
[20024, 20761, 20555, 24859, 29438, 30047, 41296, 47142]
shared_neighbor_graph_partition_s0 selection method  spend 18.869794607162476
time for parepare:  0.01979351043701172
local_output_nid generation:  0.002330303192138672
local_in_edges_tensor generation:  0.002271413803100586
mini_batch_src_global generation:  0.007491350173950195
r_  generation:  0.03020930290222168
local_output_nid generation:  0.00289154052734375
local_in_edges_tensor generation:  0.002268552780151367
mini_batch_src_global generation:  0.003540515899658203
r_  generation:  0.030173063278198242
local_output_nid generation:  0.0030324459075927734
local_in_edges_tensor generation:  0.0020723342895507812
mini_batch_src_global generation:  0.0026624202728271484
r_  generation:  0.025876522064208984
local_output_nid generation:  0.0029811859130859375
local_in_edges_tensor generation:  0.002123594284057617
mini_batch_src_global generation:  0.002891063690185547
r_  generation:  0.030976295471191406
local_output_nid generation:  0.0030889511108398438
local_in_edges_tensor generation:  0.002129077911376953
mini_batch_src_global generation:  0.0027456283569335938
r_  generation:  0.027418136596679688
local_output_nid generation:  0.0030918121337890625
local_in_edges_tensor generation:  0.0020596981048583984
mini_batch_src_global generation:  0.0024230480194091797
r_  generation:  0.027292251586914062
local_output_nid generation:  0.0030984878540039062
local_in_edges_tensor generation:  0.0027587413787841797
mini_batch_src_global generation:  0.0047571659088134766
r_  generation:  0.07347512245178223
local_output_nid generation:  0.003416776657104492
local_in_edges_tensor generation:  0.002949953079223633
mini_batch_src_global generation:  0.005677223205566406
r_  generation:  0.042934417724609375
----------------------check_connections_block total spend ----------------------------- 0.44989871978759766
generate_one_block  0.04534459114074707
generate_one_block  0.04567766189575195
generate_one_block  0.035890817642211914
generate_one_block  0.041037797927856445
generate_one_block  0.03615546226501465
generate_one_block  0.03542280197143555
generate_one_block  0.06791567802429199
generate_one_block  0.06335330009460449
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.050109148025512695
gen group dst list time:  0.006647586822509766
time for parepare:  0.0242922306060791
local_output_nid generation:  0.003681659698486328
local_in_edges_tensor generation:  0.012648344039916992
mini_batch_src_global generation:  0.004038095474243164
r_  generation:  0.042944908142089844
local_output_nid generation:  0.006083011627197266
local_in_edges_tensor generation:  0.005954742431640625
mini_batch_src_global generation:  0.004862546920776367
r_  generation:  0.044766902923583984
local_output_nid generation:  0.00615692138671875
local_in_edges_tensor generation:  0.004784822463989258
mini_batch_src_global generation:  0.0036802291870117188
r_  generation:  0.04214930534362793
local_output_nid generation:  0.007561922073364258
local_in_edges_tensor generation:  0.006765842437744141
mini_batch_src_global generation:  0.005804538726806641
r_  generation:  0.05870318412780762
local_output_nid generation:  0.008849143981933594
local_in_edges_tensor generation:  0.0063364505767822266
mini_batch_src_global generation:  0.0069239139556884766
r_  generation:  0.07320547103881836
local_output_nid generation:  0.00989389419555664
local_in_edges_tensor generation:  0.0077970027923583984
mini_batch_src_global generation:  0.008381843566894531
r_  generation:  0.0776677131652832
local_output_nid generation:  0.011337041854858398
local_in_edges_tensor generation:  0.011137247085571289
mini_batch_src_global generation:  0.014656782150268555
r_  generation:  0.12735295295715332
local_output_nid generation:  0.013027429580688477
local_in_edges_tensor generation:  0.012666940689086914
mini_batch_src_global generation:  0.021019458770751953
r_  generation:  0.14937710762023926
----------------------check_connections_block total spend ----------------------------- 0.9958577156066895
generate_one_block  0.05829930305480957
generate_one_block  0.06544160842895508
generate_one_block  0.05402350425720215
generate_one_block  0.09160161018371582
generate_one_block  0.09458327293395996
generate_one_block  0.09583139419555664
generate_one_block  0.1578211784362793
generate_one_block  0.17307376861572266
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.056639671325683594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

connection checking time:  0.9958577156066895
block generation total time  0.7906756401062012
average batch blocks generation time:  0.09883445501327515
block dataloader generation time/epoch 21.671937227249146
pseudo mini batch 0 input nodes size: 34465
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06294775009155273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0630335807800293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030060768127441406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03166389465332031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03166389465332031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03166389465332031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([34465, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03166389465332031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1943, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09347248077392578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09347248077392578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1943, 128]), torch.Size([1, 1943, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09532546997070312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11075019836425781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1943, 128])
m.shape torch.Size([2090, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1118168830871582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1118168830871582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2090, 128]), torch.Size([1, 2090, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11395740509033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14532756805419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2090, 128])
m.shape torch.Size([1935, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14638280868530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14638280868530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1935, 128]), torch.Size([1, 1935, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14822816848754883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1888260841369629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1935, 128])
m.shape torch.Size([1714, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19142580032348633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19142580032348633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1714, 128]), torch.Size([1, 1714, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19306039810180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24182748794555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1714, 128])
m.shape torch.Size([1392, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24432897567749023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24432897567749023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1392, 128]), torch.Size([1, 1392, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24565649032592773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2942948341369629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1392, 128])
m.shape torch.Size([1282, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2972989082336426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2972989082336426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2985215187072754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35140275955200195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1061, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35433292388916016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35433292388916016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1061, 128]), torch.Size([1, 1061, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3553447723388672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4061741828918457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1061, 128])
m.shape torch.Size([960, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4093303680419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4093303680419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4102458953857422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46457862854003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([857, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46779870986938477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46779870986938477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 857, 128]), torch.Size([1, 857, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4686160087585449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5211405754089355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 857, 128])
m.shape torch.Size([6790, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5534505844116211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5534505844116211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 6790, 128]), torch.Size([1, 6790, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5599260330200195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0207738876342773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 6790, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9673957824707031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9869270324707031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0064582824707031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9867777824401855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([20024, 256])
first layer input nodes number: 34465
first layer output nodes number: 20024
edges number: 124156
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0067172050476074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0262484550476074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.031022548675537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.031022548675537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1483, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.120378017425537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.120378017425537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1483, 256]), torch.Size([1, 1483, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1232695579528809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1492905616760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1483, 256])
m.shape torch.Size([1366, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1501102447509766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1501102447509766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1366, 256]), torch.Size([1, 1366, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1534671783447266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1929492950439453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1366, 256])
m.shape torch.Size([1171, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1949563026428223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1949563026428223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1171, 256]), torch.Size([1, 1171, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1973071098327637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.246696949005127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1171, 256])
m.shape torch.Size([1010, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2494635581970215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2494635581970215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1010, 256]), torch.Size([1, 1010, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.251389980316162  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.307523250579834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1010, 256])
m.shape torch.Size([791, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3107094764709473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3107094764709473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.312218189239502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3667445182800293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 791, 256])
m.shape torch.Size([711, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3700904846191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3700904846191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 711, 256]), torch.Size([1, 711, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3714466094970703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4308509826660156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 711, 256])
m.shape torch.Size([563, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4339609146118164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4339609146118164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4350347518920898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4897756576538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([498, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4930682182312012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4930682182312012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4940180778503418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.54933500289917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([460, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5528392791748047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5528392791748047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 460, 256]), torch.Size([1, 460, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5537166595458984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6108570098876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 460, 256])
m.shape torch.Size([407, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6143302917480469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6143302917480469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6151065826416016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6730289459228516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([366, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6765103340148926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6765103340148926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.677208423614502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7320542335510254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([291, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7350616455078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7350616455078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.735616683959961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7847843170166016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([253, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.787668228149414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.787668228149414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7881507873535156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8325462341308594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([208, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8354005813598633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8354005813598633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8357973098754883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8750734329223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8771677017211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8771677017211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8774709701538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9096174240112305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([169, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.912065029144287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.912065029144287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9123873710632324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9488120079040527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([153, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.951150894165039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.951150894165039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9514427185058594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9864616394042969  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([135, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9886512756347656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9886512756347656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9889087677001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0216102600097656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0235085487365723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0235085487365723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0237202644348145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0520901679992676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([113, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.05415678024292  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.05415678024292  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0543723106384277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0847620964050293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([99, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0866527557373047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0866527557373047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.086841583251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.114788055419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1164488792419434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1164488792419434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.116607189178467  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1411452293395996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([77, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.143068790435791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.143068790435791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1432156562805176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1670079231262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.168572425842285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.168572425842285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.168707847595215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.191594123840332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([771, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.210052490234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.210052490234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 771, 256]), torch.Size([1, 771, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2115230560302734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.470602035522461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.393779754638672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.395618438720703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.397502899169922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.395578384399414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11519, 40])
input nodes number: 20024
output nodes number: 11519
edges number: 90987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.395214557647705  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3952155113220215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03418111801147461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 1 input nodes size: 32850
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029462814331054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029462814331054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.045126914978027344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0452122688293457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.028692245483398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030332565307617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030332565307617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030332565307617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([32850, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030332565307617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2200, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09516143798828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09516143798828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2200, 128]), torch.Size([1, 2200, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.097259521484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11422348022460938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2200, 128])
m.shape torch.Size([2194, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11527252197265625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11527252197265625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2194, 128]), torch.Size([1, 2194, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11736488342285156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14908123016357422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2194, 128])
m.shape torch.Size([1962, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15117359161376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15117359161376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1962, 128]), torch.Size([1, 1962, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1530447006225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19516563415527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1962, 128])
m.shape torch.Size([1642, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19736194610595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.19736194610595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1642, 128]), torch.Size([1, 1642, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1989278793334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2448740005493164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1642, 128])
m.shape torch.Size([1516, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24770545959472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24770545959472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1516, 128]), torch.Size([1, 1516, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.24915122985839844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30210113525390625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1516, 128])
m.shape torch.Size([1235, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30491161346435547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30491161346435547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3060894012451172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35691356658935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1048, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35982275009155273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35982275009155273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1048, 128]), torch.Size([1, 1048, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3608222007751465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41129541397094727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1048, 128])
m.shape torch.Size([956, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4144425392150879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4144425392150879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 956, 128]), torch.Size([1, 956, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41535425186157227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46934938430786133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 956, 128])
m.shape torch.Size([800, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47232675552368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47232675552368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 800, 128]), torch.Size([1, 800, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47308969497680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5226349830627441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 800, 128])
m.shape torch.Size([7208, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5574097633361816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5574097633361816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 7208, 128]), torch.Size([1, 7208, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5642838478088379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0523438453674316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 7208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9972357749938965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0170350074768066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0368342399597168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0168800354003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([20761, 256])
first layer input nodes number: 32850
first layer output nodes number: 20761
edges number: 128296
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.037081241607666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0568804740905762  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0626635551452637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0626635551452637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1641, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1540393829345703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1540393829345703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1641, 256]), torch.Size([1, 1641, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.158731460571289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1871891021728516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1641, 256])
m.shape torch.Size([1404, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.188216209411621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.188216209411621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1404, 256]), torch.Size([1, 1404, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1908941268920898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.233626365661621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1404, 256])
m.shape torch.Size([1191, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2357215881347656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2357215881347656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1191, 256]), torch.Size([1, 1191, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2380104064941406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2895216941833496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1191, 256])
m.shape torch.Size([909, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2918062210083008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2918062210083008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2935400009155273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3438196182250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3467636108398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3467636108398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.348276138305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.403073787689209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([629, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.40594482421875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.40594482421875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.407144546508789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4598369598388672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([533, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4628233909606934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4628233909606934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4638400077819824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5168976783752441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([467, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5199804306030273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5199804306030273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5208711624145508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5716428756713867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([402, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5746750831604004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5746750831604004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.575441837310791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6248822212219238  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([346, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6278247833251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6278247833251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6284847259521484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6756305694580078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([305, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.678525447845459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.678525447845459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6791071891784668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7262978553771973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7289366722106934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7289366722106934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7294211387634277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7706007957458496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([221, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7731199264526367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7731199264526367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7735414505004883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.812321662902832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([202, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8148293495178223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8148293495178223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8152146339416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8533577919006348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([190, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8559045791625977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8559045791625977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.856266975402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8946809768676758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([144, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.896714210510254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.896714210510254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.896988868713379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.928025245666504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([164, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.930567741394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.930567741394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9308805465698242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9684171676635742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([114, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.97023344039917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.97023344039917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9704508781433105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.99806547164917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9998927116394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9998927116394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0000948905944824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.027186870574951  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([119, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0297465324401855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0297465324401855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0299735069274902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.061976909637451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([112, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.06412410736084  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.06412410736084  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.064337730407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.095953941345215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0973563194274902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0973563194274902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.097470760345459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1152091026306152  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.116699695587158  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.116699695587158  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.116833209991455  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.138462543487549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1399645805358887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1399645805358887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.14009428024292  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.162013530731201  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([976, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1854004859924316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1854004859924316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 976, 256]), torch.Size([1, 976, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1872620582580566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.528250217437744  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 976, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4493093490600586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.451655387878418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.45413875579834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.451707363128662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11420, 40])
input nodes number: 20761
output nodes number: 11420
edges number: 91748
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4524550437927246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.452455520629883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03400278091430664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 2 input nodes size: 32674
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029199600219726562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029199600219726562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04477977752685547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04486656188964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029117107391357422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030494213104248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030494213104248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030494213104248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([32674, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030494213104248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2645, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08678865432739258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08678865432739258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2645, 128]), torch.Size([1, 2645, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08965492248535156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11056995391845703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2645, 128])
m.shape torch.Size([2678, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1118626594543457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1118626594543457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2678, 128]), torch.Size([1, 2678, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11441659927368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15543222427368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2678, 128])
m.shape torch.Size([2344, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15660619735717773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15660619735717773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2344, 128]), torch.Size([1, 2344, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.15923166275024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.20976972579956055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2344, 128])
m.shape torch.Size([1977, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21312284469604492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21312284469604492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1977, 128]), torch.Size([1, 1977, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21500825881958008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.27022695541381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1977, 128])
m.shape torch.Size([1672, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2732706069946289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2732706069946289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1672, 128]), torch.Size([1, 1672, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.27486515045166016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.33501529693603516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1672, 128])
m.shape torch.Size([1374, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3381490707397461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3381490707397461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1374, 128]), torch.Size([1, 1374, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3394594192504883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.39835643768310547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1374, 128])
m.shape torch.Size([1149, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4015364646911621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4015364646911621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1149, 128]), torch.Size([1, 1149, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4026322364807129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4591341018676758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1149, 128])
m.shape torch.Size([987, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46235132217407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46235132217407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 987, 128]), torch.Size([1, 987, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.46329259872436523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.517906665802002  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 987, 128])
m.shape torch.Size([809, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5209078788757324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5209078788757324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 809, 128]), torch.Size([1, 809, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5216794013977051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.571685791015625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 809, 128])
m.shape torch.Size([4920, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5947604179382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5947604179382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 4920, 128]), torch.Size([1, 4920, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5994524955749512  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9463114738464355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 4920, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8988585472106934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9184613227844238  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9380640983581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9183077812194824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([20555, 256])
first layer input nodes number: 32674
first layer output nodes number: 20555
edges number: 111965
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9383096694946289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9579124450683594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9633674621582031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9633674621582031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1899, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0355677604675293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0355677604675293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1899, 256]), torch.Size([1, 1899, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0391898155212402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0696220397949219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1899, 256])
m.shape torch.Size([1711, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0711002349853516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0711002349853516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1711, 256]), torch.Size([1, 1711, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.07539701461792  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.126915454864502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1711, 256])
m.shape torch.Size([1373, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1292428970336914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1292428970336914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1373, 256]), torch.Size([1, 1373, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1325006484985352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1909914016723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1373, 256])
m.shape torch.Size([1083, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1938457489013672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1938457489013672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1083, 256]), torch.Size([1, 1083, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1959972381591797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.259242057800293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1083, 256])
m.shape torch.Size([898, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.261584758758545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.261584758758545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2632975578308105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3256640434265137  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([712, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.328913688659668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.328913688659668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3302717208862305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.389704704284668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([636, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3933048248291016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3933048248291016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3945178985595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4555559158325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([494, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4587478637695312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4587478637695312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 494, 256]), torch.Size([1, 494, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4596900939941406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5157556533813477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 494, 256])
m.shape torch.Size([397, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5187187194824219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5187187194824219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5194759368896484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5679378509521484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([349, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5709137916564941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5709137916564941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5715794563293457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6198134422302246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([274, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.622377872467041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.622377872467041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6229004859924316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.663994312286377  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([228, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6663627624511719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6663627624511719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6667976379394531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7037620544433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([199, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.706031322479248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.706031322479248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7064108848571777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.741330623626709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([160, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7432937622070312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7432937622070312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7435989379882812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7738113403320312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([155, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7758936882019043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7758936882019043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7761893272399902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8075270652770996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8091940879821777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8091940879821777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8094191551208496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8348517417907715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8363242149353027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8363242149353027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8365092277526855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.858710765838623  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([95, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8602619171142578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8602619171142578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.860443115234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8834552764892578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8847346305847168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8847346305847168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8848776817321777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9040465354919434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9054746627807617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9054746627807617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.905623435974121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.926600456237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.927548885345459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.927548885345459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9276423454284668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.941474437713623  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9423794746398926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9423794746398926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9424653053283691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9557690620422363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9566326141357422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9566326141357422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9567108154296875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9693794250488281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9705920219421387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9705920219421387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9706759452819824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9848589897155762  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([384, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9940438270568848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9940438270568848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9947762489318848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.126711368560791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 384, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0670056343078613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0695977210998535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0713257789611816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0686469078063965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11594, 40])
input nodes number: 20555
output nodes number: 11594
edges number: 72753
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0682692527770996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.068269729614258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03263044357299805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 3 input nodes size: 48624
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.028499126434326172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.028499126434326172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05168485641479492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05177164077758789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.036104679107666016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([48624, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03793764114379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2398, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11591434478759766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11591434478759766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2398, 128]), torch.Size([1, 2398, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11820125579833984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13666343688964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2398, 128])
m.shape torch.Size([2588, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13798809051513672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13798809051513672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2588, 128]), torch.Size([1, 2588, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1404561996459961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17870235443115234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2588, 128])
m.shape torch.Size([2320, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18117046356201172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18117046356201172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2320, 128]), torch.Size([1, 2320, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18346118927001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23367977142333984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2320, 128])
m.shape torch.Size([1926, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2369985580444336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2369985580444336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1926, 128]), torch.Size([1, 1926, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23883533477783203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2921018600463867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1926, 128])
m.shape torch.Size([1741, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2953343391418457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2953343391418457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1741, 128]), torch.Size([1, 1741, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.296994686126709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35793447494506836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1741, 128])
m.shape torch.Size([1438, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3612184524536133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3612184524536133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1438, 128]), torch.Size([1, 1438, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.36258983612060547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.42244768142700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1438, 128])
m.shape torch.Size([1277, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4260244369506836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4260244369506836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1277, 128]), torch.Size([1, 1277, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4272422790527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48996543884277344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1277, 128])
m.shape torch.Size([1251, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4941287040710449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4941287040710449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.49532175064086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5659518241882324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([998, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5696382522583008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5696382522583008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 998, 128]), torch.Size([1, 998, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5705900192260742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6329708099365234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 998, 128])
m.shape torch.Size([8922, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6750383377075195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6750383377075195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 8922, 128]), torch.Size([1, 8922, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6835470199584961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.287663459777832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 8922, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2200016975402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2437090873718262  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2674164772033691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2435235977172852  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([24859, 256])
first layer input nodes number: 48624
first layer output nodes number: 24859
edges number: 156720
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2677807807922363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2914881706237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2974152565002441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2974152565002441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1715, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3867363929748535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3867363929748535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1715, 256]), torch.Size([1, 1715, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3917641639709473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4214463233947754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1715, 256])
m.shape torch.Size([1543, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4223790168762207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4223790168762207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1543, 256]), torch.Size([1, 1543, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.425365924835205  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4705796241760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1543, 256])
m.shape torch.Size([1199, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4727706909179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4727706909179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1199, 256]), torch.Size([1, 1199, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4751858711242676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5269370079040527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1199, 256])
m.shape torch.Size([965, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5292768478393555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5292768478393555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5311174392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5844945907592773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([836, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5875921249389648  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5875921249389648  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 836, 256]), torch.Size([1, 836, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.589186668395996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6476249694824219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 836, 256])
m.shape torch.Size([626, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.650437831878662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.650437831878662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6516318321228027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7052397727966309  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([529, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7082018852233887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7082018852233887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 529, 256]), torch.Size([1, 529, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7092108726501465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7631316184997559  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 529, 256])
m.shape torch.Size([506, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7665181159973145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7665181159973145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7674832344055176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8228650093078613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([379, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8256611824035645  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8256611824035645  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8263840675354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8741211891174316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8771047592163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8771047592163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8777685165405273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.92620849609375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([278, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9288158416748047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9288158416748047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9293460845947266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9719128608703613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9746928215026855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9746928215026855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.975196361541748  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0192646980285645  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([231, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0218992233276367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0218992233276367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0223398208618164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0628747940063477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([219, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.065601348876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.065601348876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.066019058227539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.107372283935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([190, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.109902858734131  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.109902858734131  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1102652549743652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.148679256439209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1511807441711426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1511807441711426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1514534950256348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.182274341583252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1843605041503906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1843605041503906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.184619903564453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.215747833251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2175731658935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2175731658935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2177886962890625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2451610565185547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([98, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2468433380126953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2468433380126953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.247030258178711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2720775604248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2737722396850586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2737722396850586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.27394962310791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2989606857299805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.300567626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.300567626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3007278442382812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3244400024414062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([85, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.326157569885254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.326157569885254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.326319694519043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3514490127563477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.352738857269287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.352738857269287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3528571128845215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3720145225524902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3732705116271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3732705116271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3733792304992676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3917527198791504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([894, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.413179874420166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.413179874420166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4148850440979004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7151951789855957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 894, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.638350009918213  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.640829563140869  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6433091163635254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.640742778778076  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11593, 40])
input nodes number: 24859
output nodes number: 11593
edges number: 89115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6417665481567383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6417670249938965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.042236328125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 4 input nodes size: 59576
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03685617446899414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03685617446899414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06526422500610352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06534767150878906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.042075157165527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.044043540954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.044043540954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.044043540954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([59576, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.044043540954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2989, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13919734954833984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13919734954833984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2989, 128]), torch.Size([1, 2989, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14204788208007812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16516876220703125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2989, 128])
m.shape torch.Size([2892, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16650152206420898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16650152206420898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2892, 128]), torch.Size([1, 2892, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1693434715270996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2110767364501953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2892, 128])
m.shape torch.Size([2546, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2138347625732422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2138347625732422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2546, 128]), torch.Size([1, 2546, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2163562774658203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.27062034606933594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2546, 128])
m.shape torch.Size([2104, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2734193801879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2734193801879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2757124900817871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.33836984634399414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([1815, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.341064453125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.341064453125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1815, 128]), torch.Size([1, 1815, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.34279537200927734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4051084518432617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1815, 128])
m.shape torch.Size([1535, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.40863466262817383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.40863466262817383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1535, 128]), torch.Size([1, 1535, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4100985527038574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47533559799194336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1535, 128])
m.shape torch.Size([1331, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4790463447570801  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4790463447570801  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4803156852722168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5437827110290527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1198, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5477180480957031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5477180480957031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5488605499267578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.614166259765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1033, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6180281639099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6180281639099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1033, 128]), torch.Size([1, 1033, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6190133094787598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6820626258850098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1033, 128])
m.shape torch.Size([11995, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7387666702270508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7387666702270508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 11995, 128]), torch.Size([1, 11995, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7502059936523438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5691041946411133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 11995, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.484511375427246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5125856399536133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5406599044799805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5123662948608398  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([29438, 256])
first layer input nodes number: 59576
first layer output nodes number: 29438
edges number: 191260
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5411057472229004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5691800117492676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5761985778808594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5761985778808594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2120, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6491928100585938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6491928100585938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2120, 256]), torch.Size([1, 2120, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6541709899902344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6865196228027344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2120, 256])
m.shape torch.Size([1703, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.688258171081543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.688258171081543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1703, 256]), torch.Size([1, 1703, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6917328834533691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7418708801269531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1703, 256])
m.shape torch.Size([1315, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.744466781616211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.744466781616211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1315, 256]), torch.Size([1, 1315, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.747091293334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8087706565856934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1315, 256])
m.shape torch.Size([955, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8117356300354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8117356300354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8135571479797363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8664460182189941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([840, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8695721626281738  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8695721626281738  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 840, 256]), torch.Size([1, 840, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8711743354797363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9295716285705566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 840, 256])
m.shape torch.Size([616, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9323229789733887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9323229789733887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9334979057312012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9847521781921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([508, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9875826835632324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9875826835632324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9885516166687012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.037482738494873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([420, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0402278900146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0402278900146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0410289764404297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.087301254272461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([329, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0897469520568848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0897469520568848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.09037446975708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1317524909973145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([272, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1340532302856445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1340532302856445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1345720291137695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1735148429870605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([225, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.176203727722168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.176203727722168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.176632881164551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.21010684967041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2122106552124023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2122106552124023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2125940322875977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.245181083679199  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2470264434814453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2470264434814453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2473373413085938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.27593994140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2775473594665527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2775473594665527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.277797222137451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3025336265563965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3038649559020996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3038649559020996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3040575981140137  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3244776725769043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([103, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.325965404510498  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.325965404510498  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3261618614196777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3483614921569824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.349717617034912  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.349717617034912  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3498873710632324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.37025785446167  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3718514442443848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3718514442443848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3720364570617676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3955330848693848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([82, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3969383239746094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3969383239746094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3970947265625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4180526733398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([76, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.419435501098633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.419435501098633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4195804595947266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4400196075439453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.440952777862549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.440952777862549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4410462379455566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.454878330230713  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4559736251831055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4559736251831055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4560766220092773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.472041130065918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.472785472869873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.472785472869873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4728541374206543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.483977794647217  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.485166072845459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.485166072845459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.485267162322998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5023512840270996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([651, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5179433822631836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5179433822631836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5191850662231445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7377214431762695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 651, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6774940490722656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.679450511932373  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6815056800842285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6794657707214355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11189, 40])
input nodes number: 29438
output nodes number: 11189
edges number: 72716
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6792454719543457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.679245948791504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.047258853912353516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 5 input nodes size: 66812
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.041552066802978516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.041552066802978516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0734105110168457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.07349395751953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04500246047973633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0469660758972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0469660758972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0469660758972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([66812, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0469660758972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2801, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14327478408813477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14327478408813477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2801, 128]), torch.Size([1, 2801, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14657258987426758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16794252395629883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2801, 128])
m.shape torch.Size([3102, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17031192779541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17031192779541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 3102, 128]), torch.Size([1, 3102, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17327022552490234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21886682510375977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 3102, 128])
m.shape torch.Size([2696, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22182512283325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22182512283325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2696, 128]), torch.Size([1, 2696, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22494935989379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28477907180786133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2696, 128])
m.shape torch.Size([2300, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2870640754699707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2870640754699707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2300, 128]), torch.Size([1, 2300, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2892575263977051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3555760383605957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2300, 128])
m.shape torch.Size([2101, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3589773178100586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3589773178100586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2101, 128]), torch.Size([1, 2101, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.36101627349853516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.43843841552734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2101, 128])
m.shape torch.Size([1681, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4422459602355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4422459602355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1681, 128]), torch.Size([1, 1681, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4438490867614746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5136303901672363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1681, 128])
m.shape torch.Size([1527, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5179257392883301  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5179257392883301  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5193819999694824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5921950340270996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([1347, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5966053009033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5966053009033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1347, 128]), torch.Size([1, 1347, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5978899002075195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6715006828308105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1347, 128])
m.shape torch.Size([1121, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6756691932678223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6756691932678223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6767382621765137  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.745734691619873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([11371, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7998876571655273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7998876571655273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 11371, 128]), torch.Size([1, 11371, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8108663558959961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5817394256591797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 11371, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4973411560058594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.525996208190918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5546512603759766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5257720947265625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([30047, 256])
first layer input nodes number: 66812
first layer output nodes number: 30047
edges number: 192148
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5551509857177734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.583806037902832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5909700393676758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5909700393676758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1935, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.661919116973877  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.661919116973877  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1935, 256]), torch.Size([1, 1935, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6665987968444824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.69923734664917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1935, 256])
m.shape torch.Size([1737, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7005720138549805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7005720138549805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1737, 256]), torch.Size([1, 1737, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7050361633300781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7581391334533691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1737, 256])
m.shape torch.Size([1325, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7598257064819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7598257064819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1325, 256]), torch.Size([1, 1325, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7624468803405762  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.821007251739502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1325, 256])
m.shape torch.Size([1043, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.823835849761963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.823835849761963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1043, 256]), torch.Size([1, 1043, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.825899600982666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8872747421264648  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1043, 256])
m.shape torch.Size([863, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.890427589416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.890427589416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 863, 256]), torch.Size([1, 863, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.892073631286621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9513978958129883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 863, 256])
m.shape torch.Size([651, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.954329490661621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.954329490661621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 651, 256]), torch.Size([1, 651, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.955571174621582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.010128974914551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 651, 256])
m.shape torch.Size([470, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0126705169677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0126705169677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0135669708251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0593881607055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([449, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0623927116394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0623927116394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.063249111175537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1133646965026855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([364, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1160855293273926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1160855293273926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1167798042297363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.162418842315674  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1647825241088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1647825241088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.16532039642334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2046289443969727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([232, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.206812858581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.206812858581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2072553634643555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2417707443237305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2439370155334473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2439370155334473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2443318367004395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2778916358947754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.279843330383301  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.279843330383301  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2801713943481445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3103532791137695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([167, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.312436580657959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.312436580657959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3127551078796387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3442893028259277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([130, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3460044860839844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3460044860839844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.34625244140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3725357055664062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3742265701293945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3742265701293945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3744516372680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3998842239379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.401209831237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.401209831237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4013776779174805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4215192794799805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.42288875579834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.42288875579834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.423048973083496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.44339656829834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4447412490844727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4447412490844727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.444890022277832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4648256301879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.46608829498291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.46608829498291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4662065505981445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4828805923461914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.484194278717041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.484194278717041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4843239784240723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5035195350646973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.504195213317871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.504195213317871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5042619705200195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5146093368530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.51552677154541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.51552677154541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.515608787536621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.528895378112793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.529707908630371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.529707908630371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.529778480529785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5417051315307617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([528, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5543570518493652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5543570518493652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5553641319274902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7326102256774902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 528, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.673340320587158  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.675963878631592  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6776280403137207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6749210357666016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11168, 40])
input nodes number: 30047
output nodes number: 11168
edges number: 71208
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6757545471191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.675755023956299  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.051282405853271484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 6 input nodes size: 67513
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.045528411865234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.045528411865234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.07772111892700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.07780647277832031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04586458206176758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04983997344970703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04983997344970703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04983997344970703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([67513, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04983997344970703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1887, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2151346206665039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2151346206665039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1887, 128]), torch.Size([1, 1887, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2169342041015625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23133087158203125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1887, 128])
m.shape torch.Size([1930, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23227167129516602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23227167129516602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1930, 128]), torch.Size([1, 1930, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23411226272583008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.261721134185791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1930, 128])
m.shape torch.Size([1814, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2633986473083496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2633986473083496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1814, 128]), torch.Size([1, 1814, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26512861251831055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30318784713745117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1814, 128])
m.shape torch.Size([1689, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3056149482727051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3056149482727051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1689, 128]), torch.Size([1, 1689, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30722570419311523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35588884353637695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1689, 128])
m.shape torch.Size([1607, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.358914852142334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.358914852142334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1607, 128]), torch.Size([1, 1607, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.36044740676879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4161081314086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1607, 128])
m.shape torch.Size([1472, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.419553279876709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.419553279876709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1472, 128]), torch.Size([1, 1472, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.420957088470459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48214292526245117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1472, 128])
m.shape torch.Size([1471, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48669004440307617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48669004440307617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1471, 128]), torch.Size([1, 1471, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48809289932250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5582356452941895  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1471, 128])
m.shape torch.Size([1371, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5627641677856445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5627641677856445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5640716552734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6386117935180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1349, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6437473297119141  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6437473297119141  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1349, 128]), torch.Size([1, 1349, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6450338363647461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7281632423400879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1349, 128])
m.shape torch.Size([26706, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8548641204833984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8548641204833984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 26706, 128]), torch.Size([1, 26706, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8803329467773438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.688619613647461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 26706, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.534926414489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5743093490600586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.613692283630371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5740013122558594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([41296, 256])
first layer input nodes number: 67513
first layer output nodes number: 41296
edges number: 335278
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.614197254180908  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6535801887512207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.663425922393799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.663425922393799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1240, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7956395149230957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7956395149230957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1240, 256]), torch.Size([1, 1240, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.798462390899658  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8199477195739746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1240, 256])
m.shape torch.Size([1021, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.820509433746338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.820509433746338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1021, 256]), torch.Size([1, 1021, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8224568367004395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.851667881011963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1021, 256])
m.shape torch.Size([842, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8531546592712402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8531546592712402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8547606468200684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8942923545837402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([706, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8964128494262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8964128494262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 706, 256]), torch.Size([1, 706, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.897759437561035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.937854766845703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 706, 256])
m.shape torch.Size([591, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9409537315368652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9409537315368652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 591, 256]), torch.Size([1, 591, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9420809745788574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.984041690826416  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 591, 256])
m.shape torch.Size([456, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.98610782623291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.98610782623291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9869775772094727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0263633728027344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([386, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0285258293151855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0285258293151855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.029262065887451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0689406394958496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([324, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.071063995361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.071063995361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0716819763183594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1100311279296875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([339, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.112654685974121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.112654685974121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1133012771606445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1559600830078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([292, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1586685180664062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1586685180664062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1592254638671875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1993637084960938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.2018556594848633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.2018556594848633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.20235538482666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.242579460144043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([271, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.245455265045166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.245455265045166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.245972156524658  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.2908921241760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([228, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.293482780456543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.293482780456543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.293917655944824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.333926200866699  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([173, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3360366821289062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3360366821289062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.336366653442383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3690338134765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([194, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3716659545898438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3716659545898438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3720359802246094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4112586975097656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([165, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.41361141204834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.41361141204834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.413926124572754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.449488639831543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([149, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.451766014099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.451766014099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.45205020904541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4861536026000977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([160, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4887795448303223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4887795448303223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4890847206115723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5278420448303223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([158, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5305747985839844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5305747985839844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5308761596679688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.571258544921875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([154, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.574068546295166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.574068546295166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.574362277984619  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6157784461975098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([142, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.618497848510742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.618497848510742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6187686920166016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.658853530883789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([98, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.66079044342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.66079044342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.660977363586426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6899499893188477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([108, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.692244052886963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.692244052886963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6924500465393066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.725821018218994  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([109, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7282323837280273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7282323837280273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.728440284729004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.763575553894043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([2855, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8320722579956055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8320722579956055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2855, 256]), torch.Size([1, 2855, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.837517738342285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.805395126342773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2855, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.683019638061523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.684885025024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.687368392944336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.685417652130127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11423, 40])
input nodes number: 41296
output nodes number: 11423
edges number: 135766
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.68519401550293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.685194492340088  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05577659606933594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 7 input nodes size: 81843
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.045247554779052734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.045247554779052734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0842733383178711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08435583114624023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0520777702331543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05577802658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05577802658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05577802658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([81843, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05577802658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2203, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.24158382415771484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.24158382415771484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2203, 128]), torch.Size([1, 2203, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2436847686767578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.261014461517334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2203, 128])
m.shape torch.Size([2458, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26230812072753906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26230812072753906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2458, 128]), torch.Size([1, 2458, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2655811309814453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3023948669433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2458, 128])
m.shape torch.Size([2179, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.303560733795166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.303560733795166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2179, 128]), torch.Size([1, 2179, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.30577802658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.35236263275146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2179, 128])
m.shape torch.Size([2033, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.35520124435424805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.35520124435424805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2033, 128]), torch.Size([1, 2033, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.35714006423950195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.41336584091186523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2033, 128])
m.shape torch.Size([2022, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4172172546386719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4172172546386719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2022, 128]), torch.Size([1, 2022, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4191455841064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.48856544494628906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2022, 128])
m.shape torch.Size([1836, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49285411834716797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49285411834716797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1836, 128]), torch.Size([1, 1836, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.49460506439208984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5702323913574219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1836, 128])
m.shape torch.Size([1809, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5753951072692871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5753951072692871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1809, 128]), torch.Size([1, 1809, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.577120304107666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6644463539123535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1809, 128])
m.shape torch.Size([1711, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6701107025146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6701107025146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1711, 128]), torch.Size([1, 1711, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6717424392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7647695541381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1711, 128])
m.shape torch.Size([1671, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7711248397827148  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7711248397827148  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1671, 128]), torch.Size([1, 1671, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7727184295654297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8760662078857422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1671, 128])
m.shape torch.Size([29220, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.014601230621338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.014601230621338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 29220, 128]), torch.Size([1, 29220, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0424675941467285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.0300583839416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 29220, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.858687400817871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.9036455154418945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.948603630065918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.903294086456299  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([47142, 256])
first layer input nodes number: 81843
first layer output nodes number: 47142
edges number: 376504
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.9492154121398926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 2.994173526763916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.005413055419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.005413055419922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1395, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1225624084472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1225624084472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1395, 256]), torch.Size([1, 1395, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.126255512237549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1513314247131348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1395, 256])
m.shape torch.Size([1221, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1516590118408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1516590118408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1221, 256]), torch.Size([1, 1221, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1540451049804688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1992835998535156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1221, 256])
m.shape torch.Size([861, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1999998092651367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.1999998092651367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.2016420364379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.2377710342407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 861, 256])
m.shape torch.Size([649, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.239830493927002  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.239830493927002  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.2410683631896973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.281798839569092  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([610, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.284111499786377  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.284111499786377  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.2852749824523926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.328904151916504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([467, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.3310155868530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.3310155868530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.331906318664551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.37593936920166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([420, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.37831974029541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.37831974029541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 420, 256]), torch.Size([1, 420, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.3791208267211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.419480323791504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 420, 256])
m.shape torch.Size([314, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.421494483947754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.421494483947754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 314, 256]), torch.Size([1, 314, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.422093391418457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.456597328186035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 314, 256])
m.shape torch.Size([306, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.4589452743530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.4589452743530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.459528923034668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.4981775283813477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([303, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.500798225402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.500798225402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 303, 256]), torch.Size([1, 303, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.501376152038574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.5428571701049805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 303, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.545327663421631  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.545327663421631  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.545825481414795  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.58590030670166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([221, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.588200569152832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.588200569152832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.5886220932006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6244516372680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([189, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6266026496887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6266026496887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6269631385803223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.660128116607666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([174, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.662677764892578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.662677764892578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6630096435546875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.6958656311035156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([170, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.698150634765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.698150634765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.698474884033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7328453063964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([151, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7350053787231445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7350053787231445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.735293388366699  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.767838478088379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([154, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7702107429504395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7702107429504395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.7705044746398926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8057522773742676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([150, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8082008361816406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8082008361816406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8084869384765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8448219299316406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([128, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8470163345336914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8470163345336914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8472604751586914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8799753189086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([112, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8820061683654785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8820061683654785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.8822197914123535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9123406410217285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([114, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9145350456237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9145350456237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.91475248336792  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9469332695007324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([96, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9498252868652344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9498252868652344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9500083923339844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9783897399902344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9801111221313477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9801111221313477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 3.9802675247192383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.0056047439575195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([86, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.007510662078857  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.007510662078857  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.007674694061279  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.035396099090576  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([2401, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.093005657196045  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.093005657196045  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2401, 256]), torch.Size([1, 2401, 256])
----------------------------------------3
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.097585201263428  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.908534526824951  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2401, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.800564765930176  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.802590370178223  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.804234981536865  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.802126884460449  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11035, 40])
input nodes number: 47142
output nodes number: 11035
edges number: 119957
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.80272102355957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9627685546875 GB
    Memory Allocated: 4.8027215003967285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06281805038452148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06281805038452148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06281805038452148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.018769174814224243 |0.002373933792114258 |0.1217888593673706 |9.554624557495117e-05 |0.07767423987388611 |0.0052530765533447266 |
----------------------------------------------------------pseudo_mini_loss sum 4.631577014923096
Total (block generation + training)time/epoch 23.507251977920532
Training time/epoch 1.8349800109863281
Training time without block to device /epoch 1.815988540649414
Training time without total dataloading part /epoch 1.601722240447998
load block tensor time/epoch 0.15015339851379395
block to device time/epoch 0.018991470336914062
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  658479
Number of first layer input nodes during this epoch:  424357
Number of first layer output nodes during this epoch:  234122
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06281757354736328  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01959681510925293
global_2_local spend time (sec) 0.0488581657409668
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00428462028503418
A = g.adjacency_matrix() spent  0.009110450744628906
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08589839935302734
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3277196884155273
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent [05:11:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 8 parts and get 4792307 edge cuts
 1.166365385055542

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.246 seconds
Metis partitioning: 5.261 seconds
Split the graph: 2.105 seconds
Construct subgraphs: 0.059 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.684930801391602
11570
11228
11626
11664
11035
11559
11120
11139
total k batches seeds list generation spend  18.800822019577026
after graph partition
graph partition algorithm spend time 18.896007776260376
11570
11228
11626
11664
11035
11559
11120
11139
partition_len_list
[21058, 19773, 20898, 23016, 46677, 41892, 25764, 33521]
shared_neighbor_graph_partition_s0 selection method  spend 19.00142550468445
time for parepare:  0.017502307891845703
local_output_nid generation:  0.002223968505859375
local_in_edges_tensor generation:  0.002442598342895508
mini_batch_src_global generation:  0.003007650375366211
r_  generation:  0.029703617095947266
local_output_nid generation:  0.0025017261505126953
local_in_edges_tensor generation:  0.0021834373474121094
mini_batch_src_global generation:  0.0036306381225585938
r_  generation:  0.03074789047241211
local_output_nid generation:  0.0026941299438476562
local_in_edges_tensor generation:  0.0020227432250976562
mini_batch_src_global generation:  0.002476215362548828
r_  generation:  0.025772571563720703
local_output_nid generation:  0.002640962600708008
local_in_edges_tensor generation:  0.0021157264709472656
mini_batch_src_global generation:  0.0029141902923583984
r_  generation:  0.030596256256103516
local_output_nid generation:  0.002611398696899414
local_in_edges_tensor generation:  0.002157449722290039
mini_batch_src_global generation:  0.003725290298461914
r_  generation:  0.03742218017578125
local_output_nid generation:  0.0028672218322753906
local_in_edges_tensor generation:  0.004225492477416992
mini_batch_src_global generation:  0.0052204132080078125
r_  generation:  0.04620790481567383
local_output_nid generation:  0.003030538558959961
local_in_edges_tensor generation:  0.002101421356201172
mini_batch_src_global generation:  0.0030345916748046875
r_  generation:  0.02780890464782715
local_output_nid generation:  0.002934694290161133
local_in_edges_tensor generation:  0.0020656585693359375
mini_batch_src_global generation:  0.0025472640991210938
r_  generation:  0.028606891632080078
----------------------check_connections_block total spend ----------------------------- 0.4018247127532959
generate_one_block  0.045330047607421875
generate_one_block  0.04050731658935547
generate_one_block  0.03319072723388672
generate_one_block  0.04040956497192383
generate_one_block  0.05694723129272461
generate_one_block  0.06568789482116699
generate_one_block  0.03429770469665527
generate_one_block  0.03796839714050293
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036412715911865234
gen group dst list time:  0.006499290466308594
time for parepare:  0.019576072692871094
local_output_nid generation:  0.0036706924438476562
local_in_edges_tensor generation:  0.008874177932739258
mini_batch_src_global generation:  0.003968954086303711
r_  generation:  0.043741464614868164
local_output_nid generation:  0.004892110824584961
local_in_edges_tensor generation:  0.004596710205078125
mini_batch_src_global generation:  0.004715442657470703
r_  generation:  0.04348897933959961
local_output_nid generation:  0.005257844924926758
local_in_edges_tensor generation:  0.003734111785888672
mini_batch_src_global generation:  0.0037076473236083984
r_  generation:  0.04263138771057129
local_output_nid generation:  0.005768537521362305
local_in_edges_tensor generation:  0.004669904708862305
mini_batch_src_global generation:  0.005188941955566406
r_  generation:  0.05191493034362793
local_output_nid generation:  0.010738611221313477
local_in_edges_tensor generation:  0.012714147567749023
mini_batch_src_global generation:  0.013598203659057617
r_  generation:  0.12872576713562012
local_output_nid generation:  0.009179830551147461
local_in_edges_tensor generation:  0.008604288101196289
mini_batch_src_global generation:  0.016712665557861328
r_  generation:  0.11916160583496094
local_output_nid generation:  0.006537199020385742
local_in_edges_tensor generation:  0.005156040191650391
mini_batch_src_global generation:  0.010447025299072266
r_  generation:  0.06057095527648926
local_output_nid generation:  0.008362293243408203
local_in_edges_tensor generation:  0.006636142730712891
mini_batch_src_global generation:  0.01904582977294922
r_  generation:  0.08553004264831543
----------------------check_connections_block total spend ----------------------------- 0.9209907054901123
generate_one_block  0.06560373306274414
generate_one_block  0.058690786361694336
generate_one_block  0.053442955017089844
generate_one_block  0.06618928909301758
generate_one_block  0.17659878730773926
generate_one_block  0.16137337684631348
generate_one_block  0.07675337791442871
generate_one_block  0.11084747314453125
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06281757354736328  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

connection checking time:  0.9209907054901123
block generation total time  0.7694997787475586
average batch blocks generation time:  0.09618747234344482
block dataloader generation time/epoch 21.64362645149231
pseudo mini batch 0 input nodes size: 33718
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05223703384399414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05223703384399414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06831502914428711  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06840133666992188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.029293060302734375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0308990478515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0308990478515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0308990478515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([33718, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0308990478515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([2328, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09470653533935547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09470653533935547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2328, 128]), torch.Size([1, 2328, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09692668914794922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11530590057373047  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2328, 128])
m.shape torch.Size([2337, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.116424560546875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.116424560546875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2337, 128]), torch.Size([1, 2337, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11926698684692383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.15329694747924805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2337, 128])
m.shape torch.Size([2086, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.15552568435668945  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.15552568435668945  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2086, 128]), torch.Size([1, 2086, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.15762615203857422  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.20415401458740234  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2086, 128])
m.shape torch.Size([1742, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2071380615234375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2071380615234375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1742, 128]), torch.Size([1, 1742, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2087993621826172  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.25780391693115234  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1742, 128])
m.shape torch.Size([1538, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.26064014434814453  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.26064014434814453  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1538, 128]), torch.Size([1, 1538, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.26210689544677734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3153362274169922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1538, 128])
m.shape torch.Size([1287, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3182849884033203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3182849884033203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1287, 128]), torch.Size([1, 1287, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.31951236724853516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37228965759277344  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1287, 128])
m.shape torch.Size([1055, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3751974105834961  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3751974105834961  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1055, 128]), torch.Size([1, 1055, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3762035369873047  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4265098571777344  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1055, 128])
m.shape torch.Size([953, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4296422004699707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4296422004699707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 953, 128]), torch.Size([1, 953, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.43055105209350586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48271608352661133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 953, 128])
m.shape torch.Size([804, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48571205139160156  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48571205139160156  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 804, 128]), torch.Size([1, 804, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4864788055419922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5360345840454102  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 804, 128])
m.shape torch.Size([6928, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5686864852905273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5686864852905273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 6928, 128]), torch.Size([1, 6928, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5752935409545898  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0443944931030273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 6928, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9900937080383301  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.010176181793213  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0302586555480957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0100188255310059  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([21058, 256])
first layer input nodes number: 33718
first layer output nodes number: 21058
edges number: 127165
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0305118560791016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0505943298339844  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.055614948272705  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.055614948272705  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1731, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1426753997802734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1426753997802734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1731, 256]), torch.Size([1, 1731, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1472225189208984  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.173635482788086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1731, 256])
m.shape torch.Size([1487, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.175020694732666  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.175020694732666  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1487, 256]), torch.Size([1, 1487, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1780343055725098  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.224977970123291  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1487, 256])
m.shape torch.Size([1282, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2281532287597656  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2281532287597656  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1282, 256]), torch.Size([1, 1282, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2306251525878906  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2865691184997559  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1282, 256])
m.shape torch.Size([970, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2888717651367188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2888717651367188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2907218933105469  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3443756103515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([800, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3472952842712402  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3472952842712402  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3488211631774902  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4046988487243652  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([641, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.407632827758789  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.407632827758789  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4088554382324219  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4699535369873047  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([540, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.472975730895996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.472975730895996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4740056991577148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5255041122436523  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([457, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.52850341796875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.52850341796875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5293750762939453  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5796871185302734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([405, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5827546119689941  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5827546119689941  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 405, 256]), torch.Size([1, 405, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5835270881652832  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6341242790222168  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 405, 256])
m.shape torch.Size([364, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6372365951538086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6372365951538086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6379308700561523  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.687514305114746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([300, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6903390884399414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6903390884399414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6909112930297852  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7365403175354004  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([249, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.739126205444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.739126205444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7396011352539062  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7799701690673828  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7823066711425781  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7823066711425781  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7826995849609375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.81884765625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([200, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8213424682617188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8213424682617188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8217239379882812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8594894409179688  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([184, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8619518280029297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8619518280029297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8623027801513672  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8995037078857422  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([140, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9014811515808105  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9014811515808105  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9017481803894043  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.931922435760498  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([154, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.934305191040039  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.934305191040039  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9345989227294922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9698467254638672  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([104, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9714994430541992  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9714994430541992  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9716978073120117  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9968900680541992  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([95, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9985260963439941  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9985260963439941  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9987072944641113  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0229878425598145  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([113, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0250697135925293  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0250697135925293  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.025285243988037  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0556750297546387  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0576062202453613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0576062202453613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0577988624572754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0863099098205566  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.087440013885498  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.087440013885498  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.087550640106201  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1046977043151855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1061458587646484  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1061458587646484  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1062755584716797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.127286911010742  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.129106044769287  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.129106044769287  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.129220485687256  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1485610008239746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([861, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.169192314147949  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.169192314147949  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 861, 256]), torch.Size([1, 861, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.170834541320801  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.460735321044922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 861, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.386174201965332  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3878984451293945  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.389622688293457  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3878121376037598  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11570, 40])
input nodes number: 21058
output nodes number: 11570
edges number: 88245
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.387754440307617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3877553939819336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03371572494506836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

pseudo mini batch 1 input nodes size: 33413
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.028992652893066406  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.028992652893066406  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04541492462158203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04549884796142578  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.029334545135498047  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030974864959716797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030974864959716797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030974864959716797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([33413, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030974864959716797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1706, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09372758865356445  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09372758865356445  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1706, 128]), torch.Size([1, 1706, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09535455703735352  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10837030410766602  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1706, 128])
m.shape torch.Size([1955, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10951375961303711  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10951375961303711  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1955, 128]), torch.Size([1, 1955, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11137819290161133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1398768424987793  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1955, 128])
m.shape torch.Size([1805, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1415266990661621  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1415266990661621  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1805, 128]), torch.Size([1, 1805, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1432480812072754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18187999725341797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1805, 128])
m.shape torch.Size([1651, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18436288833618164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18436288833618164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1651, 128]), torch.Size([1, 1651, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18593740463256836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23179292678833008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1651, 128])
m.shape torch.Size([1367, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2352304458618164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2352304458618164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1367, 128]), torch.Size([1, 1367, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23653411865234375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2853717803955078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1367, 128])
m.shape torch.Size([1251, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2882990837097168  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2882990837097168  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1251, 128]), torch.Size([1, 1251, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.289492130279541  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.34144067764282227  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1251, 128])
m.shape torch.Size([1064, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.34439563751220703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.34439563751220703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1064, 128]), torch.Size([1, 1064, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3454103469848633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3970785140991211  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1064, 128])
m.shape torch.Size([985, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4003286361694336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4003286361694336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 985, 128]), torch.Size([1, 985, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.40126800537109375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45659351348876953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 985, 128])
m.shape torch.Size([835, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45970726013183594  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45970726013183594  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 835, 128]), torch.Size([1, 835, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.46050357818603516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5118246078491211  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 835, 128])
m.shape torch.Size([7154, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.545539379119873  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.545539379119873  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 7154, 128]), torch.Size([1, 7154, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5523619651794434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0367655754089355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 7154, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.982154369354248  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.001685619354248  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.021216869354248  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0015382766723633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([19773, 256])
first layer input nodes number: 33413
first layer output nodes number: 19773
edges number: 126359
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.021468162536621  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.040999412536621  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0457139015197754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0457139015197754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1283, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1374287605285645  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1374287605285645  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1283, 256]), torch.Size([1, 1283, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1403088569641113  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1604571342468262  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1283, 256])
m.shape torch.Size([1287, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1617002487182617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1617002487182617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1287, 256]), torch.Size([1, 1287, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1641788482666016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2069196701049805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1287, 256])
m.shape torch.Size([1120, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2089018821716309  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2089018821716309  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1120, 256]), torch.Size([1, 1120, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2110533714294434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2597837448120117  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1120, 256])
m.shape torch.Size([951, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2618823051452637  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2618823051452637  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2636961936950684  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3170466423034668  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([784, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3199076652526855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3199076652526855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3214030265808105  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3752360343933105  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([696, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.378502368927002  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.378502368927002  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 696, 256]), torch.Size([1, 696, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3798298835754395  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.438805103302002  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 696, 256])
m.shape torch.Size([551, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4418487548828125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4418487548828125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4428997039794922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5007009506225586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([488, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5039277076721191  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5039277076721191  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 488, 256]), torch.Size([1, 488, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5048584938049316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5592637062072754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 488, 256])
m.shape torch.Size([446, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.563467025756836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.563467025756836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5643177032470703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6203937530517578  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([376, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.623582363128662  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.623582363128662  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6242995262145996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6767988204956055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([363, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6802783012390137  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6802783012390137  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6809706687927246  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7353177070617676  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([293, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7383508682250977  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7383508682250977  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7389097213745117  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.787510871887207  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([259, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7904677391052246  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7904677391052246  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.790961742401123  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8382134437561035  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([218, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.84089994430542  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.84089994430542  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.841315746307373  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8824801445007324  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([171, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8847379684448242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8847379684448242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8850641250610352  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9196367263793945  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([167, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.922041893005371  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.922041893005371  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9223604202270508  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9583539962768555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9608254432678223  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9608254432678223  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.961132526397705  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9979825019836426  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([146, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0003552436828613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0003552436828613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.000633716583252  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0359997749328613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([117, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.037997245788574  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.037997245788574  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0382204055786133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0681238174438477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([124, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0703959465026855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0703959465026855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0706324577331543  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.103980541229248  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.106062412261963  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.106062412261963  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1062703132629395  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1370396614074707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.138669967651367  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.138669967651367  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.138826370239258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1630687713623047  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([75, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1646485328674316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1646485328674316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1647915840148926  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1879658699035645  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1895551681518555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1895551681518555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.189692497253418  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2129011154174805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([889, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.234193801879883  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.234193801879883  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 889, 256]), torch.Size([1, 889, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.235889434814453  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5350494384765625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 889, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4553661346435547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4579410552978516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4605159759521484  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.457857131958008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11228, 40])
input nodes number: 19773
output nodes number: 11228
edges number: 93656
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4589390754699707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.458939552307129  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.034981727600097656  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

pseudo mini batch 2 input nodes size: 36292
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030185222625732422  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030185222625732422  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04776334762573242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04785013198852539  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.031343936920166016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03271818161010742  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03271818161010742  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03271818161010742  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([36292, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03271818161010742  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([2863, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09040307998657227  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09040307998657227  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2863, 128]), torch.Size([1, 2863, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.09313344955444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11657094955444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2863, 128])
m.shape torch.Size([2835, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1179361343383789  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1179361343383789  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2835, 128]), torch.Size([1, 2835, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.12063980102539062  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16160202026367188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2835, 128])
m.shape torch.Size([2366, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1643056869506836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1643056869506836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2366, 128]), torch.Size([1, 2366, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16716289520263672  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.21720409393310547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2366, 128])
m.shape torch.Size([1928, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.22058868408203125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.22058868408203125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1928, 128]), torch.Size([1, 1928, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2224273681640625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.27574920654296875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1928, 128])
m.shape torch.Size([1591, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.278623104095459  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.278623104095459  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1591, 128]), torch.Size([1, 1591, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.28014039993286133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3355379104614258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1591, 128])
m.shape torch.Size([1308, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.33852148056030273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.33852148056030273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1308, 128]), torch.Size([1, 1308, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3397688865661621  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.39398717880249023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1308, 128])
m.shape torch.Size([1087, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3969917297363281  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3969917297363281  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1087, 128]), torch.Size([1, 1087, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3980283737182617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45060253143310547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1087, 128])
m.shape torch.Size([923, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45360517501831055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45360517501831055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 923, 128]), torch.Size([1, 923, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4544854164123535  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5056204795837402  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 923, 128])
m.shape torch.Size([744, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5083732604980469  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5083732604980469  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 744, 128]), torch.Size([1, 744, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5090827941894531  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5558795928955078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 744, 128])
m.shape torch.Size([5253, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5805730819702148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5805730819702148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 5253, 128]), torch.Size([1, 5253, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5855827331542969  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9412679672241211  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 5253, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8936433792114258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9135732650756836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9335031509399414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9134173393249512  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([20898, 256])
first layer input nodes number: 36292
first layer output nodes number: 20898
edges number: 113365
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9337759017944336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9537057876586914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9586882591247559  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.9586882591247559  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([2071, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.029388427734375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.029388427734375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2071, 256]), torch.Size([1, 2071, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0333833694458008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0659713745117188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2071, 256])
m.shape torch.Size([1793, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.067028522491455  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.067028522491455  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1793, 256]), torch.Size([1, 1793, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.071415901184082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1284875869750977  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1793, 256])
m.shape torch.Size([1388, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1303763389587402  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1303763389587402  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1388, 256]), torch.Size([1, 1388, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1330571174621582  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.192230224609375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1388, 256])
m.shape torch.Size([1077, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1951560974121094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1951560974121094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1077, 256]), torch.Size([1, 1077, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1974306106567383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2596855163574219  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1077, 256])
m.shape torch.Size([898, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.263068675994873  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.263068675994873  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2647814750671387  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3270487785339355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([721, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.330350399017334  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.330350399017334  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 721, 256]), torch.Size([1, 721, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3317255973815918  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3911375999450684  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 721, 256])
m.shape torch.Size([567, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3942651748657227  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3942651748657227  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 567, 256]), torch.Size([1, 567, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3953466415405273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4510164260864258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 567, 256])
m.shape torch.Size([483, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4541897773742676  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4541897773742676  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.455111026763916  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5077738761901855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([350, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5103411674499512  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5103411674499512  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5110087394714355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5555644035339355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([316, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5582680702209473  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5582680702209473  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.558870792388916  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6019768714904785  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([240, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6042132377624512  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6042132377624512  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6046710014343262  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6403765678405762  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([218, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6426620483398438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6426620483398438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6430778503417969  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6784210205078125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([173, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.680375099182129  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.680375099182129  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6807050704956055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7110624313354492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([155, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7129831314086914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7129831314086914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7132787704467773  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7425470352172852  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([150, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7445621490478516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7445621490478516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7448482513427734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7751750946044922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([114, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7769122123718262  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7769122123718262  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7771296501159668  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8017001152038574  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8032255172729492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8032255172729492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8034162521362305  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8263044357299805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8278875350952148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8278875350952148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8280725479125977  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8515691757202148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.852682113647461  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.852682113647461  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8528079986572266  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8696765899658203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8706650733947754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8706650733947754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8707680702209473  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8852906227111816  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8863539695739746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8863539695739746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8864569664001465  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.901700496673584  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9026217460632324  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9026217460632324  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9027094841003418  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.916308879852295  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9173798561096191  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9173798561096191  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9174752235412598  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.932924747467041  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9338459968566895  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9338459968566895  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9339261054992676  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9474644660949707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([403, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9571080207824707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9571080207824707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9578766822814941  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.093381404876709  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 403, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.034654140472412  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.036708354949951  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0393805503845215  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0372395515441895  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11626, 40])
input nodes number: 20898
output nodes number: 11626
edges number: 70996
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.036961555480957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0369620323181152  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03497028350830078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

pseudo mini batch 3 input nodes size: 42397
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.030823230743408203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.051039695739746094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.051126956939697266  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0334620475769043  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.035212039947509766  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.035212039947509766  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.035212039947509766  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([42397, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.035212039947509766  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([2209, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10715246200561523  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10715246200561523  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2209, 128]), torch.Size([1, 2209, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.10925912857055664  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.12673616409301758  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2209, 128])
m.shape torch.Size([2323, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1278982162475586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1278982162475586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2323, 128]), torch.Size([1, 2323, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1301136016845703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16480207443237305  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2323, 128])
m.shape torch.Size([2131, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16701745986938477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16701745986938477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2131, 128]), torch.Size([1, 2131, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16904973983764648  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.21580028533935547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2131, 128])
m.shape torch.Size([1889, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.21884870529174805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.21884870529174805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1889, 128]), torch.Size([1, 1889, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.22065019607543945  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.27289342880249023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1889, 128])
m.shape torch.Size([1700, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2760457992553711  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2760457992553711  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2776670455932617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3381376266479492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([1367, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.34127140045166016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.34127140045166016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1367, 128]), torch.Size([1, 1367, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3425750732421875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4010186195373535  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1367, 128])
m.shape torch.Size([1219, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4044356346130371  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4044356346130371  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1219, 128]), torch.Size([1, 1219, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.40559816360473633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.46503257751464844  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1219, 128])
m.shape torch.Size([1143, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4688115119934082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4688115119934082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1143, 128]), torch.Size([1, 1143, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.46990156173706055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5327630043029785  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1143, 128])
m.shape torch.Size([947, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5367155075073242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5367155075073242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 947, 128]), torch.Size([1, 947, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5376186370849609  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5962934494018555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 947, 128])
m.shape torch.Size([8088, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6344084739685059  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6344084739685059  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 8088, 128]), torch.Size([1, 8088, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6421217918395996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1959166526794434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 8088, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1331586837768555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1551084518432617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.177058219909668  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1549367904663086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([23016, 256])
first layer input nodes number: 42397
first layer output nodes number: 23016
edges number: 144586
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1773762702941895  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.1993260383605957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2048134803771973  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2048134803771973  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1573, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2938404083251953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2938404083251953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1573, 256]), torch.Size([1, 1573, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2973928451538086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.321763038635254  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1573, 256])
m.shape torch.Size([1457, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3232851028442383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3232851028442383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1457, 256]), torch.Size([1, 1457, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3261432647705078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.368865966796875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1457, 256])
m.shape torch.Size([1212, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3716082572937012  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3716082572937012  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3741450309753418  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.426680088043213  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([998, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4296588897705078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4296588897705078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 998, 256]), torch.Size([1, 998, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4315624237060547  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4889392852783203  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 998, 256])
m.shape torch.Size([847, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.492058277130127  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.492058277130127  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 847, 256]), torch.Size([1, 847, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4936738014221191  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5522332191467285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 847, 256])
m.shape torch.Size([641, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5551223754882812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5551223754882812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 641, 256]), torch.Size([1, 641, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.556344985961914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6095342636108398  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 641, 256])
m.shape torch.Size([605, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6129937171936035  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6129937171936035  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.614147663116455  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6720585823059082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([542, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6756491661071777  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6756491661071777  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.676682949066162  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.737454891204834  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([437, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7407183647155762  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7407183647155762  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7415518760681152  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7948966026306152  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([384, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.798170566558838  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.798170566558838  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.798902988433838  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8516030311584473  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([317, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.854588508605957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.854588508605957  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8551931381225586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9041252136230469  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([280, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9070525169372559  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9070525169372559  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9075865745544434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9536657333374023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([256, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9565973281860352  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9565973281860352  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9570856094360352  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.002007484436035  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([207, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.004549026489258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.004549026489258  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.00494384765625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0440311431884766  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([203, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0467605590820312  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0467605590820312  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.047147750854492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0881900787353516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.090456962585449  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.090456962585449  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.090756416320801  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1245946884155273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([133, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1266183853149414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1266183853149414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1268720626831055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.157313346862793  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1590380668640137  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1590380668640137  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1592421531677246  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1851611137390137  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1870131492614746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1870131492614746  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1872172355651855  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.214564800262451  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([103, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2164430618286133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2164430618286133  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.216639518737793  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.244339942932129  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([77, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2457962036132812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2457962036132812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.245943069458008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.267679214477539  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2692975997924805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2692975997924805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2694501876831055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2931013107299805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2942862510681152  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2942862510681152  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2943930625915527  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3116965293884277  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3129348754882812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3129348754882812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3130416870117188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3310928344726562  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([829, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.350958824157715  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.350958824157715  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3525400161743164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.636227607727051  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 829, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5596837997436523  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.561476707458496  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5632147789001465  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5613346099853516  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11664, 40])
input nodes number: 23016
output nodes number: 11664
edges number: 90184
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5613322257995605  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5613327026367188  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.038335323333740234  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

pseudo mini batch 4 input nodes size: 82287
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.033200740814208984  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.033200740814208984  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.07243824005126953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.07252073287963867  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05221700668334961  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0557866096496582  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0557866096496582  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0557866096496582  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([82287, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0557866096496582  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([2419, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23666858673095703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23666858673095703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2419, 128]), torch.Size([1, 2419, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23897552490234375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2583045959472656  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2419, 128])
m.shape torch.Size([2539, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.25957250595092773  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.25957250595092773  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2539, 128]), torch.Size([1, 2539, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2619938850402832  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2992520332336426  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2539, 128])
m.shape torch.Size([2372, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3014345169067383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3014345169067383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2372, 128]), torch.Size([1, 2372, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30377626419067383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3551063537597656  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2372, 128])
m.shape torch.Size([2113, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.35849952697753906  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.35849952697753906  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2113, 128]), torch.Size([1, 2113, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3607177734375  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4220438003540039  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2113, 128])
m.shape torch.Size([2035, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4260740280151367  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4260740280151367  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.42801475524902344  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4978809356689453  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
m.shape torch.Size([1857, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5028195381164551  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5028195381164551  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1857, 128]), torch.Size([1, 1857, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5045905113220215  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5809454917907715  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1857, 128])
m.shape torch.Size([1757, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5859246253967285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5859246253967285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1757, 128]), torch.Size([1, 1757, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5876002311706543  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6722617149353027  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1757, 128])
m.shape torch.Size([1697, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6778974533081055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6778974533081055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1697, 128]), torch.Size([1, 1697, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6795158386230469  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7720956802368164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1697, 128])
m.shape torch.Size([1626, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7782645225524902  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7782645225524902  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7798151969909668  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8822388648986816  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([28262, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0162291526794434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0162291526794434  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 28262, 128]), torch.Size([1, 28262, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.0431818962097168  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.970902919769287  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 28262, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.80287504196167  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8473896980285645  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.891904354095459  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.847041606903076  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([46677, 256])
first layer input nodes number: 82287
first layer output nodes number: 46677
edges number: 367511
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.892519474029541  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9370341300964355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9481630325317383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9481630325317383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1523, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.057346820831299  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.057346820831299  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1523, 256]), torch.Size([1, 1523, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0612173080444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0863418579101562  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1523, 256])
m.shape torch.Size([1258, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.087643623352051  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.087643623352051  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1258, 256]), torch.Size([1, 1258, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0901365280151367  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1264657974243164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1258, 256])
m.shape torch.Size([975, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1282777786254883  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1282777786254883  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1301374435424805  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1720190048217773  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([739, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1741576194763184  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1741576194763184  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.175567150115967  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.218754291534424  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([666, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.221250534057617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.221250534057617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2225208282470703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2708230018615723  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([498, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.273059844970703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.273059844970703  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2740097045898438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.319640636444092  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([413, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3219447135925293  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3219447135925293  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.322732448577881  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.363065719604492  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([332, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.365224838256836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.365224838256836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3658580780029297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.403532028198242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([301, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4058194160461426  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4058194160461426  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.406393527984619  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.44325590133667  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4456796646118164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4456796646118164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4462175369262695  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4850454330444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([228, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.487187385559082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.487187385559082  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4876222610473633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.521542549133301  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5237936973571777  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5237936973571777  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5242018699645996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.558896541595459  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([181, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5609540939331055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5609540939331055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5612993240356445  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5930604934692383  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5950546264648438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5950546264648438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5953617095947266  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.625762939453125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([164, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.627974033355713  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.627974033355713  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.628286838531494  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6614441871643066  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([150, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6635947227478027  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6635947227478027  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6638808250427246  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6962103843688965  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([128, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6981587409973145  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6981587409973145  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6984028816223145  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7276997566223145  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([129, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7298097610473633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7298097610473633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.730055809020996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7613039016723633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([129, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7635369300842285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7635369300842285  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7637829780578613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.796753406524658  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([104, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7986297607421875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7986297607421875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.798828125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.8267974853515625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([110, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.828918933868408  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.828918933868408  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.8291287422180176  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.860180377960205  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([98, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.862147808074951  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.862147808074951  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.862334728240967  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.8913073539733887  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.892960548400879  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.892960548400879  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.893111228942871  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9175214767456055  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([81, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9193148612976074  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9193148612976074  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9194693565368652  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9455790519714355  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([2092, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9957690238952637  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9957690238952637  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 2092, 256]), torch.Size([1, 2092, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9997591972351074  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.702220439910889  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 2092, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.604217529296875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.606212615966797  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.6078572273254395  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.605779647827148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([11035, 40])
input nodes number: 46677
output nodes number: 11035
edges number: 111413
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.606412410736084  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.606412887573242  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.06217050552368164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

pseudo mini batch 5 input nodes size: 67854
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.052419185638427734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.052419185638427734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.08558034896850586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.08566665649414062  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04634666442871094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04995250701904297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04995250701904297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04995250701904297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([67854, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04995250701904297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1805, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2183551788330078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2183551788330078  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1805, 128]), torch.Size([1, 1805, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2200765609741211  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23384761810302734  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1805, 128])
m.shape torch.Size([1909, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23480749130249023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23480749130249023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23662805557250977  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.26393651962280273  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1741, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2657747268676758  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2657747268676758  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1741, 128]), torch.Size([1, 1741, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.26743507385253906  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30474090576171875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1741, 128])
m.shape torch.Size([1660, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30707693099975586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30707693099975586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1660, 128]), torch.Size([1, 1660, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30866003036499023  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3545699119567871  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1660, 128])
m.shape torch.Size([1585, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3575572967529297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3575572967529297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3590688705444336  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4142117500305176  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1542, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.41786766052246094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.41786766052246094  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1542, 128]), torch.Size([1, 1542, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4193382263183594  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48300933837890625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1542, 128])
m.shape torch.Size([1460, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48714733123779297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.48714733123779297  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1460, 128]), torch.Size([1, 1460, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4885396957397461  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5586023330688477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1460, 128])
m.shape torch.Size([1364, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5631093978881836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5631093978881836  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1364, 128]), torch.Size([1, 1364, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5644102096557617  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6385564804077148  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1364, 128])
m.shape torch.Size([1339, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6436524391174316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6436524391174316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1339, 128]), torch.Size([1, 1339, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6449294090270996  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7274799346923828  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1339, 128])
m.shape torch.Size([27487, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8579096794128418  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8579096794128418  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 27487, 128]), torch.Size([1, 27487, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8841233253479004  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7452921867370605  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 27487, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.587954044342041  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6279053688049316  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6678566932678223  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6275930404663086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

torch.Size([41892, 256])
first layer input nodes number: 67854
first layer output nodes number: 41892
edges number: 342716
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6683645248413086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.708315849304199  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.718303680419922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.718303680419922  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

m.shape torch.Size([1229, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.85577392578125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.85577392578125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.858407974243164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.878763198852539  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
m.shape torch.Size([1033, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.879263401031494  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.879263401031494  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.881277561187744  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.914890766143799  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([812, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9157886505126953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9157886505126953  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.917337417602539  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9516396522521973  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([639, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9534173011779785  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9534173011779785  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 639, 256]), torch.Size([1, 639, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.9546360969543457  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.991061210632324  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 639, 256])
m.shape torch.Size([560, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.993143081665039  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.993143081665039  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.994211196899414  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0345230102539062  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([459, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0366363525390625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0366363525390625  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0375118255615234  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0786118507385254  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([391, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0808048248291016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0808048248291016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0815505981445312  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1217217445373535  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([331, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.123894214630127  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.123894214630127  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 331, 256]), torch.Size([1, 331, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.124525547027588  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1616969108581543  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 331, 256])
m.shape torch.Size([323, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.164175510406494  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.164175510406494  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1647915840148926  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.205357551574707  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([302, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2079524993896484  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2079524993896484  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.208528518676758  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2495007514953613  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([268, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.252046585083008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.252046585083008  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 268, 256]), torch.Size([1, 268, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2525577545166016  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.293893814086914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 268, 256])
m.shape torch.Size([269, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.296741008758545  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.296741008758545  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.2972540855407715  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.340991497039795  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([229, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.343870162963867  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.343870162963867  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3443069458007812  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.384490966796875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([199, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3869504928588867  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3869504928588867  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.3873300552368164  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4249067306518555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([179, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.427297592163086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.427297592163086  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4276390075683594  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4638290405273438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([185, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.466503620147705  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.466503620147705  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.4668564796447754  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5067296028137207  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.509183883666992  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.509183883666992  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.509490966796875  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5463409423828125  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([172, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.549163341522217  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.549163341522217  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5494914054870605  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.591155529022217  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([156, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5938405990600586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5938405990600586  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.5941381454467773  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.63400936126709  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([160, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6369857788085938  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6369857788085938  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6372909545898438  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6803207397460938  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([148, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6831555366516113  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6831555366516113  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.6834378242492676  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7252163887023926  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([95, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.727084159851074  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.727084159851074  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7272653579711914  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7553510665893555  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([113, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.757758617401123  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.757758617401123  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.757974147796631  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7928900718688965  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([109, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7952966690063477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.7952966690063477  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.795504570007324  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.8306398391723633  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([3037, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9035096168518066  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.9035096168518066  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

 h.shape torch.Size([1, 3037, 256]), torch.Size([1, 3037, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.909302234649658  GigaBytes
Max Memory Allocated: 4.965778827667236  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.934921741485596  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 3037, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.807451248168945  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.809604644775391  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.811758041381836  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.809518337249756  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([11559, 40])
input nodes number: 41892
output nodes number: 11559
edges number: 141072
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.810075283050537  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 4.810075759887695  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05634164810180664  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

pseudo mini batch 6 input nodes size: 51064
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.046504974365234375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.046504974365234375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.07085418701171875  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0709371566772461  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.0376896858215332  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.039415836334228516  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.039415836334228516  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.039415836334228516  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([51064, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.039415836334228516  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

m.shape torch.Size([2859, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11931085586547852  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.11931085586547852  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2859, 128]), torch.Size([1, 2859, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.12203741073608398  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1454606056213379  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2859, 128])
m.shape torch.Size([2782, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.14675045013427734  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.14675045013427734  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2782, 128]), torch.Size([1, 2782, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.14956140518188477  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1901707649230957  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2782, 128])
m.shape torch.Size([2347, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1928238868713379  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1928238868713379  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2347, 128]), torch.Size([1, 2347, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.19588327407836914  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24585199356079102  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2347, 128])
m.shape torch.Size([1980, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24920940399169922  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24920940399169922  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1980, 128]), torch.Size([1, 1980, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2510976791381836  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.30585765838623047  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1980, 128])
m.shape torch.Size([1735, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3090500831604004  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3090500831604004  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1735, 128]), torch.Size([1, 1735, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.31070470809936523  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37157583236694336  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1735, 128])
m.shape torch.Size([1434, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3748512268066406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3748512268066406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1434, 128]), torch.Size([1, 1434, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3762187957763672  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.43599557876586914  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1434, 128])
m.shape torch.Size([1195, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.439300537109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.439300537109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.44044017791748047  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.49903011322021484  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([1125, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5027518272399902  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5027518272399902  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1125, 128]), torch.Size([1, 1125, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5038247108459473  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.566077709197998  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1125, 128])
m.shape torch.Size([939, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5695710182189941  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5695710182189941  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 939, 128]), torch.Size([1, 939, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5704665184020996  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6278877258300781  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 939, 128])
m.shape torch.Size([9368, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6721100807189941  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6721100807189941  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 9368, 128]), torch.Size([1, 9368, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6810441017150879  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3153595924377441  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 9368, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2463207244873047  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2708911895751953  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.295461654663086  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2706990242004395  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([25764, 256])
first layer input nodes number: 51064
first layer output nodes number: 25764
edges number: 160159
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.2958440780639648  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3204145431518555  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3270940780639648  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3270940780639648  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

m.shape torch.Size([2076, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3986430168151855  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.3986430168151855  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2076, 256]), torch.Size([1, 2076, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4039702415466309  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.437382698059082  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2076, 256])
m.shape torch.Size([1696, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4393877983093262  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4393877983093262  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1696, 256]), torch.Size([1, 1696, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4426302909851074  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4916720390319824  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1696, 256])
m.shape torch.Size([1240, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4935846328735352  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4935846328735352  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1240, 256]), torch.Size([1, 1240, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.4962177276611328  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5519800186157227  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1240, 256])
m.shape torch.Size([971, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5540499687194824  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5540499687194824  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 971, 256]), torch.Size([1, 971, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.5559020042419434  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6096110343933105  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 971, 256])
m.shape torch.Size([850, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6127700805664062  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6127700805664062  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 850, 256]), torch.Size([1, 850, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6143913269042969  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6729087829589844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 850, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6758065223693848  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6758065223693848  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.6770329475402832  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7299790382385254  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([505, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7327637672424316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7327637672424316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.733726978302002  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7832789421081543  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 505, 256])
m.shape torch.Size([444, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7862114906311035  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7862114906311035  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7870583534240723  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8363289833068848  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([355, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8389763832092285  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8389763832092285  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.839653491973877  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8907132148742676  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8930854797363281  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8930854797363281  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8936233520507812  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9327726364135742  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([243, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9359188079833984  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9359188079833984  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9363822937011719  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9725341796875  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([199, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9745979309082031  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9745979309082031  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9749774932861328  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0072402954101562  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([174, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0092248916625977  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0092248916625977  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.009556770324707  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0400896072387695  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([141, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.041821002960205  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.041821002960205  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0420899391174316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0687146186828613  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([110, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0701661109924316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0701661109924316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.070375919342041  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0926156044006348  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([102, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0940794944763184  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0940794944763184  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0942740440368652  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.116258144378662  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.117713451385498  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.117713451385498  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1178946495056152  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1396384239196777  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1411051750183105  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1411051750183105  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1412768363952637  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1630778312683105  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([82, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.16448974609375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.16448974609375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1646461486816406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1856040954589844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([70, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1868715286254883  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1868715286254883  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.187005043029785  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2058305740356445  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.206782817840576  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.206782817840576  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.206878185272217  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2209925651550293  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2219176292419434  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2219176292419434  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2220053672790527  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.235604763031006  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2363128662109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2363128662109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.236377716064453  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2468833923339844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2480506896972656  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2480506896972656  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.248149871826172  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.264911651611328  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([570, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2785582542419434  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2785582542419434  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2796454429626465  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.472170352935791  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 570, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4133920669555664  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.415055274963379  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4170351028442383  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4152889251708984  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([11120, 40])
input nodes number: 25764
output nodes number: 11120
edges number: 71396
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.415073871612549  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.415074348449707  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.042265892028808594  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

pseudo mini batch 7 input nodes size: 72464
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03719949722290039  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.03719949722290039  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.07235574722290039  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.07243919372558594  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.04800701141357422  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05029010772705078  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05029010772705078  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05029010772705078  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([72464, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.05029010772705078  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

m.shape torch.Size([2790, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16381072998046875  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.16381072998046875  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2790, 128]), torch.Size([1, 2790, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.1664714813232422  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18844318389892578  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2790, 128])
m.shape torch.Size([3008, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18998146057128906  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.18998146057128906  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 3008, 128]), torch.Size([1, 3008, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.19285011291503906  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.23816871643066406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 3008, 128])
m.shape torch.Size([2644, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24103736877441406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24103736877441406  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2644, 128]), torch.Size([1, 2644, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.24449539184570312  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.2999687194824219  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2644, 128])
m.shape torch.Size([2262, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3030223846435547  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3030223846435547  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2262, 128]), torch.Size([1, 2262, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.3053274154663086  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37186527252197266  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2262, 128])
m.shape torch.Size([2003, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37617969512939453  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37617969512939453  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.37808990478515625  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.4468574523925781  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1659, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45064878463745117  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45064878463745117  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1659, 128]), torch.Size([1, 1659, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.45223093032836914  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5202631950378418  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1659, 128])
m.shape torch.Size([1476, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5243988037109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5243988037109375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1476, 128]), torch.Size([1, 1476, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5258064270019531  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.5978565216064453  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1476, 128])
m.shape torch.Size([1304, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6021270751953125  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6021270751953125  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1304, 128]), torch.Size([1, 1304, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6033706665039062  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6746702194213867  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1304, 128])
m.shape torch.Size([1203, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6792111396789551  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6792111396789551  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.6803584098815918  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.7538070678710938  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([15172, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8255791664123535  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8255791664123535  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 15172, 128]), torch.Size([1, 15172, 128])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.8400483131408691  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8673577308654785  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 15172, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7662487030029297  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7982168197631836  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8301849365234375  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.7979669570922852  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([33521, 256])
first layer input nodes number: 72464
first layer output nodes number: 33521
edges number: 229066
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8307271003723145  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.8626952171325684  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.870687484741211  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.870687484741211  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

m.shape torch.Size([1942, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9475407600402832  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9475407600402832  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1942, 256]), torch.Size([1, 1942, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9518723487854004  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9830403327941895  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1942, 256])
m.shape torch.Size([1695, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9844021797180176  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9844021797180176  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1695, 256]), torch.Size([1, 1695, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 1.9879155158996582  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0395264625549316  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1695, 256])
m.shape torch.Size([1248, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0414528846740723  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0414528846740723  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 1248, 256]), torch.Size([1, 1248, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0439658164978027  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.0998215675354004  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 1248, 256])
m.shape torch.Size([975, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.10306453704834  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.10306453704834  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 975, 256]), torch.Size([1, 975, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.104924201965332  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1588544845581055  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 975, 256])
m.shape torch.Size([817, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.161850929260254  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.161850929260254  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.1634092330932617  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.220747947692871  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([569, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.223250389099121  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.223250389099121  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2243356704711914  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2796034812927246  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([473, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.282243251800537  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.282243251800537  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.2831454277038574  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.328254222869873  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([395, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.330840587615967  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.330840587615967  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3315939903259277  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.3747973442077637  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([359, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.37752628326416  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.37752628326416  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.37821102142334  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4231529235839844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([293, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.425626754760742  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.425626754760742  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4261856079101562  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.467845916748047  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([244, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4701461791992188  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.4701461791992188  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.470611572265625  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5069122314453125  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([215, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.509159564971924  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.509159564971924  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5095696449279785  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.544426441192627  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([178, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.546445846557617  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.546445846557617  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.546785354614258  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5780200958251953  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([153, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.579909324645996  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.579909324645996  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.5802011489868164  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6090917587280273  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([128, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6107912063598633  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6107912063598633  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6110353469848633  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6369142532348633  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([96, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.63826847076416  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.63826847076416  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.63845157623291  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.65914249420166  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([98, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6606526374816895  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6606526374816895  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.660839557647705  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.68326997756958  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6849584579467773  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.6849584579467773  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.685154914855957  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7101049423217773  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([84, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.711540699005127  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.711540699005127  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.711700916290283  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7331700325012207  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7351884841918945  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7351884841918945  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7353391647338867  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.756585121154785  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.757882595062256  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.757882595062256  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.758012294769287  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.777207851409912  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([51, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7782273292541504  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7782273292541504  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.778324604034424  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7934021949768066  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes
Using backend: pytorch

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7943263053894043  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.7943263053894043  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.794410228729248  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8080058097839355  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8091864585876465  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8091864585876465  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8092875480651855  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.826371669769287  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([779, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8459978103637695  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8459978103637695  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

 h.shape torch.Size([1, 779, 256]), torch.Size([1, 779, 256])
----------------------------------------3
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 2.8474836349487305  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.1089887619018555  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

rst.shape  torch.Size([1, 779, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0444765090942383  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.046177864074707  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.047879219055176  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0460944175720215  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

torch.Size([11139, 40])
input nodes number: 33521
output nodes number: 11139
edges number: 77288
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.0464658737182617  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 3.04646635055542  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.054602622985839844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.054602622985839844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0780029296875 GB
    Memory Allocated: 0.054602622985839844  GigaBytes
Max Memory Allocated: 5.00732946395874  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0203019380569458 |0.0027736127376556396 |0.12093380093574524 |9.551644325256348e-05 |0.077246755361557 |0.004669904708862305 |
----------------------------------------------------------pseudo_mini_loss sum 3.647876501083374
Total (block generation + training)time/epoch 23.47434115409851
Training time/epoch 1.8258395195007324
Training time without block to device /epoch 1.8036506175994873
Training time without total dataloading part /epoch 1.5908784866333008
load block tensor time/epoch 0.1624155044555664
block to device time/epoch 0.022188901901245117
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  652088
Number of first layer input nodes during this epoch:  419489
Number of first layer output nodes during this epoch:  232599
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
