main start at this time 1651555019.2983956
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0265810489654541
number of batches is  8
batch size is  11368
range selection method spend 0.01412200927734375
time for parepare:  0.01755809783935547
local_output_nid generation:  0.0026900768280029297
local_in_edges_tensor generation:  0.003905773162841797
mini_batch_src_global generation:  0.002863645553588867
r_  generation:  0.03464865684509277
local_output_nid generation:  0.002941608428955078
local_in_edges_tensor generation:  0.0015568733215332031
mini_batch_src_global generation:  0.003571748733520508
r_  generation:  0.03621482849121094
local_output_nid generation:  0.003039121627807617
local_in_edges_tensor generation:  0.0015571117401123047
mini_batch_src_global generation:  0.0024106502532958984
r_  generation:  0.03564906120300293
local_output_nid generation:  0.003103971481323242
local_in_edges_tensor generation:  0.001560211181640625
mini_batch_src_global generation:  0.0024869441986083984
r_  generation:  0.03653240203857422
local_output_nid generation:  0.0030565261840820312
local_in_edges_tensor generation:  0.0015482902526855469
mini_batch_src_global generation:  0.002549409866333008
r_  generation:  0.03690814971923828
local_output_nid generation:  0.0030765533447265625
local_in_edges_tensor generation:  0.0015485286712646484
mini_batch_src_global generation:  0.0027115345001220703
r_  generation:  0.03764820098876953
local_output_nid generation:  0.0030748844146728516
local_in_edges_tensor generation:  0.0015788078308105469
mini_batch_src_global generation:  0.005653858184814453
r_  generation:  0.03745603561401367
local_output_nid generation:  0.0030393600463867188
local_in_edges_tensor generation:  0.001547098159790039
mini_batch_src_global generation:  0.0027387142181396484
r_  generation:  0.03712272644042969
----------------------check_connections_block total spend ----------------------------- 0.4347693920135498
generate_one_block  0.048279523849487305
generate_one_block  0.05018353462219238
generate_one_block  0.05268096923828125
generate_one_block  0.0533449649810791
generate_one_block  0.04939675331115723
generate_one_block  0.05012226104736328
generate_one_block  0.04969930648803711
generate_one_block  0.050314903259277344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024134159088134766
gen group dst list time:  0.014368057250976562
time for parepare:  0.018457651138305664
local_output_nid generation:  0.009543180465698242
local_in_edges_tensor generation:  0.015689373016357422
mini_batch_src_global generation:  0.015100479125976562
r_  generation:  0.16469240188598633
local_output_nid generation:  0.014119386672973633
local_in_edges_tensor generation:  0.017042875289916992
mini_batch_src_global generation:  0.019069194793701172
r_  generation:  0.17169451713562012
local_output_nid generation:  0.014480113983154297
local_in_edges_tensor generation:  0.013309955596923828
mini_batch_src_global generation:  0.01738882064819336
r_  generation:  0.17539691925048828
local_output_nid generation:  0.01495218276977539
local_in_edges_tensor generation:  0.015178203582763672
mini_batch_src_global generation:  0.018673419952392578
r_  generation:  0.17673182487487793
local_output_nid generation:  0.015049219131469727
local_in_edges_tensor generation:  0.012642621994018555
mini_batch_src_global generation:  0.01957416534423828
r_  generation:  0.17992329597473145
local_output_nid generation:  0.015252113342285156
local_in_edges_tensor generation:  0.013677835464477539
mini_batch_src_global generation:  0.021068096160888672
r_  generation:  0.1851649284362793
local_output_nid generation:  0.015456199645996094
local_in_edges_tensor generation:  0.016535520553588867
mini_batch_src_global generation:  0.01998734474182129
r_  generation:  0.18237805366516113
local_output_nid generation:  0.01572728157043457
local_in_edges_tensor generation:  0.0158233642578125
mini_batch_src_global generation:  0.020163536071777344
r_  generation:  0.18701982498168945
----------------------check_connections_block total spend ----------------------------- 2.148123264312744
generate_one_block  0.2140653133392334
generate_one_block  0.22643351554870605
generate_one_block  0.21595358848571777
generate_one_block  0.23640823364257812
generate_one_block  0.21356415748596191
generate_one_block  0.21623492240905762
generate_one_block  0.21907615661621094
generate_one_block  0.21756339073181152
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  2.148123264312744
block generation total time  1.7592992782592773
average batch blocks generation time:  0.21991240978240967
pseudo mini batch 0 input nodes size: 122322
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.0613713264465332  GigaBytes
Max Memory Allocated: 0.0613713264465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.06145620346069336  GigaBytes
Max Memory Allocated: 0.06145620346069336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.06145620346069336  GigaBytes
Max Memory Allocated: 0.06145620346069336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06558656692504883  GigaBytes
Max Memory Allocated: 0.06558656692504883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06558656692504883  GigaBytes
Max Memory Allocated: 0.06558656692504883  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06558656692504883  GigaBytes
Max Memory Allocated: 0.06558656692504883  GigaBytes

torch.Size([122322, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06558656692504883  GigaBytes
Max Memory Allocated: 0.06558656692504883  GigaBytes

m.shape torch.Size([3216, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.29418325424194336  GigaBytes
Max Memory Allocated: 0.2990427017211914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.29418325424194336  GigaBytes
Max Memory Allocated: 0.2990427017211914  GigaBytes

 h.shape torch.Size([1, 3216, 128]), torch.Size([1, 3216, 128])
----------------------------------------3
 Nvidia-smi: 1.4920654296875 GB
    Memory Allocated: 0.29725027084350586  GigaBytes
Max Memory Allocated: 0.2990427017211914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.32178640365600586  GigaBytes
Max Memory Allocated: 0.3233199119567871  GigaBytes

rst.shape  torch.Size([1, 3216, 128])
m.shape torch.Size([4016, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.3244490623474121  GigaBytes
Max Memory Allocated: 0.3245391845703125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.3244490623474121  GigaBytes
Max Memory Allocated: 0.3245391845703125  GigaBytes

 h.shape torch.Size([1, 4016, 128]), torch.Size([1, 4016, 128])
----------------------------------------3
 Nvidia-smi: 1.5330810546875 GB
    Memory Allocated: 0.3282790184020996  GigaBytes
Max Memory Allocated: 0.3282790184020996  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3872542381286621  GigaBytes
Max Memory Allocated: 0.3910841941833496  GigaBytes

rst.shape  torch.Size([1, 4016, 128])
m.shape torch.Size([4005, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3910841941833496  GigaBytes
Max Memory Allocated: 0.3912186622619629  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.3910841941833496  GigaBytes
Max Memory Allocated: 0.3912186622619629  GigaBytes

 h.shape torch.Size([1, 4005, 128]), torch.Size([1, 4005, 128])
----------------------------------------3
 Nvidia-smi: 1.5916748046875 GB
    Memory Allocated: 0.39490365982055664  GigaBytes
Max Memory Allocated: 0.39490365982055664  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4806675910949707  GigaBytes
Max Memory Allocated: 0.4868044853210449  GigaBytes

rst.shape  torch.Size([1, 4005, 128])
m.shape torch.Size([3859, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4861183166503906  GigaBytes
Max Memory Allocated: 0.4868044853210449  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4861183166503906  GigaBytes
Max Memory Allocated: 0.4868044853210449  GigaBytes

 h.shape torch.Size([1, 3859, 128]), torch.Size([1, 3859, 128])
----------------------------------------3
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4898681640625  GigaBytes
Max Memory Allocated: 0.4898681640625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.5974464416503906  GigaBytes
Max Memory Allocated: 0.6048069000244141  GigaBytes

rst.shape  torch.Size([1, 3859, 128])
m.shape torch.Size([3660, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.604332447052002  GigaBytes
Max Memory Allocated: 0.6048069000244141  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.604332447052002  GigaBytes
Max Memory Allocated: 0.6048069000244141  GigaBytes

 h.shape torch.Size([1, 3660, 128]), torch.Size([1, 3660, 128])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6078228950500488  GigaBytes
Max Memory Allocated: 0.6078228950500488  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7344803810119629  GigaBytes
Max Memory Allocated: 0.7432065010070801  GigaBytes

rst.shape  torch.Size([1, 3660, 128])
m.shape torch.Size([3207, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.741910457611084  GigaBytes
Max Memory Allocated: 0.7432065010070801  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.741910457611084  GigaBytes
Max Memory Allocated: 0.7432065010070801  GigaBytes

 h.shape torch.Size([1, 3207, 128]), torch.Size([1, 3207, 128])
----------------------------------------3
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.745734691619873  GigaBytes
Max Memory Allocated: 0.745734691619873  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8772673606872559  GigaBytes
Max Memory Allocated: 0.8864426612854004  GigaBytes

rst.shape  torch.Size([1, 3207, 128])
m.shape torch.Size([2985, 7, 128])
----------------------------------------1
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8857016563415527  GigaBytes
Max Memory Allocated: 0.8864426612854004  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8857016563415527  GigaBytes
Max Memory Allocated: 0.8864426612854004  GigaBytes

 h.shape torch.Size([1, 2985, 128]), torch.Size([1, 2985, 128])
----------------------------------------3
 Nvidia-smi: 2.0994873046875 GB
    Memory Allocated: 0.8886542320251465  GigaBytes
Max Memory Allocated: 0.8886542320251465  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 1.0315942764282227  GigaBytes
Max Memory Allocated: 1.041557788848877  GigaBytes

rst.shape  torch.Size([1, 2985, 128])
m.shape torch.Size([2794, 8, 128])
----------------------------------------1
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 1.0411620140075684  GigaBytes
Max Memory Allocated: 1.041557788848877  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 1.0411620140075684  GigaBytes
Max Memory Allocated: 1.041557788848877  GigaBytes

 h.shape torch.Size([1, 2794, 128]), torch.Size([1, 2794, 128])
----------------------------------------3
 Nvidia-smi: 2.2752685546875 GB
    Memory Allocated: 1.0439176559448242  GigaBytes
Max Memory Allocated: 1.0439176559448242  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4315185546875 GB
    Memory Allocated: 1.2026500701904297  GigaBytes
Max Memory Allocated: 1.213308334350586  GigaBytes

rst.shape  torch.Size([1, 2794, 128])
m.shape torch.Size([2503, 9, 128])
----------------------------------------1
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 1.2111802101135254  GigaBytes
Max Memory Allocated: 1.213308334350586  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 1.2111802101135254  GigaBytes
Max Memory Allocated: 1.213308334350586  GigaBytes

 h.shape torch.Size([1, 2503, 128]), torch.Size([1, 2503, 128])
----------------------------------------3
 Nvidia-smi: 2.4432373046875 GB
    Memory Allocated: 1.213630199432373  GigaBytes
Max Memory Allocated: 1.213630199432373  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5994873046875 GB
    Memory Allocated: 1.3696999549865723  GigaBytes
Max Memory Allocated: 1.380441665649414  GigaBytes

rst.shape  torch.Size([1, 2503, 128])
m.shape torch.Size([32032, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.5212469100952148  GigaBytes
Max Memory Allocated: 1.5252623558044434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7537841796875 GB
    Memory Allocated: 1.5212469100952148  GigaBytes
Max Memory Allocated: 1.5252623558044434  GigaBytes

 h.shape torch.Size([1, 32032, 128]), torch.Size([1, 32032, 128])
----------------------------------------3
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5524969100952148  GigaBytes
Max Memory Allocated: 1.5524969100952148  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.729132652282715  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

rst.shape  torch.Size([1, 32032, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.5205469131469727  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.5799388885498047  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.6393308639526367  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.579474449157715  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

torch.Size([62277, 256])
first layer input nodes number: 122322
first layer output nodes number: 62277
edges number: 462335
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.640244483947754  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.699636459350586  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.715261459350586  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1580810546875 GB
    Memory Allocated: 3.715261459350586  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

m.shape torch.Size([1720, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8060364723205566  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8060364723205566  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

 h.shape torch.Size([1, 1720, 256]), torch.Size([1, 1720, 256])
----------------------------------------3
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8097915649414062  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8384127616882324  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

rst.shape  torch.Size([1, 1720, 256])
m.shape torch.Size([1448, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8386855125427246  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8386855125427246  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

 h.shape torch.Size([1, 1448, 256]), torch.Size([1, 1448, 256])
----------------------------------------3
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8414931297302246  GigaBytes
Max Memory Allocated: 3.88187313079834  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.8837151527404785  GigaBytes
Max Memory Allocated: 3.886476993560791  GigaBytes

rst.shape  torch.Size([1, 1448, 256])
m.shape torch.Size([1168, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.885679244995117  GigaBytes
Max Memory Allocated: 3.886476993560791  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.885679244995117  GigaBytes
Max Memory Allocated: 3.886476993560791  GigaBytes

 h.shape torch.Size([1, 1168, 256]), torch.Size([1, 1168, 256])
----------------------------------------3
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.887939453125  GigaBytes
Max Memory Allocated: 3.887939453125  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.937657356262207  GigaBytes
Max Memory Allocated: 3.9411983489990234  GigaBytes

rst.shape  torch.Size([1, 1168, 256])
m.shape torch.Size([900, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.94004487991333  GigaBytes
Max Memory Allocated: 3.9411983489990234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.94004487991333  GigaBytes
Max Memory Allocated: 3.9411983489990234  GigaBytes

 h.shape torch.Size([1, 900, 256]), torch.Size([1, 900, 256])
----------------------------------------3
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.9417614936828613  GigaBytes
Max Memory Allocated: 3.9417614936828613  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 3.9915432929992676  GigaBytes
Max Memory Allocated: 3.99497652053833  GigaBytes

rst.shape  torch.Size([1, 900, 256])
m.shape torch.Size([817, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 3.9946112632751465  GigaBytes
Max Memory Allocated: 3.99497652053833  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2576904296875 GB
    Memory Allocated: 3.9946112632751465  GigaBytes
Max Memory Allocated: 3.99497652053833  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 5.2596435546875 GB
    Memory Allocated: 3.9961695671081543  GigaBytes
Max Memory Allocated: 3.9961695671081543  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.053175926208496  GigaBytes
Max Memory Allocated: 4.057071685791016  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([625, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.05600118637085  GigaBytes
Max Memory Allocated: 4.057071685791016  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.05600118637085  GigaBytes
Max Memory Allocated: 4.057071685791016  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 5.3104248046875 GB
    Memory Allocated: 4.057193279266357  GigaBytes
Max Memory Allocated: 4.057193279266357  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 4.109156131744385  GigaBytes
Max Memory Allocated: 4.112732410430908  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([504, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 4.1119513511657715  GigaBytes
Max Memory Allocated: 4.112732410430908  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 4.1119513511657715  GigaBytes
Max Memory Allocated: 4.112732410430908  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 5.3787841796875 GB
    Memory Allocated: 4.112912654876709  GigaBytes
Max Memory Allocated: 4.112912654876709  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4256591796875 GB
    Memory Allocated: 4.163143157958984  GigaBytes
Max Memory Allocated: 4.166507720947266  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([419, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.4256591796875 GB
    Memory Allocated: 4.165884494781494  GigaBytes
Max Memory Allocated: 4.166507720947266  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4256591796875 GB
    Memory Allocated: 4.165884494781494  GigaBytes
Max Memory Allocated: 4.166507720947266  GigaBytes

 h.shape torch.Size([1, 419, 256]), torch.Size([1, 419, 256])
----------------------------------------3
 Nvidia-smi: 5.4256591796875 GB
    Memory Allocated: 4.166683673858643  GigaBytes
Max Memory Allocated: 4.166683673858643  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 4.2126145362854  GigaBytes
Max Memory Allocated: 4.215811252593994  GigaBytes

rst.shape  torch.Size([1, 419, 256])
m.shape torch.Size([380, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 4.2155022621154785  GigaBytes
Max Memory Allocated: 4.215811252593994  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 4.2155022621154785  GigaBytes
Max Memory Allocated: 4.215811252593994  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 5.4725341796875 GB
    Memory Allocated: 4.216227054595947  GigaBytes
Max Memory Allocated: 4.216227054595947  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5174560546875 GB
    Memory Allocated: 4.263491153717041  GigaBytes
Max Memory Allocated: 4.26675271987915  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([324, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5174560546875 GB
    Memory Allocated: 4.266242980957031  GigaBytes
Max Memory Allocated: 4.26675271987915  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5174560546875 GB
    Memory Allocated: 4.266242980957031  GigaBytes
Max Memory Allocated: 4.26675271987915  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 5.5174560546875 GB
    Memory Allocated: 4.2668609619140625  GigaBytes
Max Memory Allocated: 4.2668609619140625  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.314709186553955  GigaBytes
Max Memory Allocated: 4.317799091339111  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([294, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.317508697509766  GigaBytes
Max Memory Allocated: 4.317799091339111  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.317508697509766  GigaBytes
Max Memory Allocated: 4.317799091339111  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 5.5447998046875 GB
    Memory Allocated: 4.3180694580078125  GigaBytes
Max Memory Allocated: 4.3180694580078125  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5916748046875 GB
    Memory Allocated: 4.363735198974609  GigaBytes
Max Memory Allocated: 4.366819381713867  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([241, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5916748046875 GB
    Memory Allocated: 4.36623477935791  GigaBytes
Max Memory Allocated: 4.366819381713867  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5916748046875 GB
    Memory Allocated: 4.36623477935791  GigaBytes
Max Memory Allocated: 4.366819381713867  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 5.5916748046875 GB
    Memory Allocated: 4.366694450378418  GigaBytes
Max Memory Allocated: 4.366819381713867  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6307373046875 GB
    Memory Allocated: 4.405766487121582  GigaBytes
Max Memory Allocated: 4.408524513244629  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([198, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.6307373046875 GB
    Memory Allocated: 4.408010959625244  GigaBytes
Max Memory Allocated: 4.408524513244629  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6307373046875 GB
    Memory Allocated: 4.408010959625244  GigaBytes
Max Memory Allocated: 4.408524513244629  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 5.6307373046875 GB
    Memory Allocated: 4.408388614654541  GigaBytes
Max Memory Allocated: 4.408524513244629  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6678466796875 GB
    Memory Allocated: 4.4431328773498535  GigaBytes
Max Memory Allocated: 4.445587635040283  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([160, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.6678466796875 GB
    Memory Allocated: 4.445096969604492  GigaBytes
Max Memory Allocated: 4.445587635040283  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6678466796875 GB
    Memory Allocated: 4.445096969604492  GigaBytes
Max Memory Allocated: 4.445587635040283  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.6678466796875 GB
    Memory Allocated: 4.445402145385742  GigaBytes
Max Memory Allocated: 4.445587635040283  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6990966796875 GB
    Memory Allocated: 4.475614547729492  GigaBytes
Max Memory Allocated: 4.477750778198242  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.6990966796875 GB
    Memory Allocated: 4.477754592895508  GigaBytes
Max Memory Allocated: 4.477763652801514  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6990966796875 GB
    Memory Allocated: 4.477754592895508  GigaBytes
Max Memory Allocated: 4.477763652801514  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 5.6990966796875 GB
    Memory Allocated: 4.478057861328125  GigaBytes
Max Memory Allocated: 4.478057861328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.510204315185547  GigaBytes
Max Memory Allocated: 4.512478828430176  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([136, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.512144088745117  GigaBytes
Max Memory Allocated: 4.512478828430176  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.512144088745117  GigaBytes
Max Memory Allocated: 4.512478828430176  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 5.7322998046875 GB
    Memory Allocated: 4.51240348815918  GigaBytes
Max Memory Allocated: 4.512478828430176  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7635498046875 GB
    Memory Allocated: 4.541715621948242  GigaBytes
Max Memory Allocated: 4.543790817260742  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([107, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.7635498046875 GB
    Memory Allocated: 4.543334484100342  GigaBytes
Max Memory Allocated: 4.543790817260742  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7635498046875 GB
    Memory Allocated: 4.543334484100342  GigaBytes
Max Memory Allocated: 4.543790817260742  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 5.7635498046875 GB
    Memory Allocated: 4.543538570404053  GigaBytes
Max Memory Allocated: 4.543790817260742  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.568028926849365  GigaBytes
Max Memory Allocated: 4.569763660430908  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([126, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.5701069831848145  GigaBytes
Max Memory Allocated: 4.570115566253662  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.5701069831848145  GigaBytes
Max Memory Allocated: 4.570115566253662  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 5.7889404296875 GB
    Memory Allocated: 4.570347309112549  GigaBytes
Max Memory Allocated: 4.570347309112549  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.6008687019348145  GigaBytes
Max Memory Allocated: 4.603031635284424  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.602684497833252  GigaBytes
Max Memory Allocated: 4.603031635284424  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.602684497833252  GigaBytes
Max Memory Allocated: 4.603031635284424  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 5.8162841796875 GB
    Memory Allocated: 4.60288667678833  GigaBytes
Max Memory Allocated: 4.603031635284424  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8436279296875 GB
    Memory Allocated: 4.629978656768799  GigaBytes
Max Memory Allocated: 4.631992816925049  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([92, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.8436279296875 GB
    Memory Allocated: 4.631905555725098  GigaBytes
Max Memory Allocated: 4.631992816925049  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8436279296875 GB
    Memory Allocated: 4.631905555725098  GigaBytes
Max Memory Allocated: 4.631992816925049  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 5.8436279296875 GB
    Memory Allocated: 4.632081031799316  GigaBytes
Max Memory Allocated: 4.632081031799316  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.65682315826416  GigaBytes
Max Memory Allocated: 4.658577919006348  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([77, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.658289909362793  GigaBytes
Max Memory Allocated: 4.658577919006348  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.658289909362793  GigaBytes
Max Memory Allocated: 4.658577919006348  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 5.8846435546875 GB
    Memory Allocated: 4.6584367752075195  GigaBytes
Max Memory Allocated: 4.658577919006348  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9061279296875 GB
    Memory Allocated: 4.680172920227051  GigaBytes
Max Memory Allocated: 4.68171501159668  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.9061279296875 GB
    Memory Allocated: 4.681516647338867  GigaBytes
Max Memory Allocated: 4.68171501159668  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9061279296875 GB
    Memory Allocated: 4.681516647338867  GigaBytes
Max Memory Allocated: 4.68171501159668  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 5.9061279296875 GB
    Memory Allocated: 4.681644439697266  GigaBytes
Max Memory Allocated: 4.68171501159668  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9256591796875 GB
    Memory Allocated: 4.701452255249023  GigaBytes
Max Memory Allocated: 4.702857971191406  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9256591796875 GB
    Memory Allocated: 4.702626705169678  GigaBytes
Max Memory Allocated: 4.702857971191406  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9256591796875 GB
    Memory Allocated: 4.702626705169678  GigaBytes
Max Memory Allocated: 4.702857971191406  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 5.9256591796875 GB
    Memory Allocated: 4.702733516693115  GigaBytes
Max Memory Allocated: 4.702857971191406  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.72003698348999  GigaBytes
Max Memory Allocated: 4.7212653160095215  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([59, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.721344947814941  GigaBytes
Max Memory Allocated: 4.72135066986084  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9412841796875 GB
    Memory Allocated: 4.721344947814941  GigaBytes
Max Memory Allocated: 4.72135066986084  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 5.9432373046875 GB
    Memory Allocated: 4.721457481384277  GigaBytes
Max Memory Allocated: 4.721457481384277  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9608154296875 GB
    Memory Allocated: 4.740475654602051  GigaBytes
Max Memory Allocated: 4.741826057434082  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([1185, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.9920654296875 GB
    Memory Allocated: 4.768892765045166  GigaBytes
Max Memory Allocated: 4.769003391265869  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9920654296875 GB
    Memory Allocated: 4.768892765045166  GigaBytes
Max Memory Allocated: 4.769003391265869  GigaBytes

 h.shape torch.Size([1, 1185, 256]), torch.Size([1, 1185, 256])
----------------------------------------3
 Nvidia-smi: 5.9920654296875 GB
    Memory Allocated: 4.771152973175049  GigaBytes
Max Memory Allocated: 4.771152973175049  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.175782680511475  GigaBytes
Max Memory Allocated: 5.20403528213501  GigaBytes

rst.shape  torch.Size([1, 1185, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.097062110900879  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.099322319030762  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.101016521453857  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.0986714363098145  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

torch.Size([11368, 40])
input nodes number: 62277
output nodes number: 11368
edges number: 91957
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.10091495513916  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.4315185546875 GB
    Memory Allocated: 5.100915908813477  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.07789087295532227  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

pseudo mini batch 1 input nodes size: 123098
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.12462425231933594  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.1247091293334961  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.06603050231933594  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.070526123046875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.070526123046875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.070526123046875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

torch.Size([123098, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6112060546875 GB
    Memory Allocated: 0.070526123046875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

m.shape torch.Size([3226, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3009934425354004  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3009934425354004  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3226, 128]), torch.Size([1, 3226, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.30406999588012695  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3304286003112793  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3226, 128])
m.shape torch.Size([3962, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3326687812805176  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3326687812805176  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3962, 128]), torch.Size([1, 3962, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.33644723892211914  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3950343132019043  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3962, 128])
m.shape torch.Size([4134, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3985476493835449  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.3985476493835449  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 4134, 128]), torch.Size([1, 4134, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.403348445892334  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.4900832176208496  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 4134, 128])
m.shape torch.Size([3833, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.495851993560791  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.495851993560791  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3833, 128]), torch.Size([1, 3833, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.4996495246887207  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.6076593399047852  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3833, 128])
m.shape torch.Size([3722, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.6147055625915527  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.6147055625915527  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3722, 128]), torch.Size([1, 3722, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.6183390617370605  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.7462453842163086  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3722, 128])
m.shape torch.Size([3334, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.7540092468261719  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.7540092468261719  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.7573738098144531  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.8973817825317383  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
m.shape torch.Size([3040, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.9059391021728516  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.9059391021728516  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 3040, 128]), torch.Size([1, 3040, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 0.9090499877929688  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.0600957870483398  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 3040, 128])
m.shape torch.Size([2815, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.0702428817749023  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.0702428817749023  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 2815, 128]), torch.Size([1, 2815, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.0730962753295898  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.2315449714660645  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 2815, 128])
m.shape torch.Size([2608, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.2406558990478516  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.2406558990478516  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 2608, 128]), torch.Size([1, 2608, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.243208408355713  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.4084901809692383  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 2608, 128])
m.shape torch.Size([32308, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.5606660842895508  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.5606660842895508  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 32308, 128]), torch.Size([1, 32308, 128])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 1.591477394104004  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.8045244216918945  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 32308, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.594874382019043  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.6549386978149414  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.71500301361084  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.6544690132141113  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

torch.Size([62982, 256])
first layer input nodes number: 123098
first layer output nodes number: 62982
edges number: 467850
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.7159223556518555  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.775986671447754  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.7910027503967285  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.7910027503967285  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

m.shape torch.Size([1677, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.8826661109924316  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.8826661109924316  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 1677, 256]), torch.Size([1, 1677, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.886383056640625  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9125070571899414  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 1677, 256])
m.shape torch.Size([1423, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9136548042297363  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9136548042297363  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 1423, 256]), torch.Size([1, 1423, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.916694164276123  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.959677219390869  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 1423, 256])
m.shape torch.Size([1140, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9624171257019043  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9624171257019043  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 1140, 256]), torch.Size([1, 1140, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 3.9647021293640137  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.01561164855957  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 1140, 256])
m.shape torch.Size([917, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.018677711486816  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.018677711486816  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 917, 256]), torch.Size([1, 917, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.0204267501831055  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.078679084777832  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 917, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.0819597244262695  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.0819597244262695  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.08347225189209  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.137923240661621  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([624, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.14076566696167  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.14076566696167  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.141955852508545  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.194011211395264  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([556, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.19715690612793  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.19715690612793  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.198217391967773  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.252126693725586  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([414, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.254779815673828  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.254779815673828  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.2555694580078125  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.301872253417969  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([379, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.304756164550781  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.304756164550781  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.305479049682617  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.352571487426758  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([322, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.355305194854736  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.355305194854736  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.355919361114502  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.399677753448486  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([286, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.402394771575928  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.402394771575928  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.402940273284912  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.446560382843018  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([235, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.44899845123291  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.44899845123291  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.449446678161621  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.487545967102051  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([202, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.489846229553223  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.489846229553223  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.490231513977051  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.525677680969238  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.52801513671875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.52801513671875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.528373718261719  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.563873291015625  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([160, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.566000938415527  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.566000938415527  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.566306114196777  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.598654747009277  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.600639820098877  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.600639820098877  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.600904941558838  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.630863666534424  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([134, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.632920742034912  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.632920742034912  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.633176326751709  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.663846492767334  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([117, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.665742874145508  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.665742874145508  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.665966033935547  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.694307327270508  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.696113586425781  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.696113586425781  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.696313858032227  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.723150253295898  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.725010871887207  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.725010871887207  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.725205421447754  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.752636909484863  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.754457473754883  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.754457473754883  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.754638671875  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.781455993652344  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.7832770347595215  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.7832770347595215  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.783389568328857  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.800832271575928  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([63, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.802168846130371  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.802168846130371  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.802289009094238  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.821755409240723  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.8233561515808105  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.8233561515808105  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 6.8358154296875 GB
    Memory Allocated: 4.823493480682373  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 4.8467020988464355  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([1166, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 4.8746771812438965  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 4.8746771812438965  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

 h.shape torch.Size([1, 1166, 256]), torch.Size([1, 1166, 256])
----------------------------------------3
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 4.876901149749756  GigaBytes
Max Memory Allocated: 5.207222938537598  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.278265476226807  GigaBytes
Max Memory Allocated: 5.306065082550049  GigaBytes

rst.shape  torch.Size([1, 1166, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.19763708114624  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.199526309967041  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.201220512390137  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.199246406555176  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([11368, 40])
input nodes number: 62982
output nodes number: 11368
edges number: 93042
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.199995994567871  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8553466796875 GB
    Memory Allocated: 5.199996471405029  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.0780487060546875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

pseudo mini batch 2 input nodes size: 122776
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.06622552871704102  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.06622552871704102  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.12481927871704102  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.12490415573120117  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.06612157821655273  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.07029581069946289  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.07029581069946289  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.07029581069946289  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([122776, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.07029581069946289  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

m.shape torch.Size([3195, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3005075454711914  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3005075454711914  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3195, 128]), torch.Size([1, 3195, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3035545349121094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3283424377441406  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3195, 128])
m.shape torch.Size([3990, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3306241035461426  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3306241035461426  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3990, 128]), torch.Size([1, 3990, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3352165222167969  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.39391136169433594  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3990, 128])
m.shape torch.Size([4047, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3977980613708496  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3977980613708496  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 4047, 128]), torch.Size([1, 4047, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4016575813293457  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4875016212463379  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 4047, 128])
m.shape torch.Size([3872, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.49295711517333984  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.49295711517333984  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3872, 128]), torch.Size([1, 3872, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4967350959777832  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6100730895996094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3872, 128])
m.shape torch.Size([3571, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6158862113952637  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6158862113952637  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3571, 128]), torch.Size([1, 3571, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6192917823791504  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7443633079528809  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3571, 128])
m.shape torch.Size([3256, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7519760131835938  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7519760131835938  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3256, 128]), torch.Size([1, 3256, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7561821937561035  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8960061073303223  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3256, 128])
m.shape torch.Size([3049, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.9037303924560547  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.9037303924560547  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3049, 128]), torch.Size([1, 3049, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.906707763671875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.0571036338806152  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3049, 128])
m.shape torch.Size([2797, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.0656886100769043  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.0656886100769043  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 2797, 128]), torch.Size([1, 2797, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.069201946258545  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.2289786338806152  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 2797, 128])
m.shape torch.Size([2488, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.2383222579956055  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.2383222579956055  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 2488, 128]), torch.Size([1, 2488, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.2408995628356934  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.3971495628356934  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 2488, 128])
m.shape torch.Size([32403, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.5504727363586426  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.5504727363586426  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 32403, 128]), torch.Size([1, 32403, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 1.5813746452331543  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.796295642852783  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 32403, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.5853748321533203  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.645139694213867  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.704904556274414  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.644672393798828  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([62668, 256])
first layer input nodes number: 122776
first layer output nodes number: 62668
edges number: 466336
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.7058215141296387  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.7655863761901855  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.7805275917053223  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.7805275917053223  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

m.shape torch.Size([1647, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.8727731704711914  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.8727731704711914  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1647, 256]), torch.Size([1, 1647, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.876549243927002  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.904660701751709  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1647, 256])
m.shape torch.Size([1473, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.906034469604492  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.906034469604492  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1473, 256]), torch.Size([1, 1473, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.9090118408203125  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.9514684677124023  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1473, 256])
m.shape torch.Size([1161, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.9541702270507812  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.9541702270507812  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1161, 256]), torch.Size([1, 1161, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 3.9565510749816895  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.008228778839111  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1161, 256])
m.shape torch.Size([915, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.011229515075684  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.011229515075684  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.012974739074707  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.070664405822754  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([765, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.0739006996154785  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.0739006996154785  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 765, 256]), torch.Size([1, 765, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.07535982131958  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.127888202667236  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 765, 256])
m.shape torch.Size([574, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.130468845367432  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.130468845367432  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.131563663482666  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.178640842437744  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([486, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.181363582611084  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.181363582611084  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.182290554046631  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.2299113273620605  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([454, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.232938766479492  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.232938766479492  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.233804702758789  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.283880233764648  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([367, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.286622047424316  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.286622047424316  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.287322044372559  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.332767486572266  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([352, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.335800647735596  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.335800647735596  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.336472034454346  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.386494159698486  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([285, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.389171600341797  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.389171600341797  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.389715194702148  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.432912826538086  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([255, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.435582160949707  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.435582160949707  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.436068534851074  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.477410316467285  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.480754852294922  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.480754852294922  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.481161117553711  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.518537521362305  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([171, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.520635604858398  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.520635604858398  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.520961761474609  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.553251266479492  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.555366516113281  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.555366516113281  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.555667877197266  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.587612152099609  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.589876174926758  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.589876174926758  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.590175628662109  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.624013900756836  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([122, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.625857830047607  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.625857830047607  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.6260905265808105  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.6540141105651855  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.655662536621094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.655662536621094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.655857086181641  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.680564880371094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([118, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.682622909545898  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.682622909545898  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.68284797668457  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.713006973266602  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.714720726013184  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.714720726013184  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.714901924133301  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.740450859069824  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([104, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.742459774017334  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.742459774017334  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.7426581382751465  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.7720160484313965  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.773651123046875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.773651123046875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.773807525634766  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.7980499267578125  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.799541473388672  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.799541473388672  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.799676895141602  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.821615219116211  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.823093414306641  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.823093414306641  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.0155029296875 GB
    Memory Allocated: 4.823221206665039  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.844818115234375  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([1174, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.873098850250244  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.873098850250244  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1174, 256]), torch.Size([1, 1174, 256])
----------------------------------------3
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 4.875338077545166  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.276600360870361  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.195005416870117  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.196871280670166  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.199380874633789  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.19743013381958  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([11368, 40])
input nodes number: 62668
output nodes number: 11368
edges number: 93733
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.197958946228027  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0213623046875 GB
    Memory Allocated: 5.1979594230651855  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.0780954360961914  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

pseudo mini batch 3 input nodes size: 123632
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06609821319580078  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06609821319580078  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.12505054473876953  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.1251354217529297  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.06645679473876953  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07070159912109375  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07070159912109375  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07070159912109375  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([123632, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0252685546875 GB
    Memory Allocated: 0.07070159912109375  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

m.shape torch.Size([3146, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30289125442504883  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30289125442504883  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3146, 128]), torch.Size([1, 3146, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3058915138244629  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3314800262451172  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3146, 128])
m.shape torch.Size([4120, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3339090347290039  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3339090347290039  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 4120, 128]), torch.Size([1, 4120, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33783817291259766  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3967752456665039  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 4120, 128])
m.shape torch.Size([4119, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.40070295333862305  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.40070295333862305  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 4119, 128]), torch.Size([1, 4119, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4046311378479004  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.49105119705200195  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 4119, 128])
m.shape torch.Size([3976, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4968538284301758  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4968538284301758  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3976, 128]), torch.Size([1, 3976, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.5007138252258301  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6135783195495605  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3976, 128])
m.shape torch.Size([3700, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6200461387634277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6200461387634277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3700, 128]), torch.Size([1, 3700, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.623685359954834  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7524170875549316  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3700, 128])
m.shape torch.Size([3286, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7600541114807129  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7600541114807129  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3286, 128]), torch.Size([1, 3286, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7637066841125488  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9055275917053223  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3286, 128])
m.shape torch.Size([3080, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9135127067565918  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9135127067565918  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 3080, 128]), torch.Size([1, 3080, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9165339469909668  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0663723945617676  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 3080, 128])
m.shape torch.Size([2848, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.075767993927002  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.075767993927002  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 2848, 128]), torch.Size([1, 2848, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0786290168762207  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2377057075500488  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 2848, 128])
m.shape torch.Size([2540, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2467293739318848  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2467293739318848  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 2540, 128]), torch.Size([1, 2540, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2498173713684082  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.4062561988830566  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 2540, 128])
m.shape torch.Size([32606, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5611424446105957  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5611424446105957  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 32606, 128]), torch.Size([1, 32606, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.592237949371338  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8089795112609863  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 32606, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.596869468688965  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6573524475097656  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7178354263305664  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6568799018859863  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

torch.Size([63421, 256])
first layer input nodes number: 123632
first layer output nodes number: 63421
edges number: 471127
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7187585830688477  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7792415618896484  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7943625450134277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7943625450134277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

m.shape torch.Size([1652, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8865132331848145  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8865132331848145  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1652, 256]), torch.Size([1, 1652, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8903732299804688  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.916943073272705  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1652, 256])
m.shape torch.Size([1441, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9185404777526855  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9185404777526855  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1441, 256]), torch.Size([1, 1441, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9214816093444824  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9632925987243652  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1441, 256])
m.shape torch.Size([1185, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.965928554534912  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.965928554534912  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1185, 256]), torch.Size([1, 1185, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.968414783477783  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.019909381866455  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1185, 256])
m.shape torch.Size([965, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.022198677062988  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.022198677062988  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.024039268493652  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.0810441970825195  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([773, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.084136486053467  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.084136486053467  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.085610866546631  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.138688564300537  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([561, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.141186714172363  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.141186714172363  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 561, 256]), torch.Size([1, 561, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.142256736755371  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.189251899719238  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 561, 256])
m.shape torch.Size([504, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.192108154296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.192108154296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.1930694580078125  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.242713928222656  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([428, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.2455244064331055  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.2455244064331055  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.246340751647949  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.293169021606445  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([398, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.29620361328125  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.29620361328125  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.296962738037109  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.346134185791016  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([330, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.348926544189453  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.348926544189453  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.349555969238281  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.395870685577393  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.3983154296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.3983154296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.398813247680664  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.438966751098633  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([234, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4414167404174805  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4414167404174805  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.441863059997559  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.479800224304199  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([202, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4821014404296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4821014404296875  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.482486724853516  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.517932891845703  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([162, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.519920349121094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.519920349121094  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.520229339599609  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.550819396972656  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.553000450134277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.553000450134277  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.553309440612793  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.586062431335449  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([130, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.587907314300537  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.587907314300537  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.588155269622803  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.616174221038818  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([139, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.618321418762207  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.618321418762207  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.618586540222168  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.6504011154174805  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.652742862701416  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.652742862701416  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.653015613555908  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.687654972076416  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.6892170906066895  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.6892170906066895  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.689394474029541  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.71316385269165  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.715266704559326  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.715266704559326  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.715484142303467  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746142864227295  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.748073101043701  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.748073101043701  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.748265743255615  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7767767906188965  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.778340816497803  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.778340816497803  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.778468608856201  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.798276424407959  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.799539089202881  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.799539089202881  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.79965353012085  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.818192958831787  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.819589138031006  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.819589138031006  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.819709300994873  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.840016841888428  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([1200, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.869477272033691  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.869477272033691  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

 h.shape torch.Size([1, 1200, 256]), torch.Size([1, 1200, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.871766090393066  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.278521537780762  GigaBytes
Max Memory Allocated: 5.309723377227783  GigaBytes

rst.shape  torch.Size([1, 1200, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.198753833770752  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.200448036193848  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.202142238616943  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.2003631591796875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([11368, 40])
input nodes number: 63421
output nodes number: 11368
edges number: 93568
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.200748920440674  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.200749397277832  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07805776596069336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

pseudo mini batch 4 input nodes size: 122407
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0662851333618164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0662851333618164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.1248788833618164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.12496376037597656  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0700531005859375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0700531005859375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0700531005859375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([122407, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0700531005859375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([3178, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.298769474029541  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.298769474029541  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3178, 128]), torch.Size([1, 3178, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3018002510070801  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.32651758193969727  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3178, 128])
m.shape torch.Size([4107, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3289189338684082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3289189338684082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 4107, 128]), torch.Size([1, 4107, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33283567428588867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3915867805480957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 4107, 128])
m.shape torch.Size([4034, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3953990936279297  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3953990936279297  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 4034, 128]), torch.Size([1, 4034, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.39934349060058594  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.48531532287597656  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 4034, 128])
m.shape torch.Size([3961, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4907102584838867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4907102584838867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3961, 128]), torch.Size([1, 3961, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.49478673934936523  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6080436706542969  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3961, 128])
m.shape torch.Size([3727, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6155986785888672  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6155986785888672  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3727, 128]), torch.Size([1, 3727, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6197795867919922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7477359771728516  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3727, 128])
m.shape torch.Size([3234, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.755211353302002  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.755211353302002  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3234, 128]), torch.Size([1, 3234, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.758730411529541  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.892676830291748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3234, 128])
m.shape torch.Size([2989, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9011116027832031  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9011116027832031  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2989, 128]), torch.Size([1, 2989, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9039621353149414  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.047189712524414  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2989, 128])
m.shape torch.Size([2735, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0561976432800293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0561976432800293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2735, 128]), torch.Size([1, 2735, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0590128898620605  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.207972526550293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2735, 128])
m.shape torch.Size([2510, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.217440128326416  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.217440128326416  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2510, 128]), torch.Size([1, 2510, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2199864387512207  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.3765101432800293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2510, 128])
m.shape torch.Size([31877, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5273146629333496  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5273146629333496  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 31877, 128]), torch.Size([1, 31877, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5577149391174316  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.716134548187256  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 31877, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.508556365966797  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.5680198669433594  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.627483367919922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.5675549507141113  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([62352, 256])
first layer input nodes number: 122407
first layer output nodes number: 62352
edges number: 461540
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6283974647521973  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6878609657287598  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7027268409729004  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7027268409729004  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([1690, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7935218811035156  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7935218811035156  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1690, 256]), torch.Size([1, 1690, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7969207763671875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.82305908203125  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1690, 256])
m.shape torch.Size([1536, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.824312210083008  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.824312210083008  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1536, 256]), torch.Size([1, 1536, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8275537490844727  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8729066848754883  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1536, 256])
m.shape torch.Size([1109, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8744049072265625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8744049072265625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1109, 256]), torch.Size([1, 1109, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8766589164733887  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9260778427124023  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1109, 256])
m.shape torch.Size([933, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.92927885055542  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.92927885055542  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 933, 256]), torch.Size([1, 933, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.931058406829834  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9903855323791504  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 933, 256])
m.shape torch.Size([772, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.993206024169922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.993206024169922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.994678497314453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.048198699951172  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([610, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.050980567932129  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.050980567932129  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.0521440505981445  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.1043219566345215  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([510, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.107171535491943  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.107171535491943  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 510, 256]), torch.Size([1, 510, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.108144283294678  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.157937049865723  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 510, 256])
m.shape torch.Size([427, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.161443710327148  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.161443710327148  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.162258148193359  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.210742950439453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([361, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.21345853805542  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.21345853805542  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 361, 256]), torch.Size([1, 361, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.214147090911865  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.258995532989502  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 361, 256])
m.shape torch.Size([319, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.261717319488525  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.261717319488525  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.262325763702393  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.305685520172119  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([267, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.308204174041748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.308204174041748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.308713436126709  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.348890781402588  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([245, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.351461887359619  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.351461887359619  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.351929187774658  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.3916497230529785  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([205, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.393977642059326  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.393977642059326  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.394368648529053  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4303412437438965  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.432971477508545  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.432971477508545  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4333720207214355  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.473025798797607  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([164, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.475190162658691  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.475190162658691  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.475502967834473  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.508660316467285  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([125, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.510735511779785  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.510735511779785  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.510973930358887  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.537915229797363  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([110, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.539593696594238  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.539593696594238  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.539803504943848  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.564980506896973  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([121, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.566969394683838  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.566969394683838  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.567200183868408  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.596510410308838  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([94, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.598111629486084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.598111629486084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.598290920257568  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.622315883636475  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.624475479125977  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.624475479125977  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.624698638916016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.656164169311523  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.657748222351074  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.657748222351074  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.6579084396362305  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.6816205978393555  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.682851791381836  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.682851791381836  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.68297004699707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.701299667358398  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.702832221984863  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.702832221984863  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.702969551086426  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.725216865539551  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.726578712463379  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.726578712463379  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.726696968078613  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746682167053223  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1163, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7745680809021  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7745680809021  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1163, 256]), torch.Size([1, 1163, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.777377605438232  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.179869174957275  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1163, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.100454330444336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.102153778076172  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.103853225708008  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.102068901062012  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([11368, 40])
input nodes number: 62352
output nodes number: 11368
edges number: 92229
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.10262393951416  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.102624416351318  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.078033447265625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

pseudo mini batch 5 input nodes size: 122883
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06593179702758789  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06593179702758789  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.1245269775390625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.12461185455322266  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.0659332275390625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07058048248291016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07058048248291016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07058048248291016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([122883, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07058048248291016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([3147, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3010845184326172  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3010845184326172  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3147, 128]), torch.Size([1, 3147, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30408573150634766  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.328580379486084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3147, 128])
m.shape torch.Size([3964, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3308601379394531  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3308601379394531  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3964, 128]), torch.Size([1, 3964, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33582067489624023  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.39454030990600586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3964, 128])
m.shape torch.Size([4023, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3984050750732422  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3984050750732422  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 4023, 128]), torch.Size([1, 4023, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.40224170684814453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4880399703979492  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 4023, 128])
m.shape torch.Size([3909, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4935774803161621  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4935774803161621  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3909, 128]), torch.Size([1, 3909, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4973597526550293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6107954978942871  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3909, 128])
m.shape torch.Size([3657, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6176505088806152  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6176505088806152  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3657, 128]), torch.Size([1, 3657, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6213483810424805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7476005554199219  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3657, 128])
m.shape torch.Size([3293, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7549285888671875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7549285888671875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3293, 128]), torch.Size([1, 3293, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7582778930664062  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9018959999084473  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3293, 128])
m.shape torch.Size([2974, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.910252571105957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.910252571105957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2974, 128]), torch.Size([1, 2974, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9131283760070801  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0550222396850586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2974, 128])
m.shape torch.Size([2754, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.064626693725586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.064626693725586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2754, 128]), torch.Size([1, 2754, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0673580169677734  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2180004119873047  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2754, 128])
m.shape torch.Size([2526, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2275276184082031  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2275276184082031  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2526, 128]), torch.Size([1, 2526, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2299871444702148  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.3868980407714844  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2526, 128])
m.shape torch.Size([32561, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5409564971923828  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5409564971923828  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 32561, 128]), torch.Size([1, 32561, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5720090866088867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7881927490234375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 32561, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.577078342437744  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.636976718902588  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6968750953674316  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6365084648132324  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([62808, 256])
first layer input nodes number: 122883
first layer output nodes number: 62808
edges number: 468017
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.6977930068969727  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7576913833618164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7726659774780273  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7726659774780273  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([1679, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8648085594177246  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8648085594177246  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1679, 256]), torch.Size([1, 1679, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.868590831756592  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8959898948669434  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1679, 256])
m.shape torch.Size([1454, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.897183895111084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.897183895111084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1454, 256]), torch.Size([1, 1454, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9001026153564453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9423704147338867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1454, 256])
m.shape torch.Size([1178, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9450154304504395  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9450154304504395  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1178, 256]), torch.Size([1, 1178, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.94730806350708  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9980273246765137  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1178, 256])
m.shape torch.Size([943, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.000828742980957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.000828742980957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 943, 256]), torch.Size([1, 943, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.002627372741699  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.059679985046387  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 943, 256])
m.shape torch.Size([737, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.0628132820129395  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.0628132820129395  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.064218997955322  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.115332126617432  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 737, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.1182451248168945  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.1182451248168945  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.119441032409668  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.17153263092041  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([493, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.174251556396484  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.174251556396484  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.175191879272461  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.222932815551758  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([434, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.225800037384033  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.225800037384033  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.226627826690674  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.2738118171691895  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([343, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.276365280151367  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.276365280151367  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 343, 256]), torch.Size([1, 343, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.277019500732422  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.319430351257324  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 343, 256])
m.shape torch.Size([318, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.322159767150879  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.322159767150879  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.322766304016113  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.366672992706299  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.369214057922363  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.369214057922363  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.36972713470459  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.412158489227295  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([246, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.414739608764648  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.414739608764648  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.41520881652832  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.45509147644043  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([228, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.457705974578857  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.457705974578857  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.458140850067139  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.498149394989014  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.500098705291748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.500098705291748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.500405788421631  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.530807018280029  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([154, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.53287410736084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.53287410736084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.533167839050293  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.564303398132324  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.566294193267822  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.566294193267822  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.566559314727783  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.596518039703369  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.59844446182251  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.59844446182251  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.598684787750244  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.627523899078369  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([119, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.629462718963623  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.629462718963623  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.629689693450928  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.658515453338623  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.660283088684082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.660283088684082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.660479545593262  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.68680477142334  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([101, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.688648223876953  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.688648223876953  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.688840866088867  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.71600341796875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.717824935913086  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.717824935913086  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.718006134033203  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.744823455810547  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746208190917969  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746208190917969  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746335983276367  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.766143798828125  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.767340183258057  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.767340183258057  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.767448902130127  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.785061359405518  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.786760330200195  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.786760330200195  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.786905288696289  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.811403274536133  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1221, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.840855121612549  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.840855121612549  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1221, 256]), torch.Size([1, 1221, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.843183994293213  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.26670503616333  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1221, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.186046123504639  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.188317775726318  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.190011978149414  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.187655448913574  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([11368, 40])
input nodes number: 62808
output nodes number: 11368
edges number: 93583
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.188780784606934  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.188781261444092  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07848453521728516  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

pseudo mini batch 6 input nodes size: 122865
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06650543212890625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06650543212890625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.12509918212890625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.1251840591430664  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06650400161743164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07067441940307617  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07067441940307617  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07067441940307617  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([122865, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07067441940307617  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([3146, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3008699417114258  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3008699417114258  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3146, 128]), torch.Size([1, 3146, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30387020111083984  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.328369140625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3146, 128])
m.shape torch.Size([3943, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3306293487548828  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3306293487548828  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3943, 128]), torch.Size([1, 3943, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33463335037231445  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3933730125427246  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3943, 128])
m.shape torch.Size([4055, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3972935676574707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3972935676574707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 4055, 128]), torch.Size([1, 4055, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.40116071701049805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.48702001571655273  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 4055, 128])
m.shape torch.Size([3844, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4924182891845703  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4924182891845703  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3844, 128]), torch.Size([1, 3844, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4961848258972168  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6094827651977539  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3844, 128])
m.shape torch.Size([3708, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.616490364074707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.616490364074707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3708, 128]), torch.Size([1, 3708, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6200966835021973  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7475647926330566  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3708, 128])
m.shape torch.Size([3325, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7553095817565918  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7553095817565918  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3325, 128]), torch.Size([1, 3325, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7586631774902344  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.8986773490905762  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3325, 128])
m.shape torch.Size([2991, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9070754051208496  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9070754051208496  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2991, 128]), torch.Size([1, 2991, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9100356101989746  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0536093711853027  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2991, 128])
m.shape torch.Size([2854, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.063070297241211  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.063070297241211  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2854, 128]), torch.Size([1, 2854, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0658574104309082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2248291969299316  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2854, 128])
m.shape torch.Size([2594, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.23460054397583  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.23460054397583  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2594, 128]), torch.Size([1, 2594, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.237297534942627  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.3968448638916016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2594, 128])
m.shape torch.Size([32302, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5499048233032227  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5499048233032227  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 32302, 128]), torch.Size([1, 32302, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5807104110717773  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.794571876525879  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 32302, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.584477424621582  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.644331932067871  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.70418643951416  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.643864154815674  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([62762, 256])
first layer input nodes number: 122865
first layer output nodes number: 62762
edges number: 467198
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.705103874206543  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.764958381652832  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7799220085144043  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.7799220085144043  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([1693, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.871117115020752  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.871117115020752  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1693, 256]), torch.Size([1, 1693, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.8749008178710938  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9017386436462402  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1693, 256])
m.shape torch.Size([1500, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.902158260345459  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.902158260345459  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1500, 256]), torch.Size([1, 1500, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.9052438735961914  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.950812339782715  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1500, 256])
m.shape torch.Size([1129, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.953535556793213  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.953535556793213  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1129, 256]), torch.Size([1, 1129, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 3.956023693084717  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.006493091583252  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1129, 256])
m.shape torch.Size([883, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.009571552276611  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.009571552276611  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 883, 256]), torch.Size([1, 883, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.011255741119385  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.069218158721924  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 883, 256])
m.shape torch.Size([755, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.072532653808594  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.072532653808594  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 755, 256]), torch.Size([1, 755, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.073972702026367  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.126638412475586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 755, 256])
m.shape torch.Size([617, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.129476547241211  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.129476547241211  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.130653381347656  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.18195915222168  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([528, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.18492317199707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.18492317199707  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.185930252075195  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.237070083618164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([441, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.240011215209961  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.240011215209961  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.240852355957031  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.288993835449219  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([390, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.291946887969971  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.291946887969971  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.292690753936768  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.340488910675049  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([308, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.343077659606934  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.343077659606934  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.34366512298584  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.387560844421387  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([285, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.390280246734619  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.390280246734619  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.390823841094971  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.43330717086792  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([243, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.435838222503662  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.435838222503662  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 243, 256]), torch.Size([1, 243, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4363017082214355  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.475697994232178  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 243, 256])
m.shape torch.Size([211, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.478102684020996  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.478102684020996  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.4785051345825195  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.515530586242676  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.51785945892334  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.51785945892334  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.518218040466309  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.553717613220215  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([164, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.55590295791626  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.55590295791626  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.556215763092041  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.5893731117248535  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.591585159301758  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.591585159301758  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.591878890991211  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.625070571899414  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([151, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.627391338348389  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.627391338348389  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.627679347991943  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.662240505218506  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.664414882659912  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.664414882659912  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.664590358734131  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.686875820159912  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([114, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.688869953155518  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.688869953155518  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.689087390899658  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.718224048614502  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.719864845275879  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.719864845275879  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.720038414001465  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.744511604309082  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7459588050842285  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7459588050842285  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.746103763580322  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.767557621002197  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.769092559814453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.769092559814453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.769237518310547  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.791706085205078  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.793181419372559  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.793181419372559  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.7933149337768555  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.814944267272949  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.8162617683410645  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.8162617683410645  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.816376209259033  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.835716724395752  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1149, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.86326789855957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.86326789855957  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1149, 256]), torch.Size([1, 1149, 256])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 4.866266250610352  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.264276504516602  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1149, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.185029983520508  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.1867241859436035  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.188418388366699  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.186639308929443  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([11368, 40])
input nodes number: 62762
output nodes number: 11368
edges number: 92505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.186614513397217  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 5.186614990234375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07749509811401367  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

pseudo mini batch 7 input nodes size: 123758
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06592655181884766  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.12493896484375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.12502384185791016  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.06634521484375  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07123756408691406  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07123756408691406  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07123756408691406  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([123758, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.07123756408691406  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([3250, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30408430099487305  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30408430099487305  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3250, 128]), torch.Size([1, 3250, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.30718374252319336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33197927474975586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3250, 128])
m.shape torch.Size([3955, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3342013359069824  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3342013359069824  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3955, 128]), torch.Size([1, 3955, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.33914661407470703  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.3978748321533203  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3955, 128])
m.shape torch.Size([4090, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4018397331237793  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.4018397331237793  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 4090, 128]), torch.Size([1, 4090, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.40574026107788086  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.491666316986084  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 4090, 128])
m.shape torch.Size([3875, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.49710702896118164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.49710702896118164  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3875, 128]), torch.Size([1, 3875, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.5009050369262695  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6141009330749512  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3875, 128])
m.shape torch.Size([3730, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6211462020874023  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6211462020874023  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3730, 128]), torch.Size([1, 3730, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.6247725486755371  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7528319358825684  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3730, 128])
m.shape torch.Size([3334, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.760591983795166  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.760591983795166  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 3334, 128]), torch.Size([1, 3334, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.7640824317932129  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9041147232055664  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 3334, 128])
m.shape torch.Size([2988, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9124984741210938  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9124984741210938  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2988, 128]), torch.Size([1, 2988, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 0.9155035018920898  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0581474304199219  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2988, 128])
m.shape torch.Size([2815, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0681209564208984  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.0681209564208984  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2815, 128]), torch.Size([1, 2815, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.070913314819336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2292165756225586  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2815, 128])
m.shape torch.Size([2591, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2389936447143555  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2389936447143555  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 2591, 128]), torch.Size([1, 2591, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.2415399551391602  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.3999905586242676  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 2591, 128])
m.shape torch.Size([32800, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5551576614379883  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5551576614379883  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 32800, 128]), torch.Size([1, 32800, 128])
----------------------------------------3
 Nvidia-smi: 7.2518310546875 GB
    Memory Allocated: 1.5864381790161133  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8073549270629883  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 32800, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.5954341888427734  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.655923843383789  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7164134979248047  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.6554508209228516  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

torch.Size([63428, 256])
first layer input nodes number: 123758
first layer output nodes number: 63428
edges number: 472339
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.7173376083374023  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.777827262878418  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.792949676513672  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.792949676513672  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

m.shape torch.Size([1670, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.885138511657715  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.885138511657715  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1670, 256]), torch.Size([1, 1670, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.8887648582458496  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.915400981903076  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1670, 256])
m.shape torch.Size([1431, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9170002937316895  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9170002937316895  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1431, 256]), torch.Size([1, 1431, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9199748039245605  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.964080333709717  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1431, 256])
m.shape torch.Size([1207, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.966106414794922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.966106414794922  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1207, 256]), torch.Size([1, 1207, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 3.9684319496154785  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.025020599365234  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 1207, 256])
m.shape torch.Size([864, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.027045249938965  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.027045249938965  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.028693199157715  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.083624839782715  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 864, 256])
m.shape torch.Size([810, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.086722373962402  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.086722373962402  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 810, 256]), torch.Size([1, 810, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.0882673263549805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.149558067321777  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 810, 256])
m.shape torch.Size([630, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.152895927429199  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.152895927429199  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.154097557067871  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.206623554229736  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([464, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.209144592285156  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.209144592285156  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.210029602050781  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.256919860839844  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([455, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.259975910186768  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.259975910186768  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.260843753814697  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.311119556427002  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([358, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.313782691955566  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.313782691955566  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.314465522766113  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.359160423278809  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([326, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.361952304840088  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.361952304840088  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.362574100494385  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.408074855804443  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([256, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.410470485687256  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.410470485687256  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.410958766937256  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.449044704437256  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([238, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.451988220214844  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.451988220214844  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.452442169189453  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.49102783203125  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([197, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.493262767791748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.493262767791748  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.493638515472412  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.528207302093506  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([194, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.530630111694336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.530630111694336  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.531000137329102  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.567632675170898  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([168, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5698699951171875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5698699951171875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.5701904296875  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.604156494140625  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([131, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.606010913848877  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.606010913848877  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.606260776519775  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.634495258331299  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636674404144287  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636674404144287  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.636943340301514  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.669215679168701  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([128, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.671295642852783  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.671295642852783  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.671539783477783  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.702545642852783  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([103, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7043046951293945  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7043046951293945  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.704501152038574  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.730826377868652  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([95, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7325544357299805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7325544357299805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.732735633850098  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.758284568786621  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([85, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7601423263549805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7601423263549805  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.7603044509887695  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.784298896789551  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.785825252532959  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.785825252532959  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.785970211029053  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.808438777923584  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.8099141120910645  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.8099141120910645  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.810047626495361  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.831676959991455  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.833132743835449  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.833132743835449  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5057373046875 GB
    Memory Allocated: 4.833258628845215  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5252685546875 GB
    Memory Allocated: 4.8545331954956055  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1202, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 4.883869171142578  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 4.883869171142578  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 4.886161804199219  GigaBytes
Max Memory Allocated: 5.309946537017822  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.291448593139648  GigaBytes
Max Memory Allocated: 5.320745468139648  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.210046768188477  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.211938858032227  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.213830947875977  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.211853981018066  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([11365, 40])
input nodes number: 63428
output nodes number: 11365
edges number: 93633
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.212609767913818  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5272216796875 GB
    Memory Allocated: 5.212610244750977  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07882022857666016  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08437061309814453  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08437061309814453  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.045491427183151245 |0.046057820320129395 |0.19799426198005676 |0.00010275840759277344 |0.07974708080291748 |0.005815029144287109 |
----------------------------------------------------------pseudo_mini_loss sum 5.331421852111816
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1486439
Number of first layer input nodes during this epoch:  983741
Number of first layer output nodes during this epoch:  502698
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08437013626098633  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.027702808380126953
number of batches is  8
batch size is  11368
range selection method spend 0.017222881317138672
time for parepare:  0.018962860107421875
local_output_nid generation:  0.0027878284454345703
local_in_edges_tensor generation:  0.008860349655151367
mini_batch_src_global generation:  0.0037670135498046875
r_  generation:  0.03415203094482422
local_output_nid generation:  0.0032165050506591797
local_in_edges_tensor generation:  0.0016367435455322266
mini_batch_src_global generation:  0.0035457611083984375
r_  generation:  0.036104440689086914
local_output_nid generation:  0.003224611282348633
local_in_edges_tensor generation:  0.001712799072265625
mini_batch_src_global generation:  0.0024390220642089844
r_  generation:  0.036861419677734375
local_output_nid generation:  0.003195047378540039
local_in_edges_tensor generation:  0.0015544891357421875
mini_batch_src_global generation:  0.0024950504302978516
r_  generation:  0.0357356071472168
local_output_nid generation:  0.0032880306243896484
local_in_edges_tensor generation:  0.00152587890625
mini_batch_src_global generation:  0.0025174617767333984
r_  generation:  0.03623557090759277
local_output_nid generation:  0.0032830238342285156
local_in_edges_tensor generation:  0.001542806625366211
mini_batch_src_global generation:  0.002726316452026367
r_  generation:  0.037134647369384766
local_output_nid generation:  0.0032339096069335938
local_in_edges_tensor generation:  0.0015344619750976562
mini_batch_src_global generation:  0.0026695728302001953
r_  generation:  0.03772163391113281
local_output_nid generation:  0.0032906532287597656
local_in_edges_tensor generation:  0.001598358154296875
mini_batch_src_global generation:  0.0027141571044921875
r_  generation:  0.037224769592285156
----------------------check_connections_block total spend ----------------------------- 0.4400973320007324
generate_one_block  0.05193495750427246
generate_one_block  0.052797555923461914
generate_one_block  0.051191091537475586
generate_one_block  0.0509796142578125
generate_one_block  0.05170297622680664
generate_one_block  0.0520782470703125
generate_one_block  0.05118727684020996
generate_one_block  0.05150127410888672
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023825407028198242
gen group dst list time:  0.014693260192871094
time for parepare:  0.020550966262817383
local_output_nid generation:  0.00977945327758789
local_in_edges_tensor generation:  0.019413232803344727
mini_batch_src_global generation:  0.01398015022277832
r_  generation:  0.1624150276184082
local_output_nid generation:  0.015080690383911133
local_in_edges_tensor generation:  0.012869119644165039
mini_batch_src_global generation:  0.019501447677612305
r_  generation:  0.17081356048583984
local_output_nid generation:  0.014842510223388672
local_in_edges_tensor generation:  0.014412403106689453
mini_batch_src_global generation:  0.017522335052490234
r_  generation:  0.1761932373046875
local_output_nid generation:  0.015440940856933594
local_in_edges_tensor generation:  0.015296220779418945
mini_batch_src_global generation:  0.019121885299682617
r_  generation:  0.1786646842956543
local_output_nid generation:  0.015321016311645508
local_in_edges_tensor generation:  0.013461828231811523
mini_batch_src_global generation:  0.019423961639404297
r_  generation:  0.17657136917114258
local_output_nid generation:  0.015600204467773438
local_in_edges_tensor generation:  0.013881206512451172
mini_batch_src_global generation:  0.021493196487426758
r_  generation:  0.181837797164917
local_output_nid generation:  0.015788793563842773
local_in_edges_tensor generation:  0.012363910675048828
mini_batch_src_global generation:  0.01996898651123047
r_  generation:  0.17969417572021484
local_output_nid generation:  0.01562356948852539
local_in_edges_tensor generation:  0.013994455337524414
mini_batch_src_global generation:  0.02132701873779297
r_  generation:  0.180894136428833
----------------------check_connections_block total spend ----------------------------- 2.1355388164520264
generate_one_block  0.223006010055542
generate_one_block  0.22353196144104004
generate_one_block  0.22501683235168457
generate_one_block  0.22130632400512695
generate_one_block  0.23326683044433594
generate_one_block  0.22427654266357422
generate_one_block  0.24100327491760254
generate_one_block  0.22141790390014648
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08437013626098633  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

connection checking time:  2.1355388164520264
block generation total time  1.8128256797790527
average batch blocks generation time:  0.2266032099723816
block dataloader generation time/epoch 5.020679950714111
pseudo mini batch 0 input nodes size: 122512
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07209253311157227  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07209253311157227  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.13068628311157227  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.13077116012573242  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07167387008666992  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([122512, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07582616806030273  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

m.shape torch.Size([3163, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3047637939453125  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3047637939453125  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3163, 128]), torch.Size([1, 3163, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.30778026580810547  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.33240222930908203  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3163, 128])
m.shape torch.Size([3963, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3346734046936035  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3346734046936035  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3963, 128]), torch.Size([1, 3963, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3395204544067383  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3982410430908203  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3963, 128])
m.shape torch.Size([4098, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40221357345581055  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40221357345581055  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 4098, 128]), torch.Size([1, 4098, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40612173080444336  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.49210119247436523  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 4098, 128])
m.shape torch.Size([3847, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4979557991027832  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4979557991027832  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3847, 128]), torch.Size([1, 3847, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5018486976623535  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6143908500671387  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3847, 128])
m.shape torch.Size([3663, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6212897300720215  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6212897300720215  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3663, 128]), torch.Size([1, 3663, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.624885082244873  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7512803077697754  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3663, 128])
m.shape torch.Size([3256, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7585310935974121  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7585310935974121  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3256, 128]), torch.Size([1, 3256, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7618346214294434  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.905552864074707  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3256, 128])
m.shape torch.Size([2968, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9148683547973633  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9148683547973633  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 2968, 128]), torch.Size([1, 2968, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9178528785705566  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0593781471252441  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 2968, 128])
m.shape torch.Size([2793, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.068617343902588  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.068617343902588  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 2793, 128]), torch.Size([1, 2793, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0712809562683105  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.231215476989746  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 2793, 128])
m.shape torch.Size([2533, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2407541275024414  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2407541275024414  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 2533, 128]), torch.Size([1, 2533, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2432193756103516  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.3993563652038574  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 2533, 128])
m.shape torch.Size([32225, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.552445411682129  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.552445411682129  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 32225, 128]), torch.Size([1, 32225, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.5831775665283203  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.76516056060791  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 32225, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.554506778717041  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.6141200065612793  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.6737332344055176  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.613654136657715  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([62509, 256])
first layer input nodes number: 122512
first layer output nodes number: 62509
edges number: 464789
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.6746482849121094  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7342615127563477  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7491650581359863  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7491650581359863  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

m.shape torch.Size([1696, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.840142250061035  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.840142250061035  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1696, 256]), torch.Size([1, 1696, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.843930721282959  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.871645450592041  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1696, 256])
m.shape torch.Size([1509, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8732857704162598  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8732857704162598  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1509, 256]), torch.Size([1, 1509, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8770060539245605  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9218249320983887  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1509, 256])
m.shape torch.Size([1177, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9245777130126953  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9245777130126953  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1177, 256]), torch.Size([1, 1177, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9268436431884766  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.978400707244873  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1177, 256])
m.shape torch.Size([898, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.981177806854248  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.981177806854248  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9828906059265137  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.041436672210693  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([764, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.044774055480957  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.044774055480957  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.046231269836426  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.099160194396973  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([594, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.1018571853637695  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.1018571853637695  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.10299015045166  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.151707649230957  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([533, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.154727458953857  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.154727458953857  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.1557440757751465  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.2065749168396  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([411, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.209227085113525  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.209227085113525  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.210011005401611  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.25601053237915  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([356, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.259495735168457  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.259495735168457  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.260174751281738  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.304501533508301  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([332, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.3073530197143555  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.3073530197143555  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.307986259460449  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.353832244873047  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.356486797332764  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.356486797332764  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.357022762298584  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.400627136230469  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([231, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.403023719787598  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.403023719787598  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.403464317321777  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.440915107727051  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([199, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.44318151473999  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.44318151473999  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.44356107711792  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.478480815887451  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.480672836303711  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.480672836303711  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.481010437011719  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.514432907104492  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([157, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5165276527404785  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5165276527404785  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.51682710647583  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.548569202423096  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.55074405670166  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.55074405670166  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.551009178161621  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.580967903137207  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.58307409286499  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.58307409286499  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5833353996276855  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.614692211151123  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([117, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.616585731506348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.616585731506348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.616808891296387  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.645150184631348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.646810054779053  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.646810054779053  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6469950675964355  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.671786785125732  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.673885822296143  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.673885822296143  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.674103260040283  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.704761981964111  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([73, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.706126689910889  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.706126689910889  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.706265926361084  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.72687292098999  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.728241443634033  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.728241443634033  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7283711433410645  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.748474597930908  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.749846935272217  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.749846935272217  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.74997091293335  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.770055294036865  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.771492958068848  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.771492958068848  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7716169357299805  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.792569160461426  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([1178, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.820812702178955  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.820812702178955  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1178, 256]), torch.Size([1, 1178, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.823147296905518  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.225429058074951  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1178, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.14651346206665  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.1487603187561035  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.150454521179199  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.148122787475586  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([11368, 40])
input nodes number: 62509
output nodes number: 11368
edges number: 92363
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.149028301239014  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.14902925491333  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08346128463745117  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

pseudo mini batch 1 input nodes size: 123120
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07202959060668945  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07202959060668945  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.1307377815246582  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.13082265853881836  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.0721440315246582  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07664060592651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07664060592651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07664060592651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([123120, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07664060592651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

m.shape torch.Size([3118, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.30860328674316406  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.30860328674316406  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3118, 128]), torch.Size([1, 3118, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.31157684326171875  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.33536529541015625  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3118, 128])
m.shape torch.Size([4002, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3376951217651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3376951217651367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 4002, 128]), torch.Size([1, 4002, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.34184741973876953  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4005308151245117  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 4002, 128])
m.shape torch.Size([4101, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40448904037475586  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40448904037475586  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 4101, 128]), torch.Size([1, 4101, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4084000587463379  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4944424629211426  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 4101, 128])
m.shape torch.Size([3872, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5002899169921875  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5002899169921875  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3872, 128]), torch.Size([1, 3872, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5041627883911133  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6167364120483398  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3872, 128])
m.shape torch.Size([3655, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6236042976379395  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6236042976379395  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3655, 128]), torch.Size([1, 3655, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6272644996643066  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7539291381835938  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3655, 128])
m.shape torch.Size([3314, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7616677284240723  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7616677284240723  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3314, 128]), torch.Size([1, 3314, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7650322914123535  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9054555892944336  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3314, 128])
m.shape torch.Size([3059, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.914085865020752  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.914085865020752  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 3059, 128]), torch.Size([1, 3059, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9170479774475098  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.066812515258789  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 3059, 128])
m.shape torch.Size([2792, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0760045051574707  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0760045051574707  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 2792, 128]), torch.Size([1, 2792, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0787944793701172  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2386579513549805  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 2792, 128])
m.shape torch.Size([2499, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2480511665344238  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2480511665344238  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 2499, 128]), torch.Size([1, 2499, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2505216598510742  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.4075570106506348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 2499, 128])
m.shape torch.Size([32713, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.5626153945922852  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.5626153945922852  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 32713, 128]), torch.Size([1, 32713, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.5938129425048828  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8118810653686523  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 32713, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.598454475402832  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.6586551666259766  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.718855857849121  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.65818452835083  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

torch.Size([63125, 256])
first layer input nodes number: 123120
first layer output nodes number: 63125
edges number: 470442
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7197751998901367  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7799758911132812  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.795936107635498  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.795936107635498  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

m.shape torch.Size([1597, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8888797760009766  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8888797760009766  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1597, 256]), torch.Size([1, 1597, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.89268159866333  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.918923854827881  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1597, 256])
m.shape torch.Size([1462, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.91945219039917  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.91945219039917  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1462, 256]), torch.Size([1, 1462, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9223976135253906  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9659976959228516  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1462, 256])
m.shape torch.Size([1182, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.968562602996826  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.968562602996826  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1182, 256]), torch.Size([1, 1182, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9708504676818848  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.022324085235596  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 1182, 256])
m.shape torch.Size([909, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.024610996246338  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.024610996246338  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.0263447761535645  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.082203388214111  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([745, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.085297107696533  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.085297107696533  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.0867180824279785  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.138685703277588  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([585, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.141348838806152  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.141348838806152  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 585, 256]), torch.Size([1, 585, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.142464637756348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.191980838775635  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 585, 256])
m.shape torch.Size([551, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.195130348205566  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.195130348205566  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 551, 256]), torch.Size([1, 551, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.196181297302246  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.25031852722168  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 551, 256])
m.shape torch.Size([446, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.253222465515137  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.253222465515137  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.254073143005371  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.303393363952637  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([367, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.306142807006836  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.306142807006836  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 367, 256]), torch.Size([1, 367, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.306842803955078  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.3527984619140625  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 367, 256])
m.shape torch.Size([301, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.355341911315918  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.355341911315918  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.3559160232543945  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.397347450256348  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([299, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.400221824645996  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.400221824645996  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.400792121887207  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.445812225341797  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([229, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.4481682777404785  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.4481682777404785  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.448605060577393  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.485731601715088  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.488387107849121  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.488387107849121  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.488825798034668  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5291852951049805  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([192, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.531549453735352  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.531549453735352  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.531915664672852  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.568170547485352  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([149, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.570135593414307  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.570135593414307  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.570419788360596  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.600544452667236  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.602939128875732  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.602939128875732  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.603194713592529  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.632075786590576  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([133, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.634121417999268  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.634121417999268  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.634375095367432  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.664816379547119  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([125, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6668524742126465  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6668524742126465  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.667090892791748  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6973700523376465  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.699277877807617  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.699277877807617  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.699489593505859  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7278594970703125  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([101, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7296953201293945  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7296953201293945  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.729887962341309  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.757050514221191  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.758993148803711  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.758993148803711  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.759185791015625  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.787696838378906  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([71, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.789102077484131  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.789102077484131  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.7892374992370605  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.810227870941162  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.811707973480225  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.811707973480225  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8118414878845215  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.833470821380615  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.834903717041016  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.834903717041016  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.835027694702148  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.855979919433594  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([1213, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.885440826416016  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.885440826416016  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

 h.shape torch.Size([1, 1213, 256]), torch.Size([1, 1213, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.887754440307617  GigaBytes
Max Memory Allocated: 5.32286262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.2970147132873535  GigaBytes
Max Memory Allocated: 5.325934886932373  GigaBytes

rst.shape  torch.Size([1, 1213, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.216264724731445  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.217958927154541  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.219653129577637  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.217874050140381  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 63125
output nodes number: 11368
edges number: 94588
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.21787691116333  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.217877388000488  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.08346033096313477  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 2 input nodes size: 123275
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07159137725830078  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07159137725830078  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.13037347793579102  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.13045835494995117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07166528701782227  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07607269287109375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07607269287109375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07607269287109375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([123275, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.07607269287109375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3307, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.30652284622192383  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.30652284622192383  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3307, 128]), torch.Size([1, 3307, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3096766471862793  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.33490705490112305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3307, 128])
m.shape torch.Size([3934, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3370819091796875  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3370819091796875  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3934, 128]), torch.Size([1, 3934, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.3417325019836426  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4004807472229004  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3934, 128])
m.shape torch.Size([4099, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4044685363769531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.4044685363769531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4099, 128]), torch.Size([1, 4099, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.40837764739990234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.49437808990478516  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4099, 128])
m.shape torch.Size([3919, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5002303123474121  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5002303123474121  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3919, 128]), torch.Size([1, 3919, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.5041165351867676  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6168513298034668  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3919, 128])
m.shape torch.Size([3773, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6239781379699707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6239781379699707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3773, 128]), torch.Size([1, 3773, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.6276459693908691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7581353187561035  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3773, 128])
m.shape torch.Size([3260, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7656631469726562  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.7656631469726562  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3260, 128]), torch.Size([1, 3260, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.768958568572998  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9081392288208008  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3260, 128])
m.shape torch.Size([2969, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9164948463439941  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9164948463439941  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2969, 128]), torch.Size([1, 2969, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 0.9193811416625977  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0614662170410156  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2969, 128])
m.shape torch.Size([2886, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0710597038269043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0710597038269043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2886, 128]), torch.Size([1, 2886, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.0738515853881836  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.232853889465332  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2886, 128])
m.shape torch.Size([2517, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2420144081115723  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2420144081115723  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2517, 128]), torch.Size([1, 2517, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.2444524765014648  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.4012718200683594  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2517, 128])
m.shape torch.Size([32357, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.554368495941162  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.554368495941162  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 32357, 128]), torch.Size([1, 32357, 128])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 1.5852265357971191  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7988810539245605  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 32357, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.588374137878418  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.6484756469726562  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7085771560668945  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.648005962371826  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([63021, 256])
first layer input nodes number: 123275
first layer output nodes number: 63021
edges number: 467667
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7094979286193848  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.769599437713623  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7846250534057617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.7846250534057617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1696, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8757987022399902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.8757987022399902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1696, 256]), torch.Size([1, 1696, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.879621982574463  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9073667526245117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1696, 256])
m.shape torch.Size([1438, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9085135459899902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9085135459899902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1438, 256]), torch.Size([1, 1438, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9113054275512695  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.953413486480713  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1438, 256])
m.shape torch.Size([1155, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9561705589294434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9561705589294434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1155, 256]), torch.Size([1, 1155, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 3.9584083557128906  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.007426738739014  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1155, 256])
m.shape torch.Size([943, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.010412216186523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.010412216186523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 943, 256]), torch.Size([1, 943, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.012210845947266  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.070430755615234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 943, 256])
m.shape torch.Size([773, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.073662757873535  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.073662757873535  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 773, 256]), torch.Size([1, 773, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.075137138366699  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.128340721130371  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 773, 256])
m.shape torch.Size([625, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.1312079429626465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.1312079429626465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.132400035858154  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.18457555770874  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([527, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.187525272369385  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.187525272369385  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 527, 256]), torch.Size([1, 527, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.188530445098877  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.238789081573486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 527, 256])
m.shape torch.Size([423, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.241539001464844  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.241539001464844  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.242345809936523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.289707183837891  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([376, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.292556285858154  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.292556285858154  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 376, 256]), torch.Size([1, 376, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.293273448944092  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.340407848358154  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 376, 256])
m.shape torch.Size([337, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.343288421630859  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.343288421630859  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.343931198120117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.391094207763672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([255, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.393468856811523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.393468856811523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.393955230712891  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.431892395019531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([247, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.434498310089111  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.434498310089111  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.434969425201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.4750142097473145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([205, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.477513790130615  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.477513790130615  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.477904796600342  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5138773918151855  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([164, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.515888690948486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.515888690948486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.516201496124268  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.547169208526611  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([167, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5494208335876465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.5494208335876465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.549739360809326  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.583503246307373  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([129, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.585328102111816  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.585328102111816  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.585574150085449  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.613377571105957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6153950691223145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.6153950691223145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.615644931793213  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.645628452301025  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.647458553314209  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.647458553314209  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.647674083709717  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.675046443939209  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.676764965057373  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.676764965057373  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.676955699920654  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.702514171600342  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([103, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.704399108886719  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.704399108886719  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.704595565795898  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.732295989990234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([81, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.734528064727783  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.734528064727783  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.734682559967041  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.757547855377197  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.759352684020996  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.759352684020996  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.759522438049316  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.785834312438965  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.786987781524658  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.786987781524658  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.787094593048096  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.804398059844971  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8061442375183105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8061442375183105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.80629301071167  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.831435680389404  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([1157, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8599958419799805  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8599958419799805  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1157, 256]), torch.Size([1, 1157, 256])
----------------------------------------3
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 4.8622941970825195  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.264398097991943  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1157, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.184218883514404  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.185922145843506  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.187616348266602  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.18582820892334  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 63021
output nodes number: 11368
edges number: 92515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.186391830444336  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5311279296875 GB
    Memory Allocated: 5.186392307281494  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08340120315551758  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 3 input nodes size: 123075
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07167434692382812  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07167434692382812  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13036108016967773  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1304459571838379  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0715789794921875  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0760807991027832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0760807991027832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0760807991027832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([123075, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0760807991027832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3228, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3063187599182129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3063187599182129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3228, 128]), torch.Size([1, 3228, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30939722061157227  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33500194549560547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3228, 128])
m.shape torch.Size([4057, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33733177185058594  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33733177185058594  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4057, 128]), torch.Size([1, 4057, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3412008285522461  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.39968299865722656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4057, 128])
m.shape torch.Size([4096, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4034590721130371  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4034590721130371  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4096, 128]), torch.Size([1, 4096, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.407625675201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.493563175201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4096, 128])
m.shape torch.Size([3933, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.499422550201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.499422550201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3933, 128]), torch.Size([1, 3933, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5032138824462891  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6168837547302246  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3933, 128])
m.shape torch.Size([3628, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6243853569030762  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6243853569030762  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3628, 128]), torch.Size([1, 3628, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.627845287322998  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7536540031433105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3628, 128])
m.shape torch.Size([3365, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7615513801574707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7615513801574707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3365, 128]), torch.Size([1, 3365, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7648859024047852  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9065694808959961  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3365, 128])
m.shape torch.Size([2970, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9148783683776855  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9148783683776855  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2970, 128]), torch.Size([1, 2970, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9177107810974121  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0601730346679688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2970, 128])
m.shape torch.Size([2748, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0697908401489258  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0697908401489258  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2748, 128]), torch.Size([1, 2748, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0725255012512207  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2228798866271973  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2748, 128])
m.shape torch.Size([2545, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2333626747131348  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2333626747131348  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2545, 128]), torch.Size([1, 2545, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2357897758483887  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.3920917510986328  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2545, 128])
m.shape torch.Size([32333, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5451750755310059  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5451750755310059  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 32333, 128]), torch.Size([1, 32333, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5760102272033691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.789367198944092  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 32333, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.578357696533203  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6383466720581055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.698335647583008  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.637877941131592  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([62903, 256])
first layer input nodes number: 123075
first layer output nodes number: 62903
edges number: 466701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6992549896240234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.759243965148926  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7742414474487305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7742414474487305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1683, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.865389347076416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.865389347076416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1683, 256]), torch.Size([1, 1683, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8695740699768066  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.896635055541992  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1683, 256])
m.shape torch.Size([1488, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8982625007629395  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8982625007629395  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1488, 256]), torch.Size([1, 1488, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.902017116546631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.944589138031006  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1488, 256])
m.shape torch.Size([1150, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9473094940185547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9473094940185547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9495506286621094  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9986419677734375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
m.shape torch.Size([951, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.001597881317139  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.001597881317139  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.003411769866943  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.061845302581787  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([784, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.065081596374512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.065081596374512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 784, 256]), torch.Size([1, 784, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.066576957702637  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.120409965515137  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 784, 256])
m.shape torch.Size([612, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.123191833496094  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.123191833496094  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 612, 256]), torch.Size([1, 612, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.124359130859375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.176261901855469  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 612, 256])
m.shape torch.Size([500, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.179042339324951  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.179042339324951  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.179996013641357  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2287211418151855  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([423, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.231496810913086  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.231496810913086  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.232303619384766  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.279478073120117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([359, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.282180309295654  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.282180309295654  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.282865047454834  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.327525615692139  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([336, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.330412864685059  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.330412864685059  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 336, 256]), torch.Size([1, 336, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.331053733825684  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.377484321594238  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 336, 256])
m.shape torch.Size([272, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.380039691925049  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.380039691925049  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.380558490753174  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.423598289489746  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([261, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.42634916305542  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.42634916305542  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.426846981048584  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.469970226287842  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([182, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4719953536987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4719953536987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.472342491149902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.504279136657715  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([176, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.506474018096924  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.506474018096924  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.506809711456299  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.540043354034424  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.542168140411377  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.542168140411377  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.542471408843994  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.574617862701416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([137, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576573371887207  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576573371887207  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576834678649902  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.606362342834473  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.608372211456299  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.608372211456299  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.608622074127197  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.63860559463501  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.640366554260254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.640366554260254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6405744552612305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.666977882385254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([95, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.668609142303467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.668609142303467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.668790340423584  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.693070888519287  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694710731506348  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694710731506348  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694882392883301  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.719086647033691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([87, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.720757007598877  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.720757007598877  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.720922946929932  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.745481967926025  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.74710750579834  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.74710750579834  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.747220039367676  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.764662742614746  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.765888690948486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.765888690948486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7659993171691895  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.783920764923096  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.785387992858887  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.785387992858887  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.785513877868652  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.806788444519043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1200, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.836246013641357  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.836246013641357  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1200, 256]), torch.Size([1, 1200, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.838534832000732  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.244480133056641  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1200, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.165787696838379  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.167481899261475  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.16917610168457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1673970222473145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 62903
output nodes number: 11368
edges number: 92348
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.167941570281982  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.167942047119141  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08370828628540039  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 4 input nodes size: 122972
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07156991958618164  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07156991958618164  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13020753860473633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13029241561889648  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07569026947021484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07569026947021484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07569026947021484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([122972, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07569026947021484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3161, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3058929443359375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3058929443359375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3161, 128]), torch.Size([1, 3161, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30890750885009766  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3339524269104004  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3161, 128])
m.shape torch.Size([4017, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3362760543823242  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3362760543823242  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4017, 128]), torch.Size([1, 4017, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.34108591079711914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.39975500106811523  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4017, 128])
m.shape torch.Size([4040, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40361881256103516  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40361881256103516  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4040, 128]), torch.Size([1, 4040, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4074716567993164  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4933023452758789  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4040, 128])
m.shape torch.Size([3924, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.49886035919189453  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.49886035919189453  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5026803016662598  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6160664558410645  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([3665, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6222772598266602  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6222772598266602  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3665, 128]), torch.Size([1, 3665, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6265521049499512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7529950141906738  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3665, 128])
m.shape torch.Size([3285, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.760338306427002  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.760338306427002  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3285, 128]), torch.Size([1, 3285, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7636265754699707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9071416854858398  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3285, 128])
m.shape torch.Size([2980, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9155220985412598  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9155220985412598  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2980, 128]), torch.Size([1, 2980, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9185500144958496  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0606474876403809  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2980, 128])
m.shape torch.Size([2706, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0695490837097168  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0695490837097168  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2706, 128]), torch.Size([1, 2706, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0721626281738281  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2204322814941406  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2706, 128])
m.shape torch.Size([2535, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2300209999084473  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2300209999084473  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2535, 128]), torch.Size([1, 2535, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2325935363769531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.3899435997009277  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2535, 128])
m.shape torch.Size([32446, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5434494018554688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5434494018554688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 32446, 128]), torch.Size([1, 32446, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.574392318725586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.789764404296875  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 32446, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.579214096069336  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.639065742492676  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6989173889160156  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6385979652404785  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([62759, 256])
first layer input nodes number: 122972
first layer output nodes number: 62759
edges number: 466829
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.699835777282715  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7596874237060547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7746505737304688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7746505737304688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1673, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.865914821624756  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.865914821624756  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1673, 256]), torch.Size([1, 1673, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8697123527526855  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.897453784942627  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1673, 256])
m.shape torch.Size([1448, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.898642063140869  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.898642063140869  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1448, 256]), torch.Size([1, 1448, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9015703201293945  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.944430351257324  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1448, 256])
m.shape torch.Size([1160, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9471354484558105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9471354484558105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1160, 256]), torch.Size([1, 1160, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.949474811553955  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.001321315765381  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1160, 256])
m.shape torch.Size([945, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.004303455352783  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.004303455352783  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 945, 256]), torch.Size([1, 945, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.006105899810791  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.063835620880127  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 945, 256])
m.shape torch.Size([815, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0670247077941895  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0670247077941895  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.068579196929932  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.128270626068115  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([614, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1310343742370605  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1310343742370605  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 614, 256]), torch.Size([1, 614, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.132205486297607  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.184115886688232  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 614, 256])
m.shape torch.Size([474, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1867194175720215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1867194175720215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 474, 256]), torch.Size([1, 474, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.187623500823975  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2328667640686035  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 474, 256])
m.shape torch.Size([423, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2356672286987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2356672286987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.23647403717041  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.282855033874512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([377, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.285713195800781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.285713195800781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.286432266235352  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.334118843078613  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([335, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.336979389190674  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.336979389190674  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 335, 256]), torch.Size([1, 335, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.337618350982666  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.384188175201416  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 335, 256])
m.shape torch.Size([281, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.386839866638184  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.386839866638184  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.387375831604004  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.430205821990967  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([262, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.432960033416748  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.432960033416748  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.433459758758545  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.476714611053467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([195, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.478901386260986  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.478901386260986  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.479273319244385  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.513491153717041  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([175, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.515660285949707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.515660285949707  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.515994071960449  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.549038887023926  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.551207542419434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.551207542419434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.551516532897949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5842695236206055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5862531661987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5862531661987305  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.586508750915527  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.615389823913574  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([121, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.617239475250244  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.617239475250244  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6174702644348145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.645164966583252  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6470046043396  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6470046043396  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.647220134735107  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6745924949646  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([88, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.676092147827148  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.676092147827148  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.676259994506836  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.698751449584961  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.700512886047363  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.700512886047363  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.700695991516113  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.726513862609863  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728501319885254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728501319885254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728697776794434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.757773399353027  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.759007453918457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.759007453918457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.759127616882324  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.777752876281738  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.778931140899658  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.778931140899658  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.779037952423096  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.796341419219971  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.797603130340576  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.797603130340576  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7977118492126465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.816085338592529  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([1198, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.844922065734863  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.844922065734863  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1198, 256]), torch.Size([1, 1198, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8476972579956055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.25332498550415  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1198, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.173553943634033  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.176018238067627  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.177712440490723  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.175163269042969  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 62759
output nodes number: 11368
edges number: 92665
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.175715923309326  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.175716400146484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0832662582397461  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 5 input nodes size: 122675
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07152080535888672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13011455535888672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13019943237304688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07610654830932617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07610654830932617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07610654830932617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([122675, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07610654830932617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3184, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3080892562866211  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3080892562866211  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3184, 128]), torch.Size([1, 3184, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3111257553100586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33634424209594727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3184, 128])
m.shape torch.Size([4075, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.338712215423584  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.338712215423584  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4075, 128]), torch.Size([1, 4075, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.34330224990844727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4019160270690918  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4075, 128])
m.shape torch.Size([4036, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40580224990844727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40580224990844727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4036, 128]), torch.Size([1, 4036, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4096512794494629  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.49570322036743164  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4036, 128])
m.shape torch.Size([3816, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5014767646789551  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5014767646789551  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3816, 128]), torch.Size([1, 3816, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5051159858703613  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6116166114807129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3816, 128])
m.shape torch.Size([3647, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6184921264648438  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6184921264648438  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3647, 128]), torch.Size([1, 3647, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6219701766967773  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7479839324951172  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3647, 128])
m.shape torch.Size([3280, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7552270889282227  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7552270889282227  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3280, 128]), torch.Size([1, 3280, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7585721015930176  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9018363952636719  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3280, 128])
m.shape torch.Size([2984, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9093055725097656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9093055725097656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2984, 128]), torch.Size([1, 2984, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9131507873535156  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0562858581542969  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2984, 128])
m.shape torch.Size([2783, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0654792785644531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0654792785644531  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2783, 128]), torch.Size([1, 2783, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0681967735290527  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2271909713745117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2783, 128])
m.shape torch.Size([2552, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.235863208770752  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.235863208770752  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2552, 128]), torch.Size([1, 2552, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2382993698120117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.395430564880371  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2552, 128])
m.shape torch.Size([32690, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5504636764526367  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5504636764526367  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 32690, 128]), torch.Size([1, 32690, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.581639289855957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7995710372924805  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 32690, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.58811616897583  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.648242473602295  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7083687782287598  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6477723121643066  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([63047, 256])
first layer input nodes number: 122675
first layer output nodes number: 63047
edges number: 469641
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.709284782409668  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.769411087036133  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.784442901611328  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.784442901611328  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1686, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.876467704772949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.876467704772949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1686, 256]), torch.Size([1, 1686, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.88021183013916  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9082045555114746  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1686, 256])
m.shape torch.Size([1503, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9087581634521484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9087581634521484  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1503, 256]), torch.Size([1, 1503, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9118404388427734  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.957538604736328  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1503, 256])
m.shape torch.Size([1182, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9600753784179688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9600753784179688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1182, 256]), torch.Size([1, 1182, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9623537063598633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.013695240020752  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1182, 256])
m.shape torch.Size([899, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.016538619995117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.016538619995117  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.018253326416016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.074148178100586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([758, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.077262878417969  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.077262878417969  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 758, 256]), torch.Size([1, 758, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.078708648681641  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.131320953369141  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 758, 256])
m.shape torch.Size([596, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.134035110473633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.134035110473633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.135171890258789  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.184053421020508  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([467, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.186627388000488  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.186627388000488  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.187518119812012  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.232054710388184  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([457, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.235123634338379  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.235123634338379  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.235995292663574  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.286389350891113  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([363, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.289093971252441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.289093971252441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.289786338806152  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.335331916809082  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([311, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.337975025177002  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.337975025177002  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.338568210601807  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.3808979988098145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([271, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.383466720581055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.383466720581055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.383983612060547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.425666809082031  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([236, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.428130626678467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.428130626678467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4285807609558105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.466842174530029  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([190, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.46925163269043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.46925163269043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.469614028930664  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.502954483032227  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([173, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.505101203918457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.505101203918457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.505431175231934  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.538098335266113  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([167, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.540341377258301  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.540341377258301  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5406599044799805  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.574423789978027  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([129, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576248645782471  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576248645782471  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5764946937561035  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.604298114776611  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.606413841247559  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.606413841247559  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.606675148010254  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.638031959533691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.639787197113037  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.639787197113037  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.639995098114014  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.666398525238037  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.668358325958252  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.668358325958252  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.66857385635376  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.697454929351807  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([99, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.699250221252441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.699250221252441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.69943904876709  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7260637283325195  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([95, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.727887153625488  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.727887153625488  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7280683517456055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.754885673522949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([69, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.756254196166992  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.756254196166992  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.756385803222656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.776784896850586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.778216361999512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.778216361999512  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.778342247009277  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.798735618591309  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.800103187561035  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.800103187561035  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8002214431762695  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.820206642150879  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([1230, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.85044002532959  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.85044002532959  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1230, 256]), torch.Size([1, 1230, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.852786064147949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.276734828948975  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1230, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.196784019470215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.199067115783691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.200761318206787  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.19839334487915  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 63047
output nodes number: 11368
edges number: 93463
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.198948383331299  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.198948860168457  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08345270156860352  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 6 input nodes size: 122423
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1298527717590332  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.12993764877319336  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0712590217590332  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([122423, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3180, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3045358657836914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3045358657836914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3180, 128]), torch.Size([1, 3180, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3075685501098633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3322916030883789  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3180, 128])
m.shape torch.Size([3975, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3345661163330078  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3345661163330078  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3975, 128]), torch.Size([1, 3975, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33835697174072266  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3966045379638672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3975, 128])
m.shape torch.Size([4058, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4005141258239746  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4005141258239746  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4058, 128]), torch.Size([1, 4058, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4047665596008301  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.49077653884887695  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4058, 128])
m.shape torch.Size([3855, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4960494041442871  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4960494041442871  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3855, 128]), torch.Size([1, 3855, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4999675750732422  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6142287254333496  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3855, 128])
m.shape torch.Size([3774, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6215815544128418  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6215815544128418  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3774, 128]), torch.Size([1, 3774, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6251974105834961  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7552981376647949  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3774, 128])
m.shape torch.Size([3289, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7629084587097168  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7629084587097168  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3289, 128]), torch.Size([1, 3289, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.766075611114502  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9058475494384766  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3289, 128])
m.shape torch.Size([3048, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9137415885925293  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9137415885925293  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3048, 128]), torch.Size([1, 3048, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9175567626953125  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0679931640625  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3048, 128])
m.shape torch.Size([2879, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0775222778320312  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0775222778320312  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2879, 128]), torch.Size([1, 2879, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0803484916687012  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2393441200256348  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2879, 128])
m.shape torch.Size([2515, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2487645149230957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2487645149230957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2515, 128]), torch.Size([1, 2515, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2512211799621582  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.4086909294128418  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2515, 128])
m.shape torch.Size([31861, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5594167709350586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5594167709350586  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 31861, 128]), torch.Size([1, 31861, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5898017883300781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.747138023376465  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 31861, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.5380983352661133  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.597640037536621  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.657181739807129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.597174644470215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([62434, 256])
first layer input nodes number: 122423
first layer output nodes number: 62434
edges number: 462941
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6580958366394043  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.717637538909912  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.732522964477539  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.732522964477539  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1688, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.82424259185791  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.82424259185791  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1688, 256]), torch.Size([1, 1688, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.827702522277832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.854153633117676  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1688, 256])
m.shape torch.Size([1403, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8552021980285645  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8552021980285645  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1403, 256]), torch.Size([1, 1403, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8579506874084473  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9002809524536133  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1403, 256])
m.shape torch.Size([1131, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9020519256591797  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9020519256591797  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.904886245727539  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9577746391296387  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([882, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9595465660095215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9595465660095215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.961228847503662  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.021049499511719  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([786, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.024576663970947  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.024576663970947  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 786, 256]), torch.Size([1, 786, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.026075839996338  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0800461769104  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 786, 256])
m.shape torch.Size([608, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.082802772521973  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.082802772521973  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.083962440490723  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.136168003082275  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([526, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.139127254486084  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.139127254486084  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 526, 256]), torch.Size([1, 526, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.140130519866943  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.190451145172119  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 526, 256])
m.shape torch.Size([455, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.193448066711426  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.193448066711426  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1943159103393555  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.245215892791748  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 455, 256])
m.shape torch.Size([397, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.248216152191162  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.248216152191162  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.248973369598389  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.300369739532471  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([355, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.303403377532959  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.303403377532959  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.304080486297607  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.352981090545654  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([283, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.355634689331055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.355634689331055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 283, 256]), torch.Size([1, 283, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.356174468994141  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.399498462677002  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 283, 256])
m.shape torch.Size([253, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.402146816253662  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.402146816253662  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.402629375457764  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4436469078063965  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([215, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.446092128753662  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.446092128753662  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.446502208709717  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.484229564666748  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([186, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.486527442932129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.486527442932129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.486882209777832  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.522004127502441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.524162292480469  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.524162292480469  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.524471282958984  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.557224273681641  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([163, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.559576511383057  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.559576511383057  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.559887409210205  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5950188636779785  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([115, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.596742630004883  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.596742630004883  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.596961975097656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.623283386230469  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([129, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.625405788421631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.625405788421631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.625651836395264  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.656899929046631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.658639907836914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.658639907836914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.658834457397461  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.684904098510742  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.686767578125  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.686767578125  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.686962127685547  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.714393615722656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.716133117675781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.716133117675781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.716306686401367  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.741994857788086  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7433037757873535  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7433037757873535  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.743429660797119  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.762941837310791  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([82, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7646918296813965  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7646918296813965  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.764848232269287  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.790185451507568  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7917680740356445  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7917680740356445  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.791905403137207  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8151140213012695  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([1116, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.841860771179199  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.841860771179199  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1116, 256]), torch.Size([1, 1116, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.844088554382324  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.225945472717285  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.145488739013672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.147218704223633  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.148948669433594  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.147133827209473  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([11368, 40])
input nodes number: 62434
output nodes number: 11368
edges number: 93156
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.147719860076904  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1477203369140625  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08379936218261719  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

pseudo mini batch 7 input nodes size: 123613
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07129478454589844  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07129478454589844  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13023805618286133  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13032293319702148  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07186222076416016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07613468170166016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07613468170166016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07613468170166016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([123613, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07613468170166016  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([3167, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30811643600463867  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30811643600463867  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3167, 128]), torch.Size([1, 3167, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.31113672256469727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3357229232788086  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3167, 128])
m.shape torch.Size([4021, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33804750442504883  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33804750442504883  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4021, 128]), torch.Size([1, 4021, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.34281063079833984  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4014759063720703  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4021, 128])
m.shape torch.Size([4023, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40531349182128906  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40531349182128906  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 4023, 128]), torch.Size([1, 4023, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4091501235961914  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4949483871459961  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 4023, 128])
m.shape torch.Size([3926, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5005183219909668  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5005183219909668  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3926, 128]), torch.Size([1, 3926, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5043520927429199  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6177959442138672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3926, 128])
m.shape torch.Size([3691, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6240754127502441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6240754127502441  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3691, 128]), torch.Size([1, 3691, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6283559799194336  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7554187774658203  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3691, 128])
m.shape torch.Size([3295, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7629146575927734  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7629146575927734  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3295, 128]), torch.Size([1, 3295, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7667770385742188  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9083805084228516  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3295, 128])
m.shape torch.Size([3016, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9161992073059082  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9161992073059082  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 3016, 128]), torch.Size([1, 3016, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9192543029785156  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0699400901794434  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 3016, 128])
m.shape torch.Size([2808, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0792136192321777  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0792136192321777  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2808, 128]), torch.Size([1, 2808, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0820846557617188  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2410125732421875  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2808, 128])
m.shape torch.Size([2601, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.25083589553833  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.25083589553833  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 2601, 128]), torch.Size([1, 2601, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2534151077270508  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.417870044708252  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 2601, 128])
m.shape torch.Size([32592, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5728797912597656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5728797912597656  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 32592, 128]), torch.Size([1, 32592, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.6039619445800781  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8205299377441406  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 32592, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.608090877532959  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6683058738708496  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7285208702087402  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.667835235595703  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

torch.Size([63140, 256])
first layer input nodes number: 123613
first layer output nodes number: 63140
edges number: 470112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7294440269470215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.789659023284912  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8047127723693848  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8047127723693848  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

m.shape torch.Size([1709, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8964571952819824  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8964571952819824  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1709, 256]), torch.Size([1, 1709, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.900247573852539  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.927705764770508  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1709, 256])
m.shape torch.Size([1455, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9293575286865234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9293575286865234  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1455, 256]), torch.Size([1, 1455, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9323058128356934  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.975757598876953  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1455, 256])
m.shape torch.Size([1140, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9783859252929688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9783859252929688  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1140, 256]), torch.Size([1, 1140, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9806976318359375  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.032626628875732  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1140, 256])
m.shape torch.Size([893, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.035556316375732  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.035556316375732  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 893, 256]), torch.Size([1, 893, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.037259578704834  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.093657970428467  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 893, 256])
m.shape torch.Size([797, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.096826553344727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.096826553344727  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.098346710205078  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.156871795654297  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([634, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.159768104553223  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.159768104553223  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 634, 256]), torch.Size([1, 634, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.160977363586426  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.21334171295166  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 634, 256])
m.shape torch.Size([467, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.215879440307617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.215879440307617  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.216770172119141  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2613067626953125  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([434, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2641987800598145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2641987800598145  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.265026569366455  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.313145160675049  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([381, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.3160271644592285  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.3160271644592285  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.31675386428833  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.364485263824463  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([292, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.366928577423096  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.366928577423096  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.367485523223877  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4086995124816895  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.41118049621582  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.41118049621582  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.411678314208984  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.451684474945068  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([218, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.453949928283691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.453949928283691  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4543657302856445  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.48970890045166  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([240, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.492499828338623  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.492499828338623  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.492957592010498  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.535071849822998  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([191, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.537413120269775  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.537413120269775  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.537777423858643  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.573843479156494  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([166, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576054573059082  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576054573059082  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.576371192932129  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.609932899475098  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.612020015716553  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.612020015716553  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.612298488616943  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.643765926361084  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([125, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.645669460296631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.645669460296631  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.645907878875732  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.67451810836792  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([133, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.676700115203857  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.676700115203857  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6769537925720215  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.709170818328857  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([130, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.711661338806152  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.711661338806152  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.711909294128418  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.745135307312012  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.74697208404541  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.74697208404541  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.747166633605957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.774598121643066  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7762370109558105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7762370109558105  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.776401042938232  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.80067777633667  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([71, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.802097320556641  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.802097320556641  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.80223274230957  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.823223114013672  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824614524841309  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824614524841309  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824740409851074  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8451337814331055  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.846455097198486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.846455097198486  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.846569538116455  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.865910053253174  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([1168, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.894556999206543  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.894556999206543  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

 h.shape torch.Size([1, 1168, 256]), torch.Size([1, 1168, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.896784782409668  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.298094749450684  GigaBytes
Max Memory Allocated: 5.328428268432617  GigaBytes

rst.shape  torch.Size([1, 1168, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.2180256843566895  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.219841480255127  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.2215352058410645  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.219634532928467  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([11365, 40])
input nodes number: 63140
output nodes number: 11365
edges number: 93152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.22015380859375  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.220154285430908  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0834507942199707  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0834507942199707  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0834507942199707  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04269632697105408 |0.0036522746086120605 |0.13492509722709656 |9.548664093017578e-05 |0.0787847638130188 |0.0052111148834228516 |
----------------------------------------------------------pseudo_mini_loss sum 4.11433219909668
Total (block generation + training)time/epoch 7.170957326889038
Training time/epoch 2.1499216556549072
Training time without block to device /epoch 2.1207034587860107
Training time without total dataloading part /epoch 1.715653896331787
load block tensor time/epoch 0.3415706157684326
block to device time/epoch 0.029218196868896484
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  1486603
Number of first layer input nodes during this epoch:  983665
Number of first layer output nodes during this epoch:  502938
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0834503173828125  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0200192928314209
number of batches is  8
batch size is  11368
range selection method spend 0.013493776321411133
time for parepare:  0.017959117889404297
local_output_nid generation:  0.002796173095703125
local_in_edges_tensor generation:  0.004827737808227539
mini_batch_src_global generation:  0.0029077529907226562
r_  generation:  0.03385519981384277
local_output_nid generation:  0.003259897232055664
local_in_edges_tensor generation:  0.0019042491912841797
mini_batch_src_global generation:  0.0038652420043945312
r_  generation:  0.037125349044799805
local_output_nid generation:  0.0034363269805908203
local_in_edges_tensor generation:  0.002009153366088867
mini_batch_src_global generation:  0.0026471614837646484
r_  generation:  0.03671741485595703
local_output_nid generation:  0.003294229507446289
local_in_edges_tensor generation:  0.0018863677978515625
mini_batch_src_global generation:  0.0025343894958496094
r_  generation:  0.03683590888977051
local_output_nid generation:  0.003364086151123047
local_in_edges_tensor generation:  0.0016317367553710938
mini_batch_src_global generation:  0.0026061534881591797
r_  generation:  0.03722667694091797
local_output_nid generation:  0.0033020973205566406
local_in_edges_tensor generation:  0.0016045570373535156
mini_batch_src_global generation:  0.002718210220336914
r_  generation:  0.03801369667053223
local_output_nid generation:  0.0032944679260253906
local_in_edges_tensor generation:  0.0017299652099609375
mini_batch_src_global generation:  0.0029251575469970703
r_  generation:  0.038434505462646484
local_output_nid generation:  0.0032591819763183594
local_in_edges_tensor generation:  0.001638650894165039
mini_batch_src_global generation:  0.002731800079345703
r_  generation:  0.03904294967651367
----------------------check_connections_block total spend ----------------------------- 0.4487180709838867
generate_one_block  0.06044769287109375
generate_one_block  0.05466437339782715
generate_one_block  0.05312490463256836
generate_one_block  0.05262351036071777
generate_one_block  0.051698923110961914
generate_one_block  0.054535865783691406
generate_one_block  0.05341839790344238
generate_one_block  0.05352902412414551
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.024951457977294922
gen group dst list time:  0.01424264907836914
time for parepare:  0.020290136337280273
local_output_nid generation:  0.010302305221557617
local_in_edges_tensor generation:  0.020598173141479492
mini_batch_src_global generation:  0.014719486236572266
r_  generation:  0.1674354076385498
local_output_nid generation:  0.01626300811767578
local_in_edges_tensor generation:  0.014961719512939453
mini_batch_src_global generation:  0.021277427673339844
r_  generation:  0.1757950782775879
local_output_nid generation:  0.01563096046447754
local_in_edges_tensor generation:  0.01459813117980957
mini_batch_src_global generation:  0.017560482025146484
r_  generation:  0.1782364845275879
local_output_nid generation:  0.015517473220825195
local_in_edges_tensor generation:  0.012782096862792969
mini_batch_src_global generation:  0.018695354461669922
r_  generation:  0.17849969863891602
local_output_nid generation:  0.01582932472229004
local_in_edges_tensor generation:  0.012427091598510742
mini_batch_src_global generation:  0.019177913665771484
r_  generation:  0.17910075187683105
local_output_nid generation:  0.016072750091552734
local_in_edges_tensor generation:  0.012720584869384766
mini_batch_src_global generation:  0.01986384391784668
r_  generation:  0.18839120864868164
local_output_nid generation:  0.016611099243164062
local_in_edges_tensor generation:  0.01471710205078125
mini_batch_src_global generation:  0.01989126205444336
r_  generation:  0.18427777290344238
local_output_nid generation:  0.016312360763549805
local_in_edges_tensor generation:  0.013706684112548828
mini_batch_src_global generation:  0.022743940353393555
r_  generation:  0.17963171005249023
----------------------check_connections_block total spend ----------------------------- 2.170290470123291
generate_one_block  0.2235269546508789
generate_one_block  0.2194201946258545
generate_one_block  0.22029638290405273
generate_one_block  0.215576171875
generate_one_block  0.21933603286743164
generate_one_block  0.22549057006835938
generate_one_block  0.22312259674072266
generate_one_block  0.22475695610046387
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0834503173828125  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

connection checking time:  2.170290470123291
block generation total time  1.7715258598327637
average batch blocks generation time:  0.22144073247909546
block dataloader generation time/epoch 5.018360137939453
pseudo mini batch 0 input nodes size: 123071
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07182502746582031  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07182502746582031  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1305098533630371  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13059473037719727  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07156658172607422  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07606363296508789  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07606363296508789  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07606363296508789  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([123071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07606363296508789  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

m.shape torch.Size([3200, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3048577308654785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3048577308654785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3200, 128]), torch.Size([1, 3200, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3079094886779785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33318281173706055  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3200, 128])
m.shape torch.Size([4148, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33561277389526367  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33561277389526367  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 4148, 128]), torch.Size([1, 4148, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3404855728149414  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3998231887817383  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 4148, 128])
m.shape torch.Size([4085, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.403688907623291  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.403688907623291  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 4085, 128]), torch.Size([1, 4085, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40761470794677734  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4935312271118164  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 4085, 128])
m.shape torch.Size([3884, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4993748664855957  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4993748664855957  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3884, 128]), torch.Size([1, 3884, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5031142234802246  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6163067817687988  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3884, 128])
m.shape torch.Size([3746, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6233859062194824  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6233859062194824  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3746, 128]), torch.Size([1, 3746, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6270351409912109  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7557096481323242  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3746, 128])
m.shape torch.Size([3296, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7633533477783203  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7633533477783203  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3296, 128]), torch.Size([1, 3296, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7666912078857422  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9066438674926758  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3296, 128])
m.shape torch.Size([3003, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9150958061218262  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9150958061218262  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3003, 128]), torch.Size([1, 3003, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9181933403015137  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0687155723571777  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3003, 128])
m.shape torch.Size([2793, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0787391662597656  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0787391662597656  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 2793, 128]), torch.Size([1, 2793, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0814094543457031  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2386984825134277  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 2793, 128])
m.shape torch.Size([2577, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.24753999710083  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.24753999710083  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 2577, 128]), torch.Size([1, 2577, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.249997615814209  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.4075818061828613  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 2577, 128])
m.shape torch.Size([32009, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5589838027954102  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5589838027954102  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 32009, 128]), torch.Size([1, 32009, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5895099639892578  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7568674087524414  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 32009, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.5474038124084473  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.607238292694092  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6670727729797363  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6067705154418945  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([62741, 256])
first layer input nodes number: 123071
first layer output nodes number: 62741
edges number: 464441
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6679916381835938  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7278261184692383  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7427849769592285  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7427849769592285  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

m.shape torch.Size([1655, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.83347749710083  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.83347749710083  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1655, 256]), torch.Size([1, 1655, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8372116088867188  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.864025115966797  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1655, 256])
m.shape torch.Size([1532, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8651208877563477  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8651208877563477  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1532, 256]), torch.Size([1, 1532, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.868889808654785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.914194107055664  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1532, 256])
m.shape torch.Size([1202, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9170284271240234  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9170284271240234  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9197921752929688  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.973341941833496  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([915, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9761900901794434  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9761900901794434  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 915, 256]), torch.Size([1, 915, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.977935314178467  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.037879467010498  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 915, 256])
m.shape torch.Size([787, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.041304588317871  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.041304588317871  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0428056716918945  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.096844673156738  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([633, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.09974479675293  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.09974479675293  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 633, 256]), torch.Size([1, 633, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1009521484375  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.154389381408691  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 633, 256])
m.shape torch.Size([486, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.157055854797363  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.157055854797363  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.15798282623291  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.204331398010254  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([434, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.207205295562744  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.207205295562744  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.208033084869385  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.255360126495361  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([375, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.258190155029297  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.258190155029297  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.258905410766602  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.305338382720947  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([300, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.307864189147949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.307864189147949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.308436393737793  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.350457668304443  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.353015899658203  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.353015899658203  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.35352897644043  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.394975185394287  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([240, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.397486686706543  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.397486686706543  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.397944450378418  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.436854362487793  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([193, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.43906307220459  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.43906307220459  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.439431190490723  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.473298072814941  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([183, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.475576877593994  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.475576877593994  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.475925922393799  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.510481357574463  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.512628078460693  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.512628078460693  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.512935161590576  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.545485973358154  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([130, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.547331809997559  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.547331809997559  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.547579765319824  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.57559871673584  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.577615261077881  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.577615261077881  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.577865123748779  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.607848644256592  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([130, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.609972953796387  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.609972953796387  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.610220909118652  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.641711235046387  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([94, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.643303871154785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.643303871154785  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6434831619262695  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.667508125305176  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([87, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.66909122467041  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.66909122467041  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.669257164001465  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.692654609680176  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([89, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694368362426758  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694368362426758  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694538116455078  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.719661712646484  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.720993995666504  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.720993995666504  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.721121788024902  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.74092960357666  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.742772579193115  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.742772579193115  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.742904186248779  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.764224529266357  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.765635013580322  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.765635013580322  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.765757083892822  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.786386966705322  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1142, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8137664794921875  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.8137664794921875  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1142, 256]), torch.Size([1, 1142, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.815944671630859  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.200893402099609  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1142, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1222243309021  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.123918533325195  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.125612735748291  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.123833656311035  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([11368, 40])
input nodes number: 62741
output nodes number: 11368
edges number: 91481
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.124386787414551  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.124387741088867  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08333778381347656  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

pseudo mini batch 1 input nodes size: 123348
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07156801223754883  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07156801223754883  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1303849220275879  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13046979904174805  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0717000961303711  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07608699798583984  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07608699798583984  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07608699798583984  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([123348, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07608699798583984  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

m.shape torch.Size([3253, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3096776008605957  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3096776008605957  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3253, 128]), torch.Size([1, 3253, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.31277990341186523  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3384413719177246  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3253, 128])
m.shape torch.Size([3884, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3405942916870117  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3405942916870117  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3884, 128]), torch.Size([1, 3884, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.34485816955566406  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4036540985107422  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3884, 128])
m.shape torch.Size([4131, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4069027900695801  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4069027900695801  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 4131, 128]), torch.Size([1, 4131, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4115333557128906  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4984250068664551  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 4131, 128])
m.shape torch.Size([3820, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5042009353637695  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5042009353637695  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3820, 128]), torch.Size([1, 3820, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.50787353515625  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6164278984069824  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3820, 128])
m.shape torch.Size([3612, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6232180595397949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6232180595397949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3612, 128]), torch.Size([1, 3612, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6266746520996094  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.75274658203125  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3612, 128])
m.shape torch.Size([3303, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7604742050170898  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7604742050170898  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3303, 128]), torch.Size([1, 3303, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7638611793518066  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9031405448913574  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3303, 128])
m.shape torch.Size([3074, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9111948013305664  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9111948013305664  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 3074, 128]), torch.Size([1, 3074, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.914952278137207  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.066298007965088  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 3074, 128])
m.shape torch.Size([2838, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0756583213806152  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0756583213806152  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 2838, 128]), torch.Size([1, 2838, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.078477382659912  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.237433910369873  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 2838, 128])
m.shape torch.Size([2505, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.246830940246582  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.246830940246582  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 2505, 128]), torch.Size([1, 2505, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2495346069335938  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.4057846069335938  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 2505, 128])
m.shape torch.Size([32959, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.561750888824463  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.561750888824463  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 32959, 128]), torch.Size([1, 32959, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5931830406188965  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8248658180236816  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 32959, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6119112968444824  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.672354221343994  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.732797145843506  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.671881675720215  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

torch.Size([63379, 256])
first layer input nodes number: 123348
first layer output nodes number: 63379
edges number: 472929
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7337183952331543  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.794161319732666  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8096323013305664  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8096323013305664  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

m.shape torch.Size([1720, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.902629852294922  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.902629852294922  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1720, 256]), torch.Size([1, 1720, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.906423568725586  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9344992637634277  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1720, 256])
m.shape torch.Size([1380, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9350953102111816  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9350953102111816  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1380, 256]), torch.Size([1, 1380, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.937999725341797  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.979104518890381  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1380, 256])
m.shape torch.Size([1208, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.981281280517578  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.981281280517578  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.983616352081299  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.038242816925049  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([889, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.040495872497559  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.040495872497559  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 889, 256]), torch.Size([1, 889, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.042191505432129  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.096451759338379  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 889, 256])
m.shape torch.Size([744, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.099447250366211  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.099447250366211  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.100866317749023  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.151952743530273  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([596, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.154680252075195  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.154680252075195  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 596, 256]), torch.Size([1, 596, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.155817031860352  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.204866409301758  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 596, 256])
m.shape torch.Size([489, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.207588195800781  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.207588195800781  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 489, 256]), torch.Size([1, 489, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.208520889282227  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.257416725158691  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 489, 256])
m.shape torch.Size([444, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.260364532470703  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.260364532470703  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.261211395263672  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.31121826171875  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([373, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.314021587371826  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.314021587371826  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.314733028411865  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.36146879196167  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([307, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.364063739776611  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.364063739776611  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.364649295806885  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.407360553741455  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([287, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.410102367401123  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.410102367401123  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 287, 256]), torch.Size([1, 287, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.41064977645874  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.453482151031494  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 287, 256])
m.shape torch.Size([247, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.456057548522949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.456057548522949  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.456528663635254  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.496573448181152  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([204, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.498887062072754  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.498887062072754  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.499276161193848  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.535073280334473  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([178, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.53727388381958  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.53727388381958  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.537613391876221  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.571224689483643  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([150, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.573217868804932  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.573217868804932  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.5735039710998535  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.603830814361572  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([149, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6059794425964355  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6059794425964355  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.606263637542725  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.638377666473389  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.640294551849365  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.640294551849365  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6405348777771  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.669373989105225  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([125, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.671416759490967  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.671416759490967  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.671655178070068  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.701934337615967  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([120, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.704006671905518  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.704006671905518  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.704235553741455  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.73490571975708  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([112, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.736944198608398  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.736944198608398  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.737157821655273  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.767278671264648  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([98, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.769201755523682  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.769201755523682  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.769388675689697  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.79705286026001  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7982072830200195  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7982072830200195  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7983198165893555  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.815762519836426  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.817165374755859  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.817165374755859  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.817291259765625  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.837684631347656  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.839305877685547  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.839305877685547  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.839445114135742  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.86297607421875  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([1224, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.892431735992432  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.892431735992432  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

 h.shape torch.Size([1, 1224, 256]), torch.Size([1, 1224, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.894766330718994  GigaBytes
Max Memory Allocated: 5.329542636871338  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.321054935455322  GigaBytes
Max Memory Allocated: 5.3502373695373535  GigaBytes

rst.shape  torch.Size([1, 1224, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.238511562347412  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.240819454193115  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.242513656616211  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.240120887756348  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 63379
output nodes number: 11368
edges number: 94395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.240678310394287  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.240678787231445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.08411884307861328  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 2 input nodes size: 123076
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0717000961303711  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0717000961303711  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1303873062133789  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13047218322753906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07157039642333984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([123076, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07607746124267578  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3208, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3080711364746094  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3080711364746094  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3208, 128]), torch.Size([1, 3208, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3111305236816406  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33574628829956055  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3208, 128])
m.shape torch.Size([4077, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3381047248840332  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3381047248840332  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4077, 128]), torch.Size([1, 4077, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3425893783569336  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4012012481689453  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4077, 128])
m.shape torch.Size([3939, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4048194885253906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4048194885253906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3939, 128]), torch.Size([1, 3939, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.40871429443359375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4948854446411133  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3939, 128])
m.shape torch.Size([3875, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5005202293395996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5005202293395996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3875, 128]), torch.Size([1, 3875, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.5048551559448242  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6171741485595703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3875, 128])
m.shape torch.Size([3725, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6242074966430664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6242074966430664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3725, 128]), torch.Size([1, 3725, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6287460327148438  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7567167282104492  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3725, 128])
m.shape torch.Size([3307, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.764401912689209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.764401912689209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3307, 128]), torch.Size([1, 3307, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7679400444030762  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9086403846740723  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3307, 128])
m.shape torch.Size([2992, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9170503616333008  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9170503616333008  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2992, 128]), torch.Size([1, 2992, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9200067520141602  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0626764297485352  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2992, 128])
m.shape torch.Size([2785, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0726633071899414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0726633071899414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2785, 128]), torch.Size([1, 2785, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.0754938125610352  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.234574317932129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2785, 128])
m.shape torch.Size([2558, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2442240715026855  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2442240715026855  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2558, 128]), torch.Size([1, 2558, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2467718124389648  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.4030218124389648  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2558, 128])
m.shape torch.Size([32599, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5580520629882812  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5580520629882812  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32599, 128]), torch.Size([1, 32599, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5891408920288086  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.805795669555664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.593593120574951  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.6537365913391113  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7138800621032715  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.653266429901123  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([63065, 256])
first layer input nodes number: 123076
first layer output nodes number: 63065
edges number: 469382
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.714799404144287  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7749428749084473  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7899789810180664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7899789810180664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1678, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.881704807281494  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.881704807281494  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1678, 256]), torch.Size([1, 1678, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8854308128356934  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9128565788269043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1678, 256])
m.shape torch.Size([1500, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9138402938842773  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9138402938842773  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1500, 256]), torch.Size([1, 1500, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9176454544067383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9614953994750977  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1500, 256])
m.shape torch.Size([1121, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9640769958496094  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9640769958496094  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1121, 256]), torch.Size([1, 1121, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9663286209106445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0156049728393555  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1121, 256])
m.shape torch.Size([899, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.018549919128418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.018549919128418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 899, 256]), torch.Size([1, 899, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.020264625549316  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0766801834106445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 899, 256])
m.shape torch.Size([802, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.079839706420898  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.079839706420898  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.081369400024414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.1407318115234375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([597, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.143409729003906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.143409729003906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 597, 256]), torch.Size([1, 597, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.144548416137695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.19361686706543  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 597, 256])
m.shape torch.Size([476, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.196662425994873  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.196662425994873  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 476, 256]), torch.Size([1, 476, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.197570323944092  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.242965221405029  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 476, 256])
m.shape torch.Size([414, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.245694637298584  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.245694637298584  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.246484279632568  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.292417049407959  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([364, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.29517126083374  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.29517126083374  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 364, 256]), torch.Size([1, 364, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.295865535736084  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.340951442718506  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 364, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.343949317932129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.343949317932129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.344613075256348  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.392777442932129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([295, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.395564556121826  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.395564556121826  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.396127223968506  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.44102144241333  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([249, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.443612098693848  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.443612098693848  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.444087028503418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4844560623168945  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 249, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4870924949646  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4870924949646  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.4875311851501465  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.527890682220459  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([184, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.530147552490234  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.530147552490234  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.530498504638672  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.565242767333984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([160, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.567456245422363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.567456245422363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.567761421203613  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.600110054016113  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([147, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.602218151092529  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.602218151092529  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.602498531341553  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.634181499481201  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([128, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.636132717132568  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.636132717132568  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.636376857757568  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.665673732757568  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.667437553405762  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.667437553405762  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.667645454406738  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.694048881530762  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([91, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6956071853637695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6956071853637695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.6957807540893555  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.719038963317871  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.721066951751709  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.721066951751709  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.721276760101318  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.75085973739624  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752632141113281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752632141113281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752809524536133  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.779062271118164  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.780411720275879  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.780411720275879  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.78054141998291  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.800644874572754  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.802149772644043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.802149772644043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.802285194396973  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824223518371582  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.825632095336914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.825632095336914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.825754165649414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.846384048461914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([1170, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.875063419342041  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.875063419342041  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1170, 256]), torch.Size([1, 1170, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.877295017242432  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.279072284698486  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1170, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1981353759765625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.200103759765625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.201797962188721  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.199744701385498  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 63065
output nodes number: 11368
edges number: 93115
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.200573921203613  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.2005743980407715  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.0836935043334961  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 3 input nodes size: 122368
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07184457778930664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07184457778930664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.13043832778930664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.1305232048034668  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07175111770629883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07590150833129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07590150833129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07590150833129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([122368, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.07590150833129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3120, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30457353591918945  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30457353591918945  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3120, 128]), torch.Size([1, 3120, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.30754899978637695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33268117904663086  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3120, 128])
m.shape torch.Size([4009, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33426904678344727  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.33426904678344727  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4009, 128]), torch.Size([1, 4009, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.3380923271179199  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.39697694778442383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4009, 128])
m.shape torch.Size([4027, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4004940986633301  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4004940986633301  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4027, 128]), torch.Size([1, 4027, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4049811363220215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.49105024337768555  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4027, 128])
m.shape torch.Size([3844, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4968109130859375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.4968109130859375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3844, 128]), torch.Size([1, 3844, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.500546932220459  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6144618988037109  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3844, 128])
m.shape torch.Size([3657, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6217937469482422  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6217937469482422  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3657, 128]), torch.Size([1, 3657, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.6253490447998047  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.751950740814209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3657, 128])
m.shape torch.Size([3275, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7595767974853516  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7595767974853516  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3275, 128]), torch.Size([1, 3275, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.7629261016845703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.904541015625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3275, 128])
m.shape torch.Size([3015, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9139108657836914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9139108657836914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3015, 128]), torch.Size([1, 3015, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 0.9167861938476562  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.066443920135498  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3015, 128])
m.shape torch.Size([2749, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.075911521911621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.075911521911621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2749, 128]), torch.Size([1, 2749, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.078660011291504  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.229020118713379  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2749, 128])
m.shape torch.Size([2497, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2384252548217773  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2384252548217773  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2497, 128]), torch.Size([1, 2497, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.2409157752990723  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.3977556228637695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2497, 128])
m.shape torch.Size([32200, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5508618354797363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5508618354797363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32200, 128]), torch.Size([1, 32200, 128])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 1.5815701484680176  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7618603706359863  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32200, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.5524754524230957  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.611978054046631  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.671480655670166  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.611513137817383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([62393, 256])
first layer input nodes number: 122368
first layer output nodes number: 62393
edges number: 464100
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.672394275665283  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7318968772888184  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7467727661132812  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.7467727661132812  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1720, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8384246826171875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8384246826171875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1720, 256]), torch.Size([1, 1720, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8419852256774902  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.869126796722412  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1720, 256])
m.shape torch.Size([1437, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.870248794555664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.870248794555664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1437, 256]), torch.Size([1, 1437, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.8731226921081543  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.9165525436401367  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1437, 256])
m.shape torch.Size([1122, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.918748378753662  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.918748378753662  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1122, 256]), torch.Size([1, 1122, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.920915126800537  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.970489501953125  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1122, 256])
m.shape torch.Size([933, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.973611354827881  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.973611354827881  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 933, 256]), torch.Size([1, 933, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 3.975390911102295  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.034413814544678  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 933, 256])
m.shape torch.Size([743, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.037729263305664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.037729263305664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 743, 256]), torch.Size([1, 743, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.039146423339844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.090415954589844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 743, 256])
m.shape torch.Size([654, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.093479156494141  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.093479156494141  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.0947265625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.148365020751953  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([528, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.151293754577637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.151293754577637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 528, 256]), torch.Size([1, 528, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.152300834655762  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.2036237716674805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 528, 256])
m.shape torch.Size([424, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.206380367279053  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.206380367279053  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.207189083099365  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.254136562347412  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([378, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.257002353668213  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.257002353668213  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.257723331451416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.305290699005127  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([319, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.308623790740967  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.308623790740967  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.309232234954834  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.353559494018555  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([252, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.35591983795166  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.35591983795166  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.356400489807129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.393891334533691  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([237, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.3963847160339355  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.3963847160339355  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.396836757659912  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.43526029586792  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([218, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.437758445739746  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.437758445739746  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.438174247741699  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.476428031921387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.478750228881836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.478750228881836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.479108810424805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.514608383178711  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([150, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.516592025756836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.516592025756836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.516878128051758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.547204971313477  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.549261093139648  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.549261093139648  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.549533843994141  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.580354690551758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([138, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.582473278045654  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.582473278045654  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.582736492156982  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.614322185516357  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.616076469421387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.616076469421387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.616284370422363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.642687797546387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.644592761993408  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.644592761993408  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.644802570343018  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.672916889190674  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([101, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.674753665924072  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.674753665924072  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.674946308135986  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.702108860015869  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([81, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.703686714172363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.703686714172363  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.703841209411621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.726706504821777  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728257656097412  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728257656097412  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.728404521942139  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.751168727874756  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([64, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752510070800781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752510070800781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.752632141113281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.772407531738281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7739152908325195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.7739152908325195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.774044990539551  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.795964241027832  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1174, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824108600616455  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.824108600616455  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1174, 256]), torch.Size([1, 1174, 256])
----------------------------------------3
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 4.826426029205322  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.229372024536133  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1493611335754395  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.151773452758789  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.153467655181885  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.150970458984375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 62393
output nodes number: 11368
edges number: 92898
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.15196418762207  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5330810546875 GB
    Memory Allocated: 5.1519646644592285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.08362245559692383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 4 input nodes size: 122870
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07219505310058594  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07219505310058594  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.1307840347290039  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13086891174316406  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0721902847290039  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07678699493408203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07678699493408203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07678699493408203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([122870, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07678699493408203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3209, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3055734634399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3055734634399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3209, 128]), torch.Size([1, 3209, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.30863380432128906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3342471122741699  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3209, 128])
m.shape torch.Size([4008, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33653926849365234  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33653926849365234  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4008, 128]), torch.Size([1, 4008, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3403615951538086  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.39870357513427734  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4008, 128])
m.shape torch.Size([4073, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4022831916809082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4022831916809082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4073, 128]), torch.Size([1, 4073, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40677690505981445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.49275827407836914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4073, 128])
m.shape torch.Size([3924, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4985847473144531  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4985847473144531  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5023360252380371  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6160383224487305  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([3672, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6235227584838867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6235227584838867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3672, 128]), torch.Size([1, 3672, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6271333694458008  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7534723281860352  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3672, 128])
m.shape torch.Size([3220, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7606630325317383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7606630325317383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3220, 128]), torch.Size([1, 3220, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7638978958129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.8989152908325195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3220, 128])
m.shape torch.Size([3028, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9065694808959961  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9065694808959961  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3028, 128]), torch.Size([1, 3028, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9094572067260742  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0597200393676758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3028, 128])
m.shape torch.Size([2834, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.069087028503418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.069087028503418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2834, 128]), torch.Size([1, 2834, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0718727111816406  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2309179306030273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2834, 128])
m.shape torch.Size([2516, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2397518157958984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2397518157958984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2516, 128]), torch.Size([1, 2516, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.242915153503418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.3996295928955078  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2516, 128])
m.shape torch.Size([32109, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5515375137329102  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5515375137329102  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32109, 128]), torch.Size([1, 32109, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5821590423583984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7562875747680664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32109, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.546396255493164  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6060895919799805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.665782928466797  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6056227684020996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([62593, 256])
first layer input nodes number: 122870
first layer output nodes number: 62593
edges number: 464422
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6667003631591797  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.726393699645996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7413172721862793  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7413172721862793  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1719, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8322572708129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8322572708129883  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1719, 256]), torch.Size([1, 1719, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.836726665496826  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8629565238952637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1719, 256])
m.shape torch.Size([1470, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8641676902770996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8641676902770996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1470, 256]), torch.Size([1, 1470, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8675503730773926  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.91119384765625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1470, 256])
m.shape torch.Size([1141, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9140233993530273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9140233993530273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1141, 256]), torch.Size([1, 1141, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9162254333496094  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9663567543029785  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1141, 256])
m.shape torch.Size([930, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9694161415100098  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9694161415100098  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 930, 256]), torch.Size([1, 930, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9711899757385254  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.030704975128174  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 930, 256])
m.shape torch.Size([802, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.034068584442139  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.034068584442139  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 802, 256]), torch.Size([1, 802, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.035598278045654  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.090667247772217  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 802, 256])
m.shape torch.Size([570, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.093189716339111  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.093189716339111  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.0942769050598145  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.142238616943359  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([520, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.145193576812744  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.145193576812744  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.146185398101807  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.196066379547119  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([404, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.198677062988281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.198677062988281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 404, 256]), torch.Size([1, 404, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.1994476318359375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.243644714355469  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 404, 256])
m.shape torch.Size([366, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.246425628662109  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.246425628662109  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.247123718261719  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.291801452636719  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([333, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.294653415679932  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.294653415679932  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.295288562774658  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.341742038726807  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([285, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.344437599182129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.344437599182129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3449811935424805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.392258644104004  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.394870281219482  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.394870281219482  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3953471183776855  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.435878276824951  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([203, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.43817663192749  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.43817663192749  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.438563823699951  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.474185466766357  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([188, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.476521968841553  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.476521968841553  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4768805503845215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.512380123138428  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([178, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.514767169952393  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.514767169952393  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 178, 256]), torch.Size([1, 178, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.515106678009033  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.5510945320129395  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 178, 256])
m.shape torch.Size([137, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.553031921386719  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.553031921386719  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.553293228149414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.582820892333984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([123, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.584700107574463  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.584700107574463  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.584934711456299  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.613087177276611  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([133, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.615271091461182  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.615271091461182  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.615524768829346  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.647741794586182  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.649678707122803  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.649678707122803  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.6498942375183105  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.678775310516357  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.680359363555908  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.680359363555908  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.680527210235596  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.704193592071533  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.70580530166626  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.70580530166626  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.705965518951416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.729677677154541  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.730866432189941  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.730866432189941  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.73098087310791  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.748719215393066  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.75040864944458  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.75040864944458  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.750559329986572  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.774969577789307  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([58, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7762322425842285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7762322425842285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.776342868804932  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.79503870010376  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([1134, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.822231292724609  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.822231292724609  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1134, 256]), torch.Size([1, 1134, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.824745178222656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.207760334014893  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1134, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.1292924880981445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.13098669052124  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.132680892944336  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.13090181350708  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 62593
output nodes number: 11368
edges number: 92031
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.130735397338867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.130735874176025  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.08334493637084961  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 5 input nodes size: 122482
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07147216796875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07147216796875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13006591796875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13015079498291016  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07565116882324219  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07565116882324219  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07565116882324219  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([122482, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07565116882324219  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3165, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.30585718154907227  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.30585718154907227  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3165, 128]), torch.Size([1, 3165, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.30887556076049805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3334832191467285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3165, 128])
m.shape torch.Size([4014, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3358020782470703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3358020782470703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4014, 128]), torch.Size([1, 4014, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.34058618545532227  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3992581367492676  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4014, 128])
m.shape torch.Size([4090, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4031949043273926  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4031949043273926  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4090, 128]), torch.Size([1, 4090, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40709543228149414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.49302148818969727  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4090, 128])
m.shape torch.Size([3874, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4984602928161621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4984602928161621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3874, 128]), torch.Size([1, 3874, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5022578239440918  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6154532432556152  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3874, 128])
m.shape torch.Size([3698, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6224226951599121  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6224226951599121  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3698, 128]), torch.Size([1, 3698, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6261115074157715  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7533411979675293  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3698, 128])
m.shape torch.Size([3286, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7608447074890137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7608447074890137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3286, 128]), torch.Size([1, 3286, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7646403312683105  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9052119255065918  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3286, 128])
m.shape torch.Size([2977, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9128532409667969  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9128532409667969  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2977, 128]), torch.Size([1, 2977, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9158806800842285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.058908462524414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2977, 128])
m.shape torch.Size([2797, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0681586265563965  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0681586265563965  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2797, 128]), torch.Size([1, 2797, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0709285736083984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2307062149047852  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2797, 128])
m.shape torch.Size([2498, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2400927543640137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2400927543640137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2498, 128]), torch.Size([1, 2498, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2425670623779297  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.3988170623779297  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2498, 128])
m.shape torch.Size([32425, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.551767349243164  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.551767349243164  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32425, 128]), torch.Size([1, 32425, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5826902389526367  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.797842025756836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32425, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.587252616882324  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6471662521362305  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7070798873901367  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.646697998046875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([62824, 256])
first layer input nodes number: 122482
first layer output nodes number: 62824
edges number: 467112
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7079944610595703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7679080963134766  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.782886505126953  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.782886505126953  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1644, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8743791580200195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8743791580200195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1644, 256]), torch.Size([1, 1644, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8778905868530273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.904700756072998  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1644, 256])
m.shape torch.Size([1452, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9059243202209473  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9059243202209473  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1452, 256]), torch.Size([1, 1452, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.908853054046631  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9519705772399902  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1452, 256])
m.shape torch.Size([1174, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9546823501586914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9546823501586914  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1174, 256]), torch.Size([1, 1174, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.957035541534424  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.00816011428833  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1174, 256])
m.shape torch.Size([919, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.011043071746826  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.011043071746826  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 919, 256]), torch.Size([1, 919, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.012795925140381  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.070397853851318  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 919, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.073620796203613  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.073620796203613  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.075133323669434  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.129630088806152  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([571, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.132166862487793  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.132166862487793  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.133255958557129  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.180741310119629  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([519, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.184507846832275  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.184507846832275  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 519, 256]), torch.Size([1, 519, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.185497760772705  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.235119342803955  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 519, 256])
m.shape torch.Size([453, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.238107681274414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.238107681274414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.238971710205078  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.288865566253662  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([390, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.291807174682617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.291807174682617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 390, 256]), torch.Size([1, 390, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.292551040649414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.340904235839844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 390, 256])
m.shape torch.Size([323, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.343636989593506  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.343636989593506  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.344253063201904  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.388143062591553  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([279, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.390784740447998  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.390784740447998  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.391316890716553  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.43346643447876  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.436083793640137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.436083793640137  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.43656063079834  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4770917892456055  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([215, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.47953987121582  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.47953987121582  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.479949951171875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.517677307128906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([189, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.520015716552734  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.520015716552734  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.520376205444336  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.556064605712891  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([171, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.558350086212158  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.558350086212158  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.558676242828369  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.5932488441467285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([129, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.595069885253906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.595069885253906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.595315933227539  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.623119354248047  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([138, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.625251293182373  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.625251293182373  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.625514507293701  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.657100200653076  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.6588544845581055  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.6588544845581055  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.659062385559082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.6854658126831055  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.687270164489746  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.687270164489746  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.687460899353027  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.713019371032715  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7146735191345215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7146735191345215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.714847087860107  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.739320278167725  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.741110801696777  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.741110801696777  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.741288185119629  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.76754093170166  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([71, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.768953800201416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.768953800201416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.769089221954346  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.790079593658447  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.791205883026123  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.791205883026123  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.791308879852295  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.807994365692139  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.809488773345947  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.809488773345947  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.809616565704346  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.831213474273682  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([1174, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.859358787536621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.859358787536621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1174, 256]), torch.Size([1, 1174, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.861784934997559  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.2648844718933105  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1174, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.185667037963867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.187906265258789  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.189600467681885  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.187276363372803  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 62824
output nodes number: 11368
edges number: 93016
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.187829494476318  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.187829971313477  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.08309602737426758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 6 input nodes size: 123195
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07147693634033203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13022089004516602  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13030576705932617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07162714004516602  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([123195, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07608222961425781  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3212, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3080911636352539  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3080911636352539  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3212, 128]), torch.Size([1, 3212, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3111543655395508  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3365445137023926  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3212, 128])
m.shape torch.Size([3973, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33880186080932617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33880186080932617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3973, 128]), torch.Size([1, 3973, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.34334278106689453  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4020538330078125  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3973, 128])
m.shape torch.Size([4065, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40584278106689453  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40584278106689453  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4065, 128]), torch.Size([1, 4065, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40971946716308594  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.49564170837402344  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4065, 128])
m.shape torch.Size([3846, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5010390281677246  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5010390281677246  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3846, 128]), torch.Size([1, 3846, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5048179626464844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6180834770202637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3846, 128])
m.shape torch.Size([3611, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6239051818847656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6239051818847656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3611, 128]), torch.Size([1, 3611, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6273488998413086  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7529053688049316  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3611, 128])
m.shape torch.Size([3386, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7602801322937012  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7602801322937012  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3386, 128]), torch.Size([1, 3386, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7642073631286621  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9058732986450195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3386, 128])
m.shape torch.Size([3040, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9144058227539062  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9144058227539062  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3040, 128]), torch.Size([1, 3040, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9173870086669922  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0676383972167969  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3040, 128])
m.shape torch.Size([2910, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0772895812988281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0772895812988281  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2910, 128]), torch.Size([1, 2910, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0801410675048828  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2390613555908203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2910, 128])
m.shape torch.Size([2511, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.248344898223877  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.248344898223877  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2511, 128]), torch.Size([1, 2511, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2510395050048828  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.4075164794921875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2511, 128])
m.shape torch.Size([32614, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5625691413879395  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5625691413879395  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32614, 128]), torch.Size([1, 32614, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.593672275543213  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.811065673828125  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32614, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.5998401641845703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6600818634033203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7203235626220703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.659611225128174  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([63168, 256])
first layer input nodes number: 123195
first layer output nodes number: 63168
edges number: 470407
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.721243381500244  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.781485080718994  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7965455055236816  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7965455055236816  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1639, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.888798713684082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.888798713684082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1639, 256]), torch.Size([1, 1639, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8925271034240723  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.919525623321533  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1639, 256])
m.shape torch.Size([1480, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9199681282043457  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9199681282043457  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1480, 256]), torch.Size([1, 1480, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9229493141174316  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.965292453765869  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1480, 256])
m.shape torch.Size([1150, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.967886447906494  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.967886447906494  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9701499938964844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.021210670471191  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
m.shape torch.Size([912, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.024120807647705  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.024120807647705  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 912, 256]), torch.Size([1, 912, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.02586030960083  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.0823140144348145  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 912, 256])
m.shape torch.Size([754, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.085452079772949  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.085452079772949  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 754, 256]), torch.Size([1, 754, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.08689022064209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.138663291931152  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 754, 256])
m.shape torch.Size([631, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.141583442687988  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.141583442687988  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.142786979675293  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.194974899291992  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([542, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.198019981384277  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.198019981384277  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 542, 256]), torch.Size([1, 542, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.199053764343262  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.251954078674316  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 542, 256])
m.shape torch.Size([453, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.254920482635498  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.254920482635498  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 453, 256]), torch.Size([1, 453, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.255784511566162  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.306079387664795  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 453, 256])
m.shape torch.Size([345, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.308631896972656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.308631896972656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.309289932250977  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.352337837219238  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([344, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.355315208435059  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.355315208435059  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.355971336364746  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4030561447143555  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([264, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.405519485473633  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.405519485473633  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.406023025512695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.446471691131592  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([237, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.448953628540039  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.448953628540039  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 237, 256]), torch.Size([1, 237, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.449405670166016  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.487829208374023  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 237, 256])
m.shape torch.Size([190, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4899773597717285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4899773597717285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.490339756011963  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.523680210113525  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([176, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.525867462158203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.525867462158203  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.526203155517578  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.559436798095703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([157, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.561532497406006  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.561532497406006  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.561831951141357  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.593574047088623  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.59562349319458  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.59562349319458  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.595896244049072  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.6267170906066895  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([112, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.628410816192627  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.628410816192627  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.628624439239502  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.654259204864502  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.656038284301758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.656038284301758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.656246185302734  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.682649612426758  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([104, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.684444904327393  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.684444904327393  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.684643268585205  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.71122407913208  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.713258743286133  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.713258743286133  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.713470458984375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.743322372436523  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([88, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.744992733001709  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.744992733001709  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7451605796813965  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7700018882751465  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.771546363830566  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.771546363830566  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.771693229675293  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.79445743560791  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.795765399932861  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.795765399932861  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7958760261535645  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.813797473907471  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.815439701080322  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.815439701080322  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.815548419952393  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.833921909332275  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([1235, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.864218711853027  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.864218711853027  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1235, 256]), torch.Size([1, 1235, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.866574287414551  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.291140556335449  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1235, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.211432933807373  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.213127136230469  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.2148213386535645  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.213042259216309  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11368, 40])
input nodes number: 63168
output nodes number: 11368
edges number: 93722
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.213597774505615  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.213598251342773  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.08344364166259766  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

pseudo mini batch 7 input nodes size: 123025
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07162714004516602  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07162714004516602  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13029003143310547  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.13037490844726562  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.07154607772827148  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([123025, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0760812759399414  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([3160, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3080472946166992  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3080472946166992  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3160, 128]), torch.Size([1, 3160, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.31106090545654297  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3361387252807617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3160, 128])
m.shape torch.Size([3939, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33838844299316406  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.33838844299316406  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3939, 128]), torch.Size([1, 3939, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.3432798385620117  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4020233154296875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3939, 128])
m.shape torch.Size([4029, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40590858459472656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40590858459472656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 4029, 128]), torch.Size([1, 4029, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.40975093841552734  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.4955606460571289  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 4029, 128])
m.shape torch.Size([3924, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5011239051818848  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5011239051818848  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3924, 128]), torch.Size([1, 3924, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.5049161911010742  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6183390617370605  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3924, 128])
m.shape torch.Size([3702, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6252942085266113  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6252942085266113  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3702, 128]), torch.Size([1, 3702, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.6289577484130859  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7562828063964844  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3702, 128])
m.shape torch.Size([3239, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7636709213256836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7636709213256836  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 3239, 128]), torch.Size([1, 3239, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.7674283981323242  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9018049240112305  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 3239, 128])
m.shape torch.Size([2983, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.91021728515625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.91021728515625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2983, 128]), torch.Size([1, 2983, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.9132232666015625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.055628776550293  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2983, 128])
m.shape torch.Size([2753, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0647082328796387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0647082328796387  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2753, 128]), torch.Size([1, 2753, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.0674943923950195  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2172021865844727  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2753, 128])
m.shape torch.Size([2542, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2277040481567383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.2277040481567383  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 2542, 128]), torch.Size([1, 2542, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.230219841003418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.386469841003418  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 2542, 128])
m.shape torch.Size([32695, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5415077209472656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.5415077209472656  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 32695, 128]), torch.Size([1, 32695, 128])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 1.572688102722168  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7905330657958984  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 32695, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.5784430503845215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6384921073913574  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6985411643981934  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.6380228996276855  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([62966, 256])
first layer input nodes number: 123025
first layer output nodes number: 62966
edges number: 469498
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.699460029602051  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7595090866088867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7745213508605957  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.7745213508605957  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

m.shape torch.Size([1653, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.866802215576172  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.866802215576172  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1653, 256]), torch.Size([1, 1653, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.8708157539367676  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.898075580596924  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1653, 256])
m.shape torch.Size([1455, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.89939022064209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.89939022064209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1455, 256]), torch.Size([1, 1455, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9023194313049316  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9448413848876953  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1455, 256])
m.shape torch.Size([1159, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.947421073913574  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.947421073913574  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1159, 256]), torch.Size([1, 1159, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9496936798095703  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 3.9995365142822266  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1159, 256])
m.shape torch.Size([923, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.002352237701416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.002352237701416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 923, 256]), torch.Size([1, 923, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.004112720489502  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.060207843780518  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 923, 256])
m.shape torch.Size([797, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.06329870223999  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.06329870223999  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 797, 256]), torch.Size([1, 797, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.064818859100342  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.124048233032227  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 797, 256])
m.shape torch.Size([616, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.126840591430664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.126840591430664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.128015518188477  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.180398941040039  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([485, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.183074951171875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.183074951171875  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.184000015258789  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.23093318939209  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([446, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.23390007019043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.23390007019043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.234750747680664  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.285017013549805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([385, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.287922382354736  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.287922382354736  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 385, 256]), torch.Size([1, 385, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.288656711578369  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.336092472076416  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 385, 256])
m.shape torch.Size([325, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.338849067687988  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.338849067687988  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.339468955993652  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3851165771484375  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([272, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3876824378967285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3876824378967285  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.3882012367248535  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.429259300231934  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([227, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4316182136535645  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4316182136535645  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.432051181793213  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.46885347366333  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([203, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4711737632751465  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.4711737632751465  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.471560955047607  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.507182598114014  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([148, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.508980751037598  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.508980751037598  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.509263038635254  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.537209510803223  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.539403915405273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.539403915405273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.539712905883789  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.572465896606445  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([133, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.574357032775879  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.574357032775879  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.574610710144043  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.603276252746582  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([134, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.605339050292969  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.605339050292969  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.605594635009766  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.636264801025391  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([124, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.638282299041748  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.638282299041748  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.638518810272217  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.668555736541748  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([104, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.670336723327637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.670336723327637  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.670535087585449  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.697115898132324  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([107, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.699073791503906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.699073791503906  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.699277877807617  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.728054046630859  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.729788780212402  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.729788780212402  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.729962348937988  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.755650520324707  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.757192134857178  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.757192134857178  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.757339000701904  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7801032066345215  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.781311988830566  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.781311988830566  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.7814226150512695  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.799344062805176  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([74, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.801549911499023  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.801549911499023  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.801691055297852  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.825544357299805  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([1207, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.8549957275390625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.8549957275390625  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

 h.shape torch.Size([1, 1207, 256]), torch.Size([1, 1207, 256])
----------------------------------------3
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 4.857297897338867  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.263307094573975  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

rst.shape  torch.Size([1, 1207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.183446884155273  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.185637474060059  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.187331199645996  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes
Using backend: pytorch

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.185055732727051  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

torch.Size([11365, 40])
input nodes number: 62966
output nodes number: 11365
edges number: 93592
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.186106204986572  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 5.1861066818237305  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0839238166809082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0839238166809082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.5350341796875 GB
    Memory Allocated: 0.0839238166809082  GigaBytes
Max Memory Allocated: 5.35306978225708  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04487207531929016 |0.0028886795043945312 |0.1350191831588745 |9.754300117492676e-05 |0.0787525475025177 |0.004581451416015625 |
----------------------------------------------------------pseudo_mini_loss sum 3.100426435470581
Total (block generation + training)time/epoch 7.172530174255371
Training time/epoch 2.1578190326690674
Training time without block to device /epoch 2.134709596633911
Training time without total dataloading part /epoch 1.7155356407165527
load block tensor time/epoch 0.3589766025543213
block to device time/epoch 0.02310943603515625
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  1486564
Number of first layer input nodes during this epoch:  983435
Number of first layer output nodes during this epoch:  503129
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
