[05:13:11] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23358328 edges into 8 parts and get 3929474 edge cuts
main start at this time 1651554770.9772682
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.029336929321289062
global_2_local spend time (sec) 0.03529191017150879
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004803895950317383
A = g.adjacency_matrix() spent  0.007376432418823242
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08421874046325684
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2869277000427246
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1715877056121826

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328})
Convert a graph into a bidirected graph: 0.979 seconds
Metis partitioning: 4.602 seconds
Split the graph: 1.320 seconds
Construct subgraphs: 0.093 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.005151748657227
11322
11035
11256
11222
11582
11357
11621
11546
total k batches seeds list generation spend  17.638866186141968
after graph partition
graph partition algorithm spend time 17.748075485229492
11322
11035
11256
11222
11582
11357
11621
11546
partition_len_list
[41829, 49146, 26960, 37261, 21816, 19603, 25939, 20238]
shared_neighbor_graph_partition_s0 selection method  spend 17.83129572868347
time for parepare:  0.017085552215576172
local_output_nid generation:  0.0020139217376708984
local_in_edges_tensor generation:  0.002376556396484375
mini_batch_src_global generation:  0.0051991939544677734
r_  generation:  0.04440641403198242
local_output_nid generation:  0.0026497840881347656
local_in_edges_tensor generation:  0.0026831626892089844
mini_batch_src_global generation:  0.0051860809326171875
r_  generation:  0.04091453552246094
local_output_nid generation:  0.002867460250854492
local_in_edges_tensor generation:  0.00214385986328125
mini_batch_src_global generation:  0.0029175281524658203
r_  generation:  0.0288541316986084
local_output_nid generation:  0.0026221275329589844
local_in_edges_tensor generation:  0.002104520797729492
mini_batch_src_global generation:  0.003176450729370117
r_  generation:  0.033087968826293945
local_output_nid generation:  0.002644062042236328
local_in_edges_tensor generation:  0.0021386146545410156
mini_batch_src_global generation:  0.0033164024353027344
r_  generation:  0.031616926193237305
local_output_nid generation:  0.003122091293334961
local_in_edges_tensor generation:  0.004775285720825195
mini_batch_src_global generation:  0.0036804676055908203
r_  generation:  0.029714584350585938
local_output_nid generation:  0.002655029296875
local_in_edges_tensor generation:  0.0023126602172851562
mini_batch_src_global generation:  0.003069162368774414
r_  generation:  0.03294491767883301
local_output_nid generation:  0.0026922225952148438
local_in_edges_tensor generation:  0.0020208358764648438
mini_batch_src_global generation:  0.0023331642150878906
r_  generation:  0.02481365203857422
----------------------check_connections_block total spend ----------------------------- 0.429645299911499
generate_one_block  0.06371235847473145
generate_one_block  0.05200314521789551
generate_one_block  0.033182382583618164
generate_one_block  0.04282093048095703
generate_one_block  0.042531490325927734
generate_one_block  0.03803062438964844
generate_one_block  0.041882991790771484
generate_one_block  0.035561561584472656
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03618764877319336
gen group dst list time:  0.006573915481567383
time for parepare:  0.023194313049316406
local_output_nid generation:  0.0064792633056640625
local_in_edges_tensor generation:  0.026302099227905273
mini_batch_src_global generation:  0.010324954986572266
r_  generation:  0.128004789352417
local_output_nid generation:  0.01979827880859375
local_in_edges_tensor generation:  0.017550945281982422
mini_batch_src_global generation:  0.017718076705932617
r_  generation:  0.14101290702819824
local_output_nid generation:  0.01212763786315918
local_in_edges_tensor generation:  0.0072286128997802734
mini_batch_src_global generation:  0.010199308395385742
r_  generation:  0.06823062896728516
local_output_nid generation:  0.014165163040161133
local_in_edges_tensor generation:  0.010158538818359375
mini_batch_src_global generation:  0.013375520706176758
r_  generation:  0.10659217834472656
local_output_nid generation:  0.010183334350585938
local_in_edges_tensor generation:  0.005849599838256836
mini_batch_src_global generation:  0.008817434310913086
r_  generation:  0.05076909065246582
local_output_nid generation:  0.005522966384887695
local_in_edges_tensor generation:  0.004171133041381836
mini_batch_src_global generation:  0.005272388458251953
r_  generation:  0.044213294982910156
local_output_nid generation:  0.006915092468261719
local_in_edges_tensor generation:  0.005540132522583008
mini_batch_src_global generation:  0.008627176284790039
r_  generation:  0.06247448921203613
local_output_nid generation:  0.005166053771972656
local_in_edges_tensor generation:  0.004136085510253906
mini_batch_src_global generation:  0.004968166351318359
r_  generation:  0.040711164474487305
----------------------check_connections_block total spend ----------------------------- 1.0574514865875244
generate_one_block  0.15333771705627441
generate_one_block  0.1777358055114746
generate_one_block  0.07526040077209473
generate_one_block  0.12383222579956055
generate_one_block  0.06068825721740723
generate_one_block  0.053827524185180664
generate_one_block  0.0773615837097168
generate_one_block  0.04897141456604004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  1.0574514865875244
block generation total time  0.771014928817749
average batch blocks generation time:  0.09637686610221863
pseudo mini batch 0 input nodes size: 68805
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.0359807014465332  GigaBytes
Max Memory Allocated: 0.0359807014465332  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036065101623535156  GigaBytes
Max Memory Allocated: 0.036065101623535156  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.036065101623535156  GigaBytes
Max Memory Allocated: 0.036065101623535156  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 0.039595603942871094  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 0.039595603942871094  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 0.039595603942871094  GigaBytes

torch.Size([68805, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.039595603942871094  GigaBytes
Max Memory Allocated: 0.039595603942871094  GigaBytes

m.shape torch.Size([1927, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20671701431274414  GigaBytes
Max Memory Allocated: 0.21101808547973633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4080810546875 GB
    Memory Allocated: 0.20671701431274414  GigaBytes
Max Memory Allocated: 0.21101808547973633  GigaBytes

 h.shape torch.Size([1, 1927, 128]), torch.Size([1, 1927, 128])
----------------------------------------3
 Nvidia-smi: 1.4100341796875 GB
    Memory Allocated: 0.20855474472045898  GigaBytes
Max Memory Allocated: 0.21101808547973633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.22325658798217773  GigaBytes
Max Memory Allocated: 0.22417545318603516  GigaBytes

rst.shape  torch.Size([1, 1927, 128])
m.shape torch.Size([1940, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.22418785095214844  GigaBytes
Max Memory Allocated: 0.22423171997070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4158935546875 GB
    Memory Allocated: 0.22418785095214844  GigaBytes
Max Memory Allocated: 0.22423171997070312  GigaBytes

 h.shape torch.Size([1, 1940, 128]), torch.Size([1, 1940, 128])
----------------------------------------3
 Nvidia-smi: 1.4178466796875 GB
    Memory Allocated: 0.22603797912597656  GigaBytes
Max Memory Allocated: 0.22603797912597656  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.25378990173339844  GigaBytes
Max Memory Allocated: 0.25564002990722656  GigaBytes

rst.shape  torch.Size([1, 1940, 128])
m.shape torch.Size([1841, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.25549840927124023  GigaBytes
Max Memory Allocated: 0.25564002990722656  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.25549840927124023  GigaBytes
Max Memory Allocated: 0.25564002990722656  GigaBytes

 h.shape torch.Size([1, 1841, 128]), torch.Size([1, 1841, 128])
----------------------------------------3
 Nvidia-smi: 1.4627685546875 GB
    Memory Allocated: 0.25725412368774414  GigaBytes
Max Memory Allocated: 0.25725412368774414  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.2958798408508301  GigaBytes
Max Memory Allocated: 0.29854297637939453  GigaBytes

rst.shape  torch.Size([1, 1841, 128])
m.shape torch.Size([1737, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.29831504821777344  GigaBytes
Max Memory Allocated: 0.29854297637939453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.29831504821777344  GigaBytes
Max Memory Allocated: 0.29854297637939453  GigaBytes

 h.shape torch.Size([1, 1737, 128]), torch.Size([1, 1737, 128])
----------------------------------------3
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.2999715805053711  GigaBytes
Max Memory Allocated: 0.2999715805053711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.3480110168457031  GigaBytes
Max Memory Allocated: 0.35132408142089844  GigaBytes

rst.shape  torch.Size([1, 1737, 128])
m.shape torch.Size([1632, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.3510737419128418  GigaBytes
Max Memory Allocated: 0.35132408142089844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.3510737419128418  GigaBytes
Max Memory Allocated: 0.35132408142089844  GigaBytes

 h.shape torch.Size([1, 1632, 128]), torch.Size([1, 1632, 128])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.3526301383972168  GigaBytes
Max Memory Allocated: 0.3526301383972168  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4103693962097168  GigaBytes
Max Memory Allocated: 0.4142603874206543  GigaBytes

rst.shape  torch.Size([1, 1632, 128])
m.shape torch.Size([1525, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4139542579650879  GigaBytes
Max Memory Allocated: 0.4142603874206543  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4139542579650879  GigaBytes
Max Memory Allocated: 0.4142603874206543  GigaBytes

 h.shape torch.Size([1, 1525, 128]), torch.Size([1, 1525, 128])
----------------------------------------3
 Nvidia-smi: 1.6307373046875 GB
    Memory Allocated: 0.4154086112976074  GigaBytes
Max Memory Allocated: 0.4154086112976074  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4780154228210449  GigaBytes
Max Memory Allocated: 0.4823784828186035  GigaBytes

rst.shape  torch.Size([1, 1525, 128])
m.shape torch.Size([1515, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4823451042175293  GigaBytes
Max Memory Allocated: 0.4824638366699219  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7030029296875 GB
    Memory Allocated: 0.4823451042175293  GigaBytes
Max Memory Allocated: 0.4824638366699219  GigaBytes

 h.shape torch.Size([1, 1515, 128]), torch.Size([1, 1515, 128])
----------------------------------------3
 Nvidia-smi: 1.7049560546875 GB
    Memory Allocated: 0.48378992080688477  GigaBytes
Max Memory Allocated: 0.48378992080688477  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5560307502746582  GigaBytes
Max Memory Allocated: 0.5610876083374023  GigaBytes

rst.shape  torch.Size([1, 1515, 128])
m.shape torch.Size([1388, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.560603141784668  GigaBytes
Max Memory Allocated: 0.5610876083374023  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.560603141784668  GigaBytes
Max Memory Allocated: 0.5610876083374023  GigaBytes

 h.shape torch.Size([1, 1388, 128]), torch.Size([1, 1388, 128])
----------------------------------------3
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.5619268417358398  GigaBytes
Max Memory Allocated: 0.5619268417358398  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.638239860534668  GigaBytes
Max Memory Allocated: 0.6435346603393555  GigaBytes

rst.shape  torch.Size([1, 1388, 128])
m.shape torch.Size([1360, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6434144973754883  GigaBytes
Max Memory Allocated: 0.6435518264770508  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8748779296875 GB
    Memory Allocated: 0.6434144973754883  GigaBytes
Max Memory Allocated: 0.6435518264770508  GigaBytes

 h.shape torch.Size([1, 1360, 128]), torch.Size([1, 1360, 128])
----------------------------------------3
 Nvidia-smi: 1.8768310546875 GB
    Memory Allocated: 0.6447114944458008  GigaBytes
Max Memory Allocated: 0.6447114944458008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7282304763793945  GigaBytes
Max Memory Allocated: 0.7347917556762695  GigaBytes

rst.shape  torch.Size([1, 1360, 128])
m.shape torch.Size([26964, 10, 128])
----------------------------------------1
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8564882278442383  GigaBytes
Max Memory Allocated: 0.8595972061157227  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0955810546875 GB
    Memory Allocated: 0.8564882278442383  GigaBytes
Max Memory Allocated: 0.8595972061157227  GigaBytes

 h.shape torch.Size([1, 26964, 128]), torch.Size([1, 26964, 128])
----------------------------------------3
 Nvidia-smi: 2.1229248046875 GB
    Memory Allocated: 0.8838319778442383  GigaBytes
Max Memory Allocated: 0.8838319778442383  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.727505683898926  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

rst.shape  torch.Size([1, 26964, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.5700693130493164  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.6099605560302734  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.6498517990112305  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.6096487045288086  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

torch.Size([41829, 256])
first layer input nodes number: 68805
first layer output nodes number: 41829
edges number: 339177
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.65036678314209  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.690258026123047  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.7002310752868652  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.1346435546875 GB
    Memory Allocated: 2.7002310752868652  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

m.shape torch.Size([1257, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.8318943977355957  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.8318943977355957  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

 h.shape torch.Size([1, 1257, 256]), torch.Size([1, 1257, 256])
----------------------------------------3
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.834503650665283  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.85410737991333  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

rst.shape  torch.Size([1, 1257, 256])
m.shape torch.Size([1004, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.8547921180725098  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.8547921180725098  GigaBytes
Max Memory Allocated: 2.856411933898926  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 4.2635498046875 GB
    Memory Allocated: 2.8567070960998535  GigaBytes
Max Memory Allocated: 2.8567070960998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.886479377746582  GigaBytes
Max Memory Allocated: 2.8885583877563477  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
m.shape torch.Size([812, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.8879284858703613  GigaBytes
Max Memory Allocated: 2.8885583877563477  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.8879284858703613  GigaBytes
Max Memory Allocated: 2.8885583877563477  GigaBytes

 h.shape torch.Size([1, 812, 256]), torch.Size([1, 812, 256])
----------------------------------------3
 Nvidia-smi: 4.2655029296875 GB
    Memory Allocated: 2.889477252960205  GigaBytes
Max Memory Allocated: 2.889477252960205  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2713623046875 GB
    Memory Allocated: 2.9241514205932617  GigaBytes
Max Memory Allocated: 2.9264745712280273  GigaBytes

rst.shape  torch.Size([1, 812, 256])
m.shape torch.Size([673, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.2713623046875 GB
    Memory Allocated: 2.925964832305908  GigaBytes
Max Memory Allocated: 2.9264745712280273  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2713623046875 GB
    Memory Allocated: 2.925964832305908  GigaBytes
Max Memory Allocated: 2.9264745712280273  GigaBytes

 h.shape torch.Size([1, 673, 256]), torch.Size([1, 673, 256])
----------------------------------------3
 Nvidia-smi: 4.2713623046875 GB
    Memory Allocated: 2.927248477935791  GigaBytes
Max Memory Allocated: 2.927248477935791  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.9644742012023926  GigaBytes
Max Memory Allocated: 2.967041492462158  GigaBytes

rst.shape  torch.Size([1, 673, 256])
m.shape torch.Size([571, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.96657657623291  GigaBytes
Max Memory Allocated: 2.967041492462158  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.96657657623291  GigaBytes
Max Memory Allocated: 2.967041492462158  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 4.2791748046875 GB
    Memory Allocated: 2.967665672302246  GigaBytes
Max Memory Allocated: 2.967665672302246  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 3.0069923400878906  GigaBytes
Max Memory Allocated: 3.0097150802612305  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([447, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 3.0090255737304688  GigaBytes
Max Memory Allocated: 3.0097150802612305  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 3.0090255737304688  GigaBytes
Max Memory Allocated: 3.0097150802612305  GigaBytes

 h.shape torch.Size([1, 447, 256]), torch.Size([1, 447, 256])
----------------------------------------3
 Nvidia-smi: 4.2811279296875 GB
    Memory Allocated: 3.009878158569336  GigaBytes
Max Memory Allocated: 3.009878158569336  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 3.0473480224609375  GigaBytes
Max Memory Allocated: 3.049905776977539  GigaBytes

rst.shape  torch.Size([1, 447, 256])
m.shape torch.Size([398, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 3.0495996475219727  GigaBytes
Max Memory Allocated: 3.049905776977539  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 3.0495996475219727  GigaBytes
Max Memory Allocated: 3.049905776977539  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.3006591796875 GB
    Memory Allocated: 3.050358772277832  GigaBytes
Max Memory Allocated: 3.050358772277832  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.0883970260620117  GigaBytes
Max Memory Allocated: 3.0910539627075195  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([326, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.090524196624756  GigaBytes
Max Memory Allocated: 3.0910539627075195  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.090524196624756  GigaBytes
Max Memory Allocated: 3.0910539627075195  GigaBytes

 h.shape torch.Size([1, 326, 256]), torch.Size([1, 326, 256])
----------------------------------------3
 Nvidia-smi: 4.3436279296875 GB
    Memory Allocated: 3.0911459922790527  GigaBytes
Max Memory Allocated: 3.0911459922790527  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3494873046875 GB
    Memory Allocated: 3.1280531883239746  GigaBytes
Max Memory Allocated: 3.130540370941162  GigaBytes

rst.shape  torch.Size([1, 326, 256])
m.shape torch.Size([333, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3494873046875 GB
    Memory Allocated: 3.1306228637695312  GigaBytes
Max Memory Allocated: 3.130634307861328  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3494873046875 GB
    Memory Allocated: 3.1306228637695312  GigaBytes
Max Memory Allocated: 3.130634307861328  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 4.3494873046875 GB
    Memory Allocated: 3.131258010864258  GigaBytes
Max Memory Allocated: 3.131258010864258  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 3.1723837852478027  GigaBytes
Max Memory Allocated: 3.175401210784912  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([300, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 3.1751060485839844  GigaBytes
Max Memory Allocated: 3.175401210784912  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 3.1751060485839844  GigaBytes
Max Memory Allocated: 3.175401210784912  GigaBytes

 h.shape torch.Size([1, 300, 256]), torch.Size([1, 300, 256])
----------------------------------------3
 Nvidia-smi: 4.3768310546875 GB
    Memory Allocated: 3.175678253173828  GigaBytes
Max Memory Allocated: 3.175678253173828  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4217529296875 GB
    Memory Allocated: 3.2164716720581055  GigaBytes
Max Memory Allocated: 3.219332695007324  GigaBytes

rst.shape  torch.Size([1, 300, 256])
m.shape torch.Size([266, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.4217529296875 GB
    Memory Allocated: 3.2189979553222656  GigaBytes
Max Memory Allocated: 3.219332695007324  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4217529296875 GB
    Memory Allocated: 3.2189979553222656  GigaBytes
Max Memory Allocated: 3.219332695007324  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 4.4217529296875 GB
    Memory Allocated: 3.2195053100585938  GigaBytes
Max Memory Allocated: 3.2195053100585938  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.259462356567383  GigaBytes
Max Memory Allocated: 3.2622528076171875  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([280, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.2624382972717285  GigaBytes
Max Memory Allocated: 3.262451171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.2624382972717285  GigaBytes
Max Memory Allocated: 3.262451171875  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 4.4666748046875 GB
    Memory Allocated: 3.262972354888916  GigaBytes
Max Memory Allocated: 3.262972354888916  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5135498046875 GB
    Memory Allocated: 3.309511661529541  GigaBytes
Max Memory Allocated: 3.312716007232666  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.5135498046875 GB
    Memory Allocated: 3.3121185302734375  GigaBytes
Max Memory Allocated: 3.312716007232666  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5135498046875 GB
    Memory Allocated: 3.3121185302734375  GigaBytes
Max Memory Allocated: 3.312716007232666  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 4.5135498046875 GB
    Memory Allocated: 3.3125572204589844  GigaBytes
Max Memory Allocated: 3.312716007232666  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5780029296875 GB
    Memory Allocated: 3.352916717529297  GigaBytes
Max Memory Allocated: 3.3557682037353516  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([180, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.5780029296875 GB
    Memory Allocated: 3.355510711669922  GigaBytes
Max Memory Allocated: 3.3557682037353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5780029296875 GB
    Memory Allocated: 3.355510711669922  GigaBytes
Max Memory Allocated: 3.3557682037353516  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 4.5780029296875 GB
    Memory Allocated: 3.355854034423828  GigaBytes
Max Memory Allocated: 3.355854034423828  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6170654296875 GB
    Memory Allocated: 3.389842987060547  GigaBytes
Max Memory Allocated: 3.3922462463378906  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([173, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.6170654296875 GB
    Memory Allocated: 3.3921656608581543  GigaBytes
Max Memory Allocated: 3.3922462463378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6170654296875 GB
    Memory Allocated: 3.3921656608581543  GigaBytes
Max Memory Allocated: 3.3922462463378906  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 4.6170654296875 GB
    Memory Allocated: 3.392495632171631  GigaBytes
Max Memory Allocated: 3.392495632171631  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.6619873046875 GB
    Memory Allocated: 3.4274725914001465  GigaBytes
Max Memory Allocated: 3.4299473762512207  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([174, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.6619873046875 GB
    Memory Allocated: 3.429983615875244  GigaBytes
Max Memory Allocated: 3.4299941062927246  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6619873046875 GB
    Memory Allocated: 3.429983615875244  GigaBytes
Max Memory Allocated: 3.4299941062927246  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 4.6619873046875 GB
    Memory Allocated: 3.4303154945373535  GigaBytes
Max Memory Allocated: 3.4303154945373535  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7088623046875 GB
    Memory Allocated: 3.467817783355713  GigaBytes
Max Memory Allocated: 3.470472812652588  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([163, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.7088623046875 GB
    Memory Allocated: 3.470315456390381  GigaBytes
Max Memory Allocated: 3.470472812652588  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7088623046875 GB
    Memory Allocated: 3.470315456390381  GigaBytes
Max Memory Allocated: 3.470472812652588  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 4.7088623046875 GB
    Memory Allocated: 3.4706263542175293  GigaBytes
Max Memory Allocated: 3.4706263542175293  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7186279296875 GB
    Memory Allocated: 3.507934093475342  GigaBytes
Max Memory Allocated: 3.5105767250061035  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([172, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.7186279296875 GB
    Memory Allocated: 3.5107545852661133  GigaBytes
Max Memory Allocated: 3.5107665061950684  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7186279296875 GB
    Memory Allocated: 3.5107545852661133  GigaBytes
Max Memory Allocated: 3.5107665061950684  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 4.7186279296875 GB
    Memory Allocated: 3.511082649230957  GigaBytes
Max Memory Allocated: 3.511082649230957  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.5527467727661133  GigaBytes
Max Memory Allocated: 3.555699348449707  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([145, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.5552310943603516  GigaBytes
Max Memory Allocated: 3.555699348449707  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.5552310943603516  GigaBytes
Max Memory Allocated: 3.555699348449707  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.7713623046875 GB
    Memory Allocated: 3.5555076599121094  GigaBytes
Max Memory Allocated: 3.555699348449707  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.5925674438476562  GigaBytes
Max Memory Allocated: 3.5951948165893555  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([147, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.595254898071289  GigaBytes
Max Memory Allocated: 3.5952658653259277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.595254898071289  GigaBytes
Max Memory Allocated: 3.5952658653259277  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 4.7987060546875 GB
    Memory Allocated: 3.5955352783203125  GigaBytes
Max Memory Allocated: 3.5955352783203125  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8416748046875 GB
    Memory Allocated: 3.635068893432617  GigaBytes
Max Memory Allocated: 3.638443946838379  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([150, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8416748046875 GB
    Memory Allocated: 3.6383275985717773  GigaBytes
Max Memory Allocated: 3.638443946838379  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8416748046875 GB
    Memory Allocated: 3.6383275985717773  GigaBytes
Max Memory Allocated: 3.638443946838379  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 4.8416748046875 GB
    Memory Allocated: 3.638613700866699  GigaBytes
Max Memory Allocated: 3.638613700866699  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.6809568405151367  GigaBytes
Max Memory Allocated: 3.6839609146118164  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([90, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.6827168464660645  GigaBytes
Max Memory Allocated: 3.6839609146118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.6827168464660645  GigaBytes
Max Memory Allocated: 3.6839609146118164  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 4.9061279296875 GB
    Memory Allocated: 3.6828885078430176  GigaBytes
Max Memory Allocated: 3.6839609146118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9315185546875 GB
    Memory Allocated: 3.709496021270752  GigaBytes
Max Memory Allocated: 3.7113842964172363  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([111, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.9315185546875 GB
    Memory Allocated: 3.7118639945983887  GigaBytes
Max Memory Allocated: 3.7118735313415527  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9315185546875 GB
    Memory Allocated: 3.7118639945983887  GigaBytes
Max Memory Allocated: 3.7118735313415527  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 4.9315185546875 GB
    Memory Allocated: 3.712075710296631  GigaBytes
Max Memory Allocated: 3.712075710296631  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9647216796875 GB
    Memory Allocated: 3.7463736534118652  GigaBytes
Max Memory Allocated: 3.7488083839416504  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([109, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.9647216796875 GB
    Memory Allocated: 3.748782157897949  GigaBytes
Max Memory Allocated: 3.7488083839416504  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.9647216796875 GB
    Memory Allocated: 3.748782157897949  GigaBytes
Max Memory Allocated: 3.7488083839416504  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 4.9647216796875 GB
    Memory Allocated: 3.748990058898926  GigaBytes
Max Memory Allocated: 3.748990058898926  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9998779296875 GB
    Memory Allocated: 3.784125328063965  GigaBytes
Max Memory Allocated: 3.7866201400756836  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([2811, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0682373046875 GB
    Memory Allocated: 3.851564884185791  GigaBytes
Max Memory Allocated: 3.8518271446228027  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0682373046875 GB
    Memory Allocated: 3.851564884185791  GigaBytes
Max Memory Allocated: 3.8518271446228027  GigaBytes

 h.shape torch.Size([1, 2811, 256]), torch.Size([1, 2811, 256])
----------------------------------------3
 Nvidia-smi: 5.0682373046875 GB
    Memory Allocated: 3.856926441192627  GigaBytes
Max Memory Allocated: 3.856926441192627  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.8128132820129395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2811, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.691689491271973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.6936798095703125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.695367336273193  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.693292617797852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11322, 40])
input nodes number: 41829
output nodes number: 11322
edges number: 134632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.695679187774658  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.1600341796875 GB
    Memory Allocated: 4.695680141448975  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.05047130584716797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 1 input nodes size: 88944
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.040831565856933594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.040831565856933594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.08324337005615234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.08332586288452148  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.05003833770751953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.053702354431152344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.053702354431152344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.053702354431152344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([88944, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.4237060546875 GB
    Memory Allocated: 0.053702354431152344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2537, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.24320697784423828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.24320697784423828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2537, 128]), torch.Size([1, 2537, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.24659395217895508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.2667808532714844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2537, 128])
m.shape torch.Size([2740, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.26818418502807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.26818418502807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2740, 128]), torch.Size([1, 2740, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.2715315818786621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.310727596282959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2740, 128])
m.shape torch.Size([2575, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.31330060958862305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.31330060958862305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.31583356857299805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.3726487159729004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
m.shape torch.Size([2332, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.3758687973022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.3758687973022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2332, 128]), torch.Size([1, 2332, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.37820959091186523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.44606637954711914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2332, 128])
m.shape torch.Size([2253, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.45032596588134766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.45032596588134766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2253, 128]), torch.Size([1, 2253, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.4533371925354004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.5365414619445801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2253, 128])
m.shape torch.Size([2021, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.5402736663818359  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.5402736663818359  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2021, 128]), torch.Size([1, 2021, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.542201042175293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.626190185546875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2021, 128])
m.shape torch.Size([1936, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.6316885948181152  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.6316885948181152  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1936, 128]), torch.Size([1, 1936, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.6335349082946777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.7300124168395996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1936, 128])
m.shape torch.Size([1791, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.7359213829040527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.7359213829040527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1791, 128]), torch.Size([1, 1791, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.7376294136047363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.8349871635437012  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1791, 128])
m.shape torch.Size([1729, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.8415532112121582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.8415532112121582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1729, 128]), torch.Size([1, 1729, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.8432021141052246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 0.9487318992614746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1729, 128])
m.shape torch.Size([29232, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 1.087296485900879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 1.087296485900879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 29232, 128]), torch.Size([1, 29232, 128])
----------------------------------------3
 Nvidia-smi: 6.6072998046875 GB
    Memory Allocated: 1.1151742935180664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.110428810119629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 29232, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 2.9348092079162598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 2.9816784858703613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.028547763824463  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 2.9813122749328613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([49146, 256])
first layer input nodes number: 88944
first layer output nodes number: 49146
edges number: 384222
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.029212474822998  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.0760817527770996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.0878005027770996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.0878005027770996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1562, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.1930837631225586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.1930837631225586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1562, 256]), torch.Size([1, 1562, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.1964340209960938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.2222976684570312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1562, 256])
m.shape torch.Size([1326, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.223616600036621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.223616600036621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1326, 256]), torch.Size([1, 1326, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.226393699645996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.2683019638061523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1326, 256])
m.shape torch.Size([989, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.2699780464172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.2699780464172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.271864414215088  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.313401699066162  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 989, 256])
m.shape torch.Size([749, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.315937042236328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.315937042236328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 749, 256]), torch.Size([1, 749, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.3173656463623047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.362236976623535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 749, 256])
m.shape torch.Size([657, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.364680290222168  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.364680290222168  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.365933418273926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.412883758544922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([524, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4159278869628906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4159278869628906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4169273376464844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4599037170410156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([397, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4620752334594727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.4620752334594727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 397, 256]), torch.Size([1, 397, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.462832450866699  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.505181312561035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 397, 256])
m.shape torch.Size([339, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.508272647857666  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.508272647857666  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.5089192390441895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.547609806060791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([319, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.550045967102051  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.550045967102051  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.550654411315918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.5898919105529785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([267, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.59232759475708  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.59232759475708  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.592836856842041  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.630250930786133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([245, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.63258695602417  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.63258695602417  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.633054256439209  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.669503688812256  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([219, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.6717963218688965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.6717963218688965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.6722140312194824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.707719326019287  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([188, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.709859848022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.709859848022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7102184295654297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7432079315185547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.745410442352295  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.745410442352295  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7457480430603027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.779170513153076  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([186, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7819056510925293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7819056510925293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.7822604179382324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8198657035827637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8219337463378906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8219337463378906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8222122192382812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.853679656982422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([132, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8556976318359375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8556976318359375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8559494018554688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8861618041992188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([127, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.888233184814453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.888233184814453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.8884754180908203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.919239044189453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([128, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9214553833007812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9214553833007812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9216995239257812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9544143676757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.956407070159912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.956407070159912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9566168785095215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9861998558044434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9888176918029785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.9888176918029785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 3.989014148712158  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.018089771270752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([92, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.019937038421631  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.019937038421631  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.02011251449585  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.047311305999756  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.048837661743164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.048837661743164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.048976898193359  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.071533203125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([82, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.073355197906494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.073355197906494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.073511600494385  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.0999436378479  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([1898, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.145471096038818  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.145471096038818  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1898, 256]), torch.Size([1, 1898, 256])
----------------------------------------3
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.1490912437438965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.786479473114014  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1898, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.691951751708984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.693718910217285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.695363521575928  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.693513870239258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11035, 40])
input nodes number: 49146
output nodes number: 11035
edges number: 107455
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.693739414215088  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.7674560546875 GB
    Memory Allocated: 4.693739891052246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0598297119140625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 2 input nodes size: 54088
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04981517791748047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04981517791748047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0756063461303711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.07569026947021484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03319597244262695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([54088, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03490304946899414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2988, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11448144912719727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11448144912719727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2988, 128]), torch.Size([1, 2988, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11733102798461914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14073610305786133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2988, 128])
m.shape torch.Size([3119, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14228582382202148  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14228582382202148  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3119, 128]), torch.Size([1, 3119, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14551830291748047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.19013595581054688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 3119, 128])
m.shape torch.Size([2771, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1929311752319336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1929311752319336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2771, 128]), torch.Size([1, 2771, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.19561481475830078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2552061080932617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2771, 128])
m.shape torch.Size([2358, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25838232040405273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25838232040405273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2358, 128]), torch.Size([1, 2358, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.260678768157959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3282661437988281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2358, 128])
m.shape torch.Size([2095, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3321366310119629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3321366310119629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2095, 128]), torch.Size([1, 2095, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3342599868774414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4105491638183594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2095, 128])
m.shape torch.Size([1639, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.41423940658569336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.41423940658569336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4158024787902832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4882345199584961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1426, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.49221277236938477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.49221277236938477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4935727119445801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5649266242980957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1266, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5690760612487793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5690760612487793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5702834129333496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6391024589538574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1081, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6431379318237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6431379318237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6441688537597656  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.711524486541748  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([8217, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7501907348632812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7501907348632812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 8217, 128]), torch.Size([1, 8217, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7580270767211914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3144073486328125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 8217, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2473092079162598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2730202674865723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2987313270568848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2728190422058105  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([26960, 256])
first layer input nodes number: 54088
first layer output nodes number: 26960
edges number: 159289
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2991366386413574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.32484769821167  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.331275463104248  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.331275463104248  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2054, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4007673263549805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4007673263549805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2054, 256]), torch.Size([1, 2054, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4048871994018555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4373326301574707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2054, 256])
m.shape torch.Size([1740, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4389443397521973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4389443397521973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1740, 256]), torch.Size([1, 1740, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4429030418395996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4953866004943848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1740, 256])
m.shape torch.Size([1329, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4976158142089844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4976158142089844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1329, 256]), torch.Size([1, 1329, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5002403259277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5595588684082031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1329, 256])
m.shape torch.Size([1060, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5621471405029297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5621471405029297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1060, 256]), torch.Size([1, 1060, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5647788047790527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6278047561645508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1060, 256])
m.shape torch.Size([906, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.631147861480713  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.631147861480713  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.632875919342041  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7004704475402832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([626, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7034931182861328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7034931182861328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 626, 256]), torch.Size([1, 626, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7046871185302734  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7560291290283203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 626, 256])
m.shape torch.Size([486, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7593402862548828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7593402862548828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7602672576904297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8078336715698242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 486, 256])
m.shape torch.Size([430, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8106765747070312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8106765747070312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8114967346191406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8608016967773438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([378, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.863661766052246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.863661766052246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 378, 256]), torch.Size([1, 378, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8643827438354492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9114770889282227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 378, 256])
m.shape torch.Size([294, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9139423370361328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9139423370361328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9145030975341797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9546642303466797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([216, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9566679000854492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9566679000854492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9570798873901367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9892148971557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9913272857666016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9913272857666016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9917106628417969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0242977142333984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([185, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.026752471923828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.026752471923828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0271053314208984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.059568405151367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([167, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0616393089294434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0616393089294434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.061957836151123  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.093492031097412  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([121, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0950775146484375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0950775146484375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.095308303833008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.119771957397461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1213483810424805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1213483810424805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.12155818939209  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.145266532897949  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([95, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.146714210510254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.146714210510254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.146895408630371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1686391830444336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([87, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1700539588928223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1700539588928223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.170219898223877  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1912941932678223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1924896240234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1924896240234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1926231384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2105140686035156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2115817070007324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2115817070007324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2116942405700684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2275614738464355  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2284135818481445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2284135818481445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.228499412536621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2412023544311523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2418785095214844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2418785095214844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.241943359375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.251995086669922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2528252601623535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2528252601623535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.252899646759033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2649502754211426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2655820846557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2655820846557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2656373977661133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2749853134155273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([495, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2868518829345703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2868518829345703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2877960205078125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4589433670043945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 495, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.400458812713623  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.402657985687256  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4043354988098145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.402052402496338  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11256, 40])
input nodes number: 26960
output nodes number: 11256
edges number: 69689
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4027695655822754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4027700424194336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03869485855102539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 3 input nodes size: 72413
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033627986907958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033627986907958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.06815719604492188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.06824111938476562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04236602783203125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04504966735839844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04504966735839844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04504966735839844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([72413, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04504966735839844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2739, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1793532371520996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1793532371520996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2739, 128]), torch.Size([1, 2739, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18196535110473633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2033848762512207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2739, 128])
m.shape torch.Size([2827, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2047748565673828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2047748565673828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2827, 128]), torch.Size([1, 2827, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20747089385986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2507152557373047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2827, 128])
m.shape torch.Size([2431, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25299787521362305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25299787521362305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2431, 128]), torch.Size([1, 2431, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25545215606689453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3071308135986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2431, 128])
m.shape torch.Size([2112, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31035757064819336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31035757064819336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31252384185791016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3732881546020508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([1946, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3769207000732422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3769207000732422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1946, 128]), torch.Size([1, 1946, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37877655029296875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4479217529296875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1946, 128])
m.shape torch.Size([1692, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45183467864990234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45183467864990234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1692, 128]), torch.Size([1, 1692, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4534482955932617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5247020721435547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1692, 128])
m.shape torch.Size([1508, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5291595458984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5291595458984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1508, 128]), torch.Size([1, 1508, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5305976867675781  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6035728454589844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1508, 128])
m.shape torch.Size([1435, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6083278656005859  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6083278656005859  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1435, 128]), torch.Size([1, 1435, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6096963882446289  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6921863555908203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1435, 128])
m.shape torch.Size([1333, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6972227096557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6972227096557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1333, 128]), torch.Size([1, 1333, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6984939575195312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7817320823669434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1333, 128])
m.shape torch.Size([19238, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8728303909301758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8728303909301758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 19238, 128]), torch.Size([1, 19238, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8911771774291992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1937990188598633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 19238, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.07241153717041  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1079463958740234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1434812545776367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.107668399810791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([37261, 256])
first layer input nodes number: 72413
first layer output nodes number: 37261
edges number: 270429
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1440229415893555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1795578002929688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.188441753387451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.188441753387451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1867, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2771224975585938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2771224975585938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1867, 256]), torch.Size([1, 1867, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2811965942382812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.312744140625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1867, 256])
m.shape torch.Size([1606, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.313286304473877  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.313286304473877  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1606, 256]), torch.Size([1, 1606, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3163838386535645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.363903045654297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1606, 256])
m.shape torch.Size([1167, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.365504264831543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.365504264831543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1167, 256]), torch.Size([1, 1167, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.367949962615967  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.419609546661377  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1167, 256])
m.shape torch.Size([827, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.421356678009033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.421356678009033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 827, 256]), torch.Size([1, 827, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.422934055328369  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4686779975891113  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 827, 256])
m.shape torch.Size([759, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4715371131896973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4715371131896973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 759, 256]), torch.Size([1, 759, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.472984790802002  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.525299549102783  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 759, 256])
m.shape torch.Size([574, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.527885913848877  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.527885913848877  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5289807319641113  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5796103477478027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([466, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.582198143005371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.582198143005371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5830869674682617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.628994941711426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([406, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6316723823547363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6316723823547363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.632446765899658  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6773152351379395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([327, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6797566413879395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6797566413879395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.680380344390869  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7206673622131348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([281, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7230563163757324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7230563163757324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7235922813415527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7622523307800293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([252, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.764648914337158  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.764648914337158  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.765129566192627  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8026204109191895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.804767608642578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.804767608642578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8051624298095703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8387222290039062  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([174, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8406991958618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8406991958618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.841031074523926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8715639114379883  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([130, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.873147487640381  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.873147487640381  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8733954429626465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8979430198669434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([122, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.899578094482422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.899578094482422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.899810791015625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9244766235351562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([116, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9261441230773926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9261441230773926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.926365375518799  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.951366901397705  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9527759552001953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9527759552001953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.952953338623047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9742393493652344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9762778282165527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9762778282165527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9764838218688965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0026450157165527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([112, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0045876502990723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0045876502990723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0048012733459473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0334267616271973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0350117683410645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0350117683410645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.035179615020752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0588459968566895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0601954460144043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0601954460144043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.060330867767334  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0803732872009277  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0817012786865234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0817012786865234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.081827163696289  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.101339340209961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1023378372192383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1023378372192383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1024293899536133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1172609329223633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1188530921936035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1188530921936035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.118988513946533  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1418747901916504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1284, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.172659397125244  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.172659397125244  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1284, 256]), torch.Size([1, 1284, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1752495765686035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.609220027923584  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1284, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.532181739807129  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.534727096557617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5363993644714355  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5337700843811035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11222, 40])
input nodes number: 37261
output nodes number: 11222
edges number: 89678
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.534478187561035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5344786643981934  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05088376998901367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 4 input nodes size: 34579
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04271221160888672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04271221160888672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05920076370239258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.059287071228027344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024673938751220703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.026375293731689453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.026375293731689453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.026375293731689453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([34579, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.026375293731689453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2235, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2235, 128]), torch.Size([1, 2235, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.09649133682250977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11491060256958008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2235, 128])
m.shape torch.Size([2267, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11600685119628906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11600685119628906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2267, 128]), torch.Size([1, 2267, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11816883087158203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.15332508087158203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2267, 128])
m.shape torch.Size([2104, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.15434503555297852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.15434503555297852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2104, 128]), torch.Size([1, 2104, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.15642642974853516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2018580436706543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2104, 128])
m.shape torch.Size([1758, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20386457443237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20386457443237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1758, 128]), torch.Size([1, 1758, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20554113388061523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2545008659362793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1758, 128])
m.shape torch.Size([1585, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25744152069091797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25744152069091797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1585, 128]), torch.Size([1, 1585, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2589530944824219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3133697509765625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1585, 128])
m.shape torch.Size([1326, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3164076805114746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3164076805114746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1326, 128]), torch.Size([1, 1326, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3176722526550293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37314748764038086  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1326, 128])
m.shape torch.Size([1141, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3763236999511719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3763236999511719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3774118423461914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.43433094024658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([1002, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4376091957092285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4376091957092285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1002, 128]), torch.Size([1, 1002, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4385647773742676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.49404001235961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1002, 128])
m.shape torch.Size([832, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4971327781677246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4971327781677246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 832, 128]), torch.Size([1, 832, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4979262351989746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5502753257751465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 832, 128])
m.shape torch.Size([7566, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5859560966491699  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5859560966491699  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 7566, 128]), torch.Size([1, 7566, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5931715965270996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1054720878601074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 7566, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0474128723144531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0682182312011719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0890235900878906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0680556297302246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([21816, 256])
first layer input nodes number: 34579
first layer output nodes number: 21816
edges number: 135145
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0892834663391113  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.11008882522583  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1152901649475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1152901649475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1632, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2070341110229492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2070341110229492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1632, 256]), torch.Size([1, 1632, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2108163833618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2357187271118164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1632, 256])
m.shape torch.Size([1419, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2368903160095215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2368903160095215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1419, 256]), torch.Size([1, 1419, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2397198677062988  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2830986976623535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1419, 256])
m.shape torch.Size([1234, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2851643562316895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2851643562316895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1234, 256]), torch.Size([1, 1234, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2877140045166016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3442010879516602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1234, 256])
m.shape torch.Size([939, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3463187217712402  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3463187217712402  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 939, 256]), torch.Size([1, 939, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3481097221374512  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4039397239685059  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 939, 256])
m.shape torch.Size([793, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4068551063537598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4068551063537598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.40836763381958  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4632229804992676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([657, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4662556648254395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4662556648254395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4675087928771973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.522383213043213  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([548, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5259852409362793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5259852409362793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 548, 256]), torch.Size([1, 548, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5270304679870605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5798087120056152  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 548, 256])
m.shape torch.Size([458, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.582808017730713  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.582808017730713  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 458, 256]), torch.Size([1, 458, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.583681583404541  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.634305477142334  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 458, 256])
m.shape torch.Size([401, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6373376846313477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6373376846313477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6381025314331055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6874475479125977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([353, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6904582977294922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6904582977294922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.691131591796875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.741912841796875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([301, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7447586059570312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7447586059570312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 301, 256]), torch.Size([1, 301, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7453327178955078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7903499603271484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 301, 256])
m.shape torch.Size([258, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.793424129486084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.793424129486084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7939162254333496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8382248878479004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([225, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8407902717590332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8407902717590332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.841219425201416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8807015419006348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([209, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8832993507385254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8832993507385254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8836979866027832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9231629371643066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([189, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9256887435913086  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9256887435913086  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9260492324829102  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9642610549926758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([150, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9663877487182617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9663877487182617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9666738510131836  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9990034103393555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([164, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.001980781555176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.001980781555176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.002293586730957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.039830207824707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([119, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0417327880859375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0417327880859375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.041959762573242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0707855224609375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0726447105407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0726447105407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0728507041931152  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1004538536071777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([121, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1026768684387207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1026768684387207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.102907657623291  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.135448932647705  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1374731063842773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1374731063842773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1376752853393555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.167597770690918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([64, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1688499450683594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1688499450683594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1689720153808594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1878929138183594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1894235610961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1894235610961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.189560890197754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.211808204650879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.214071750640869  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.214071750640869  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.214207172393799  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.237093448638916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([991, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.260838031768799  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.260838031768799  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 991, 256]), torch.Size([1, 991, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.262728214263916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.601065158843994  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 991, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5216526985168457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.523667812347412  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.525998592376709  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.523897171020508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11582, 40])
input nodes number: 21816
output nodes number: 11582
edges number: 93138
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.523615837097168  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.523616313934326  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.02911663055419922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 5 input nodes size: 32714
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024143695831298828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024143695831298828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03974294662475586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.039827823638916016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.02325296401977539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024821758270263672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024821758270263672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024821758270263672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([32714, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.024821758270263672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1917, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08545112609863281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08545112609863281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1917, 128]), torch.Size([1, 1917, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0872793197631836  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10218048095703125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1917, 128])
m.shape torch.Size([2072, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10324239730834961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10324239730834961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2072, 128]), torch.Size([1, 2072, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10523319244384766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13742542266845703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2072, 128])
m.shape torch.Size([1873, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13826608657836914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13826608657836914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1873, 128]), torch.Size([1, 1873, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14005231857299805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17934942245483398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1873, 128])
m.shape torch.Size([1639, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18158245086669922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18158245086669922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18314552307128906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22847461700439453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1346, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23090219497680664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23090219497680664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1346, 128]), torch.Size([1, 1346, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23218584060668945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2783970832824707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1346, 128])
m.shape torch.Size([1235, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2817721366882324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2817721366882324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28294992446899414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33359479904174805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1038, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3364706039428711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3364706039428711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1038, 128]), torch.Size([1, 1038, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3374605178833008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.38958168029785156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1038, 128])
m.shape torch.Size([958, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.39274120330810547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.39274120330810547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 958, 128]), torch.Size([1, 958, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.39365482330322266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.44874143600463867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 958, 128])
m.shape torch.Size([779, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4516277313232422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4516277313232422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 779, 128]), torch.Size([1, 779, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45237064361572266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5016083717346191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 779, 128])
m.shape torch.Size([6746, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5334043502807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5334043502807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 6746, 128]), torch.Size([1, 6746, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5398378372192383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0163946151733398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 6746, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9630026817321777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9825339317321777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0020651817321777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9823875427246094  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([19603, 256])
first layer input nodes number: 32714
first layer output nodes number: 19603
edges number: 121777
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0023112297058105  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0218424797058105  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0265164375305176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0265164375305176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1484, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1135821342468262  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1135821342468262  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1484, 256]), torch.Size([1, 1484, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1164813041687012  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.141430377960205  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1484, 256])
m.shape torch.Size([1395, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1428303718566895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1428303718566895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1395, 256]), torch.Size([1, 1395, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1469674110412598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1890931129455566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1395, 256])
m.shape torch.Size([1187, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.191185474395752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.191185474395752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1938214302062988  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2449312210083008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
m.shape torch.Size([952, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.248159408569336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.248159408569336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 952, 256]), torch.Size([1, 952, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2499752044677734  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.305105209350586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 952, 256])
m.shape torch.Size([792, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3086824417114258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3086824417114258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3101930618286133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3651132583618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 792, 256])
m.shape torch.Size([688, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3683257102966309  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3683257102966309  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 688, 256]), torch.Size([1, 688, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3696379661560059  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4262633323669434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 688, 256])
m.shape torch.Size([568, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.429429054260254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.429429054260254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4305124282836914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4847660064697266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([498, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.488053798675537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.488053798675537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4890036582946777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5442137718200684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([417, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5473461151123047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5473461151123047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 417, 256]), torch.Size([1, 417, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5481414794921875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5996360778808594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 417, 256])
m.shape torch.Size([398, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6030640602111816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6030640602111816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.603823184967041  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6577668190002441  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([365, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6612462997436523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6612462997436523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.661942481994629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7162914276123047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([293, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7201848030090332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7201848030090332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 293, 256]), torch.Size([1, 293, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7207436561584473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.76948881149292  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 293, 256])
m.shape torch.Size([238, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7721834182739258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7721834182739258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7726373672485352  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8144006729125977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([203, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8169054985046387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8169054985046387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8172926902770996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8556246757507324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8577523231506348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8577523231506348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8580594062805176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8906102180480957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([158, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8928866386413574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8928866386413574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8931879997253418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9272418022155762  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([152, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.929574966430664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.929574966430664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9298648834228516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9646549224853516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([134, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9668283462524414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9668283462524414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9670839309692383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9995431900024414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([108, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.001481533050537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.001481533050537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.001687526702881  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0292906761169434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0314178466796875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0314178466796875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0316390991210938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.062835693359375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0647640228271484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0647640228271484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0649566650390625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0934677124023438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0951056480407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0951056480407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.095262050628662  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.119504451751709  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([65, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.120863437652588  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.120863437652588  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1209874153137207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1410717964172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1425094604492188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1425094604492188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1426334381103516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.163585662841797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([737, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.181232452392578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.181232452392578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 737, 256]), torch.Size([1, 737, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.182638168334961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.430044174194336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 737, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.35438871383667  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3563485145568848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3589091300964355  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3568644523620605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11357, 40])
input nodes number: 19603
output nodes number: 11357
edges number: 88607
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3570404052734375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3570408821105957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.027807235717773438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 6 input nodes size: 49498
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023197650909423828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023197650909423828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04680013656616211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04688692092895508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03120279312133789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03316831588745117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03316831588745117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03316831588745117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([49498, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03316831588745117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2243, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11691904067993164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11691904067993164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2243, 128]), torch.Size([1, 2243, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11905813217163086  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1361708641052246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2243, 128])
m.shape torch.Size([2430, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1374187469482422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1374187469482422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2430, 128]), torch.Size([1, 2430, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1406702995300293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17600488662719727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2430, 128])
m.shape torch.Size([2267, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17832231521606445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17832231521606445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2267, 128]), torch.Size([1, 2267, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1806936264038086  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2311391830444336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2267, 128])
m.shape torch.Size([2013, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23298883438110352  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23298883438110352  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2013, 128]), torch.Size([1, 2013, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2349085807800293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2913823127746582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2013, 128])
m.shape torch.Size([1808, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29473304748535156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29473304748535156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1808, 128]), torch.Size([1, 1808, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29645729064941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3591480255126953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1808, 128])
m.shape torch.Size([1553, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3627290725708008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3627290725708008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1553, 128]), torch.Size([1, 1553, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3642101287841797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.42789554595947266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1553, 128])
m.shape torch.Size([1393, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4318046569824219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4318046569824219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1393, 128]), torch.Size([1, 1393, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4331331253051758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5004339218139648  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1393, 128])
m.shape torch.Size([1282, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5046601295471191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5046601295471191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.505882740020752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5755715370178223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1108, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5797152519226074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5797152519226074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1108, 128]), torch.Size([1, 1108, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5807719230651855  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6486907005310059  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1108, 128])
m.shape torch.Size([9842, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6950926780700684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6950926780700684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 9842, 128]), torch.Size([1, 9842, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7044787406921387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.393662929534912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 9842, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.320399284362793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3451366424560547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3698740005493164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3449430465698242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([25939, 256])
first layer input nodes number: 49498
first layer output nodes number: 25939
edges number: 168713
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3702449798583984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3949823379516602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.402008056640625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.402008056640625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1565, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4955835342407227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4955835342407227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1565, 256]), torch.Size([1, 1565, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4994592666625977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.525373935699463  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1565, 256])
m.shape torch.Size([1377, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5264759063720703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5264759063720703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1377, 256]), torch.Size([1, 1377, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.529200553894043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5717029571533203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1377, 256])
m.shape torch.Size([1125, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5730500221252441  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5730500221252441  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1125, 256]), torch.Size([1, 1125, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5752320289611816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6239466667175293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1125, 256])
m.shape torch.Size([970, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6265239715576172  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6265239715576172  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6283740997314453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.682027816772461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([819, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6850385665893555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6850385665893555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 819, 256]), torch.Size([1, 819, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.686600685119629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7429838180541992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 819, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7459111213684082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7459111213684082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7471375465393066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8010172843933105  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([569, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8042945861816406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8042945861816406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 569, 256]), torch.Size([1, 569, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.805379867553711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.861917495727539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 569, 256])
m.shape torch.Size([556, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8663978576660156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8663978576660156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 556, 256]), torch.Size([1, 556, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8674583435058594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9316902160644531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 556, 256])
m.shape torch.Size([422, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9348106384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9348106384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 422, 256]), torch.Size([1, 422, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9356155395507812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9894351959228516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 422, 256])
m.shape torch.Size([384, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9927234649658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9927234649658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 384, 256]), torch.Size([1, 384, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9934558868408203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0465869903564453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 384, 256])
m.shape torch.Size([312, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0495195388793945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0495195388793945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.050114631652832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0987443923950195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.101491928100586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.101491928100586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1019954681396484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.146733283996582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.149280548095703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.149280548095703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.149707794189453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.189014434814453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([214, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.191680431365967  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.191680431365967  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1920886039733887  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2324976921081543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([203, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.235220432281494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.235220432281494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.235607624053955  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2766499519348145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([164, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2789783477783203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2789783477783203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2792911529541016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.314638137817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([152, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3169655799865723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3169655799865723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3172554969787598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3520455360412598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([124, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.354045867919922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.354045867919922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3542823791503906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.384319305419922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([109, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3861918449401855  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3861918449401855  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.386399745941162  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4142584800720215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([113, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4163269996643066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4163269996643066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4165425300598145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.446932315826416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([91, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.448761463165283  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.448761463165283  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.448935031890869  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.474623203277588  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([93, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4765028953552246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4765028953552246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.476680278778076  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5041747093200684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([75, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.505743980407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.505743980407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.505887031555176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5290613174438477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([64, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.530466079711914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.530466079711914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.530588150024414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.551218032836914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([989, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.574921131134033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.574921131134033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 989, 256]), torch.Size([1, 989, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5768074989318848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.918154239654541  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 989, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8370866775512695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.839076519012451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.840808391571045  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8387317657470703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11621, 40])
input nodes number: 25939
output nodes number: 11621
edges number: 94863
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8390421867370605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8390426635742188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.036951541900634766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 7 input nodes size: 31284
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031232833862304688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031232833862304688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04615020751953125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.046236515045166016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.022547245025634766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([31284, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.023823261260986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2801, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.07671880722045898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.07671880722045898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2801, 128]), torch.Size([1, 2801, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0794363021850586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10179281234741211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2801, 128])
m.shape torch.Size([2901, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10322380065917969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10322380065917969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2901, 128]), torch.Size([1, 2901, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10599040985107422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1500988006591797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2901, 128])
m.shape torch.Size([2459, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.151580810546875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.151580810546875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2459, 128]), torch.Size([1, 2459, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.15490436553955078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20691776275634766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2459, 128])
m.shape torch.Size([2037, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20979642868041992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20979642868041992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2037, 128]), torch.Size([1, 2037, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21173906326293945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26906251907348633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2037, 128])
m.shape torch.Size([1696, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.27213478088378906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.27213478088378906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1696, 128]), torch.Size([1, 1696, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.27375221252441406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33269309997558594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1696, 128])
m.shape torch.Size([1317, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33565235137939453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33565235137939453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33690834045410156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3913307189941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([1120, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3948855400085449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3948855400085449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1120, 128]), torch.Size([1, 1120, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3959536552429199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4493594169616699  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1120, 128])
m.shape torch.Size([885, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45220136642456055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45220136642456055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 885, 128]), torch.Size([1, 885, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4530453681945801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5024580955505371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 885, 128])
m.shape torch.Size([757, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.505314826965332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.505314826965332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 757, 128]), torch.Size([1, 757, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5060367584228516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5535507202148438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 757, 128])
m.shape torch.Size([4265, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5735268592834473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5735268592834473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 4265, 128]), torch.Size([1, 4265, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5775942802429199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8663811683654785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 4265, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8232183456420898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8427495956420898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8622808456420898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8425984382629395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([20238, 256])
first layer input nodes number: 31284
first layer output nodes number: 20238
edges number: 104893
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.862515926361084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.882047176361084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8875842094421387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8875842094421387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2007, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9540085792541504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9540085792541504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2007, 256]), torch.Size([1, 2007, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9578366279602051  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9895577430725098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2007, 256])
m.shape torch.Size([1839, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9911789894104004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9911789894104004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1839, 256]), torch.Size([1, 1839, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9952006340026855  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0480904579162598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1839, 256])
m.shape torch.Size([1434, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0504717826843262  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0504717826843262  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1434, 256]), torch.Size([1, 1434, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0532894134521484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1166934967041016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1434, 256])
m.shape torch.Size([1150, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1195645332336426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1195645332336426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1150, 256]), torch.Size([1, 1150, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.121872901916504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1885981559753418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1150, 256])
m.shape torch.Size([925, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1919808387756348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1919808387756348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 925, 256]), torch.Size([1, 925, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1937451362609863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.257514476776123  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 925, 256])
m.shape torch.Size([709, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.260721206665039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.260721206665039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 709, 256]), torch.Size([1, 709, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2620735168457031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.322183609008789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 709, 256])
m.shape torch.Size([613, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.325632095336914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.325632095336914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 613, 256]), torch.Size([1, 613, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3268013000488281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3869094848632812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 613, 256])
m.shape torch.Size([459, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3898544311523438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3898544311523438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3907299041748047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4427919387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([379, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.446152687072754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.446152687072754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4468755722045898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4952754974365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([322, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4985661506652832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4985661506652832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4991803169250488  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5427861213684082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([246, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5450801849365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5450801849365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 246, 256]), torch.Size([1, 246, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5455493927001953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5821475982666016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 246, 256])
m.shape torch.Size([215, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.58439302444458  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.58439302444458  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 215, 256]), torch.Size([1, 215, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5848031044006348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6196599006652832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 215, 256])
m.shape torch.Size([192, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6218538284301758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6218538284301758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6222200393676758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6559114456176758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([154, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6578006744384766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6578006744384766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6580944061279297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.687173843383789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([134, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6889591217041016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6889591217041016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6892147064208984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7163066864013672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([93, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7176094055175781  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7176094055175781  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7177867889404297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7378311157226562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7390332221984863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7390332221984863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7391839027404785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.757265567779541  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([77, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7585225105285645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7585225105285645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.758669376373291  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7773213386535645  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.77827787399292  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.77827787399292  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7783846855163574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7926974296569824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7936859130859375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7936859130859375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7937870025634766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8080406188964844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8090357780456543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8090357780456543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.809131145477295  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8232455253601074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8239383697509766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8239383697509766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.824005126953125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8343524932861328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8351149559020996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8351149559020996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8351836204528809  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8463072776794434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8470573425292969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8470573425292969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8471221923828125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8580818176269531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([255, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8641767501831055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8641767501831055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8646631240844727  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9502649307250977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 255, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8961396217346191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8978934288024902  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8996143341064453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8977742195129395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11546, 40])
input nodes number: 20238
output nodes number: 11546
edges number: 66188
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.897775650024414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8977761268615723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.026174068450927734  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03172445297241211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03172445297241211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02190461754798889 |0.04377773404121399 |0.18668410181999207 |0.00011539459228515625 |0.0765693187713623 |0.005906105041503906 |
----------------------------------------------------------pseudo_mini_loss sum 5.327828884124756
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  675117
Number of first layer input nodes during this epoch:  432325
Number of first layer output nodes during this epoch:  242792
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031723976135253906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01729440689086914
global_2_local spend time (sec) 0.043215036392211914
----------------------------  graph partition start---------------------
[05:13:35] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23400434 edges into 8 parts and get 4100897 edge cuts
g = dgl.graph((u,v))  spent  0.004246950149536133
A = g.adjacency_matrix() spent  0.007682085037231445
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08053851127624512
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.322782278060913
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.3375015258789062

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f5

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434})
Convert a graph into a bidirected graph: 1.037 seconds
Metis partitioning: 4.721 seconds
Split the graph: 1.365 seconds
Construct subgraphs: 0.054 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.189144611358643
11197
11518
11648
11603
11147
11193
11035
11600
total k batches seeds list generation spend  18.077475786209106
after graph partition
graph partition algorithm spend time 18.171712160110474
11197
11518
11648
11603
11147
11193
11035
11600
partition_len_list
[19503, 23012, 25425, 20380, 30620, 36196, 47095, 43322]
shared_neighbor_graph_partition_s0 selection method  spend 18.26862096786499
time for parepare:  0.018502473831176758
local_output_nid generation:  0.0023458003997802734
local_in_edges_tensor generation:  0.0024535655975341797
mini_batch_src_global generation:  0.017137527465820312
r_  generation:  0.032991647720336914
local_output_nid generation:  0.0039060115814208984
local_in_edges_tensor generation:  0.0026743412017822266
mini_batch_src_global generation:  0.018121004104614258
r_  generation:  0.03393435478210449
local_output_nid generation:  0.003314495086669922
local_in_edges_tensor generation:  0.002545595169067383
mini_batch_src_global generation:  0.0038650035858154297
r_  generation:  0.034001827239990234
local_output_nid generation:  0.0031168460845947266
local_in_edges_tensor generation:  0.002373933792114258
mini_batch_src_global generation:  0.002800464630126953
r_  generation:  0.024309158325195312
local_output_nid generation:  0.003017425537109375
local_in_edges_tensor generation:  0.002063751220703125
mini_batch_src_global generation:  0.0023517608642578125
r_  generation:  0.025975465774536133
local_output_nid generation:  0.0029251575469970703
local_in_edges_tensor generation:  0.002338409423828125
mini_batch_src_global generation:  0.0032629966735839844
r_  generation:  0.0318605899810791
local_output_nid generation:  0.0030503273010253906
local_in_edges_tensor generation:  0.0024099349975585938
mini_batch_src_global generation:  0.0035507678985595703
r_  generation:  0.03563380241394043
local_output_nid generation:  0.0037391185760498047
local_in_edges_tensor generation:  0.0032052993774414062
mini_batch_src_global generation:  0.005180835723876953
r_  generation:  0.04970145225524902
----------------------check_connections_block total spend ----------------------------- 0.4638957977294922
generate_one_block  0.046712636947631836
generate_one_block  0.0426640510559082
generate_one_block  0.04241061210632324
generate_one_block  0.030521392822265625
generate_one_block  0.03455185890197754
generate_one_block  0.04375338554382324
generate_one_block  0.0510098934173584
generate_one_block  0.06762313842773438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03915834426879883
gen group dst list time:  0.0070362091064453125
time for parepare:  0.022794008255004883
local_output_nid generation:  0.0035703182220458984
local_in_edges_tensor generation:  0.017856359481811523
mini_batch_src_global generation:  0.004112958908081055
r_  generation:  0.04290580749511719
local_output_nid generation:  0.0058519840240478516
local_in_edges_tensor generation:  0.00480341911315918
mini_batch_src_global generation:  0.006018161773681641
r_  generation:  0.05380821228027344
local_output_nid generation:  0.006856203079223633
local_in_edges_tensor generation:  0.005773305892944336
mini_batch_src_global generation:  0.005583047866821289
r_  generation:  0.0637059211730957
local_output_nid generation:  0.005655050277709961
local_in_edges_tensor generation:  0.004267215728759766
mini_batch_src_global generation:  0.00429534912109375
r_  generation:  0.04206395149230957
local_output_nid generation:  0.007742404937744141
local_in_edges_tensor generation:  0.0065004825592041016
mini_batch_src_global generation:  0.0063974857330322266
r_  generation:  0.07538485527038574
local_output_nid generation:  0.009023427963256836
local_in_edges_tensor generation:  0.010206222534179688
mini_batch_src_global generation:  0.010174751281738281
r_  generation:  0.10009503364562988
local_output_nid generation:  0.011931419372558594
local_in_edges_tensor generation:  0.012314558029174805
mini_batch_src_global generation:  0.013754606246948242
r_  generation:  0.1386425495147705
local_output_nid generation:  0.009621143341064453
local_in_edges_tensor generation:  0.009641408920288086
mini_batch_src_global generation:  0.014773130416870117
r_  generation:  0.12347745895385742
----------------------check_connections_block total spend ----------------------------- 1.0185070037841797
generate_one_block  0.06880044937133789
generate_one_block  0.06818914413452148
generate_one_block  0.0784006118774414
generate_one_block  0.06814193725585938
generate_one_block  0.0933997631072998
generate_one_block  0.1256401538848877
generate_one_block  0.1705188751220703
generate_one_block  0.16287612915039062
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031723976135253906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

connection checking time:  1.0185070037841797
block generation total time  0.8359670639038086
average batch blocks generation time:  0.10449588298797607
block dataloader generation time/epoch 21.127062797546387
pseudo mini batch 0 input nodes size: 33614
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.027860641479492188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.027860641479492188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04388904571533203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04397249221801758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.02896881103515625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030574798583984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030574798583984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030574798583984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([33614, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030574798583984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1718, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0923299789428711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0923299789428711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.09396839141845703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10730171203613281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
m.shape torch.Size([1958, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10851192474365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10851192474365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1958, 128]), torch.Size([1, 1958, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11037921905517578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13890361785888672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1958, 128])
m.shape torch.Size([1767, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14050054550170898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14050054550170898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1767, 128]), torch.Size([1, 1767, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14218568801879883  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1792588233947754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1767, 128])
m.shape torch.Size([1588, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18144512176513672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18144512176513672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1588, 128]), torch.Size([1, 1588, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18295955657958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22687816619873047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1588, 128])
m.shape torch.Size([1340, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22931575775146484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22931575775146484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1340, 128]), torch.Size([1, 1340, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23059368133544922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2768278121948242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1340, 128])
m.shape torch.Size([1240, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2797365188598633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2797365188598633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1240, 128]), torch.Size([1, 1240, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28091907501220703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3319244384765625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1240, 128])
m.shape torch.Size([1094, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33498477935791016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.33498477935791016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3360280990600586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3889131546020508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([967, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.39208030700683594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.39208030700683594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3930025100708008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4481773376464844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([822, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45124387741088867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45124387741088867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 822, 128]), torch.Size([1, 822, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4520277976989746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5045104026794434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 822, 128])
m.shape torch.Size([7009, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5375399589538574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5375399589538574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 7009, 128]), torch.Size([1, 7009, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5442242622375488  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.025784969329834  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 7009, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9720973968505859  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9916286468505859  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.011159896850586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.991483211517334  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([19503, 256])
first layer input nodes number: 33614
first layer output nodes number: 19503
edges number: 124309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0114126205444336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0309438705444336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0355939865112305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0355939865112305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1337, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1247973442077637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1247973442077637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1337, 256]), torch.Size([1, 1337, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.127368450164795  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1485390663146973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1337, 256])
m.shape torch.Size([1305, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.149665355682373  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.149665355682373  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1305, 256]), torch.Size([1, 1305, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.152656078338623  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1923413276672363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1305, 256])
m.shape torch.Size([1100, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1938209533691406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1938209533691406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1100, 256]), torch.Size([1, 1100, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1959590911865234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2467670440673828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1100, 256])
m.shape torch.Size([951, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2485246658325195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2485246658325195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 951, 256]), torch.Size([1, 951, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2503385543823242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3057146072387695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 951, 256])
m.shape torch.Size([764, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3092994689941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3092994689941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 764, 256]), torch.Size([1, 764, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3107566833496094  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3646354675292969  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 764, 256])
m.shape torch.Size([702, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.367955207824707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.367955207824707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3692941665649414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4274396896362305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([583, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4306926727294922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4306926727294922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4318046569824219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4889187812805176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([487, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4921073913574219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4921073913574219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4930362701416016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5479307174682617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([441, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.551281452178955  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.551281452178955  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 441, 256]), torch.Size([1, 441, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5521225929260254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6059556007385254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 441, 256])
m.shape torch.Size([398, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.609360694885254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.609360694885254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6101198196411133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.664475440979004  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([360, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6679019927978516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6679019927978516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.668588638305664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.722757339477539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([308, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.725966453552246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.725966453552246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7265539169311523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7778887748718262  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([253, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7807564735412598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7807564735412598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7812390327453613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.825634479522705  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([231, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8285017013549805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8285017013549805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 231, 256]), torch.Size([1, 231, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8289422988891602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8725614547729492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 231, 256])
m.shape torch.Size([169, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8747777938842773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8747777938842773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8751001358032227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9092683792114258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([166, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9117956161499023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9117956161499023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9121122360229492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.947890281677246  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([157, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9502973556518555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9502973556518555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.950596809387207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9865312576293945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([146, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.988907814025879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.988907814025879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9891862869262695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.024552345275879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0264768600463867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0264768600463867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0266923904418945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0555734634399414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.057676315307617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.057676315307617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0578956604003906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0888233184814453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.090853214263916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.090853214263916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.091055393218994  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1209778785705566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([82, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1226110458374023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1226110458374023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.122767448425293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.14700984954834  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.148545742034912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.148545742034912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1486849784851074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.171241283416748  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.172809600830078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.172809600830078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.172945022583008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.195831298828125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([779, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.215440273284912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.215440273284912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 779, 256]), torch.Size([1, 779, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.216926097869873  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.478628635406494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 779, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4008588790893555  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4025511741638184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.404252529144287  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4024767875671387  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11197, 40])
input nodes number: 19503
output nodes number: 11197
edges number: 91011
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.402644157409668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4026451110839844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03361225128173828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 1 input nodes size: 38656
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.028908252716064453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.028908252716064453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04734086990356445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.047426700592041016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031314849853515625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033123016357421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033123016357421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033123016357421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([38656, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.033123016357421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2169, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10647249221801758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10647249221801758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2169, 128]), torch.Size([1, 2169, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10854101181030273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.12508916854858398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2169, 128])
m.shape torch.Size([2223, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1261749267578125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1261749267578125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2223, 128]), torch.Size([1, 2223, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1293034553527832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16127967834472656  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2223, 128])
m.shape torch.Size([2058, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16339969635009766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16339969635009766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16541528701782227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2112874984741211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([1772, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21325016021728516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21325016021728516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1772, 128]), torch.Size([1, 1772, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21494007110595703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26399993896484375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1772, 128])
m.shape torch.Size([1653, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26709604263305664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26709604263305664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1653, 128]), torch.Size([1, 1653, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26867246627807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3254237174987793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1653, 128])
m.shape torch.Size([1354, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3285093307495117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3285093307495117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3298006057739258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.38532543182373047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([1203, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.38869524002075195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.38869524002075195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1203, 128]), torch.Size([1, 1203, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.38984251022338867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.44843387603759766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1203, 128])
m.shape torch.Size([1081, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4519839286804199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4519839286804199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4530148506164551  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.512570858001709  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([921, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5160079002380371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5160079002380371  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5168862342834473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5733776092529297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([8578, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6138415336608887  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6138415336608887  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 8578, 128]), torch.Size([1, 8578, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6220221519470215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2028460502624512  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 8578, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1404972076416016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1624431610107422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1843891143798828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.162271499633789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([23012, 256])
first layer input nodes number: 38656
first layer output nodes number: 23012
edges number: 147404
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1846790313720703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.206624984741211  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.212111473083496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.212111473083496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1609, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3055481910705566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3055481910705566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1609, 256]), torch.Size([1, 1609, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3087067604064941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3334040641784668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1609, 256])
m.shape torch.Size([1371, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3350601196289062  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3350601196289062  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1371, 256]), torch.Size([1, 1371, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3378372192382812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3786849975585938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1371, 256])
m.shape torch.Size([1191, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3808403015136719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3808403015136719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1191, 256]), torch.Size([1, 1191, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3831977844238281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.435473918914795  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1191, 256])
m.shape torch.Size([889, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4374032020568848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4374032020568848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 889, 256]), torch.Size([1, 889, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.439098834991455  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4895939826965332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 889, 256])
m.shape torch.Size([798, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4925813674926758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4925813674926758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4941034317016602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.550786018371582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([630, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5536584854125977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5536584854125977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5548601150512695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6175994873046875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([546, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6206722259521484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6206722259521484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.621713638305664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6746740341186523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([467, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6777443885803223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6777443885803223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 467, 256]), torch.Size([1, 467, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6786351203918457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7294068336486816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 467, 256])
m.shape torch.Size([407, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7324824333190918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7324824333190918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 407, 256]), torch.Size([1, 407, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7332587242126465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7836737632751465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 407, 256])
m.shape torch.Size([352, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7866687774658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7866687774658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 352, 256]), torch.Size([1, 352, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7873401641845703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8355731964111328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 352, 256])
m.shape torch.Size([306, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.838472843170166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.838472843170166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8390564918518066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8865303993225098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([260, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.889237403869629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.889237403869629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 260, 256]), torch.Size([1, 260, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8897333145141602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.933699607849121  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 260, 256])
m.shape torch.Size([223, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9362382888793945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9362382888793945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 223, 256]), torch.Size([1, 223, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9366636276245117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.975794792175293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 223, 256])
m.shape torch.Size([209, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9783945083618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9783945083618164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9787931442260742  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0182580947875977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([189, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0207839012145996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0207839012145996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.021144390106201  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.059356212615967  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([155, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0615596771240234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0615596771240234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0618553161621094  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0952625274658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([172, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0979251861572266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0979251861572266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0982532501220703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1376209259033203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1395678520202637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1395678520202637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.139800548553467  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1693530082702637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1713085174560547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1713085174560547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.171518325805664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1996326446533203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([126, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2019500732421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2019500732421875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.202190399169922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2360763549804688  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.238095760345459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.238095760345459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.238297939300537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2682204246520996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([70, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2695999145507812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2695999145507812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.269733428955078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2904281616210938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.292086124420166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.292086124420166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2922348976135254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.316336154937744  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3178768157958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3178768157958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3180103302001953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.340574264526367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1062, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.366025447845459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.366025447845459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1062, 256]), torch.Size([1, 1062, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.36812162399292  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.731292247772217  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1062, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6497344970703125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6516799926757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6533966064453125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.651365280151367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11518, 40])
input nodes number: 23012
output nodes number: 11518
edges number: 95137
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6518759727478027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.651876449584961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03682565689086914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 2 input nodes size: 45598
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031568050384521484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.031568050384521484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05331087112426758  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05339765548706055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.034879207611083984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03677701950073242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03677701950073242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03677701950073242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([45598, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03677701950073242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2295, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11742210388183594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11742210388183594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2295, 128]), torch.Size([1, 2295, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11961078643798828  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13712024688720703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2295, 128])
m.shape torch.Size([2484, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13839483261108398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.13839483261108398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2484, 128]), torch.Size([1, 2484, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1411905288696289  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17677879333496094  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2484, 128])
m.shape torch.Size([2347, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17914772033691406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17914772033691406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2347, 128]), torch.Size([1, 2347, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.18138599395751953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23273754119873047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2347, 128])
m.shape torch.Size([2034, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23609495162963867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23609495162963867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2034, 128]), torch.Size([1, 2034, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23803472518920898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29460859298706055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2034, 128])
m.shape torch.Size([1822, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29798269271850586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29798269271850586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1822, 128]), torch.Size([1, 1822, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.29972028732299805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3626980781555176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1822, 128])
m.shape torch.Size([1510, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3661494255065918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3661494255065918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1510, 128]), torch.Size([1, 1510, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.36758947372436523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.43030500411987305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1510, 128])
m.shape torch.Size([1330, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4340243339538574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4340243339538574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.43529272079467773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.49871206283569336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1275, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5029416084289551  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5029416084289551  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1275, 128]), torch.Size([1, 1275, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.504157543182373  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5734658241271973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1275, 128])
m.shape torch.Size([1106, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5776042938232422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5776042938232422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1106, 128]), torch.Size([1, 1106, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5786590576171875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6461639404296875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1106, 128])
m.shape torch.Size([9222, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.689610481262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.689610481262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 9222, 128]), torch.Size([1, 9222, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6984052658081055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3228349685668945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 9222, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2526941299438477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2769412994384766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3011884689331055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2767515182495117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([25425, 256])
first layer input nodes number: 45598
first layer output nodes number: 25425
edges number: 162294
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.301530361175537  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.325777530670166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3318395614624023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3318395614624023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1568, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4225883483886719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4225883483886719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1568, 256]), torch.Size([1, 1568, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.425708293914795  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4502301216125488  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1568, 256])
m.shape torch.Size([1462, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4516043663024902  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4516043663024902  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1462, 256]), torch.Size([1, 1462, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4547476768493652  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5009851455688477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1462, 256])
m.shape torch.Size([1202, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5033106803894043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5033106803894043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.505652904510498  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5575480461120605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([1002, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5605249404907227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5605249404907227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1002, 256]), torch.Size([1, 1002, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5624361038208008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6204376220703125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1002, 256])
m.shape torch.Size([820, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6234230995178223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6234230995178223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6249871253967285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6816697120666504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([621, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.684469223022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.684469223022461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6856536865234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7435331344604492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([549, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7466349601745605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7466349601745605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 549, 256]), torch.Size([1, 549, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7476820945739746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8005175590515137  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 549, 256])
m.shape torch.Size([517, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.803969383239746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.803969383239746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 517, 256]), torch.Size([1, 517, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8049554824829102  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8612775802612305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 517, 256])
m.shape torch.Size([427, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.864478588104248  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.864478588104248  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.865293025970459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9258332252502441  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 427, 256])
m.shape torch.Size([369, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9289727210998535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9289727210998535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9296765327453613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9801678657531738  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([330, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9833049774169922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9833049774169922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9839344024658203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0350236892700195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([269, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.037811756134033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.037811756134033  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0383248329162598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.083461284637451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([254, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.086378574371338  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.086378574371338  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0868630409240723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1314339637756348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([212, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.134256362915039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.134256362915039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1346607208251953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.174692153930664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([197, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.177330493927002  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.177330493927002  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.177706241607666  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2175354957580566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([157, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2197623252868652  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2197623252868652  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.220061779022217  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2539000511169434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([136, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2559728622436523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2559728622436523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.256232261657715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.287360191345215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.289168357849121  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.289168357849121  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.289381980895996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.316512107849121  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([124, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3186697959899902  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3186697959899902  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.318906307220459  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3505988121032715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.352691173553467  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.352691173553467  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3529105186462402  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.383838176727295  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([89, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3855252265930176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3855252265930176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.385694980621338  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.410818576812744  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([92, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4126791954040527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4126791954040527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4128546714782715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4400534629821777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4420132637023926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4420132637023926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4421257972717285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4603562355041504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.46193790435791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.46193790435791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.46207332611084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.484959602355957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([894, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.506373405456543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.506373405456543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 894, 256]), torch.Size([1, 894, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5080785751342773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8090429306030273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 894, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.729306221008301  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.731168746948242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7331104278564453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.731161117553711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11648, 40])
input nodes number: 25425
output nodes number: 11648
edges number: 92327
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7313547134399414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7313551902770996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.040320396423339844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 3 input nodes size: 33037
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03479623794555664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03479623794555664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05054950714111328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05063629150390625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.028806686401367188  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030051231384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030051231384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030051231384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([33037, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.030051231384277344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([3029, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08210611343383789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08210611343383789  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3029, 128]), torch.Size([1, 3029, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08576536178588867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.10992813110351562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 3029, 128])
m.shape torch.Size([3018, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11136198043823242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11136198043823242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3018, 128]), torch.Size([1, 3018, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.11424541473388672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1582317352294922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 3018, 128])
m.shape torch.Size([2491, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16110992431640625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16110992431640625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2491, 128]), torch.Size([1, 2491, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.16349315643310547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21577978134155273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2491, 128])
m.shape torch.Size([2054, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21850967407226562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21850967407226562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2054, 128]), torch.Size([1, 2054, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2205667495727539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.27873659133911133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2054, 128])
m.shape torch.Size([1716, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28090333938598633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28090333938598633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1716, 128]), torch.Size([1, 1716, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28253984451293945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.34389543533325195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1716, 128])
m.shape torch.Size([1332, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.34688806533813477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.34688806533813477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1332, 128]), torch.Size([1, 1332, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3481583595275879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4034304618835449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1332, 128])
m.shape torch.Size([1069, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.40636348724365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.40636348724365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1069, 128]), torch.Size([1, 1069, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4073829650878906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4583568572998047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1069, 128])
m.shape torch.Size([931, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4613986015319824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4613986015319824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 931, 128]), torch.Size([1, 931, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.46228647232055664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5134158134460449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 931, 128])
m.shape torch.Size([739, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5161433219909668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5161433219909668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 739, 128]), torch.Size([1, 739, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.516848087310791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5637712478637695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 739, 128])
m.shape torch.Size([4001, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5829501152038574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5829501152038574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 4001, 128]), torch.Size([1, 4001, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5867657661437988  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8603949546813965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 4001, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8184709548950195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8380022048950195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8575334548950195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8378500938415527  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([20380, 256])
first layer input nodes number: 33037
first layer output nodes number: 20380
edges number: 102918
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8577818870544434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8773131370544434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8821721076965332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8821721076965332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2211, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9462652206420898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9462652206420898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2211, 256]), torch.Size([1, 2211, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9504823684692383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9842195510864258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2211, 256])
m.shape torch.Size([1893, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9862270355224609  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9862270355224609  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1893, 256]), torch.Size([1, 1893, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9899177551269531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.045243263244629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1893, 256])
m.shape torch.Size([1456, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0471596717834473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0471596717834473  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1456, 256]), torch.Size([1, 1456, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0500431060791016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1180920600891113  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1456, 256])
m.shape torch.Size([1120, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1219744682312012  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1219744682312012  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1120, 256]), torch.Size([1, 1120, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1241278648376465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1893539428710938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1120, 256])
m.shape torch.Size([933, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1927275657653809  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.1927275657653809  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 933, 256]), torch.Size([1, 933, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.194507122039795  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2596278190612793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 933, 256])
m.shape torch.Size([685, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2626886367797852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2626886367797852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.2639951705932617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.321110725402832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 685, 256])
m.shape torch.Size([575, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3243260383605957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3243260383605957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.325422763824463  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3802590370178223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([471, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3833322525024414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.3833322525024414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.384230613708496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4365816116333008  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([362, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4392638206481934  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4392638206481934  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4399542808532715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4852299690246582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([313, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4878931045532227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.4878931045532227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.488490104675293  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5315189361572266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([218, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5335254669189453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5335254669189453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5339412689208984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5663738250732422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([195, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5684151649475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5684151649475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5687870979309082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6004014015197754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6023645401000977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6023645401000977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6026926040649414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6328744888305664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([144, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.634648323059082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.634648323059082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.634922981262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.662114143371582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([130, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.663851261138916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.663851261138916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6640992164611816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.690382480621338  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([97, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6917505264282227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6917505264282227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6919355392456055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7128419876098633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7140569686889648  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7140569686889648  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7142095565795898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7325201034545898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7339997291564941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7339997291564941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.734154224395752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7537751197814941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7546296119689941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7546296119689941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7547268867492676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7677617073059082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7685976028442383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7685976028442383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7686853408813477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7810564041137695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7817597389221191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7817597389221191  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7818303108215332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7922749519348145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7928953170776367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7928953170776367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.792954444885254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.802119255065918  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8026423454284668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8026423454284668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.802690029144287  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8104147911071777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8110370635986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8110370635986328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8110904693603516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8201160430908203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([249, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8260726928710938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8260726928710938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 249, 256]), torch.Size([1, 249, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.826547622680664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.910135269165039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 249, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8597602844238281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8615655899047852  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.863743782043457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.861851692199707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11603, 40])
input nodes number: 20380
output nodes number: 11603
edges number: 63931
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8620333671569824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8620338439941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.03254890441894531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 4 input nodes size: 64629
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.028749465942382812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.028749465942382812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.05956697463989258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.059650421142578125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.043810367584228516  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04575204849243164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04575204849243164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04575204849243164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([64629, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04575204849243164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([3131, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14148616790771484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14148616790771484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3131, 128]), torch.Size([1, 3131, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.14536476135253906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.1694188117980957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 3131, 128])
m.shape torch.Size([3171, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17094993591308594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17094993591308594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3171, 128]), torch.Size([1, 3171, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17397403717041016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.21933555603027344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 3171, 128])
m.shape torch.Size([2883, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22198200225830078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22198200225830078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2883, 128]), torch.Size([1, 2883, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22484970092773438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.28873634338378906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2883, 128])
m.shape torch.Size([2463, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2913384437561035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2913384437561035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2463, 128]), torch.Size([1, 2463, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2938361167907715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3632230758666992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2463, 128])
m.shape torch.Size([2223, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.36734867095947266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.36734867095947266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2223, 128]), torch.Size([1, 2223, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3696174621582031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4473586082458496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2223, 128])
m.shape torch.Size([1846, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4515800476074219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4515800476074219  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1846, 128]), torch.Size([1, 1846, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4533405303955078  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5290412902832031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1846, 128])
m.shape torch.Size([1557, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.533358097076416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.533358097076416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1557, 128]), torch.Size([1, 1557, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5348429679870605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6112823486328125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1557, 128])
m.shape torch.Size([1383, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6158156394958496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6158156394958496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1383, 128]), torch.Size([1, 1383, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6171345710754395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6932787895202637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1383, 128])
m.shape torch.Size([1165, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6976189613342285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6976189613342285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1165, 128]), torch.Size([1, 1165, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6987299919128418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7728781700134277  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1165, 128])
m.shape torch.Size([10798, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8238115310668945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8238115310668945  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 10798, 128]), torch.Size([1, 10798, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8341093063354492  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.565251350402832  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 10798, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.483243465423584  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5124449729919434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5416464805603027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.512216567993164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([30620, 256])
first layer input nodes number: 64629
first layer output nodes number: 30620
edges number: 190593
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.5421299934387207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.57133150100708  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.57863187789917  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.57863187789917  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2077, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.648198127746582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.648198127746582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2077, 256]), torch.Size([1, 2077, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6524410247802734  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6845197677612305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2077, 256])
m.shape torch.Size([1683, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6861844062805176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6861844062805176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1683, 256]), torch.Size([1, 1683, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.6894631385803223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.7386035919189453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1683, 256])
m.shape torch.Size([1351, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.740778923034668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.740778923034668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1351, 256]), torch.Size([1, 1351, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.743574619293213  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8022894859313965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1351, 256])
m.shape torch.Size([1008, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8048763275146484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8048763275146484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1008, 256]), torch.Size([1, 1008, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8067989349365234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.863382339477539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1008, 256])
m.shape torch.Size([849, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8665013313293457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8665013313293457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.8681206703186035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9285683631896973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([632, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9317431449890137  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9317431449890137  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9329485893249512  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9847826957702637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([516, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9876518249511719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9876518249511719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9886360168457031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.038349151611328  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([402, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0417113304138184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0417113304138184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.042478084564209  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0874905586242676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([342, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0900659561157227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0900659561157227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0907182693481445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.133915901184082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([305, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.136521339416504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.136521339416504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1371030807495117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1799397468566895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([228, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1820597648620605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.1820597648620605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.182494640350342  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2164149284362793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([217, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.218700408935547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.218700408935547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.219114303588867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2542953491210938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([163, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2561254501342773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2561254501342773  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.256436347961426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.285038948059082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([147, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2868618965148926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2868618965148926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.287142276763916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3148999214172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([132, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3166627883911133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3166627883911133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3169145584106445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.343602180480957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.345250129699707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.345250129699707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3454484939575195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.367863655090332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([87, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3691864013671875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3691864013671875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.369352340698242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3892650604248047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3905835151672363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3905835151672363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.390738010406494  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4103589057922363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([69, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4115419387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4115419387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4116735458374023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4293088912963867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4303979873657227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4303979873657227  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.430506706237793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.445836067199707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.446690082550049  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.446690082550049  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4467759132385254  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4594788551330566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.460176467895508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.460176467895508  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4602432250976562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.470590591430664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.471721649169922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.471721649169922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4718170166015625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4872665405273438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4880032539367676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4880032539367676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.488068103790283  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.499027729034424  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([533, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5118026733398438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5118026733398438  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.512819290161133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.69246768951416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 533, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6353635787963867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.637730598449707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6393918991088867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.636941432952881  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11147, 40])
input nodes number: 30620
output nodes number: 11147
edges number: 69848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6371092796325684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6371097564697266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.049363136291503906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 5 input nodes size: 70276
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04366636276245117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04366636276245117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.07717657089233398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.07726001739501953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04635906219482422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.048946380615234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.048946380615234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.048946380615234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([70276, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.048946380615234375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2733, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17692136764526367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17692136764526367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2733, 128]), torch.Size([1, 2733, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.17952775955200195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2016134262084961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2733, 128])
m.shape torch.Size([2846, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20302438735961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20302438735961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2846, 128]), torch.Size([1, 2846, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.20573854446411133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2490372657775879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2846, 128])
m.shape torch.Size([2424, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25125646591186523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.25125646591186523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2424, 128]), torch.Size([1, 2424, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2536616325378418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3051600456237793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2424, 128])
m.shape torch.Size([2201, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.30820226669311523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.30820226669311523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2201, 128]), torch.Size([1, 2201, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3104076385498047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3732423782348633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2201, 128])
m.shape torch.Size([1986, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3767538070678711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3767538070678711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1986, 128]), torch.Size([1, 1986, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3786478042602539  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.44825077056884766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1986, 128])
m.shape torch.Size([1687, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4521303176879883  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4521303176879883  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1687, 128]), torch.Size([1, 1687, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4537391662597656  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5246162414550781  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1687, 128])
m.shape torch.Size([1570, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5290522575378418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5290522575378418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1570, 128]), torch.Size([1, 1570, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5305495262145996  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6061034202575684  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1570, 128])
m.shape torch.Size([1470, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6109623908996582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6109623908996582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1470, 128]), torch.Size([1, 1470, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6123642921447754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6952939033508301  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1470, 128])
m.shape torch.Size([1331, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7007040977478027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7007040977478027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7019734382629395  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7843899726867676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([17948, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8693380355834961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8693380355834961  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 17948, 128]), torch.Size([1, 17948, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8870763778686523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.102351188659668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 17948, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.9874968528747559  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0220160484313965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.056535243988037  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.0217461585998535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([36196, 256])
first layer input nodes number: 70276
first layer output nodes number: 36196
edges number: 258762
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.057061195373535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.091580390930176  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.100210189819336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.100210189819336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1826, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.187657356262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.187657356262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1826, 256]), torch.Size([1, 1826, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.191788673400879  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.219975471496582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1826, 256])
m.shape torch.Size([1582, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2214183807373047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2214183807373047  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1582, 256]), torch.Size([1, 1582, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.224546432495117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2722244262695312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1582, 256])
m.shape torch.Size([1116, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2740635871887207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.2740635871887207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1116, 256]), torch.Size([1, 1116, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.276528835296631  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3337879180908203  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1116, 256])
m.shape torch.Size([877, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3352389335632324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3352389335632324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 877, 256]), torch.Size([1, 877, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.336911678314209  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3869471549987793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 877, 256])
m.shape torch.Size([787, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.389893054962158  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.389893054962158  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.3913941383361816  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4467673301696777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 787, 256])
m.shape torch.Size([594, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4494423866271973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4494423866271973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 594, 256]), torch.Size([1, 594, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.450575351715088  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.4995217323303223  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 594, 256])
m.shape torch.Size([465, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5020837783813477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5020837783813477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5029706954956055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.5484018325805664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([448, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.551403045654297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.551403045654297  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.552257537841797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.601022720336914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([344, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6035714149475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6035714149475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6042275428771973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.647155284881592  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([295, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.649662971496582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.649662971496582  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6502256393432617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.69081974029541  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([239, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.693305015563965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.693305015563965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.693760871887207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7293176651000977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([212, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.731534957885742  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.731534957885742  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7319393157958984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7663097381591797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([179, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7683444023132324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7683444023132324  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.768685817718506  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.800096035003662  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([138, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8017826080322266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8017826080322266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8020458221435547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.828104019165039  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([128, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.829817771911621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.829817771911621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.830061912536621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.855940818786621  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([116, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.857602596282959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.857602596282959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8578238487243652  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8828253746032715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8843488693237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8843488693237305  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8845396041870117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9074277877807617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([110, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9092354774475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9092354774475098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.909445285797119  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9360909461975098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([96, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.937739372253418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.937739372253418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.937922477722168  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.962458610534668  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9641165733337402  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9641165733337402  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.964290142059326  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9887633323669434  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([70, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.990115165710449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.990115165710449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.990248680114746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0100088119506836  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([68, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.011380195617676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.011380195617676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.011509895324707  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.031613349914551  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0326151847839355  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0326151847839355  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0327048301696777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.047227382659912  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0487051010131836  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0487051010131836  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.048830986022949  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.07010555267334  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1199, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0988526344299316  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0988526344299316  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1199, 256]), torch.Size([1, 1199, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.101139545440674  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5091071128845215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1199, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.433995246887207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.435736656188965  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.437591552734375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4357666969299316  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11193, 40])
input nodes number: 36196
output nodes number: 11193
edges number: 88368
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.436126708984375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.436127185821533  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.053658485412597656  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 6 input nodes size: 87698
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04636573791503906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04636573791503906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08818340301513672  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08826589584350586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.0546722412109375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.058634281158447266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.058634281158447266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.058634281158447266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([87698, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.058634281158447266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([2575, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23730134963989258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23730134963989258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23975706100463867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.26092100143432617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
m.shape torch.Size([2878, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2628169059753418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2628169059753418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2878, 128]), torch.Size([1, 2878, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.265561580657959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3096919059753418  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2878, 128])
m.shape torch.Size([2548, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31122446060180664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31122446060180664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2548, 128]), torch.Size([1, 2548, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31365442276000977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37087583541870117  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2548, 128])
m.shape torch.Size([2346, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37452077865600586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37452077865600586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2346, 128]), torch.Size([1, 2346, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37685155868530273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4444451332092285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2346, 128])
m.shape torch.Size([2262, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.44871950149536133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.44871950149536133  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 2262, 128]), torch.Size([1, 2262, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.45092153549194336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.534949779510498  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 2262, 128])
m.shape torch.Size([1955, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5385317802429199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5385317802429199  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1955, 128]), torch.Size([1, 1955, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5403962135314941  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.623227596282959  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1955, 128])
m.shape torch.Size([1915, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6286873817443848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6286873817443848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1915, 128]), torch.Size([1, 1915, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6305136680603027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7271552085876465  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1915, 128])
m.shape torch.Size([1758, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7329483032226562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7329483032226562  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1758, 128]), torch.Size([1, 1758, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7346248626708984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8301887512207031  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1758, 128])
m.shape torch.Size([1694, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8366203308105469  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8366203308105469  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1694, 128]), torch.Size([1, 1694, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.8382358551025391  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9416294097900391  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1694, 128])
m.shape torch.Size([27164, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0703496932983398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0703496932983398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 27164, 128]), torch.Size([1, 27164, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 1.0976934432983398  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9795827865600586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 27164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8123254776000977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.85723876953125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9021520614624023  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.8568878173828125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([47095, 256])
first layer input nodes number: 87698
first layer output nodes number: 47095
edges number: 362754
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9028077125549316  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.947721004486084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.959439754486084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.959439754486084  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1598, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0589065551757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0589065551757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1598, 256]), torch.Size([1, 1598, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0622167587280273  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.087892532348633  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1598, 256])
m.shape torch.Size([1418, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0893445014953613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0893445014953613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1418, 256]), torch.Size([1, 1418, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.092376232147217  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1377243995666504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1418, 256])
m.shape torch.Size([1027, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.138826370239258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.138826370239258  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1027, 256]), torch.Size([1, 1027, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.14125919342041  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1873722076416016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1027, 256])
m.shape torch.Size([796, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.190092086791992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.190092086791992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 796, 256]), torch.Size([1, 796, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.191610336303711  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2381763458251953  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 796, 256])
m.shape torch.Size([703, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.240795612335205  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.240795612335205  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2421364784240723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2911667823791504  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([538, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2935991287231445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2935991287231445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 538, 256]), torch.Size([1, 538, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2946252822875977  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.339797019958496  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 538, 256])
m.shape torch.Size([434, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3422040939331055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3422040939331055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.343031883239746  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.386418342590332  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([358, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3887572288513184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3887572288513184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3894400596618652  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4291892051696777  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([319, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.431607246398926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.431607246398926  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.432215690612793  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4720230102539062  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([257, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.474189281463623  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.474189281463623  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 257, 256]), torch.Size([1, 257, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.474679470062256  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5109496116638184  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 257, 256])
m.shape torch.Size([253, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5133795738220215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5133795738220215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 253, 256]), torch.Size([1, 253, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.513862133026123  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.551501750946045  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 253, 256])
m.shape torch.Size([211, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.553694248199463  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.553694248199463  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5540966987609863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5883049964904785  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([184, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5904030799865723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5904030799865723  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5907540321350098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6230416297912598  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([151, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6248984336853027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6248984336853027  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6251864433288574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6536993980407715  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6558480262756348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6558480262756348  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.656151294708252  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.688297748565674  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([136, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.690237522125244  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.690237522125244  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6904969215393066  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.719809055328369  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7225704193115234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7225704193115234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.722820281982422  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7528038024902344  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([138, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.755066394805908  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.755066394805908  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7553296089172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.788757801055908  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7907629013061523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7907629013061523  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7909860610961914  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.820889472961426  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8228158950805664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8228158950805664  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8230180740356445  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.85152530670166  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([110, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.853644847869873  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.853644847869873  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8538546562194824  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.88490629196167  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([75, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.886387348175049  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.886387348175049  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8865303993225098  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.908703327178955  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.910245895385742  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.910245895385742  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.9103851318359375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.932941436767578  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.9344868659973145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.9344868659973145  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.9346203804016113  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.957184314727783  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1673, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.997316837310791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.997316837310791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1673, 256]), torch.Size([1, 1673, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.000507831573486  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.573709011077881  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1673, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.484481334686279  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.486140727996826  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.488166332244873  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.486424446105957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([11035, 40])
input nodes number: 47095
output nodes number: 11035
edges number: 101365
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.486849308013916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 4.486849784851074  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.06467056274414062  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

pseudo mini batch 7 input nodes size: 69065
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.054663658142089844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.054663658142089844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08786678314208984  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.08795356750488281  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.046053409576416016  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04974794387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04974794387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04974794387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([69065, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.04974794387817383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1904, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22344160079956055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22344160079956055  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1904, 128]), torch.Size([1, 1904, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.22525739669799805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.23978376388549805  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1904, 128])
m.shape torch.Size([1927, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.24071359634399414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.24071359634399414  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1927, 128]), torch.Size([1, 1927, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.24255132675170898  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2715020179748535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1927, 128])
m.shape torch.Size([1866, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2732524871826172  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.2732524871826172  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.27503204345703125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3141822814941406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1768, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3166646957397461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3166646957397461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1768, 128]), torch.Size([1, 1768, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.31835079193115234  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.3672475814819336  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1768, 128])
m.shape torch.Size([1680, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37137889862060547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37137889862060547  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1680, 128]), torch.Size([1, 1680, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.37298107147216797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.43065929412841797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1680, 128])
m.shape torch.Size([1579, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4343757629394531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4343757629394531  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1579, 128]), torch.Size([1, 1579, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.4358816146850586  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5006332397460938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1579, 128])
m.shape torch.Size([1527, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5049772262573242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5049772262573242  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1527, 128]), torch.Size([1, 1527, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5064334869384766  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5802874565124512  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1527, 128])
m.shape torch.Size([1416, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5849609375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5849609375  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1416, 128]), torch.Size([1, 1416, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.5863113403320312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6687774658203125  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1416, 128])
m.shape torch.Size([1437, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6744194030761719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6744194030761719  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1437, 128]), torch.Size([1, 1437, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.6757898330688477  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.7680292129516602  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1437, 128])
m.shape torch.Size([28218, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9018979072570801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9018979072570801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 28218, 128]), torch.Size([1, 28218, 128])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 0.9292416572570801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.844669818878174  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 28218, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.6833057403564453  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.724620819091797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7659358978271484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7242980003356934  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

torch.Size([43322, 256])
first layer input nodes number: 69065
first layer output nodes number: 43322
edges number: 353432
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.7664527893066406  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.807767868041992  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.81809663772583  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.81809663772583  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

m.shape torch.Size([1202, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.956448554992676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.956448554992676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9590415954589844  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9794187545776367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([992, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9799370765686035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9799370765686035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 992, 256]), torch.Size([1, 992, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 2.9818291664123535  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.010286808013916  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 992, 256])
m.shape torch.Size([834, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0119776725769043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0119776725769043  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 834, 256]), torch.Size([1, 834, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.01356840133667  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0488791465759277  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 834, 256])
m.shape torch.Size([677, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.050787925720215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.050787925720215  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.052079200744629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.091822624206543  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([568, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.094017505645752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.094017505645752  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 568, 256]), torch.Size([1, 568, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.0951008796691895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.140871524810791  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 568, 256])
m.shape torch.Size([466, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.143017292022705  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.143017292022705  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1439061164855957  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1842122077941895  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([377, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1863045692443848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.1863045692443848  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 377, 256]), torch.Size([1, 377, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.187023639678955  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.223886013031006  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 377, 256])
m.shape torch.Size([322, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2260026931762695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2260026931762695  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 322, 256]), torch.Size([1, 322, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.226616859436035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2637948989868164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 322, 256])
m.shape torch.Size([334, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2663769721984863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2663769721984863  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.2670140266418457  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3084511756896973  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([310, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.311112403869629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.311112403869629  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.311703681945801  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3552675247192383  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.357816219329834  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.357816219329834  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3583292961120605  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.3999176025390625  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([265, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4027175903320312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4027175903320312  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4032230377197266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4468040466308594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([228, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4494004249572754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4494004249572754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 228, 256]), torch.Size([1, 228, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4498353004455566  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.4898438453674316  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 228, 256])
m.shape torch.Size([202, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.492344856262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.492344856262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.492730140686035  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5308732986450195  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([185, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5333480834960938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5333480834960938  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.533700942993164  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.571104049682617  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([180, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.573695659637451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.573695659637451  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.5740389823913574  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6128344535827637  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([167, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.615391731262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.615391731262207  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6157102584838867  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.653933525085449  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([158, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.656670093536377  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.656670093536377  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6569714546203613  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.695244312286377  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([156, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6979427337646484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.6979427337646484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.698240280151367  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7381114959716797  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([151, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.740865707397461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.740865707397461  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7411537170410156  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7817630767822266  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([154, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7847275733947754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7847275733947754  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.7850213050842285  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.828493595123291  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([103, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8305249214172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8305249214172363  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.830721378326416  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8611721992492676  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([114, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8635940551757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.8635940551757812  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.863811492919922  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.899036407470703  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([115, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.901580810546875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.901580810546875  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.8709716796875 GB
    Memory Allocated: 3.9018001556396484  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8963623046875 GB
    Memory Allocated: 3.9388694763183594  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([3071, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.012550354003906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.012550354003906  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

 h.shape torch.Size([1, 3071, 256]), torch.Size([1, 3071, 256])
----------------------------------------3
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.018925666809082  GigaBytes
Max Memory Allocated: 4.879832744598389  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 5.050299644470215  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 3071, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.921742916107178  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.923609256744385  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.925568103790283  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.923614978790283  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11600, 40])
input nodes number: 43322
output nodes number: 11600
edges number: 142263
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.92423152923584  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8983154296875 GB
    Memory Allocated: 4.924232006072998  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.056324005126953125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.056324005126953125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.056324005126953125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01920372247695923 |0.003371208906173706 |0.12123924493789673 |9.569525718688965e-05 |0.07562220096588135 |0.005269289016723633 |
----------------------------------------------------------pseudo_mini_loss sum 4.63699197769165
Total (block generation + training)time/epoch 22.93881583213806
Training time/epoch 1.8114402294158936
Training time without block to device /epoch 1.784470558166504
Training time without total dataloading part /epoch 1.5809264183044434
load block tensor time/epoch 0.15362977981567383
block to device time/epoch 0.02696967124938965
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  688126
Number of first layer input nodes during this epoch:  442573
Number of first layer output nodes during this epoch:  245553
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05632352828979492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02232646942138672
global_2_local spend time (sec) 0.04861760139465332
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004511356353759766
A = g.adjacency_matrix() spent  0.012953758239746094
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08359384536743164
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3272600173950195
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1977715492248535

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f5[05:13:58] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 23407770 edges into 8 parts and get 3909601 edge cuts


after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770})
Convert a graph into a bidirected graph: 0.989 seconds
Metis partitioning: 4.698 seconds
Split the graph: 1.334 seconds
Construct subgraphs: 0.079 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.11144495010376
11564
11624
11183
11548
11112
11709
11157
11044
total k batches seeds list generation spend  17.718658685684204
after graph partition
graph partition algorithm spend time 17.806246042251587
11564
11624
11183
11548
11112
11709
11157
11044
partition_len_list
[22355, 24489, 20950, 20143, 47587, 43395, 27876, 35703]
shared_neighbor_graph_partition_s0 selection method  spend 17.90789794921875
time for parepare:  0.017576217651367188
local_output_nid generation:  0.002323627471923828
local_in_edges_tensor generation:  0.0023958683013916016
mini_batch_src_global generation:  0.004088878631591797
r_  generation:  0.027929067611694336
local_output_nid generation:  0.002890348434448242
local_in_edges_tensor generation:  0.0024144649505615234
mini_batch_src_global generation:  0.00401759147644043
r_  generation:  0.03514599800109863
local_output_nid generation:  0.003354787826538086
local_in_edges_tensor generation:  0.0027005672454833984
mini_batch_src_global generation:  0.01647353172302246
r_  generation:  0.03417325019836426
local_output_nid generation:  0.0031418800354003906
local_in_edges_tensor generation:  0.005437612533569336
mini_batch_src_global generation:  0.003814220428466797
r_  generation:  0.03268623352050781
local_output_nid generation:  0.002813577651977539
local_in_edges_tensor generation:  0.0031909942626953125
mini_batch_src_global generation:  0.003969907760620117
r_  generation:  0.039998769760131836
local_output_nid generation:  0.003094196319580078
local_in_edges_tensor generation:  0.003815889358520508
mini_batch_src_global generation:  0.005877494812011719
r_  generation:  0.04814600944519043
local_output_nid generation:  0.0031087398529052734
local_in_edges_tensor generation:  0.0024945735931396484
mini_batch_src_global generation:  0.0027937889099121094
r_  generation:  0.02734208106994629
local_output_nid generation:  0.002948284149169922
local_in_edges_tensor generation:  0.00228118896484375
mini_batch_src_global generation:  0.002646923065185547
r_  generation:  0.029543638229370117
----------------------check_connections_block total spend ----------------------------- 0.46175694465637207
generate_one_block  0.041040897369384766
generate_one_block  0.04257822036743164
generate_one_block  0.04074263572692871
generate_one_block  0.03877425193786621
generate_one_block  0.057118892669677734
generate_one_block  0.06736278533935547
generate_one_block  0.03419685363769531
generate_one_block  0.04006671905517578
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023588180541992188
gen group dst list time:  0.006756782531738281
time for parepare:  0.021288394927978516
local_output_nid generation:  0.0041980743408203125
local_in_edges_tensor generation:  0.007719516754150391
mini_batch_src_global generation:  0.003994941711425781
r_  generation:  0.04493522644042969
local_output_nid generation:  0.0062847137451171875
local_in_edges_tensor generation:  0.00536799430847168
mini_batch_src_global generation:  0.005765438079833984
r_  generation:  0.0564875602722168
local_output_nid generation:  0.005518674850463867
local_in_edges_tensor generation:  0.004308462142944336
mini_batch_src_global generation:  0.0045702457427978516
r_  generation:  0.0475010871887207
local_output_nid generation:  0.0051157474517822266
local_in_edges_tensor generation:  0.003974437713623047
mini_batch_src_global generation:  0.004339694976806641
r_  generation:  0.04481101036071777
local_output_nid generation:  0.0108489990234375
local_in_edges_tensor generation:  0.01202249526977539
mini_batch_src_global generation:  0.013239860534667969
r_  generation:  0.13269519805908203
local_output_nid generation:  0.009483814239501953
local_in_edges_tensor generation:  0.010940790176391602
mini_batch_src_global generation:  0.01520848274230957
r_  generation:  0.12300539016723633
local_output_nid generation:  0.007406473159790039
local_in_edges_tensor generation:  0.005892753601074219
mini_batch_src_global generation:  0.008241415023803711
r_  generation:  0.06511473655700684
local_output_nid generation:  0.00910639762878418
local_in_edges_tensor generation:  0.007322788238525391
mini_batch_src_global generation:  0.010104656219482422
r_  generation:  0.09178757667541504
----------------------check_connections_block total spend ----------------------------- 0.9586374759674072
generate_one_block  0.05728292465209961
generate_one_block  0.07154512405395508
generate_one_block  0.058962345123291016
generate_one_block  0.056914567947387695
generate_one_block  0.17293596267700195
generate_one_block  0.16335201263427734
generate_one_block  0.08221030235290527
generate_one_block  0.12071919441223145
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05632352828979492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

connection checking time:  0.9586374759674072
block generation total time  0.7839224338531494
average batch blocks generation time:  0.09799030423164368
block dataloader generation time/epoch 20.88259518146515
pseudo mini batch 0 input nodes size: 38260
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.046259403228759766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.046259403228759766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.06450319290161133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.0645895004272461  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031299591064453125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.032741546630859375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.032741546630859375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.032741546630859375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([38260, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.032741546630859375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([2857, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09440279006958008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09440279006958008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2857, 128]), torch.Size([1, 2857, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09712743759155273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1200265884399414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2857, 128])
m.shape torch.Size([3006, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.12153100967407227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.12153100967407227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 3006, 128]), torch.Size([1, 3006, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.12500476837158203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.16901302337646484  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 3006, 128])
m.shape torch.Size([2534, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.17187976837158203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.17187976837158203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2534, 128]), torch.Size([1, 2534, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.17445850372314453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.23099994659423828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2534, 128])
m.shape torch.Size([2064, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.23426055908203125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.23426055908203125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2064, 128]), torch.Size([1, 2064, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.23645305633544922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2966585159301758  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2064, 128])
m.shape torch.Size([1753, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.29896116256713867  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.29896116256713867  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1753, 128]), torch.Size([1, 1753, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30063295364379883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3621711730957031  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1753, 128])
m.shape torch.Size([1435, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.36544084548950195  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.36544084548950195  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1435, 128]), torch.Size([1, 1435, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3668093681335449  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.42809152603149414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1435, 128])
m.shape torch.Size([1157, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.43126916885375977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.43126916885375977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1157, 128]), torch.Size([1, 1157, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4323725700378418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4895968437194824  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1157, 128])
m.shape torch.Size([1028, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4929666519165039  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4929666519165039  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1028, 128]), torch.Size([1, 1028, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.49394702911376953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5500068664550781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1028, 128])
m.shape torch.Size([865, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5532288551330566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5532288551330566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 865, 128]), torch.Size([1, 865, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.554053783416748  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6094141006469727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 865, 128])
m.shape torch.Size([5656, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6359715461730957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6359715461730957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 5656, 128]), torch.Size([1, 5656, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.642204761505127  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0452466011047363  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 5656, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9936175346374512  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.014936923980713  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0362563133239746  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0147700309753418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([22355, 256])
first layer input nodes number: 38260
first layer output nodes number: 22355
edges number: 122770
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.036543369293213  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0578627586364746  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0631928443908691  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0631928443908691  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([2020, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1343984603881836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1343984603881836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2020, 256]), torch.Size([1, 2020, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1401662826538086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.172410011291504  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2020, 256])
m.shape torch.Size([1809, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1739611625671387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1739611625671387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1809, 256]), torch.Size([1, 1809, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1782021522521973  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2307486534118652  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1809, 256])
m.shape torch.Size([1395, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.232255458831787  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.232255458831787  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1395, 256]), torch.Size([1, 1395, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2350406646728516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2946739196777344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1395, 256])
m.shape torch.Size([1062, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.297426700592041  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.297426700592041  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1062, 256]), torch.Size([1, 1062, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2995667457580566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3604917526245117  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1062, 256])
m.shape torch.Size([942, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3640060424804688  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3640060424804688  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 942, 256]), torch.Size([1, 942, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3658027648925781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4306926727294922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 942, 256])
m.shape torch.Size([681, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4337215423583984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4337215423583984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4350204467773438  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.495534896850586  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([560, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4986534118652344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4986534118652344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 560, 256]), torch.Size([1, 560, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4997215270996094  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5537376403808594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 560, 256])
m.shape torch.Size([487, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.556948184967041  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.556948184967041  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 487, 256]), torch.Size([1, 487, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5578770637512207  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6127305030822754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 487, 256])
m.shape torch.Size([375, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6155099868774414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6155099868774414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 375, 256]), torch.Size([1, 375, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.616225242614746  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6642379760742188  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 375, 256])
m.shape torch.Size([311, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6668696403503418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6668696403503418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6674628257751465  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7106642723083496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([247, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7129793167114258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7129793167114258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7134504318237305  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.750197410583496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7524304389953613  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7524304389953613  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7528386116027832  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7875332832336426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([161, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7893409729003906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7893409729003906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7896480560302734  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8178997039794922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([157, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8198590278625488  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8198590278625488  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8201584815979004  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.849804401397705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([139, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.851658821105957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.851658821105957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.851923942565918  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8800268173217773  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([98, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8817238807678223  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8817238807678223  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.881910800933838  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9030327796936035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9042959213256836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9042959213256836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.904454231262207  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9234514236450195  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([91, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9249467849731445  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9249467849731445  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9251203536987305  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9471635818481445  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([63, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9482274055480957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9482274055480957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.948347568511963  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.964449405670166  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.965446949005127  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.965446949005127  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9655518531799316  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9803433418273926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9813809394836426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9813809394836426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9814839363098145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.996727466583252  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9976873397827148  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9976873397827148  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.997776985168457  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.011672019958496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.012648105621338  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.012648105621338  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0127339363098145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0266385078430176  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.027564525604248  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.027564525604248  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.027644634246826  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0411829948425293  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([426, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0513792037963867  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0513792037963867  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.052191734313965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.19534969329834  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 426, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1387853622436523  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1405105590820312  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1422338485717773  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1404223442077637  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11564, 40])
input nodes number: 22355
output nodes number: 11564
edges number: 70604
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1405344009399414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.140535354614258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.035485267639160156  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

pseudo mini batch 1 input nodes size: 45436
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031159400939941406  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031159400939941406  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.052824974060058594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05291175842285156  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.034581661224365234  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03641653060913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03641653060913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03641653060913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([45436, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03641653060913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([2302, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1143808364868164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1143808364868164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2302, 128]), torch.Size([1, 2302, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1165761947631836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.13517189025878906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2302, 128])
m.shape torch.Size([2370, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.13633441925048828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.13633441925048828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2370, 128]), torch.Size([1, 2370, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1385946273803711  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1737508773803711  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2370, 128])
m.shape torch.Size([2208, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1760110855102539  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1760110855102539  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2208, 128]), torch.Size([1, 2208, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1781291961669922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.22553348541259766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2208, 128])
m.shape torch.Size([1975, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.22824764251708984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.22824764251708984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1975, 128]), torch.Size([1, 1975, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2301311492919922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2864236831665039  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1975, 128])
m.shape torch.Size([1767, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.28969478607177734  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.28969478607177734  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1767, 128]), torch.Size([1, 1767, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2913799285888672  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3524136543273926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1767, 128])
m.shape torch.Size([1463, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3565492630004883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3565492630004883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1463, 128]), torch.Size([1, 1463, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3579444885253906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4206724166870117  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1463, 128])
m.shape torch.Size([1327, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4244041442871094  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4244041442871094  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.42566967010498047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.48894596099853516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([1211, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4929327964782715  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4929327964782715  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.49408769607543945  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5607657432556152  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1022, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5645742416381836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5645742416381836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1022, 128]), torch.Size([1, 1022, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5655488967895508  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6280369758605957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1022, 128])
m.shape torch.Size([8844, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6697211265563965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6697211265563965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 8844, 128]), torch.Size([1, 8844, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6781554222106934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2769904136657715  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 8844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2093110084533691  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2326655387878418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2560200691223145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.23248291015625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([24489, 256])
first layer input nodes number: 45436
first layer output nodes number: 24489
edges number: 155794
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2563605308532715  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2797150611877441  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2857403755187988  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2857403755187988  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1621, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.374577522277832  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.374577522277832  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1621, 256]), torch.Size([1, 1621, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3777666091918945  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4027223587036133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1621, 256])
m.shape torch.Size([1436, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4044203758239746  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4044203758239746  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1436, 256]), torch.Size([1, 1436, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4076228141784668  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4514250755310059  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1436, 256])
m.shape torch.Size([1200, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4535160064697266  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4535160064697266  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1200, 256]), torch.Size([1, 1200, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4561023712158203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5075550079345703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1200, 256])
m.shape torch.Size([994, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5102324485778809  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5102324485778809  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 994, 256]), torch.Size([1, 994, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5121283531188965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5671095848083496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 994, 256])
m.shape torch.Size([818, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5700926780700684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5700926780700684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 818, 256]), torch.Size([1, 818, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.571652889251709  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6300597190856934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 818, 256])
m.shape torch.Size([644, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6336193084716797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6336193084716797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 644, 256]), torch.Size([1, 644, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.634847640991211  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6913738250732422  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 644, 256])
m.shape torch.Size([603, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6948165893554688  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6948165893554688  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 603, 256]), torch.Size([1, 603, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6959667205810547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.758101463317871  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 603, 256])
m.shape torch.Size([504, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.761401653289795  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.761401653289795  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 504, 256]), torch.Size([1, 504, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7623629570007324  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8193278312683105  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 504, 256])
m.shape torch.Size([450, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.822740077972412  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.822740077972412  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 450, 256]), torch.Size([1, 450, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8235983848571777  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8793864250183105  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 450, 256])
m.shape torch.Size([383, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8826384544372559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8826384544372559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.883368968963623  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9376063346862793  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([296, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9403705596923828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9403705596923828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 296, 256]), torch.Size([1, 296, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9409351348876953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9852323532104492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 296, 256])
m.shape torch.Size([278, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.988156795501709  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.988156795501709  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 278, 256]), torch.Size([1, 278, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9886870384216309  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0357861518859863  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 278, 256])
m.shape torch.Size([239, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0385074615478516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0385074615478516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0389633178710938  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.080902099609375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([199, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0833520889282227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0833520889282227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0837316513061523  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1213083267211914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([188, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1238293647766113  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1238293647766113  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 188, 256]), torch.Size([1, 188, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.12418794631958  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1621975898742676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 188, 256])
m.shape torch.Size([161, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.164494514465332  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.164494514465332  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.164801597595215  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1995019912719727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([150, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2017993927001953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2017993927001953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.202085494995117  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.236417770385742  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([114, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2382473945617676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2382473945617676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.238464832305908  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2660794258117676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([114, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.268052577972412  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.268052577972412  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2682700157165527  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2974066734313965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([107, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2993550300598145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2993550300598145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2995591163635254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3283352851867676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([77, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3297877311706543  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3297877311706543  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.329934597015381  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.351670742034912  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([90, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3535003662109375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3535003662109375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3536720275878906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.380279541015625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([59, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.381498336791992  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.381498336791992  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.381610870361328  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.39984130859375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([58, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.401123046875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.401123046875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.401233673095703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4199295043945312  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([841, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.44008207321167  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.44008207321167  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 841, 256]), torch.Size([1, 841, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4416861534118652  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.727487087249756  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 841, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.651069164276123  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.652801513671875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.654533863067627  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.652714729309082  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11624, 40])
input nodes number: 24489
output nodes number: 11624
edges number: 90316
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.65299129486084  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.652991771697998  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03994894027709961  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

pseudo mini batch 2 input nodes size: 32765
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03458881378173828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03458881378173828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05021238327026367  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05029582977294922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.028543472290039062  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.030203819274902344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.030203819274902344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.030203819274902344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([32765, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.030203819274902344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([2152, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.095611572265625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.095611572265625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2152, 128]), torch.Size([1, 2152, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09849309921264648  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1155247688293457  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2152, 128])
m.shape torch.Size([2112, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11651277542114258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11651277542114258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2112, 128]), torch.Size([1, 2112, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11912155151367188  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.15151596069335938  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2112, 128])
m.shape torch.Size([1929, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.15353012084960938  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.15353012084960938  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1929, 128]), torch.Size([1, 1929, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.15536975860595703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.19788455963134766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1929, 128])
m.shape torch.Size([1637, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2000870704650879  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2000870704650879  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1637, 128]), torch.Size([1, 1637, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.20164823532104492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24692201614379883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1637, 128])
m.shape torch.Size([1530, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24978923797607422  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24978923797607422  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1530, 128]), torch.Size([1, 1530, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2512483596801758  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30391407012939453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1530, 128])
m.shape torch.Size([1244, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3067436218261719  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3067436218261719  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1244, 128]), torch.Size([1, 1244, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30792999267578125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3589439392089844  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1244, 128])
m.shape torch.Size([1081, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.36195898056030273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.36195898056030273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1081, 128]), torch.Size([1, 1081, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3629899024963379  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.41662073135375977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1081, 128])
m.shape torch.Size([961, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4197711944580078  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4197711944580078  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 961, 128]), torch.Size([1, 961, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4206876754760742  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.47596073150634766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 961, 128])
m.shape torch.Size([806, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4789614677429199  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4789614677429199  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 806, 128]), torch.Size([1, 806, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.47973012924194336  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5321850776672363  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 806, 128])
m.shape torch.Size([7498, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5675539970397949  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5675539970397949  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 7498, 128]), torch.Size([1, 7498, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.574704647064209  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0824007987976074  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 7498, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0251622200012207  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0451416969299316  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0651211738586426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.044985294342041  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([20950, 256])
first layer input nodes number: 32765
first layer output nodes number: 20950
edges number: 131314
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0653672218322754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0853466987609863  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0905766487121582  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0905766487121582  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1600, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1806144714355469  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1806144714355469  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1600, 256]), torch.Size([1, 1600, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1839237213134766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.208852767944336  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1600, 256])
m.shape torch.Size([1329, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2098979949951172  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2098979949951172  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1329, 256]), torch.Size([1, 1329, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2126107215881348  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2536730766296387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1329, 256])
m.shape torch.Size([1153, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2553434371948242  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2553434371948242  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1153, 256]), torch.Size([1, 1153, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.258652687072754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3109931945800781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1153, 256])
m.shape torch.Size([884, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3127374649047852  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3127374649047852  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 884, 256]), torch.Size([1, 884, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3144235610961914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.363896369934082  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 884, 256])
m.shape torch.Size([772, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3667635917663574  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3667635917663574  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3682360649108887  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4213309288024902  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([608, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4241008758544922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4241008758544922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 608, 256]), torch.Size([1, 608, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4252605438232422  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4788646697998047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 608, 256])
m.shape torch.Size([533, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4818711280822754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4818711280822754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4828877449035645  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5337185859680176  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([446, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.53682279586792  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.53682279586792  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5376734733581543  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5865206718444824  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([391, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5894775390625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5894775390625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5902233123779297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6406688690185547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([347, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6436314582824707  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6436314582824707  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6442933082580566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.692915439605713  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([298, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6957354545593262  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6957354545593262  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6963038444519043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7413725852966309  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([247, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7439374923706055  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7439374923706055  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7444086074829102  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7844533920288086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([224, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7870168685913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7870168685913086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7874441146850586  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8267507553100586  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([204, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.829282283782959  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.829282283782959  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8296713829040527  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.868192195892334  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([182, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.870621681213379  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.870621681213379  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8709688186645508  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9077653884887695  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9099936485290527  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9099936485290527  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9102721214294434  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.941739559173584  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9441494941711426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9441494941711426  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9444470405578613  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9801526069641113  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9819588661193848  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9819588661193848  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9821743965148926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0095467567443848  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0113749504089355  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0113749504089355  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0115771293640137  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0386691093444824  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([123, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0409326553344727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0409326553344727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0411672592163086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.074246406555176  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0762081146240234  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0762081146240234  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.076404571533203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.105480194091797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1073474884033203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1073474884033203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1074657440185547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.125795364379883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.127284049987793  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.127284049987793  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.12741756439209  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1490468978881836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.150618076324463  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.150618076324463  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1507534980773926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1736397743225098  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([1015, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.19796085357666  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.19796085357666  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1015, 256]), torch.Size([1, 1015, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.199896812438965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.5428895950317383  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1015, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4640283584594727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4660844802856445  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4681406021118164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.466001033782959  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11183, 40])
input nodes number: 20950
output nodes number: 11183
edges number: 91501
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.466564655303955  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.4665651321411133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03370857238769531  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

pseudo mini batch 3 input nodes size: 34200
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.028867244720458984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.028867244720458984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.04517507553100586  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.045261383056640625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.029554367065429688  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031139373779296875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031139373779296875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031139373779296875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([34200, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.031139373779296875  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1956, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09282493591308594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09282493591308594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1956, 128]), torch.Size([1, 1956, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.09469032287597656  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.10961341857910156  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1956, 128])
m.shape torch.Size([2193, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11077213287353516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11077213287353516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.11373281478881836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.14531993865966797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
m.shape torch.Size([1953, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.14706802368164062  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.14706802368164062  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1953, 128]), torch.Size([1, 1953, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.14893054962158203  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.1909933090209961  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1953, 128])
m.shape torch.Size([1736, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.19433069229125977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.19433069229125977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1736, 128]), torch.Size([1, 1736, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.19598627090454102  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24399805068969727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1736, 128])
m.shape torch.Size([1440, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24660348892211914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24660348892211914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1440, 128]), torch.Size([1, 1440, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24797677993774414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.29965829849243164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1440, 128])
m.shape torch.Size([1301, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30269384384155273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30269384384155273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1301, 128]), torch.Size([1, 1301, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30393457412719727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.35783815383911133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1301, 128])
m.shape torch.Size([1059, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3614921569824219  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3614921569824219  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1059, 128]), torch.Size([1, 1059, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3625020980834961  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4132866859436035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1059, 128])
m.shape torch.Size([965, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.41646289825439453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.41646289825439453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 965, 128]), torch.Size([1, 965, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.41738319396972656  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.47254085540771484  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 965, 128])
m.shape torch.Size([807, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4755439758300781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4755439758300781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 807, 128]), torch.Size([1, 807, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.47631359100341797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5286502838134766  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 807, 128])
m.shape torch.Size([6733, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.560370922088623  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.560370922088623  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 6733, 128]), torch.Size([1, 6733, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5667920112609863  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.042844295501709  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 6733, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9895167350769043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0090479850769043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0285792350769043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0088977813720703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([20143, 256])
first layer input nodes number: 34200
first layer output nodes number: 20143
edges number: 123877
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0288362503051758  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0483675003051758  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0531702041625977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.0531702041625977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1493, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1404023170471191  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1404023170471191  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1493, 256]), torch.Size([1, 1493, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1443758010864258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1698145866394043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1493, 256])
m.shape torch.Size([1427, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1704707145690918  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.1704707145690918  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1427, 256]), torch.Size([1, 1427, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.174644947052002  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2198152542114258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1427, 256])
m.shape torch.Size([1224, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2211523056030273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2211523056030273  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1224, 256]), torch.Size([1, 1224, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2237319946289062  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2752761840820312  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1224, 256])
m.shape torch.Size([1020, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.278660774230957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.278660774230957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1020, 256]), torch.Size([1, 1020, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.2806062698364258  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3372087478637695  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1020, 256])
m.shape torch.Size([832, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3402342796325684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3402342796325684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 832, 256]), torch.Size([1, 832, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3418211936950684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.3989500999450684  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 832, 256])
m.shape torch.Size([717, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4022917747497559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4022917747497559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 717, 256]), torch.Size([1, 717, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4036593437194824  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.464799404144287  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 717, 256])
m.shape torch.Size([565, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4679169654846191  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4679169654846191  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.4689946174621582  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5231785774230957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([496, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5264534950256348  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5264534950256348  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 496, 256]), torch.Size([1, 496, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5273995399475098  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5829415321350098  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 496, 256])
m.shape torch.Size([423, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.586127758026123  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.586127758026123  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 423, 256]), torch.Size([1, 423, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.5869345664978027  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.638831615447998  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 423, 256])
m.shape torch.Size([394, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6422152519226074  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6422152519226074  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.6429667472839355  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.697441577911377  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([355, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.700819492340088  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.700819492340088  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7014966011047363  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7551922798156738  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([309, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7584176063537598  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7584176063537598  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.7590069770812988  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8104462623596191  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([240, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.813150405883789  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.813150405883789  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 240, 256]), torch.Size([1, 240, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.813608169555664  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.855722427368164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 240, 256])
m.shape torch.Size([212, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8583464622497559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8583464622497559  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.858750820159912  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.8987822532653809  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([165, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9009590148925781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9009590148925781  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9012737274169922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9346332550048828  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([158, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.936905860900879  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.936905860900879  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9372072219848633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9712610244750977  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([153, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9736104011535645  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9736104011535645  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.9739022254943848  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0089211463928223  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([134, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0110936164855957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0110936164855957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0113492012023926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0438084602355957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.045543670654297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.045543670654297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0457382202148438  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.071807861328125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.073902130126953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.073902130126953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.0741195678710938  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.104778289794922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([99, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.106667995452881  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.106667995452881  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1068568229675293  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.134803295135498  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([73, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1364798545837402  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1364798545837402  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1366190910339355  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.158200740814209  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1596789360046387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1596789360046387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1598124504089355  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1814417839050293  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1828055381774902  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1828055381774902  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.1829237937927246  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.202908992767334  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([711, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2199339866638184  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.2199339866638184  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 711, 256]), torch.Size([1, 711, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.221290111541748  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.46555757522583  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 711, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3903322219848633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.392423629760742  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.395003318786621  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3928256034851074  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11548, 40])
input nodes number: 20143
output nodes number: 11548
edges number: 88724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.393097400665283  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.3930978775024414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.03425741195678711  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

pseudo mini batch 4 input nodes size: 84071
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.02958965301513672  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.02958965301513672  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.06967782974243164  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.06976079940795898  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.053366661071777344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05787181854248047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05787181854248047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05787181854248047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([84071, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05787181854248047  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([2328, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2424302101135254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2424302101135254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2328, 128]), torch.Size([1, 2328, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24549102783203125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.263369083404541  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2328, 128])
m.shape torch.Size([2678, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2648129463195801  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2648129463195801  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2678, 128]), torch.Size([1, 2678, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.26781797409057617  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.30736494064331055  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2678, 128])
m.shape torch.Size([2525, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3099188804626465  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3099188804626465  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2525, 128]), torch.Size([1, 2525, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.31232690811157227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3696436882019043  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2525, 128])
m.shape torch.Size([2238, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.37325572967529297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.37325572967529297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2238, 128]), torch.Size([1, 2238, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.37543296813964844  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.43769121170043945  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2238, 128])
m.shape torch.Size([2173, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4418048858642578  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4418048858642578  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2173, 128]), torch.Size([1, 2173, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.44389915466308594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5194058418273926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2173, 128])
m.shape torch.Size([1929, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5238885879516602  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5238885879516602  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1929, 128]), torch.Size([1, 1929, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5257282257080078  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6089181900024414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1929, 128])
m.shape torch.Size([1851, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6141767501831055  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6141767501831055  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1851, 128]), torch.Size([1, 1851, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6159420013427734  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.7042045593261719  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1851, 128])
m.shape torch.Size([1710, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.7098450660705566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.7098450660705566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1710, 128]), torch.Size([1, 1710, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.7114758491516113  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.805269718170166  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1710, 128])
m.shape torch.Size([1698, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.8117413520812988  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.8117413520812988  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1698, 128]), torch.Size([1, 1698, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.8133606910705566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9169983863830566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1698, 128])
m.shape torch.Size([28457, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.051882266998291  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.051882266998291  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 28457, 128]), torch.Size([1, 28457, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 1.079226016998291  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.008739948272705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 28457, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.838107109069824  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.8834896087646484  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.9288721084594727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.8831348419189453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([47587, 256])
first layer input nodes number: 84071
first layer output nodes number: 47587
edges number: 373139
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.9295005798339844  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.9748830795288086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.9866018295288086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.9866018295288086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1389, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.096536159515381  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.096536159515381  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1389, 256]), torch.Size([1, 1389, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1004042625427246  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1240592002868652  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1389, 256])
m.shape torch.Size([1312, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1246471405029297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1246471405029297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1312, 256]), torch.Size([1, 1312, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.127277374267578  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.169394016265869  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1312, 256])
m.shape torch.Size([963, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1708884239196777  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1708884239196777  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 963, 256]), torch.Size([1, 963, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.172725200653076  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.213134288787842  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 963, 256])
m.shape torch.Size([760, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2152791023254395  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2152791023254395  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 760, 256]), torch.Size([1, 760, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.216728687286377  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2597031593322754  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 760, 256])
m.shape torch.Size([669, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2621936798095703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2621936798095703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.263469696044922  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3095054626464844  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([511, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.311814308166504  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.311814308166504  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.312788963317871  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.358168125152588  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([426, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3605470657348633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3605470657348633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3613595962524414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4125146865844727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([372, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4152169227600098  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4152169227600098  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.415926456451416  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4563698768615723  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([341, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4589648246765137  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4589648246765137  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4596152305603027  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.501260280609131  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5036263465881348  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5036263465881348  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5041604042053223  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5432395935058594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.545732021331787  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.545732021331787  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.546229839324951  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.585984706878662  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([202, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5880656242370605  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5880656242370605  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5884509086608887  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6212000846862793  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6235814094543457  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6235814094543457  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.623974323272705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6601223945617676  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([165, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.662228584289551  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.662228584289551  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.662543296813965  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.693699836730957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([170, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.695993423461914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.695993423461914  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.696317672729492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7306880950927734  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.732863426208496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.732863426208496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7331533432006836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.765913963317871  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([138, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.76802396774292  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.76802396774292  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.768287181854248  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.799872875213623  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([140, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.802163600921631  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.802163600921631  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8024306297302246  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.836343288421631  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([129, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8385658264160156  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8385658264160156  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8388118743896484  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8717823028564453  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([98, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8735432624816895  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8735432624816895  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.873730182647705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.900085926055908  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([118, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.902374267578125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.902374267578125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.902599334716797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9359092712402344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([85, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.937594413757324  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.937594413757324  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9377565383911133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.962885856628418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9644851684570312  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9644851684570312  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.964630126953125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9881134033203125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([78, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.989840507507324  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.989840507507324  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9899892807006836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.015131950378418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([2071, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.064819812774658  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.064819812774658  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 2071, 256]), torch.Size([1, 2071, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.068769931793213  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.764461040496826  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 2071, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.664217472076416  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.66597318649292  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.667728900909424  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.665890216827393  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([11112, 40])
input nodes number: 47587
output nodes number: 11112
edges number: 112465
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.665992259979248  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 4.665992736816406  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.06477069854736328  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

pseudo mini batch 5 input nodes size: 70165
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.053030967712402344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.053030967712402344  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.08648824691772461  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.08657550811767578  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.046404361724853516  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05009889602661133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05009889602661133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05009889602661133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([70165, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.05009889602661133  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1940, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2238755226135254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2238755226135254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1940, 128]), torch.Size([1, 1940, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.22572565078735352  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24052667617797852  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1940, 128])
m.shape torch.Size([1924, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24143648147583008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.24143648147583008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1924, 128]), torch.Size([1, 1924, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2432713508605957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.2722134590148926  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1924, 128])
m.shape torch.Size([1867, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.27396678924560547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.27396678924560547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1867, 128]), torch.Size([1, 1867, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.27574729919433594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.31491851806640625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1867, 128])
m.shape torch.Size([1761, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.31738710403442383  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.31738710403442383  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1761, 128]), torch.Size([1, 1761, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.31906652450561523  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.367769718170166  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1761, 128])
m.shape torch.Size([1675, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3709235191345215  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.3709235191345215  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1675, 128]), torch.Size([1, 1675, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.37252092361450195  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.43002748489379883  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1675, 128])
m.shape torch.Size([1647, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4339408874511719  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.4339408874511719  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1647, 128]), torch.Size([1, 1647, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.43551158905029297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5037755966186523  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1647, 128])
m.shape torch.Size([1525, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5080804824829102  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5080804824829102  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1525, 128]), torch.Size([1, 1525, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5095348358154297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5832505226135254  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1525, 128])
m.shape torch.Size([1474, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5881462097167969  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5881462097167969  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1474, 128]), torch.Size([1, 1474, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.5895519256591797  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.672515869140625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1474, 128])
m.shape torch.Size([1421, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6779112815856934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6779112815856934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1421, 128]), torch.Size([1, 1421, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.6792664527893066  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.7712593078613281  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1421, 128])
m.shape torch.Size([28161, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9048638343811035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9048638343811035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 28161, 128]), torch.Size([1, 28161, 128])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 0.9322075843811035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.844374179840088  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 28161, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.6833205223083496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.724705219268799  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.766089916229248  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.724381446838379  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

torch.Size([43395, 256])
first layer input nodes number: 70165
first layer output nodes number: 43395
edges number: 353556
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.7666149139404297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.807999610900879  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.8183460235595703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.8183460235595703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

m.shape torch.Size([1266, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.956840991973877  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.956840991973877  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1266, 256]), torch.Size([1, 1266, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.960052490234375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.982358932495117  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1266, 256])
m.shape torch.Size([1002, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.982165813446045  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.982165813446045  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 1002, 256]), torch.Size([1, 1002, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 2.984076976776123  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.012996196746826  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 1002, 256])
m.shape torch.Size([849, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.014496326446533  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.014496326446533  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.016115665435791  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.0529065132141113  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([659, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.0548148155212402  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.0548148155212402  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 659, 256]), torch.Size([1, 659, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.0560717582702637  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.097489833831787  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 659, 256])
m.shape torch.Size([578, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.09981107711792  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.09981107711792  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 578, 256]), torch.Size([1, 578, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1009135246276855  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1449427604675293  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 578, 256])
m.shape torch.Size([470, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1473121643066406  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1473121643066406  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 470, 256]), torch.Size([1, 470, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1482086181640625  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1904640197753906  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 470, 256])
m.shape torch.Size([402, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.192720413208008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.192720413208008  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.1934871673583984  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2318248748779297  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([323, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2339253425598145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2339253425598145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 323, 256]), torch.Size([1, 323, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.234541416168213  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.271078586578369  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 323, 256])
m.shape torch.Size([341, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2737202644348145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2737202644348145  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.2743706703186035  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3160195350646973  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([309, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.31866455078125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.31866455078125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.319253921508789  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3626656532287598  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([276, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3652892112731934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3652892112731934  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.3658156394958496  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4086813926696777  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([271, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.411543846130371  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.411543846130371  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4120607376098633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.456669330596924  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4594240188598633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.4594240188598633  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.45986270904541  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5002222061157227  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([196, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5026402473449707  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5026402473449707  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.503014087677002  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5400242805480957  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([191, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.542591094970703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.542591094970703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5429553985595703  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.581571578979492  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([185, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5842347145080566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.5842347145080566  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 185, 256]), torch.Size([1, 185, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.584587574005127  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6244606971740723  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 185, 256])
m.shape torch.Size([164, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6269640922546387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6269640922546387  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.62727689743042  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.66481351852417  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([168, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6675639152526855  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.6675639152526855  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.667884349822998  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7085795402526855  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([151, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.711176872253418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.711176872253418  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7114648818969727  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.750058174133301  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([167, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.753124713897705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.753124713897705  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7534432411193848  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.7983555793762207  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([149, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.801300048828125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.801300048828125  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.801584243774414  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8436450958251953  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([102, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8456602096557617  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8456602096557617  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8458547592163086  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.876009941101074  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([116, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.878477096557617  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.878477096557617  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.8786983489990234  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.914541244506836  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([115, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.917083740234375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.917083740234375  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.0369873046875 GB
    Memory Allocated: 3.9173030853271484  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 3.9543724060058594  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([3029, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.027044296264648  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.027044296264648  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

 h.shape torch.Size([1, 3029, 256]), torch.Size([1, 3029, 256])
----------------------------------------3
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.032909393310547  GigaBytes
Max Memory Allocated: 5.123517990112305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 5.053983688354492  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 3029, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.925567150115967  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.927701473236084  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.929900646209717  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.927679061889648  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([11709, 40])
input nodes number: 43395
output nodes number: 11709
edges number: 142114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.928468704223633  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0408935546875 GB
    Memory Allocated: 4.928469181060791  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.05685758590698242  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

pseudo mini batch 6 input nodes size: 57354
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.0467829704284668  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.0467829704284668  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.07413148880004883  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.07421493530273438  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04067039489746094  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.042420387268066406  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.042420387268066406  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.042420387268066406  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([57354, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.042420387268066406  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

m.shape torch.Size([3057, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.1256265640258789  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.1256265640258789  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 3057, 128]), torch.Size([1, 3057, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.1285419464111328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.1519460678100586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 3057, 128])
m.shape torch.Size([3118, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.15346193313598633  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.15346193313598633  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 3118, 128]), torch.Size([1, 3118, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.15724468231201172  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.20184803009033203  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 3118, 128])
m.shape torch.Size([2798, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.20436382293701172  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.20436382293701172  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2798, 128]), torch.Size([1, 2798, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.20719099044799805  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.2680697441101074  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2798, 128])
m.shape torch.Size([2429, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.27207231521606445  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.27207231521606445  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2429, 128]), torch.Size([1, 2429, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.27454185485839844  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.34240150451660156  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2429, 128])
m.shape torch.Size([2087, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.3462190628051758  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.3462190628051758  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2087, 128]), torch.Size([1, 2087, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.3483095169067383  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.4227457046508789  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2087, 128])
m.shape torch.Size([1740, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.42595672607421875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.42595672607421875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1740, 128]), torch.Size([1, 1740, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.4276161193847656  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5012664794921875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1740, 128])
m.shape torch.Size([1456, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5055179595947266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5055179595947266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5069065093994141  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5793857574462891  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([1324, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5837421417236328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5837421417236328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1324, 128]), torch.Size([1, 1324, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5850048065185547  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6572136878967285  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1324, 128])
m.shape torch.Size([1089, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6612558364868164  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6612558364868164  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1089, 128]), torch.Size([1, 1089, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6622943878173828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7287616729736328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1089, 128])
m.shape torch.Size([8778, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7700991630554199  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7700991630554199  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 8778, 128]), torch.Size([1, 8778, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.778470516204834  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3728365898132324  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 8778, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3025789260864258  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3291635513305664  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.355748176574707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3289556503295898  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([27876, 256])
first layer input nodes number: 57354
first layer output nodes number: 27876
edges number: 166643
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.356177806854248  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3827624320983887  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3894085884094238  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.3894085884094238  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

m.shape torch.Size([2076, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4573097229003906  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4573097229003906  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2076, 256]), torch.Size([1, 2076, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4626045227050781  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4975166320800781  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2076, 256])
m.shape torch.Size([1742, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4981017112731934  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.4981017112731934  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1742, 256]), torch.Size([1, 1742, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.5016264915466309  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.5528168678283691  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1742, 256])
m.shape torch.Size([1327, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.5549821853637695  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.5549821853637695  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1327, 256]), torch.Size([1, 1327, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.557610034942627  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6155271530151367  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1327, 256])
m.shape torch.Size([1065, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6181640625  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6181640625  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1065, 256]), torch.Size([1, 1065, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6204185485839844  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.684645175933838  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1065, 256])
m.shape torch.Size([839, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6871933937072754  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.6871933937072754  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 839, 256]), torch.Size([1, 839, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.688793659210205  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.749009609222412  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 839, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.7518253326416016  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.7518253326416016  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.753021240234375  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8115863800048828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([481, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8146967887878418  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8146967887878418  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 481, 256]), torch.Size([1, 481, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8156142234802246  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8680310249328613  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 481, 256])
m.shape torch.Size([430, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8708786964416504  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8708786964416504  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 430, 256]), torch.Size([1, 430, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.8716988563537598  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9200959205627441  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 430, 256])
m.shape torch.Size([350, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9227137565612793  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9227137565612793  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9233813285827637  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9681496620178223  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([289, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9705939292907715  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9705939292907715  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9711451530456543  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0110716819763184  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([225, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0131750106811523  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0131750106811523  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.013604164123535  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0470781326293945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([202, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0491933822631836  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0491933822631836  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0495786666870117  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0823278427124023  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([199, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0846219062805176  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0846219062805176  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0850014686584473  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1199212074279785  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([170, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1220192909240723  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1220192909240723  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1223435401916504  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1544442176818848  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([135, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.156228542327881  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.156228542327881  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1564860343933105  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1837801933288574  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([107, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1852970123291016  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1852970123291016  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1855010986328125  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2085628509521484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([86, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.210048198699951  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.210048198699951  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.210212230682373  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.229896068572998  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.231215476989746  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.231215476989746  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.231369972229004  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.250990867614746  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.252338409423828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.252338409423828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2524871826171875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2724227905273438  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2734827995300293  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2734827995300293  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2735953330993652  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2894625663757324  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.290335178375244  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.290335178375244  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2904229164123535  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.303408145904541  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.304168224334717  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.304168224334717  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3042407035827637  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3154749870300293  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3162569999694824  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3162569999694824  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3163275718688965  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3277602195739746  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3286709785461426  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3286709785461426  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.328749179840088  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3419651985168457  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([427, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3521862030029297  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3521862030029297  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 427, 256]), torch.Size([1, 427, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3530006408691406  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.496872901916504  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 427, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.440300464630127  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4419631958007812  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4436259269714355  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4418797492980957  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([11157, 40])
input nodes number: 27876
output nodes number: 11157
edges number: 68102
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.441699504852295  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.441699981689453  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04538393020629883  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

pseudo mini batch 7 input nodes size: 72338
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04019880294799805  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04019880294799805  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.0746922492980957  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.07477474212646484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.047342777252197266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04981374740600586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04981374740600586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04981374740600586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([72338, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.04981374740600586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

m.shape torch.Size([2849, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.17410898208618164  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.17410898208618164  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2849, 128]), torch.Size([1, 2849, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.17682600021362305  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.1990962028503418  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2849, 128])
m.shape torch.Size([2963, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.2005634307861328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.2005634307861328  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2963, 128]), torch.Size([1, 2963, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.20436334609985352  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.2485213279724121  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2963, 128])
m.shape torch.Size([2508, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.25134706497192383  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.25134706497192383  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2508, 128]), torch.Size([1, 2508, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.25390148162841797  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.31129932403564453  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2508, 128])
m.shape torch.Size([2195, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.31488704681396484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.31488704681396484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2195, 128]), torch.Size([1, 2195, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.3170003890991211  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.3783230781555176  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2195, 128])
m.shape torch.Size([2003, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.382051944732666  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.382051944732666  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 2003, 128]), torch.Size([1, 2003, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.38396215438842773  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.45375967025756836  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 2003, 128])
m.shape torch.Size([1757, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.45783138275146484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.45783138275146484  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1757, 128]), torch.Size([1, 1757, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.4595069885253906  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5322847366333008  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1757, 128])
m.shape torch.Size([1562, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5366606712341309  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5366606712341309  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1562, 128]), torch.Size([1, 1562, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.5381503105163574  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.614044189453125  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1562, 128])
m.shape torch.Size([1433, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6187658309936523  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6187658309936523  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.6201324462890625  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7019510269165039  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1279, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7075200080871582  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7075200080871582  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1279, 128]), torch.Size([1, 1279, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7087397575378418  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.7868037223815918  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1279, 128])
m.shape torch.Size([17154, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.8679904937744141  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.8679904937744141  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 17154, 128]), torch.Size([1, 17154, 128])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.8843498229980469  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.046346664428711  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 17154, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.933835506439209  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.9678845405578613  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0019335746765137  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 1.967618465423584  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([35703, 256])
first layer input nodes number: 72338
first layer output nodes number: 35703
edges number: 251085
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.002474784851074  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0365238189697266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0450363159179688  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.0450363159179688  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

m.shape torch.Size([1963, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.124739170074463  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.124739170074463  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1963, 256]), torch.Size([1, 1963, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1286606788635254  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.15970516204834  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1963, 256])
m.shape torch.Size([1649, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.160923957824707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.160923957824707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1649, 256]), torch.Size([1, 1649, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.1642541885375977  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.212677001953125  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1649, 256])
m.shape torch.Size([1166, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2140908241271973  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2140908241271973  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 1166, 256]), torch.Size([1, 1166, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.216665744781494  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.26766300201416  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 1166, 256])
m.shape torch.Size([876, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2701163291931152  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.2701163291931152  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 876, 256]), torch.Size([1, 876, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.271787166595459  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3216233253479004  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 876, 256])
m.shape torch.Size([772, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.324498176574707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.324498176574707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 772, 256]), torch.Size([1, 772, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3259706497192383  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3789796829223633  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 772, 256])
m.shape torch.Size([610, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3817615509033203  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.3817615509033203  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 610, 256]), torch.Size([1, 610, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.382925033569336  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4341602325439453  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 610, 256])
m.shape torch.Size([475, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.436774253845215  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.436774253845215  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.437680244445801  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4846248626708984  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([414, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4873552322387695  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.4873552322387695  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 414, 256]), torch.Size([1, 414, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.488144874572754  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.5337343215942383  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 414, 256])
m.shape torch.Size([305, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.535977840423584  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.535977840423584  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 305, 256]), torch.Size([1, 305, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.536559581756592  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.5751471519470215  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 305, 256])
m.shape torch.Size([286, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.5776052474975586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.5776052474975586  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.578150749206543  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.617123603820801  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([245, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.619441509246826  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.619441509246826  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 245, 256]), torch.Size([1, 245, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.6199088096618652  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.656358242034912  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 245, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.65859317779541  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.65859317779541  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.659001350402832  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.6936960220336914  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([157, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.695453643798828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.695453643798828  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.6957530975341797  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7233028411865234  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7249159812927246  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7249159812927246  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.725165843963623  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7499022483825684  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([119, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.751492977142334  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.751492977142334  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7517199516296387  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7757792472839355  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.777365207672119  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.777365207672119  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.7775635719299316  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.799978733062744  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.801513671875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.801513671875  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8017044067382812  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8245925903320312  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8263487815856934  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8263487815856934  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8265528678894043  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8524718284606934  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([93, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8540682792663574  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8540682792663574  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.854245662689209  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8780150413513184  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([84, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8795413970947266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.8795413970947266  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.879701614379883  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.902292251586914  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([71, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9036455154418945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9036455154418945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.903780937194824  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.923823356628418  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([59, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9250035285949707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9250035285949707  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9251160621643066  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes
Using backend: pytorch

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.942558765411377  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.943542957305908  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.943542957305908  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9436306953430176  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9578442573547363  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([58, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.960090160369873  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.960090160369873  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.960200786590576  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 2.9788966178894043  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([940, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.001608371734619  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.001608371734619  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

 h.shape torch.Size([1, 940, 256]), torch.Size([1, 940, 256])
----------------------------------------3
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.003401279449463  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.318953037261963  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

rst.shape  torch.Size([1, 940, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.251033306121826  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.2535400390625  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.255186080932617  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.252596855163574  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

torch.Size([11044, 40])
input nodes number: 35703
output nodes number: 11044
edges number: 80424
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.2529287338256836  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 3.252929210662842  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.05432939529418945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.05432939529418945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0447998046875 GB
    Memory Allocated: 0.05432939529418945  GigaBytes
Max Memory Allocated: 5.1262006759643555  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01924160122871399 |0.002450227737426758 |0.12054675817489624 |9.396672248840332e-05 |0.07504507899284363 |0.004574298858642578 |
----------------------------------------------------------pseudo_mini_loss sum 3.6500186920166016
Total (block generation + training)time/epoch 22.68636131286621
Training time/epoch 1.7955403327941895
Training time without block to device /epoch 1.7759385108947754
Training time without total dataloading part /epoch 1.5700607299804688
load block tensor time/epoch 0.15393280982971191
block to device time/epoch 0.019601821899414062
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  677087
Number of first layer input nodes during this epoch:  434589
Number of first layer output nodes during this epoch:  242498
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
