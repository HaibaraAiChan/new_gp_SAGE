[05:07:43] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27741370 edges into 8 parts and get 4362583 edge cuts
main start at this time 1651554440.7108502
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.02435159683227539
global_2_local spend time (sec) 0.03567934036254883
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.003885984420776367
A = g.adjacency_matrix() spent  0.007858037948608398
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07774090766906738
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.2917404174804688
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1755411624908447

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18687042, 2.0: 3216437, 3.0: 806435, 4.0: 243588, 5.0: 87963, 6.0: 38056, 7.0: 17712, 8.0: 9211, 9.0: 5018, 10.0: 2773, 11.0: 1603, 12.0: 931, 13.0: 552, 14.0: 368, 15.0: 239, 16.0: 157, 17.0: 127, 18.0: 78, 19.0: 42, 20.0: 15, 21.0: 7})
Convert a graph into a bidirected graph: 1.111 seconds
Metis partitioning: 4.903 seconds
Split the graph: 1.350 seconds
Construct subgraphs: 0.083 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.460228204727173
11315
11219
11317
11035
11585
11706
11567
11197
total k batches seeds list generation spend  19.561071157455444
after graph partition
graph partition algorithm spend time 19.657673835754395
11315
11219
11317
11035
11585
11706
11567
11197
partition_len_list
[26043, 34253, 41544, 46964, 21746, 22636, 20947, 19921]
shared_neighbor_graph_partition_s0 selection method  spend 19.742902278900146
time for parepare:  0.01634502410888672
local_output_nid generation:  0.0019032955169677734
local_in_edges_tensor generation:  0.002115964889526367
mini_batch_src_global generation:  0.0026845932006835938
r_  generation:  0.026030540466308594
local_output_nid generation:  0.0022308826446533203
local_in_edges_tensor generation:  0.002040863037109375
mini_batch_src_global generation:  0.003797769546508789
r_  generation:  0.032306671142578125
local_output_nid generation:  0.0024864673614501953
local_in_edges_tensor generation:  0.0031349658966064453
mini_batch_src_global generation:  0.011312484741210938
r_  generation:  0.04605722427368164
local_output_nid generation:  0.003335237503051758
local_in_edges_tensor generation:  0.002895355224609375
mini_batch_src_global generation:  0.004609823226928711
r_  generation:  0.03873181343078613
local_output_nid generation:  0.0027723312377929688
local_in_edges_tensor generation:  0.002156496047973633
mini_batch_src_global generation:  0.0031549930572509766
r_  generation:  0.02765369415283203
local_output_nid generation:  0.0026166439056396484
local_in_edges_tensor generation:  0.002144336700439453
mini_batch_src_global generation:  0.002656221389770508
r_  generation:  0.03045940399169922
local_output_nid generation:  0.002549886703491211
local_in_edges_tensor generation:  0.002155303955078125
mini_batch_src_global generation:  0.0028533935546875
r_  generation:  0.029690027236938477
local_output_nid generation:  0.0025043487548828125
local_in_edges_tensor generation:  0.0026149749755859375
mini_batch_src_global generation:  0.0028421878814697266
r_  generation:  0.03063511848449707
----------------------check_connections_block total spend ----------------------------- 0.41881561279296875
generate_one_block  0.03413128852844238
generate_one_block  0.04201245307922363
generate_one_block  0.0603485107421875
generate_one_block  0.050949811935424805
generate_one_block  0.03363180160522461
generate_one_block  0.03781270980834961
generate_one_block  0.041759490966796875
generate_one_block  0.047519683837890625
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.036379098892211914
gen group dst list time:  0.0063953399658203125
time for parepare:  0.024075984954833984
local_output_nid generation:  0.005251884460449219
local_in_edges_tensor generation:  0.01641559600830078
mini_batch_src_global generation:  0.005373477935791016
r_  generation:  0.05980086326599121
local_output_nid generation:  0.008557558059692383
local_in_edges_tensor generation:  0.009898900985717773
mini_batch_src_global generation:  0.009234428405761719
r_  generation:  0.08548951148986816
local_output_nid generation:  0.009649038314819336
local_in_edges_tensor generation:  0.009796857833862305
mini_batch_src_global generation:  0.011520624160766602
r_  generation:  0.1162574291229248
local_output_nid generation:  0.01101374626159668
local_in_edges_tensor generation:  0.011134624481201172
mini_batch_src_global generation:  0.014261960983276367
r_  generation:  0.1305832862854004
local_output_nid generation:  0.005419492721557617
local_in_edges_tensor generation:  0.004281759262084961
mini_batch_src_global generation:  0.006909847259521484
r_  generation:  0.04733633995056152
local_output_nid generation:  0.00547480583190918
local_in_edges_tensor generation:  0.004503965377807617
mini_batch_src_global generation:  0.005239963531494141
r_  generation:  0.05098247528076172
local_output_nid generation:  0.004976987838745117
local_in_edges_tensor generation:  0.004042863845825195
mini_batch_src_global generation:  0.004687309265136719
r_  generation:  0.045233726501464844
local_output_nid generation:  0.004739999771118164
local_in_edges_tensor generation:  0.0038962364196777344
mini_batch_src_global generation:  0.004547119140625
r_  generation:  0.04609346389770508
----------------------check_connections_block total spend ----------------------------- 0.9234721660614014
generate_one_block  0.0686028003692627
generate_one_block  0.11015820503234863
generate_one_block  0.1507565975189209
generate_one_block  0.16606926918029785
generate_one_block  0.05598759651184082
generate_one_block  0.06212973594665527
generate_one_block  0.05583524703979492
generate_one_block  0.05616426467895508
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9234721660614014
block generation total time  0.7257037162780762
average batch blocks generation time:  0.09071296453475952
pseudo mini batch 0 input nodes size: 53318
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.028201580047607422  GigaBytes
Max Memory Allocated: 0.028201580047607422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.028285980224609375  GigaBytes
Max Memory Allocated: 0.028285980224609375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0467529296875 GB
    Memory Allocated: 0.028285980224609375  GigaBytes
Max Memory Allocated: 0.028285980224609375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.029926300048828125  GigaBytes
Max Memory Allocated: 0.029926300048828125  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.029926300048828125  GigaBytes
Max Memory Allocated: 0.029926300048828125  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.029926300048828125  GigaBytes
Max Memory Allocated: 0.029926300048828125  GigaBytes

torch.Size([53318, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1131591796875 GB
    Memory Allocated: 0.029926300048828125  GigaBytes
Max Memory Allocated: 0.029926300048828125  GigaBytes

m.shape torch.Size([3009, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 0.10806560516357422  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.1068415641784668  GigaBytes
Max Memory Allocated: 0.10806560516357422  GigaBytes

 h.shape torch.Size([1, 3009, 128]), torch.Size([1, 3009, 128])
----------------------------------------3
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.1097111701965332  GigaBytes
Max Memory Allocated: 0.1097111701965332  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13266801834106445  GigaBytes
Max Memory Allocated: 0.13498163223266602  GigaBytes

rst.shape  torch.Size([1, 3009, 128])
m.shape torch.Size([3008, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13410186767578125  GigaBytes
Max Memory Allocated: 0.13498163223266602  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13410186767578125  GigaBytes
Max Memory Allocated: 0.13498163223266602  GigaBytes

 h.shape torch.Size([1, 3008, 128]), torch.Size([1, 3008, 128])
----------------------------------------3
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.13785028457641602  GigaBytes
Max Memory Allocated: 0.13785028457641602  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.1835322380065918  GigaBytes
Max Memory Allocated: 0.1864008903503418  GigaBytes

rst.shape  torch.Size([1, 3008, 128])
m.shape torch.Size([2710, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.1850895881652832  GigaBytes
Max Memory Allocated: 0.1864008903503418  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.1850895881652832  GigaBytes
Max Memory Allocated: 0.1864008903503418  GigaBytes

 h.shape torch.Size([1, 2710, 128]), torch.Size([1, 2710, 128])
----------------------------------------3
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.18774080276489258  GigaBytes
Max Memory Allocated: 0.18774080276489258  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.24490022659301758  GigaBytes
Max Memory Allocated: 0.24877691268920898  GigaBytes

rst.shape  torch.Size([1, 2710, 128])
m.shape torch.Size([2245, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.24788999557495117  GigaBytes
Max Memory Allocated: 0.24877691268920898  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.24788999557495117  GigaBytes
Max Memory Allocated: 0.24877691268920898  GigaBytes

 h.shape torch.Size([1, 2245, 128]), torch.Size([1, 2245, 128])
----------------------------------------3
 Nvidia-smi: 1.4490966796875 GB
    Memory Allocated: 0.25025272369384766  GigaBytes
Max Memory Allocated: 0.25025272369384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3131284713745117  GigaBytes
Max Memory Allocated: 0.3174104690551758  GigaBytes

rst.shape  torch.Size([1, 2245, 128])
m.shape torch.Size([2035, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3174104690551758  GigaBytes
Max Memory Allocated: 0.31752443313598633  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5076904296875 GB
    Memory Allocated: 0.3174104690551758  GigaBytes
Max Memory Allocated: 0.31752443313598633  GigaBytes

 h.shape torch.Size([1, 2035, 128]), torch.Size([1, 2035, 128])
----------------------------------------3
 Nvidia-smi: 1.5096435546875 GB
    Memory Allocated: 0.3193511962890625  GigaBytes
Max Memory Allocated: 0.3193511962890625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3898658752441406  GigaBytes
Max Memory Allocated: 0.3947176933288574  GigaBytes

rst.shape  torch.Size([1, 2035, 128])
m.shape torch.Size([1563, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39336729049682617  GigaBytes
Max Memory Allocated: 0.3947176933288574  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39336729049682617  GigaBytes
Max Memory Allocated: 0.3947176933288574  GigaBytes

 h.shape torch.Size([1, 1563, 128]), torch.Size([1, 1563, 128])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.39485788345336914  GigaBytes
Max Memory Allocated: 0.39485788345336914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4591069221496582  GigaBytes
Max Memory Allocated: 0.4635787010192871  GigaBytes

rst.shape  torch.Size([1, 1563, 128])
m.shape torch.Size([1379, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4629645347595215  GigaBytes
Max Memory Allocated: 0.4635787010192871  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.4629645347595215  GigaBytes
Max Memory Allocated: 0.4635787010192871  GigaBytes

 h.shape torch.Size([1, 1379, 128]), torch.Size([1, 1379, 128])
----------------------------------------3
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4642796516418457  GigaBytes
Max Memory Allocated: 0.4642796516418457  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.5300354957580566  GigaBytes
Max Memory Allocated: 0.5346384048461914  GigaBytes

rst.shape  torch.Size([1, 1379, 128])
m.shape torch.Size([1211, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.5339975357055664  GigaBytes
Max Memory Allocated: 0.5346384048461914  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.5339975357055664  GigaBytes
Max Memory Allocated: 0.5346384048461914  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 1.7479248046875 GB
    Memory Allocated: 0.5351524353027344  GigaBytes
Max Memory Allocated: 0.5351524353027344  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6013936996459961  GigaBytes
Max Memory Allocated: 0.606013298034668  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1021, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6051979064941406  GigaBytes
Max Memory Allocated: 0.606013298034668  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.6051979064941406  GigaBytes
Max Memory Allocated: 0.606013298034668  GigaBytes

 h.shape torch.Size([1, 1021, 128]), torch.Size([1, 1021, 128])
----------------------------------------3
 Nvidia-smi: 1.8143310546875 GB
    Memory Allocated: 0.6061716079711914  GigaBytes
Max Memory Allocated: 0.6061716079711914  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8826904296875 GB
    Memory Allocated: 0.6686711311340332  GigaBytes
Max Memory Allocated: 0.6730527877807617  GigaBytes

rst.shape  torch.Size([1, 1021, 128])
m.shape torch.Size([7862, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.7056732177734375  GigaBytes
Max Memory Allocated: 0.7065525054931641  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.7056732177734375  GigaBytes
Max Memory Allocated: 0.7065525054931641  GigaBytes

 h.shape torch.Size([1, 7862, 128]), torch.Size([1, 7862, 128])
----------------------------------------3
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.7131710052490234  GigaBytes
Max Memory Allocated: 0.7131710052490234  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 1.2677240371704102  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

rst.shape  torch.Size([1, 7862, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 1.2028751373291016  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.5194091796875 GB
    Memory Allocated: 1.2277116775512695  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 1.2531023025512695  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 1.228071689605713  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

torch.Size([26043, 256])
first layer input nodes number: 53318
first layer output nodes number: 26043
edges number: 152838
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 1.2535018920898438  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.5447998046875 GB
    Memory Allocated: 1.2783384323120117  GigaBytes
Max Memory Allocated: 1.3052129745483398  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 1.2851018905639648  GigaBytes
Max Memory Allocated: 1.3099384307861328  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.5701904296875 GB
    Memory Allocated: 1.2851018905639648  GigaBytes
Max Memory Allocated: 1.3099384307861328  GigaBytes

m.shape torch.Size([2139, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.3525495529174805  GigaBytes
Max Memory Allocated: 1.35255765914917  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.3525495529174805  GigaBytes
Max Memory Allocated: 1.35255765914917  GigaBytes

 h.shape torch.Size([1, 2139, 256]), torch.Size([1, 2139, 256])
----------------------------------------3
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.3567185401916504  GigaBytes
Max Memory Allocated: 1.3567185401916504  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.389357089996338  GigaBytes
Max Memory Allocated: 1.3913969993591309  GigaBytes

rst.shape  torch.Size([1, 2139, 256])
m.shape torch.Size([1721, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.390885829925537  GigaBytes
Max Memory Allocated: 1.3913969993591309  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.390885829925537  GigaBytes
Max Memory Allocated: 1.3913969993591309  GigaBytes

 h.shape torch.Size([1, 1721, 256]), torch.Size([1, 1721, 256])
----------------------------------------3
 Nvidia-smi: 2.6346435546875 GB
    Memory Allocated: 1.3941740989685059  GigaBytes
Max Memory Allocated: 1.3941740989685059  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.4441132545471191  GigaBytes
Max Memory Allocated: 1.4473958015441895  GigaBytes

rst.shape  torch.Size([1, 1721, 256])
m.shape torch.Size([1399, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.447263240814209  GigaBytes
Max Memory Allocated: 1.4473958015441895  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.447263240814209  GigaBytes
Max Memory Allocated: 1.4473958015441895  GigaBytes

 h.shape torch.Size([1, 1399, 256]), torch.Size([1, 1399, 256])
----------------------------------------3
 Nvidia-smi: 2.6737060546875 GB
    Memory Allocated: 1.450080394744873  GigaBytes
Max Memory Allocated: 1.450080394744873  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.5114812850952148  GigaBytes
Max Memory Allocated: 1.5154838562011719  GigaBytes

rst.shape  torch.Size([1, 1399, 256])
m.shape torch.Size([1094, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.5143532752990723  GigaBytes
Max Memory Allocated: 1.5154838562011719  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.5143532752990723  GigaBytes
Max Memory Allocated: 1.5154838562011719  GigaBytes

 h.shape torch.Size([1, 1094, 256]), torch.Size([1, 1094, 256])
----------------------------------------3
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 1.5164589881896973  GigaBytes
Max Memory Allocated: 1.5164589881896973  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7908935546875 GB
    Memory Allocated: 1.5792346000671387  GigaBytes
Max Memory Allocated: 1.5834078788757324  GigaBytes

rst.shape  torch.Size([1, 1094, 256])
m.shape torch.Size([916, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.7908935546875 GB
    Memory Allocated: 1.5818419456481934  GigaBytes
Max Memory Allocated: 1.5834078788757324  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7908935546875 GB
    Memory Allocated: 1.5818419456481934  GigaBytes
Max Memory Allocated: 1.5834078788757324  GigaBytes

 h.shape torch.Size([1, 916, 256]), torch.Size([1, 916, 256])
----------------------------------------3
 Nvidia-smi: 2.7908935546875 GB
    Memory Allocated: 1.5835890769958496  GigaBytes
Max Memory Allocated: 1.5835890769958496  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6469931602478027  GigaBytes
Max Memory Allocated: 1.6513609886169434  GigaBytes

rst.shape  torch.Size([1, 916, 256])
m.shape torch.Size([631, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6497588157653809  GigaBytes
Max Memory Allocated: 1.6513609886169434  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6497588157653809  GigaBytes
Max Memory Allocated: 1.6513609886169434  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 2.8592529296875 GB
    Memory Allocated: 1.6509623527526855  GigaBytes
Max Memory Allocated: 1.6513609886169434  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9276123046875 GB
    Memory Allocated: 1.702989101409912  GigaBytes
Max Memory Allocated: 1.7065997123718262  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([511, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9276123046875 GB
    Memory Allocated: 1.7058253288269043  GigaBytes
Max Memory Allocated: 1.7065997123718262  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9276123046875 GB
    Memory Allocated: 1.7058253288269043  GigaBytes
Max Memory Allocated: 1.7065997123718262  GigaBytes

 h.shape torch.Size([1, 511, 256]), torch.Size([1, 511, 256])
----------------------------------------3
 Nvidia-smi: 2.9276123046875 GB
    Memory Allocated: 1.7067999839782715  GigaBytes
Max Memory Allocated: 1.7067999839782715  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.7570500373840332  GigaBytes
Max Memory Allocated: 1.7604613304138184  GigaBytes

rst.shape  torch.Size([1, 511, 256])
m.shape torch.Size([437, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.759922981262207  GigaBytes
Max Memory Allocated: 1.7604613304138184  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.759922981262207  GigaBytes
Max Memory Allocated: 1.7604613304138184  GigaBytes

 h.shape torch.Size([1, 437, 256]), torch.Size([1, 437, 256])
----------------------------------------3
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.760756492614746  GigaBytes
Max Memory Allocated: 1.760756492614746  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0194091796875 GB
    Memory Allocated: 1.8085660934448242  GigaBytes
Max Memory Allocated: 1.8119001388549805  GigaBytes

rst.shape  torch.Size([1, 437, 256])
m.shape torch.Size([353, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.0194091796875 GB
    Memory Allocated: 1.8112030029296875  GigaBytes
Max Memory Allocated: 1.8119001388549805  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0194091796875 GB
    Memory Allocated: 1.8112030029296875  GigaBytes
Max Memory Allocated: 1.8119001388549805  GigaBytes

 h.shape torch.Size([1, 353, 256]), torch.Size([1, 353, 256])
----------------------------------------3
 Nvidia-smi: 3.0194091796875 GB
    Memory Allocated: 1.8118762969970703  GigaBytes
Max Memory Allocated: 1.8119001388549805  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.855668067932129  GigaBytes
Max Memory Allocated: 1.8586978912353516  GigaBytes

rst.shape  torch.Size([1, 353, 256])
m.shape torch.Size([308, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.8582921028137207  GigaBytes
Max Memory Allocated: 1.8586978912353516  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.8582921028137207  GigaBytes
Max Memory Allocated: 1.8586978912353516  GigaBytes

 h.shape torch.Size([1, 308, 256]), torch.Size([1, 308, 256])
----------------------------------------3
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.858879566192627  GigaBytes
Max Memory Allocated: 1.858879566192627  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 1.902336597442627  GigaBytes
Max Memory Allocated: 1.9052739143371582  GigaBytes

rst.shape  torch.Size([1, 308, 256])
m.shape torch.Size([233, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 1.9045066833496094  GigaBytes
Max Memory Allocated: 1.9052739143371582  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 1.9045066833496094  GigaBytes
Max Memory Allocated: 1.9052739143371582  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 3.1112060546875 GB
    Memory Allocated: 1.9049510955810547  GigaBytes
Max Memory Allocated: 1.9052739143371582  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.939615249633789  GigaBytes
Max Memory Allocated: 1.9420595169067383  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.9417805671691895  GigaBytes
Max Memory Allocated: 1.9420595169067383  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.9417805671691895  GigaBytes
Max Memory Allocated: 1.9420595169067383  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 3.1483154296875 GB
    Memory Allocated: 1.9421753883361816  GigaBytes
Max Memory Allocated: 1.9421753883361816  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9757351875305176  GigaBytes
Max Memory Allocated: 1.9781041145324707  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([180, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9777870178222656  GigaBytes
Max Memory Allocated: 1.9781041145324707  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9777870178222656  GigaBytes
Max Memory Allocated: 1.9781041145324707  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 3.1834716796875 GB
    Memory Allocated: 1.9781303405761719  GigaBytes
Max Memory Allocated: 1.9781303405761719  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.009716033935547  GigaBytes
Max Memory Allocated: 2.0119476318359375  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([144, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.0114822387695312  GigaBytes
Max Memory Allocated: 2.0119476318359375  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.0114822387695312  GigaBytes
Max Memory Allocated: 2.0119476318359375  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 3.2225341796875 GB
    Memory Allocated: 2.0117568969726562  GigaBytes
Max Memory Allocated: 2.0119476318359375  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.0389480590820312  GigaBytes
Max Memory Allocated: 2.0408706665039062  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([116, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.0404834747314453  GigaBytes
Max Memory Allocated: 2.0408706665039062  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.0404834747314453  GigaBytes
Max Memory Allocated: 2.0408706665039062  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.0407047271728516  GigaBytes
Max Memory Allocated: 2.0408706665039062  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2615966796875 GB
    Memory Allocated: 2.064157485961914  GigaBytes
Max Memory Allocated: 2.065816879272461  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([98, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.2615966796875 GB
    Memory Allocated: 2.065554141998291  GigaBytes
Max Memory Allocated: 2.065816879272461  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2615966796875 GB
    Memory Allocated: 2.065554141998291  GigaBytes
Max Memory Allocated: 2.065816879272461  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 3.2615966796875 GB
    Memory Allocated: 2.0657410621643066  GigaBytes
Max Memory Allocated: 2.065816879272461  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2830810546875 GB
    Memory Allocated: 2.0868630409240723  GigaBytes
Max Memory Allocated: 2.0883584022521973  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([80, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.2830810546875 GB
    Memory Allocated: 2.0880770683288574  GigaBytes
Max Memory Allocated: 2.0883584022521973  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2830810546875 GB
    Memory Allocated: 2.0880770683288574  GigaBytes
Max Memory Allocated: 2.0883584022521973  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 3.2830810546875 GB
    Memory Allocated: 2.0882296562194824  GigaBytes
Max Memory Allocated: 2.0883584022521973  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 2.1065402030944824  GigaBytes
Max Memory Allocated: 2.107837200164795  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([74, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 2.1077442169189453  GigaBytes
Max Memory Allocated: 2.107837200164795  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 2.1077442169189453  GigaBytes
Max Memory Allocated: 2.107837200164795  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.3006591796875 GB
    Memory Allocated: 2.1078853607177734  GigaBytes
Max Memory Allocated: 2.1078853607177734  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.1258106231689453  GigaBytes
Max Memory Allocated: 2.1270809173583984  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.1268177032470703  GigaBytes
Max Memory Allocated: 2.1270809173583984  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.1268177032470703  GigaBytes
Max Memory Allocated: 2.1270809173583984  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.1269302368164062  GigaBytes
Max Memory Allocated: 2.1270809173583984  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 2.142009735107422  GigaBytes
Max Memory Allocated: 2.1430788040161133  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([55, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 2.1430110931396484  GigaBytes
Max Memory Allocated: 2.1430788040161133  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 2.1430110931396484  GigaBytes
Max Memory Allocated: 2.1430788040161133  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 2.143115997314453  GigaBytes
Max Memory Allocated: 2.143115997314453  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3475341796875 GB
    Memory Allocated: 2.157907485961914  GigaBytes
Max Memory Allocated: 2.159456253051758  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 2.1586222648620605  GigaBytes
Max Memory Allocated: 2.159456253051758  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 2.1586222648620605  GigaBytes
Max Memory Allocated: 2.159456253051758  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.3494873046875 GB
    Memory Allocated: 2.1586947441101074  GigaBytes
Max Memory Allocated: 2.159456253051758  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3592529296875 GB
    Memory Allocated: 2.169421672821045  GigaBytes
Max Memory Allocated: 2.170182704925537  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.3592529296875 GB
    Memory Allocated: 2.170083522796631  GigaBytes
Max Memory Allocated: 2.170182704925537  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3592529296875 GB
    Memory Allocated: 2.170083522796631  GigaBytes
Max Memory Allocated: 2.170182704925537  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.3592529296875 GB
    Memory Allocated: 2.1701464653015137  GigaBytes
Max Memory Allocated: 2.170182704925537  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.1799025535583496  GigaBytes
Max Memory Allocated: 2.1805949211120605  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.180600643157959  GigaBytes
Max Memory Allocated: 2.180603504180908  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.180600643157959  GigaBytes
Max Memory Allocated: 2.180603504180908  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 3.3690185546875 GB
    Memory Allocated: 2.180663585662842  GigaBytes
Max Memory Allocated: 2.180663585662842  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3807373046875 GB
    Memory Allocated: 2.1908602714538574  GigaBytes
Max Memory Allocated: 2.1915841102600098  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.3807373046875 GB
    Memory Allocated: 2.1917057037353516  GigaBytes
Max Memory Allocated: 2.191709518432617  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3807373046875 GB
    Memory Allocated: 2.1917057037353516  GigaBytes
Max Memory Allocated: 2.191709518432617  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 3.3807373046875 GB
    Memory Allocated: 2.1917781829833984  GigaBytes
Max Memory Allocated: 2.1917781829833984  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.3944091796875 GB
    Memory Allocated: 2.2040271759033203  GigaBytes
Max Memory Allocated: 2.204896926879883  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([418, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.4061279296875 GB
    Memory Allocated: 2.2140350341796875  GigaBytes
Max Memory Allocated: 2.21407413482666  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.4061279296875 GB
    Memory Allocated: 2.2140350341796875  GigaBytes
Max Memory Allocated: 2.21407413482666  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 3.4061279296875 GB
    Memory Allocated: 2.214832305908203  GigaBytes
Max Memory Allocated: 2.214832305908203  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.5682373046875 GB
    Memory Allocated: 2.3576908111572266  GigaBytes
Max Memory Allocated: 2.367656707763672  GigaBytes

rst.shape  torch.Size([1, 418, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.303478717803955  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.305518627166748  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.3072047233581543  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.3050804138183594  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

torch.Size([11315, 40])
input nodes number: 26043
output nodes number: 11315
edges number: 67119
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.307398796081543  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5916748046875 GB
    Memory Allocated: 2.3073997497558594  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.037990570068359375  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

pseudo mini batch 1 input nodes size: 65608
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.03310203552246094  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.03310203552246094  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.06438636779785156  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.06447029113769531  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.03896188735961914  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.04142045974731445  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.04142045974731445  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.04142045974731445  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

torch.Size([65608, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7225341796875 GB
    Memory Allocated: 0.04142045974731445  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

m.shape torch.Size([2774, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.16170024871826172  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.16170024871826172  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 2774, 128]), torch.Size([1, 2774, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.16434574127197266  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.18550968170166016  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 2774, 128])
m.shape torch.Size([2805, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.18686199188232422  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.18686199188232422  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 2805, 128]), torch.Size([1, 2805, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.18953704833984375  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.2305750846862793  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 2805, 128])
m.shape torch.Size([2343, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.23282480239868164  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.23282480239868164  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 2343, 128]), torch.Size([1, 2343, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.23511123657226562  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.285036563873291  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 2343, 128])
m.shape torch.Size([2057, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.2877211570739746  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.2877211570739746  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 2057, 128]), torch.Size([1, 2057, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.28992319107055664  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.3493204116821289  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 2057, 128])
m.shape torch.Size([1850, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.352750301361084  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.352750301361084  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.35451459884643555  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.41963624954223633  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1557, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.42320871353149414  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.42320871353149414  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1557, 128]), torch.Size([1, 1557, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.42469358444213867  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.4908719062805176  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1557, 128])
m.shape torch.Size([1445, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.4949526786804199  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.4949526786804199  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1445, 128]), torch.Size([1, 1445, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.49633073806762695  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.5652337074279785  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1445, 128])
m.shape torch.Size([1365, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.5697517395019531  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.5697517395019531  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1365, 128]), torch.Size([1, 1365, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.5710535049438477  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.6452693939208984  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1365, 128])
m.shape torch.Size([1238, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.6499314308166504  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.6499314308166504  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1238, 128]), torch.Size([1, 1238, 128])
----------------------------------------3
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.6511120796203613  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8436279296875 GB
    Memory Allocated: 0.7292208671569824  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1238, 128])
m.shape torch.Size([16819, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.8088297843933105  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.8088297843933105  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 16819, 128]), torch.Size([1, 16819, 128])
----------------------------------------3
 Nvidia-smi: 3.9256591796875 GB
    Memory Allocated: 0.8248696327209473  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.9645800590515137  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 16819, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.8556551933288574  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.8883213996887207  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.920987606048584  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.8880658149719238  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

torch.Size([34253, 256])
first layer input nodes number: 65608
first layer output nodes number: 34253
edges number: 242600
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.9214787483215332  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.9541449546813965  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.9623117446899414  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.7381591796875 GB
    Memory Allocated: 1.9623117446899414  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

m.shape torch.Size([1939, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.0493950843811035  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.0493950843811035  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1939, 256]), torch.Size([1, 1939, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.0535640716552734  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.083150863647461  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1939, 256])
m.shape torch.Size([1639, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.084524631500244  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.084524631500244  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1639, 256]), torch.Size([1, 1639, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.087869167327881  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.137744426727295  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1639, 256])
m.shape torch.Size([1139, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1395516395568848  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1395516395568848  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 1139, 256]), torch.Size([1, 1139, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1417922973632812  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.190521240234375  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 1139, 256])
m.shape torch.Size([853, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1929149627685547  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1929149627685547  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.1945419311523438  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.2433862686157227  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([745, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.2461533546447754  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.2461533546447754  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 745, 256]), torch.Size([1, 745, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.2475743293762207  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.2991490364074707  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 745, 256])
m.shape torch.Size([577, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3017663955688477  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3017663955688477  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3028669357299805  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.350468635559082  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([473, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3531007766723633  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3531007766723633  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3540029525756836  GigaBytes
Max Memory Allocated: 2.391561508178711  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.3995771408081055  GigaBytes
Max Memory Allocated: 2.4027347564697266  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([418, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.4023404121398926  GigaBytes
Max Memory Allocated: 2.4027347564697266  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.4023404121398926  GigaBytes
Max Memory Allocated: 2.4027347564697266  GigaBytes

 h.shape torch.Size([1, 418, 256]), torch.Size([1, 418, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.403137683868408  GigaBytes
Max Memory Allocated: 2.403137683868408  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.4494662284851074  GigaBytes
Max Memory Allocated: 2.453052043914795  GigaBytes

rst.shape  torch.Size([1, 418, 256])
m.shape torch.Size([329, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.4526758193969727  GigaBytes
Max Memory Allocated: 2.453052043914795  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.4526758193969727  GigaBytes
Max Memory Allocated: 2.453052043914795  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.453303337097168  GigaBytes
Max Memory Allocated: 2.453303337097168  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.495856285095215  GigaBytes
Max Memory Allocated: 2.4986801147460938  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([282, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.498253345489502  GigaBytes
Max Memory Allocated: 2.4986801147460938  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.498253345489502  GigaBytes
Max Memory Allocated: 2.4986801147460938  GigaBytes

 h.shape torch.Size([1, 282, 256]), torch.Size([1, 282, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.498791217803955  GigaBytes
Max Memory Allocated: 2.498791217803955  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5380115509033203  GigaBytes
Max Memory Allocated: 2.540700912475586  GigaBytes

rst.shape  torch.Size([1, 282, 256])
m.shape torch.Size([250, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5403857231140137  GigaBytes
Max Memory Allocated: 2.540700912475586  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5403857231140137  GigaBytes
Max Memory Allocated: 2.540700912475586  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.540862560272217  GigaBytes
Max Memory Allocated: 2.540862560272217  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5780558586120605  GigaBytes
Max Memory Allocated: 2.5806784629821777  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([204, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5801706314086914  GigaBytes
Max Memory Allocated: 2.5806784629821777  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.5801706314086914  GigaBytes
Max Memory Allocated: 2.5806784629821777  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.580559730529785  GigaBytes
Max Memory Allocated: 2.5806784629821777  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.613633155822754  GigaBytes
Max Memory Allocated: 2.6159677505493164  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([159, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6154255867004395  GigaBytes
Max Memory Allocated: 2.6159677505493164  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6154255867004395  GigaBytes
Max Memory Allocated: 2.6159677505493164  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6157288551330566  GigaBytes
Max Memory Allocated: 2.6159677505493164  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.643629550933838  GigaBytes
Max Memory Allocated: 2.6456007957458496  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([138, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6453351974487305  GigaBytes
Max Memory Allocated: 2.6456007957458496  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6453351974487305  GigaBytes
Max Memory Allocated: 2.6456007957458496  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.6455984115600586  GigaBytes
Max Memory Allocated: 2.6456007957458496  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.671656608581543  GigaBytes
Max Memory Allocated: 2.67349910736084  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([112, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.673140048980713  GigaBytes
Max Memory Allocated: 2.67349910736084  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.673140048980713  GigaBytes
Max Memory Allocated: 2.67349910736084  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.673353672027588  GigaBytes
Max Memory Allocated: 2.67349910736084  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.695997714996338  GigaBytes
Max Memory Allocated: 2.6975998878479004  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([112, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.69761323928833  GigaBytes
Max Memory Allocated: 2.697619915008545  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.69761323928833  GigaBytes
Max Memory Allocated: 2.697619915008545  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.697826862335205  GigaBytes
Max Memory Allocated: 2.697826862335205  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.72196626663208  GigaBytes
Max Memory Allocated: 2.72367525100708  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([108, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7236242294311523  GigaBytes
Max Memory Allocated: 2.72367525100708  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7236242294311523  GigaBytes
Max Memory Allocated: 2.72367525100708  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.723830223083496  GigaBytes
Max Memory Allocated: 2.723830223083496  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.748549461364746  GigaBytes
Max Memory Allocated: 2.750300407409668  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([103, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7502284049987793  GigaBytes
Max Memory Allocated: 2.750300407409668  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7502284049987793  GigaBytes
Max Memory Allocated: 2.750300407409668  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.750424861907959  GigaBytes
Max Memory Allocated: 2.750424861907959  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7753748893737793  GigaBytes
Max Memory Allocated: 2.777153491973877  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.777212619781494  GigaBytes
Max Memory Allocated: 2.7772202491760254  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.777212619781494  GigaBytes
Max Memory Allocated: 2.7772202491760254  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.7774147987365723  GigaBytes
Max Memory Allocated: 2.7774147987365723  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.804506778717041  GigaBytes
Max Memory Allocated: 2.806427478790283  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8062705993652344  GigaBytes
Max Memory Allocated: 2.806427478790283  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8062705993652344  GigaBytes
Max Memory Allocated: 2.806427478790283  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.806455612182617  GigaBytes
Max Memory Allocated: 2.806455612182617  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8325424194335938  GigaBytes
Max Memory Allocated: 2.834392547607422  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([67, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8342390060424805  GigaBytes
Max Memory Allocated: 2.834392547607422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8342390060424805  GigaBytes
Max Memory Allocated: 2.834392547607422  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.834366798400879  GigaBytes
Max Memory Allocated: 2.834392547607422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.8532800674438477  GigaBytes
Max Memory Allocated: 2.8546218872070312  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.854590892791748  GigaBytes
Max Memory Allocated: 2.8546218872070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.854590892791748  GigaBytes
Max Memory Allocated: 2.8546218872070312  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 4.8221435546875 GB
    Memory Allocated: 2.854714870452881  GigaBytes
Max Memory Allocated: 2.854714870452881  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8358154296875 GB
    Memory Allocated: 2.873931407928467  GigaBytes
Max Memory Allocated: 2.8752951622009277  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 2.8748202323913574  GigaBytes
Max Memory Allocated: 2.8752951622009277  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 2.8748202323913574  GigaBytes
Max Memory Allocated: 2.8752951622009277  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 2.8749022483825684  GigaBytes
Max Memory Allocated: 2.8752951622009277  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8494873046875 GB
    Memory Allocated: 2.8881888389587402  GigaBytes
Max Memory Allocated: 2.889132022857666  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.8494873046875 GB
    Memory Allocated: 2.889716625213623  GigaBytes
Max Memory Allocated: 2.8897228240966797  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8494873046875 GB
    Memory Allocated: 2.889716625213623  GigaBytes
Max Memory Allocated: 2.8897228240966797  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 4.8494873046875 GB
    Memory Allocated: 2.8898463249206543  GigaBytes
Max Memory Allocated: 2.8898463249206543  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.9117655754089355  GigaBytes
Max Memory Allocated: 2.9133219718933105  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([1193, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.940906524658203  GigaBytes
Max Memory Allocated: 2.9410181045532227  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.940906524658203  GigaBytes
Max Memory Allocated: 2.9410181045532227  GigaBytes

 h.shape torch.Size([1, 1193, 256]), torch.Size([1, 1193, 256])
----------------------------------------3
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 2.9431819915771484  GigaBytes
Max Memory Allocated: 2.9431819915771484  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.347784996032715  GigaBytes
Max Memory Allocated: 3.3762283325195312  GigaBytes

rst.shape  torch.Size([1, 1193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.272732734680176  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.2745819091796875  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.276857376098633  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.2749242782592773  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

torch.Size([11219, 40])
input nodes number: 34253
output nodes number: 11219
edges number: 87265
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.2750730514526367  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8709716796875 GB
    Memory Allocated: 3.275073528289795  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.045720577239990234  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

pseudo mini batch 2 input nodes size: 68125
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.03877115249633789  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.03877115249633789  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.07197427749633789  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.07205867767333984  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.04069042205810547  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.044614315032958984  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.044614315032958984  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.044614315032958984  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

torch.Size([68125, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.0428466796875 GB
    Memory Allocated: 0.044614315032958984  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

m.shape torch.Size([1870, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2120685577392578  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2120685577392578  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1870, 128]), torch.Size([1, 1870, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2138519287109375  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.228546142578125  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1870, 128])
m.shape torch.Size([1888, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.22945499420166016  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.22945499420166016  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1888, 128]), torch.Size([1, 1888, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.23125553131103516  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.25917911529541016  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1888, 128])
m.shape torch.Size([1793, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2610292434692383  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2610292434692383  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1793, 128]), torch.Size([1, 1793, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.2627391815185547  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.3003578186035156  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1793, 128])
m.shape torch.Size([1688, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.3027224540710449  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.3027224540710449  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1688, 128]), torch.Size([1, 1688, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.30433225631713867  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.3510165214538574  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1688, 128])
m.shape torch.Size([1633, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.35410499572753906  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.35410499572753906  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1633, 128]), torch.Size([1, 1633, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.35566234588623047  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.41182994842529297  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1633, 128])
m.shape torch.Size([1515, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.41538572311401367  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.41538572311401367  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1515, 128]), torch.Size([1, 1515, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.41683053970336914  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.4789576530456543  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1515, 128])
m.shape torch.Size([1454, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.48308849334716797  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.48308849334716797  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1454, 128]), torch.Size([1, 1454, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.48447513580322266  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.553807258605957  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1454, 128])
m.shape torch.Size([1359, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.5582981109619141  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.5582981109619141  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1359, 128]), torch.Size([1, 1359, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.5595941543579102  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.6341495513916016  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1359, 128])
m.shape torch.Size([1337, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.6392393112182617  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.6392393112182617  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1337, 128]), torch.Size([1, 1337, 128])
----------------------------------------3
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.6405143737792969  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.2069091796875 GB
    Memory Allocated: 0.72320556640625  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1337, 128])
m.shape torch.Size([27007, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 0.8514742851257324  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 0.8514742851257324  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 27007, 128]), torch.Size([1, 27007, 128])
----------------------------------------3
 Nvidia-smi: 5.3358154296875 GB
    Memory Allocated: 0.877230167388916  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.706088066101074  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 27007, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.5501298904418945  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.589749336242676  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.629368782043457  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.5894393920898438  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

torch.Size([41544, 256])
first layer input nodes number: 68125
first layer output nodes number: 41544
edges number: 338185
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.629878520965576  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.6694979667663574  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.6795458793640137  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.4666748046875 GB
    Memory Allocated: 2.6795458793640137  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

m.shape torch.Size([1202, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.813054084777832  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.813054084777832  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8154077529907227  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8340539932250977  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([983, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.834791660308838  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.834791660308838  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8366665840148926  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.864790439605713  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 983, 256])
m.shape torch.Size([793, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8662586212158203  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8662586212158203  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 793, 256]), torch.Size([1, 793, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.8677711486816406  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9035964012145996  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 793, 256])
m.shape torch.Size([661, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9057345390319824  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9057345390319824  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 661, 256]), torch.Size([1, 661, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9069952964782715  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9462246894836426  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 661, 256])
m.shape torch.Size([577, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9483675956726074  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9483675956726074  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.9494681358337402  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.989241600036621  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([454, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.991309642791748  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.991309642791748  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 2.992175579071045  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.031043529510498  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([382, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.0331807136535645  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.0331807136535645  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.033909320831299  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.072547435760498  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([313, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.0745902061462402  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.0745902061462402  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.0751872062683105  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.109952449798584  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([325, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.1124653816223145  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.1124653816223145  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 325, 256]), torch.Size([1, 325, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.1130852699279785  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.1535964012145996  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 325, 256])
m.shape torch.Size([311, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.156275749206543  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.156275749206543  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 311, 256]), torch.Size([1, 311, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.1568689346313477  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.20003604888916  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 311, 256])
m.shape torch.Size([269, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2025837898254395  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2025837898254395  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.203096866607666  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2434115409851074  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([266, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.246222972869873  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.246222972869873  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.246730327606201  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.290210247039795  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([227, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2927932739257812  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2927932739257812  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 227, 256]), torch.Size([1, 227, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.2932262420654297  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.333059310913086  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 227, 256])
m.shape torch.Size([202, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.3355612754821777  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.3355612754821777  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.335946559906006  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.3740897178649902  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([183, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.376535415649414  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.376535415649414  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.3768844604492188  GigaBytes
Max Memory Allocated: 3.3787899017333984  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4138832092285156  GigaBytes
Max Memory Allocated: 3.416501045227051  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([184, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4165382385253906  GigaBytes
Max Memory Allocated: 3.4165492057800293  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4165382385253906  GigaBytes
Max Memory Allocated: 3.4165492057800293  GigaBytes

 h.shape torch.Size([1, 184, 256]), torch.Size([1, 184, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.416889190673828  GigaBytes
Max Memory Allocated: 3.416889190673828  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4565467834472656  GigaBytes
Max Memory Allocated: 3.4593544006347656  GigaBytes

rst.shape  torch.Size([1, 184, 256])
m.shape torch.Size([163, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4590349197387695  GigaBytes
Max Memory Allocated: 3.4593544006347656  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4590349197387695  GigaBytes
Max Memory Allocated: 3.4593544006347656  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.459345817565918  GigaBytes
Max Memory Allocated: 3.4593544006347656  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4966535568237305  GigaBytes
Max Memory Allocated: 3.499296188354492  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([167, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.499387264251709  GigaBytes
Max Memory Allocated: 3.499398708343506  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.499387264251709  GigaBytes
Max Memory Allocated: 3.499398708343506  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.4997057914733887  GigaBytes
Max Memory Allocated: 3.4997057914733887  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.540158748626709  GigaBytes
Max Memory Allocated: 3.543025493621826  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([144, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.5426292419433594  GigaBytes
Max Memory Allocated: 3.543025493621826  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.5426292419433594  GigaBytes
Max Memory Allocated: 3.543025493621826  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.5429039001464844  GigaBytes
Max Memory Allocated: 3.543025493621826  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.5797080993652344  GigaBytes
Max Memory Allocated: 3.582998275756836  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([147, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.582882881164551  GigaBytes
Max Memory Allocated: 3.582998275756836  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.582882881164551  GigaBytes
Max Memory Allocated: 3.582998275756836  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 6.5975341796875 GB
    Memory Allocated: 3.583163261413574  GigaBytes
Max Memory Allocated: 3.583163261413574  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6014404296875 GB
    Memory Allocated: 3.622696876525879  GigaBytes
Max Memory Allocated: 3.6255006790161133  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([142, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.6014404296875 GB
    Memory Allocated: 3.625422954559326  GigaBytes
Max Memory Allocated: 3.6255006790161133  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6014404296875 GB
    Memory Allocated: 3.625422954559326  GigaBytes
Max Memory Allocated: 3.6255006790161133  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 6.6014404296875 GB
    Memory Allocated: 3.6256937980651855  GigaBytes
Max Memory Allocated: 3.6256937980651855  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6424560546875 GB
    Memory Allocated: 3.665778636932373  GigaBytes
Max Memory Allocated: 3.6686224937438965  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.6424560546875 GB
    Memory Allocated: 3.668170928955078  GigaBytes
Max Memory Allocated: 3.6686224937438965  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6424560546875 GB
    Memory Allocated: 3.668170928955078  GigaBytes
Max Memory Allocated: 3.6686224937438965  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 6.6424560546875 GB
    Memory Allocated: 3.6683616638183594  GigaBytes
Max Memory Allocated: 3.6686224937438965  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6717529296875 GB
    Memory Allocated: 3.697925567626953  GigaBytes
Max Memory Allocated: 3.700023651123047  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([115, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.6717529296875 GB
    Memory Allocated: 3.7003726959228516  GigaBytes
Max Memory Allocated: 3.700382709503174  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.6717529296875 GB
    Memory Allocated: 3.7003726959228516  GigaBytes
Max Memory Allocated: 3.700382709503174  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 6.6717529296875 GB
    Memory Allocated: 3.700592041015625  GigaBytes
Max Memory Allocated: 3.700592041015625  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7088623046875 GB
    Memory Allocated: 3.736125946044922  GigaBytes
Max Memory Allocated: 3.7386484146118164  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7088623046875 GB
    Memory Allocated: 3.7383460998535156  GigaBytes
Max Memory Allocated: 3.7386484146118164  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7088623046875 GB
    Memory Allocated: 3.7383460998535156  GigaBytes
Max Memory Allocated: 3.7386484146118164  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 6.7088623046875 GB
    Memory Allocated: 3.7385387420654297  GigaBytes
Max Memory Allocated: 3.7386484146118164  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7420654296875 GB
    Memory Allocated: 3.7710952758789062  GigaBytes
Max Memory Allocated: 3.773406982421875  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([2906, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.7420654296875 GB
    Memory Allocated: 3.840825080871582  GigaBytes
Max Memory Allocated: 3.8410959243774414  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7420654296875 GB
    Memory Allocated: 3.840825080871582  GigaBytes
Max Memory Allocated: 3.8410959243774414  GigaBytes

 h.shape torch.Size([1, 2906, 256]), torch.Size([1, 2906, 256])
----------------------------------------3
 Nvidia-smi: 6.7420654296875 GB
    Memory Allocated: 3.846367835998535  GigaBytes
Max Memory Allocated: 3.846367835998535  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.825019836425781  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2906, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.7022223472595215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.704623699188232  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.706310272216797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.703824520111084  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11317, 40])
input nodes number: 41544
output nodes number: 11317
edges number: 136986
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.704056262969971  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.8123779296875 GB
    Memory Allocated: 4.704056739807129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.05095672607421875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 3 input nodes size: 84611
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.0405278205871582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.0405278205871582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.08087348937988281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.08095598220825195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.04766845703125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.05121421813964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.05121421813964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.05121421813964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([84611, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.9471435546875 GB
    Memory Allocated: 0.05121421813964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2410, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.23348283767700195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.23348283767700195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2410, 128]), torch.Size([1, 2410, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.23578119277954102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.25435400009155273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2410, 128])
m.shape torch.Size([2677, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.25575780868530273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.25575780868530273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2677, 128]), torch.Size([1, 2677, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.2584104537963867  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.29809045791625977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2677, 128])
m.shape torch.Size([2425, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.3006434440612793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.3006434440612793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2425, 128]), torch.Size([1, 2425, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.30295610427856445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.3562803268432617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2425, 128])
m.shape torch.Size([2165, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.35974931716918945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.35974931716918945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2165, 128]), torch.Size([1, 2165, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.36199045181274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.42245054244995117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2165, 128])
m.shape torch.Size([2074, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.4262232780456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.4262232780456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2074, 128]), torch.Size([1, 2074, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.42838430404663086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5026311874389648  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2074, 128])
m.shape torch.Size([1909, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5071039199829102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5071039199829102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1909, 128]), torch.Size([1, 1909, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5089244842529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5874414443969727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1909, 128])
m.shape torch.Size([1807, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5925626754760742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5925626754760742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1807, 128]), torch.Size([1, 1807, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.5942859649658203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.680450439453125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1807, 128])
m.shape torch.Size([1709, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.6861081123352051  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.6861081123352051  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1709, 128]), torch.Size([1, 1709, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.6877379417419434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.7806382179260254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1709, 128])
m.shape torch.Size([1592, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.7866554260253906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.7866554260253906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1592, 128]), torch.Size([1, 1592, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.7881736755371094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 0.8864841461181641  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1592, 128])
m.shape torch.Size([28196, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 1.0201740264892578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 1.0201740264892578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 28196, 128]), torch.Size([1, 28196, 128])
----------------------------------------3
 Nvidia-smi: 7.1229248046875 GB
    Memory Allocated: 1.0470771789550781  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.96533203125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 28196, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.7977356910705566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.8425240516662598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.887312412261963  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.8421740531921387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([46964, 256])
first layer input nodes number: 84611
first layer output nodes number: 46964
edges number: 368132
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.8879451751708984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.9327335357666016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.9439306259155273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 2.9439306259155273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1524, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.0495715141296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.0495715141296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1524, 256]), torch.Size([1, 1524, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.053248882293701  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.079038143157959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1524, 256])
m.shape torch.Size([1372, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.079427719116211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.079427719116211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1372, 256]), torch.Size([1, 1372, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.082052230834961  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.1268043518066406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1372, 256])
m.shape torch.Size([999, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.12839937210083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.12839937210083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 999, 256]), torch.Size([1, 999, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.1303048133850098  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.172224521636963  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 999, 256])
m.shape torch.Size([739, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.174382209777832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.174382209777832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 739, 256]), torch.Size([1, 739, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.1757917404174805  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.217564582824707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 739, 256])
m.shape torch.Size([669, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2200751304626465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2200751304626465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 669, 256]), torch.Size([1, 669, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.221351146697998  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2688279151916504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 669, 256])
m.shape torch.Size([512, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2711424827575684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2711424827575684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 512, 256]), torch.Size([1, 512, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.2721190452575684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3180766105651855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 512, 256])
m.shape torch.Size([410, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3203468322753906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3203468322753906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 410, 256]), torch.Size([1, 410, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3211288452148438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.361574172973633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 410, 256])
m.shape torch.Size([346, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3638439178466797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.3638439178466797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 346, 256]), torch.Size([1, 346, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.364503860473633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.402554512023926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 346, 256])
m.shape torch.Size([318, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.404975414276123  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.404975414276123  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4055819511413574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4451370239257812  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([255, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.447284698486328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.447284698486328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4477710723876953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4823036193847656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([235, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4845452308654785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4845452308654785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 235, 256]), torch.Size([1, 235, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.4849934577941895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5199551582336426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 235, 256])
m.shape torch.Size([226, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5223379135131836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5223379135131836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 226, 256]), torch.Size([1, 226, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.522768974304199  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5594091415405273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 226, 256])
m.shape torch.Size([191, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.561580181121826  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.561580181121826  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5619444847106934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5954604148864746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([150, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.597296714782715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.597296714782715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.5975828170776367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6259069442749023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([176, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6283016204833984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6283016204833984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6286373138427734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6642208099365234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.66611385345459  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.66611385345459  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6663694381713867  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6952505111694336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([126, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6971817016601562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6971817016601562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.6974220275878906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.7262611389160156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([144, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.7286324501037598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.7286324501037598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.7289071083068848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.7637887001037598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([128, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.765988826751709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.765988826751709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.766232967376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.798947811126709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([107, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8008828163146973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8008828163146973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.801086902618408  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8298630714416504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([120, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.832183361053467  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.832183361053467  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8324122428894043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8662867546081543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8680877685546875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8680877685546875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.868246078491211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.8927841186523438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.894340991973877  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.894340991973877  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.894482135772705  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9173474311828613  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([86, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9192609786987305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9192609786987305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9194250106811523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.947146415710449  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([1911, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9929823875427246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9929823875427246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1911, 256]), torch.Size([1, 1911, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 3.9966273307800293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.638137340545654  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1911, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.543676853179932  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.545364856719971  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.5479512214660645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.546180725097656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11035, 40])
input nodes number: 46964
output nodes number: 11035
edges number: 107545
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.546614646911621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 4.546615123748779  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05811309814453125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 4 input nodes size: 38244
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04766988754272461  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04766988754272461  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.06590604782104492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.06599283218383789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02556467056274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02702951431274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02702951431274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02702951431274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([38244, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02702951431274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2710, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0881357192993164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0881357192993164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2710, 128]), torch.Size([1, 2710, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09072017669677734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11148452758789062  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2710, 128])
m.shape torch.Size([2848, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11290836334228516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11290836334228516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2848, 128]), torch.Size([1, 2848, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11562442779541016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15705204010009766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2848, 128])
m.shape torch.Size([2352, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15909671783447266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15909671783447266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2352, 128]), torch.Size([1, 2352, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.16147804260253906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21133136749267578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2352, 128])
m.shape torch.Size([2009, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21469593048095703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21469593048095703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2009, 128]), torch.Size([1, 2009, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2166118621826172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2727689743041992  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2009, 128])
m.shape torch.Size([1649, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2759404182434082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2759404182434082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1649, 128]), torch.Size([1, 1649, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2775130271911621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.33412694931030273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1649, 128])
m.shape torch.Size([1334, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3371572494506836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3371572494506836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1334, 128]), torch.Size([1, 1334, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.33842945098876953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39535045623779297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1334, 128])
m.shape torch.Size([1167, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39860963821411133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39860963821411133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1167, 128]), torch.Size([1, 1167, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3997225761413574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45560407638549805  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1167, 128])
m.shape torch.Size([1009, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45954322814941406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45954322814941406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1009, 128]), torch.Size([1, 1009, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.46050548553466797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5160408020019531  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1009, 128])
m.shape torch.Size([852, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5192160606384277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5192160606384277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 852, 128]), torch.Size([1, 852, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5200285911560059  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5729436874389648  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 852, 128])
m.shape torch.Size([5816, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6002702713012695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6002702713012695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 5816, 128]), torch.Size([1, 5816, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6058168411254883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0003328323364258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 5816, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9494309425354004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9701695442199707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.990908145904541  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9700074195861816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([21746, 256])
first layer input nodes number: 38244
first layer output nodes number: 21746
edges number: 121816
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9911952018737793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0119338035583496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0175986289978027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0175986289978027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1942, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0924830436706543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0924830436706543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1942, 256]), torch.Size([1, 1942, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0961871147155762  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1258196830749512  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1942, 256])
m.shape torch.Size([1725, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1272835731506348  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1272835731506348  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1725, 256]), torch.Size([1, 1725, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.130800724029541  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1814236640930176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1725, 256])
m.shape torch.Size([1341, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1834325790405273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1834325790405273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1341, 256]), torch.Size([1, 1341, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1860828399658203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2447843551635742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1341, 256])
m.shape torch.Size([1078, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2473745346069336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2473745346069336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1078, 256]), torch.Size([1, 1078, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.249434471130371  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3117237091064453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1078, 256])
m.shape torch.Size([898, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3150115013122559  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3150115013122559  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 898, 256]), torch.Size([1, 898, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3167243003845215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3790717124938965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 898, 256])
m.shape torch.Size([690, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3821945190429688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3821945190429688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 690, 256]), torch.Size([1, 690, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3835105895996094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4449348449707031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 690, 256])
m.shape torch.Size([572, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4481253623962402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4481253623962402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 572, 256]), torch.Size([1, 572, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.449216365814209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5048880577087402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 572, 256])
m.shape torch.Size([493, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5081334114074707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5081334114074707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 493, 256]), torch.Size([1, 493, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5090737342834473  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5640501976013184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 493, 256])
m.shape torch.Size([381, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.56687593460083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.56687593460083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5676026344299316  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6149449348449707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([317, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.617628574371338  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.617628574371338  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 317, 256]), torch.Size([1, 317, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6182332038879395  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.661388874053955  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 317, 256])
m.shape torch.Size([251, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.663740634918213  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.663740634918213  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6642193794250488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.701561450958252  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([230, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7039752006530762  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7039752006530762  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.704413890838623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7417025566101074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([174, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7436738014221191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7436738014221191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7440056800842285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.774538516998291  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.776754379272461  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.776754379272461  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7770919799804688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8105144500732422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([154, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8125662803649902  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8125662803649902  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8128600120544434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8439955711364746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8456635475158691  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8456635475158691  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.845888614654541  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.871321201324463  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.872891902923584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.872891902923584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8730883598327637  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8966631889343262  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([100, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8982954025268555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8982954025268555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8984861373901367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9227094650268555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9239473342895508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9239473342895508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.924086570739746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.942744255065918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9437270164489746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9437270164489746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9438300132751465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9583525657653809  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([66, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9596333503723145  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9596333503723145  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.95975923538208  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9783902168273926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9795536994934082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9795536994934082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9796643257141113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9968113899230957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9981045722961426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9981045722961426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9982209205627441  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0170693397521973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0180349349975586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0180349349975586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0181188583374023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.032301902770996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([485, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0439138412475586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0439138412475586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0448389053344727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2090959548950195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 485, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1480703353881836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1499223709106445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.151648998260498  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.149710178375244  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11585, 40])
input nodes number: 21746
output nodes number: 11585
edges number: 74627
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.150123119354248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1501235961914062  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030117034912109375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 5 input nodes size: 39945
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025728702545166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025728702545166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.045259952545166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04534721374511719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.027024269104003906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028730392456054688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028730392456054688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028730392456054688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([39945, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028730392456054688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2266, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09821605682373047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09821605682373047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2266, 128]), torch.Size([1, 2266, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10093355178833008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11954736709594727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2266, 128])
m.shape torch.Size([2379, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12073564529418945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12073564529418945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2379, 128]), torch.Size([1, 2379, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12300443649291992  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15841436386108398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2379, 128])
m.shape torch.Size([2219, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1599874496459961  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1599874496459961  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2219, 128]), torch.Size([1, 2219, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.16264677047729492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2120680809020996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2219, 128])
m.shape torch.Size([1876, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2152423858642578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2152423858642578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1876, 128]), torch.Size([1, 1876, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21703147888183594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.26891517639160156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1876, 128])
m.shape torch.Size([1680, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27202606201171875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27202606201171875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1680, 128]), torch.Size([1, 1680, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27362823486328125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.33130645751953125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1680, 128])
m.shape torch.Size([1366, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3344135284423828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3344135284423828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.33571624755859375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39233970642089844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1211, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39573049545288086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39573049545288086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1211, 128]), torch.Size([1, 1211, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39688539505004883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45520639419555664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1211, 128])
m.shape torch.Size([1099, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45882129669189453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45882129669189453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1099, 128]), torch.Size([1, 1099, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.459869384765625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5225629806518555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1099, 128])
m.shape torch.Size([959, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5261545181274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5261545181274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.527069091796875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.58599853515625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([7581, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6216902732849121  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6216902732849121  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 7581, 128]), torch.Size([1, 7581, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6289200782775879  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1422362327575684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 7581, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0816597938537598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1032471656799316  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1248345375061035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1030783653259277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([22636, 256])
first layer input nodes number: 39945
first layer output nodes number: 22636
edges number: 139491
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1251344680786133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1467218399047852  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1524782180786133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1524782180786133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1616, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2406134605407715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2406134605407715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1616, 256]), torch.Size([1, 1616, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2442493438720703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2694735527038574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1616, 256])
m.shape torch.Size([1494, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2708191871643066  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2708191871643066  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1494, 256]), torch.Size([1, 1494, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2737326622009277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3173842430114746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1494, 256])
m.shape torch.Size([1229, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3194713592529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3194713592529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3219828605651855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.379227638244629  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
m.shape torch.Size([1006, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.381638526916504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.381638526916504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1006, 256]), torch.Size([1, 1006, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3835573196411133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4398889541625977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1006, 256])
m.shape torch.Size([856, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4430432319641113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4430432319641113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 856, 256]), torch.Size([1, 856, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4446759223937988  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5034527778625488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 856, 256])
m.shape torch.Size([653, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5064024925231934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5064024925231934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 653, 256]), torch.Size([1, 653, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.50764799118042  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5631279945373535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 653, 256])
m.shape torch.Size([599, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.566535472869873  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.566535472869873  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 599, 256]), torch.Size([1, 599, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5676779747009277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.625089168548584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 599, 256])
m.shape torch.Size([503, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6283855438232422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6283855438232422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6293449401855469  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6852359771728516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([448, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.688631534576416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.688631534576416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 448, 256]), torch.Size([1, 448, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.689486026763916  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.745638370513916  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 448, 256])
m.shape torch.Size([399, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7490463256835938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7490463256835938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.749807357788086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8044748306274414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([302, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8072872161865234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8072872161865234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 302, 256]), torch.Size([1, 302, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8078632354736328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.85636568069458  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 302, 256])
m.shape torch.Size([256, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8590302467346191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8590302467346191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8595185279846191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9010224342346191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([247, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.903864860534668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.903864860534668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9043359756469727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.947678565979004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([203, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9501748085021973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9501748085021973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9505620002746582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.988893985748291  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([201, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9915986061096191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9915986061096191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9919819831848145  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0326199531555176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([153, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0347814559936523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0347814559936523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0350732803344727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.068049430847168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([140, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0701913833618164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0701913833618164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.07045841217041  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.10250186920166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([112, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.104306221008301  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.104306221008301  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.104519844055176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.131649971008301  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1334972381591797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1334972381591797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1337013244628906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1610488891601562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.163381576538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.163381576538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1636009216308594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.194528579711914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1960558891296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1960558891296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.196197032928467  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2170863151550293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.218686580657959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.218686580657959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.218837261199951  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2421927452087402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.243267059326172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.243267059326172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.243366241455078  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2594337463378906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2605838775634766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2605838775634766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.260683059692383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.277444839477539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([810, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2970776557922363  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2970776557922363  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 810, 256]), torch.Size([1, 810, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2986226081848145  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5712990760803223  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 810, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4959020614624023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.49820613861084  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.499950885772705  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4975595474243164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11706, 40])
input nodes number: 22636
output nodes number: 11706
edges number: 89377
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.498267650604248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4982681274414062  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03249073028564453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 6 input nodes size: 33800
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02747631072998047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02747631072998047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.043593406677246094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04367971420288086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.024061203002929688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02565288543701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02565288543701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02565288543701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([33800, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.02565288543701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2375, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08854246139526367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08854246139526367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2375, 128]), torch.Size([1, 2375, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09082412719726562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10933780670166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2375, 128])
m.shape torch.Size([2307, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11047029495239258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11047029495239258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2307, 128]), torch.Size([1, 2307, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1126704216003418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1472029685974121  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2307, 128])
m.shape torch.Size([2114, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14940309524536133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14940309524536133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2114, 128]), torch.Size([1, 2114, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15143632888793945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19693517684936523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2114, 128])
m.shape torch.Size([1727, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19922113418579102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19922113418579102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1727, 128]), torch.Size([1, 1727, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2008681297302246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.24863100051879883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1727, 128])
m.shape torch.Size([1538, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.25147438049316406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.25147438049316406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1538, 128]), torch.Size([1, 1538, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2529411315917969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3076591491699219  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1538, 128])
m.shape torch.Size([1257, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31081676483154297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31081676483154297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1257, 128]), torch.Size([1, 1257, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3120155334472656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3637046813964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1257, 128])
m.shape torch.Size([1062, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3666501045227051  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3666501045227051  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3676629066467285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.41913938522338867  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([959, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42229127883911133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42229127883911133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 959, 128]), torch.Size([1, 959, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4232058525085449  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.47534608840942383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 959, 128])
m.shape torch.Size([764, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4781675338745117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4781675338745117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 764, 128]), torch.Size([1, 764, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4788961410522461  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5264692306518555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 764, 128])
m.shape torch.Size([6844, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5593080520629883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5593080520629883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 6844, 128]), torch.Size([1, 6844, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5658349990844727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0292482376098633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 6844, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9750409126281738  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9950175285339355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0149941444396973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9948611259460449  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([20947, 256])
first layer input nodes number: 33800
first layer output nodes number: 20947
edges number: 125893
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0152482986450195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0352249145507812  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0406389236450195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0406389236450195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1775, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.127901554107666  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.127901554107666  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.132993221282959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1624302864074707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1486, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1639738082885742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1639738082885742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1486, 256]), torch.Size([1, 1486, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.166865348815918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.214991569519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1486, 256])
m.shape torch.Size([1282, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.217271327972412  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.217271327972412  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1282, 256]), torch.Size([1, 1282, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2197508811950684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2754707336425781  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1282, 256])
m.shape torch.Size([969, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2779736518859863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2779736518859863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 969, 256]), torch.Size([1, 969, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2798218727111816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3334202766418457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 969, 256])
m.shape torch.Size([817, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3372721672058105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3372721672058105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3388304710388184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.396726131439209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([647, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3996782302856445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3996782302856445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 647, 256]), torch.Size([1, 647, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4009122848510742  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4539766311645508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 647, 256])
m.shape torch.Size([535, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4569592475891113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4569592475891113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.457979679107666  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5092148780822754  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([459, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5122342109680176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5122342109680176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5131096839904785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5632824897766113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([386, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5661840438842773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5661840438842773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 386, 256]), torch.Size([1, 386, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.566920280456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6147937774658203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 386, 256])
m.shape torch.Size([339, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6176838874816895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6176838874816895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.618330478668213  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6648335456848145  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([297, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6685481071472168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6685481071472168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.669114589691162  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7137818336486816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([251, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7163939476013184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7163939476013184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 251, 256]), torch.Size([1, 251, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7168726921081543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.757565975189209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 251, 256])
m.shape torch.Size([205, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7598881721496582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7598881721496582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7602791786193848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7962517738342285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([202, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7988653182983398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7988653182983398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.799250602722168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8373937606811523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([182, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.83982515335083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.83982515335083  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.840172290802002  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8769688606262207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8789639472961426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8789639472961426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8792328834533691  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9096226692199707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([140, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.911776065826416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.911776065826416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9120430946350098  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9440865516662598  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([105, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9457697868347168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9457697868347168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.945970058441162  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9714045524597168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9730210304260254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9730210304260254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9732003211975098  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.997225284576416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.999173641204834  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.999173641204834  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.999375820159912  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0278830528259277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([98, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0297603607177734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0297603607177734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.029947280883789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0576114654541016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0587234497070312  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0587234497070312  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0588321685791016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.07568359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.077000141143799  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.077000141143799  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.077118396759033  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.096275806427002  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.097670078277588  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.097670078277588  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.097790241241455  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1180977821350098  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([869, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.138918399810791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.138918399810791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 869, 256]), torch.Size([1, 869, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.140575885772705  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.43229341506958  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 869, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3575329780578613  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3593297004699707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.361053466796875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.359170436859131  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11567, 40])
input nodes number: 20947
output nodes number: 11567
edges number: 87626
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.358905792236328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3589062690734863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028241634368896484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 7 input nodes size: 35109
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.023553848266601562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.023553848266601562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04029512405395508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.040378570556640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.024175167083740234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025835514068603516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025835514068603516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025835514068603516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([35109, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.025835514068603516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1692, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08982467651367188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08982467651367188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1692, 128]), torch.Size([1, 1692, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09143829345703125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10434722900390625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1692, 128])
m.shape torch.Size([1933, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10557746887207031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10557746887207031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1933, 128]), torch.Size([1, 1933, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1074209213256836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13638877868652344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1933, 128])
m.shape torch.Size([1732, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13844919204711914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13844919204711914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1732, 128]), torch.Size([1, 1732, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14010095596313477  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17643976211547852  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1732, 128])
m.shape torch.Size([1625, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17871332168579102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17871332168579102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1625, 128]), torch.Size([1, 1625, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.18026304244995117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.22546052932739258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1625, 128])
m.shape torch.Size([1330, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.22785663604736328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.22785663604736328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1330, 128]), torch.Size([1, 1330, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2291250228881836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2756776809692383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1330, 128])
m.shape torch.Size([1258, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2786426544189453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2786426544189453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1258, 128]), torch.Size([1, 1258, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2798423767089844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3314533233642578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1258, 128])
m.shape torch.Size([1075, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3344416618347168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3344416618347168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1075, 128]), torch.Size([1, 1075, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3354668617248535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3873720169067383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1075, 128])
m.shape torch.Size([1003, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3906855583190918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3906855583190918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1003, 128]), torch.Size([1, 1003, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.39164209365844727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4471259117126465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1003, 128])
m.shape torch.Size([817, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45015382766723633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45015382766723633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 817, 128]), torch.Size([1, 817, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.45093297958374023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5011610984802246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 817, 128])
m.shape torch.Size([7456, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5363245010375977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5363245010375977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 7456, 128]), torch.Size([1, 7456, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5434350967407227  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0482873916625977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 7456, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.992915153503418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.012446403503418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.031977653503418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0122976303100586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([19921, 256])
first layer input nodes number: 35109
first layer output nodes number: 19921
edges number: 128914
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0322413444519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0517725944519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0570826530456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0570826530456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1291, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1488633155822754  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1488633155822754  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1291, 256]), torch.Size([1, 1291, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1515393257141113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1730847358703613  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1291, 256])
m.shape torch.Size([1286, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1746220588684082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1746220588684082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1286, 256]), torch.Size([1, 1286, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1770787239074707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2172436714172363  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1286, 256])
m.shape torch.Size([1095, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2191777229309082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2191777229309082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1095, 256]), torch.Size([1, 1095, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2219886779785156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2749285697937012  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1095, 256])
m.shape torch.Size([920, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2767109870910645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2767109870910645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 920, 256]), torch.Size([1, 920, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.278465747833252  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3300023078918457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 920, 256])
m.shape torch.Size([744, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3327007293701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3327007293701172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 744, 256]), torch.Size([1, 744, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3341197967529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3852062225341797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 744, 256])
m.shape torch.Size([704, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3885564804077148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3885564804077148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3898992538452148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4492406845092773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([563, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.452357292175293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.452357292175293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 563, 256]), torch.Size([1, 563, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4534311294555664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5076799392700195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 563, 256])
m.shape torch.Size([503, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5116705894470215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5116705894470215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5126299858093262  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.568131923675537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([436, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5714240074157715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5714240074157715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5722556114196777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6267971992492676  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([388, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.630110740661621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.630110740661621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 388, 256]), torch.Size([1, 388, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6308507919311523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6836843490600586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 388, 256])
m.shape torch.Size([366, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6871838569641113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6871838569641113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6878819465637207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.742424488067627  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([297, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7455010414123535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7455010414123535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 297, 256]), torch.Size([1, 297, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7460675239562988  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.79508638381958  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 297, 256])
m.shape torch.Size([273, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7982144355773926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7982144355773926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 273, 256]), torch.Size([1, 273, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7987351417541504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8476767539978027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 273, 256])
m.shape torch.Size([218, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8503499031066895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8503499031066895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8507657051086426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.891930103302002  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([165, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8941011428833008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8941011428833008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8944158554077148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9277753829956055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([171, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9302477836608887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9302477836608887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9305739402770996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9674296379089355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([170, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9700446128845215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9700446128845215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9703688621520996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0092787742614746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0115909576416016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0115909576416016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0118637084960938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0465030670166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([125, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0486631393432617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0486631393432617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0489015579223633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0808496475219727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([126, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0831527709960938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0831527709960938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.083393096923828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.117279052734375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([112, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.119419574737549  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.119419574737549  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.119633197784424  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.151249408721924  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([81, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.152855396270752  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.152855396270752  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1530098915100098  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1769566535949707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.17862606048584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.17862606048584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.178776741027832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2031869888305664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([73, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2047958374023438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2047958374023438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.204935073852539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.228466033935547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([868, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.249253273010254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.249253273010254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 868, 256]), torch.Size([1, 868, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.250908851623535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.543328285217285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 868, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.46217679977417  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4639315605163574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.46614408493042  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.464305877685547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11197, 40])
input nodes number: 19921
output nodes number: 11197
edges number: 93705
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.46449613571167  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.464496612548828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028986454010009766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03453683853149414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03453683853149414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019007593393325806 |0.04297846555709839 |0.18883872032165527 |0.00010856986045837402 |0.0793662965297699 |0.005810976028442383 |
----------------------------------------------------------pseudo_mini_loss sum 5.334288597106934
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  652814
Number of first layer input nodes during this epoch:  418760
Number of first layer output nodes during this epoch:  234054
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03453636169433594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.019984722137451172
global_2_local spend time (sec) 0.042975425720214844
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent [05:08:09] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27802158 edges into 8 parts and get 4518173 edge cuts
 0.004289388656616211
A = g.adjacency_matrix() spent  0.009151458740234375
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08157610893249512
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.40486741065979
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1837031841278076

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18720996, 2.0: 3229533, 3.0: 807748, 4.0: 243722, 5.0: 89337, 6.0: 38108, 7.0: 18016, 8.0: 9112, 9.0: 4890, 10.0: 2746, 11.0: 1644, 12.0: 893, 13.0: 552, 14.0: 337, 15.0: 196, 16.0: 180, 17.0: 140, 18.0: 67, 19.0: 54, 20.0: 11, 21.0: 10})
Convert a graph into a bidirected graph: 1.127 seconds
Metis partitioning: 5.091 seconds
Split the graph: 1.425 seconds
Construct subgraphs: 0.043 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  7.69907283782959
11477
11454
11604
11645
11295
11104
11035
11327
total k batches seeds list generation spend  20.6125807762146
after graph partition
graph partition algorithm spend time 20.7163667678833
11477
11454
11604
11645
11295
11104
11035
11327
partition_len_list
[19666, 21436, 21577, 24276, 27604, 34809, 47245, 41172]
shared_neighbor_graph_partition_s0 selection method  spend 20.811841011047363
time for parepare:  0.01656627655029297
local_output_nid generation:  0.002123117446899414
local_in_edges_tensor generation:  0.0022873878479003906
mini_batch_src_global generation:  0.0030803680419921875
r_  generation:  0.03022933006286621
local_output_nid generation:  0.0028820037841796875
local_in_edges_tensor generation:  0.0024671554565429688
mini_batch_src_global generation:  0.0035622119903564453
r_  generation:  0.034629106521606445
local_output_nid generation:  0.0035877227783203125
local_in_edges_tensor generation:  0.002164602279663086
mini_batch_src_global generation:  0.002824544906616211
r_  generation:  0.026721715927124023
local_output_nid generation:  0.0026633739471435547
local_in_edges_tensor generation:  0.002540111541748047
mini_batch_src_global generation:  0.002899646759033203
r_  generation:  0.030115604400634766
local_output_nid generation:  0.002683877944946289
local_in_edges_tensor generation:  0.002064228057861328
mini_batch_src_global generation:  0.002584695816040039
r_  generation:  0.028010845184326172
local_output_nid generation:  0.0027513504028320312
local_in_edges_tensor generation:  0.0022211074829101562
mini_batch_src_global generation:  0.003305196762084961
r_  generation:  0.03163027763366699
local_output_nid generation:  0.002740144729614258
local_in_edges_tensor generation:  0.0025479793548583984
mini_batch_src_global generation:  0.0035533905029296875
r_  generation:  0.035222530364990234
local_output_nid generation:  0.0032334327697753906
local_in_edges_tensor generation:  0.003488779067993164
mini_batch_src_global generation:  0.005156993865966797
r_  generation:  0.044782161712646484
----------------------check_connections_block total spend ----------------------------- 0.4127218723297119
generate_one_block  0.04566621780395508
generate_one_block  0.04101133346557617
generate_one_block  0.03385114669799805
generate_one_block  0.03917860984802246
generate_one_block  0.03417634963989258
generate_one_block  0.044362545013427734
generate_one_block  0.05115175247192383
generate_one_block  0.06394004821777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04644179344177246
gen group dst list time:  0.0067441463470458984
time for parepare:  0.02354145050048828
local_output_nid generation:  0.0034890174865722656
local_in_edges_tensor generation:  0.015057563781738281
mini_batch_src_global generation:  0.003928422927856445
r_  generation:  0.04226231575012207
local_output_nid generation:  0.005248308181762695
local_in_edges_tensor generation:  0.0048980712890625
mini_batch_src_global generation:  0.005358219146728516
r_  generation:  0.04618048667907715
local_output_nid generation:  0.0053369998931884766
local_in_edges_tensor generation:  0.004084587097167969
mini_batch_src_global generation:  0.0038471221923828125
r_  generation:  0.04430580139160156
local_output_nid generation:  0.0060846805572509766
local_in_edges_tensor generation:  0.004647731781005859
mini_batch_src_global generation:  0.00507044792175293
r_  generation:  0.05543804168701172
local_output_nid generation:  0.006822347640991211
local_in_edges_tensor generation:  0.005827188491821289
mini_batch_src_global generation:  0.005864143371582031
r_  generation:  0.06346440315246582
local_output_nid generation:  0.008114099502563477
local_in_edges_tensor generation:  0.008349895477294922
mini_batch_src_global generation:  0.009869575500488281
r_  generation:  0.08885693550109863
local_output_nid generation:  0.011190414428710938
local_in_edges_tensor generation:  0.012550115585327148
mini_batch_src_global generation:  0.013249874114990234
r_  generation:  0.13228797912597656
local_output_nid generation:  0.009319305419921875
local_in_edges_tensor generation:  0.010680675506591797
mini_batch_src_global generation:  0.013667821884155273
r_  generation:  0.11635470390319824
----------------------check_connections_block total spend ----------------------------- 0.9372901916503906
generate_one_block  0.054599761962890625
generate_one_block  0.060590505599975586
generate_one_block  0.055570363998413086
generate_one_block  0.08510422706604004
generate_one_block  0.07874608039855957
generate_one_block  0.11901211738586426
generate_one_block  0.1703321933746338
generate_one_block  0.1527080535888672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03453636169433594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

connection checking time:  0.9372901916503906
block generation total time  0.7766633033752441
average batch blocks generation time:  0.09708291292190552
block dataloader generation time/epoch 23.475813150405884
pseudo mini batch 0 input nodes size: 33222
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029682636260986328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029682636260986328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04552412033081055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04560995101928711  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.028785228729248047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030384540557861328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030384540557861328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030384540557861328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([33222, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030384540557861328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1828, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09137153625488281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09137153625488281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1828, 128]), torch.Size([1, 1828, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09311485290527344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10706138610839844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1828, 128])
m.shape torch.Size([2076, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10869550704956055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10869550704956055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11162042617797852  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1421036720275879  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([1898, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14392328262329102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14392328262329102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1898, 128]), torch.Size([1, 1898, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.14573335647583008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1860203742980957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1898, 128])
m.shape torch.Size([1664, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.18828916549682617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.18828916549682617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1664, 128]), torch.Size([1, 1664, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.18987607955932617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.23589658737182617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1664, 128])
m.shape torch.Size([1359, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2383432388305664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2383432388305664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1359, 128]), torch.Size([1, 1359, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2396392822265625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2873821258544922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1359, 128])
m.shape torch.Size([1233, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29026174545288086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29026174545288086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1233, 128]), torch.Size([1, 1233, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29143762588500977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34200048446655273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1233, 128])
m.shape torch.Size([1073, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34499406814575195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34499406814575195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34601736068725586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3979349136352539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([971, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.40112733840942383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.40112733840942383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 971, 128]), torch.Size([1, 971, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4020533561706543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4566183090209961  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 971, 128])
m.shape torch.Size([841, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4597644805908203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4597644805908203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 841, 128]), torch.Size([1, 841, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.46056652069091797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5129837989807129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 841, 128])
m.shape torch.Size([6723, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5446405410766602  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5446405410766602  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 6723, 128]), torch.Size([1, 6723, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5510520935058594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0092382431030273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 6723, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9562788009643555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9758100509643555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9953413009643555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9756631851196289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([19666, 256])
first layer input nodes number: 33222
first layer output nodes number: 19666
edges number: 122601
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9955911636352539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.015122413635254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0198111534118652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0198111534118652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1389, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1102170944213867  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1102170944213867  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1389, 256]), torch.Size([1, 1389, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1133222579956055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1360363960266113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1389, 256])
m.shape torch.Size([1370, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1368694305419922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1368694305419922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1370, 256]), torch.Size([1, 1370, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1402587890625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1805076599121094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1370, 256])
m.shape torch.Size([1173, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1824078559875488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1824078559875488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1173, 256]), torch.Size([1, 1173, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1846976280212402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2348837852478027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1173, 256])
m.shape torch.Size([984, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2375483512878418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2375483512878418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 984, 256]), torch.Size([1, 984, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2394251823425293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.29536771774292  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 984, 256])
m.shape torch.Size([805, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.298975944519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.298975944519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 805, 256]), torch.Size([1, 805, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.300511360168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3560676574707031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 805, 256])
m.shape torch.Size([704, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3593597412109375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3593597412109375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 704, 256]), torch.Size([1, 704, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3607025146484375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4198722839355469  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 704, 256])
m.shape torch.Size([589, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.423163890838623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.423163890838623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4242873191833496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4804587364196777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([495, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4837031364440918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4837031364440918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.484647274017334  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5407824516296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 495, 256])
m.shape torch.Size([456, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.544255256652832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.544255256652832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 456, 256]), torch.Size([1, 456, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5451250076293945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6015825271606445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 456, 256])
m.shape torch.Size([395, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6049442291259766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6049442291259766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6056976318359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6599845886230469  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([357, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6633825302124023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6633825302124023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 357, 256]), torch.Size([1, 357, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6640634536743164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7181940078735352  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 357, 256])
m.shape torch.Size([288, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.721175193786621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.721175193786621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.721724510192871  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7700061798095703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([256, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7729301452636719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7729301452636719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7734184265136719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8183403015136719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([225, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.821171760559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.821171760559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8216009140014648  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8640871047973633  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([163, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.866222858428955  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.866222858428955  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8665337562561035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.899488925933838  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([173, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.901994228363037  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.901994228363037  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9023241996765137  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9396109580993652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([159, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9420442581176758  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9420442581176758  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.942347526550293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9787397384643555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([140, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9810104370117188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9810104370117188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9812774658203125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0151901245117188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0170836448669434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0170836448669434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0172953605651855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0456652641296387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([121, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0478854179382324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0478854179382324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0481162071228027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.080657482147217  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.082643985748291  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.082643985748291  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.082838535308838  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1116318702697754  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([85, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1133322715759277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1133322715759277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.113494396209717  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1386237144470215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1402230262756348  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1402230262756348  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1403679847717285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.163851261138916  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.165370464324951  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.165370464324951  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1655020713806152  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.187743663787842  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([792, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2073569297790527  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2073569297790527  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 792, 256]), torch.Size([1, 792, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2088675498962402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4747366905212402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 792, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3964428901672363  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3984622955322266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.400172710418701  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3980674743652344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11477, 40])
input nodes number: 19666
output nodes number: 11477
edges number: 92012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3985648155212402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3985657691955566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03375244140625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 1 input nodes size: 34652
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029050827026367188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029050827026367188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.045574188232421875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.045659542083740234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029732227325439453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0314183235168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0314183235168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0314183235168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([34652, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0314183235168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2195, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0987234115600586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0987234115600586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2195, 128]), torch.Size([1, 2195, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.10081672668457031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11776876449584961  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2195, 128])
m.shape torch.Size([2222, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11902093887329102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11902093887329102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2222, 128]), torch.Size([1, 2222, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1211400032043457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15378141403198242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2222, 128])
m.shape torch.Size([1975, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1559004783630371  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1559004783630371  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1975, 128]), torch.Size([1, 1975, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15778398513793945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20033502578735352  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1975, 128])
m.shape torch.Size([1692, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2027750015258789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2027750015258789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1692, 128]), torch.Size([1, 1692, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20438861846923828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.25118350982666016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1692, 128])
m.shape torch.Size([1534, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.25403404235839844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.25403404235839844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1534, 128]), torch.Size([1, 1534, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2554969787597656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3084268569946289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1534, 128])
m.shape torch.Size([1285, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3113718032836914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3113718032836914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1285, 128]), torch.Size([1, 1285, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31259727478027344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.36792659759521484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1285, 128])
m.shape torch.Size([1100, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3709855079650879  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3709855079650879  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.37203454971313477  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.426363468170166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([991, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42961931228637695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42961931228637695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 991, 128]), torch.Size([1, 991, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.43056440353393555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.48552942276000977  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 991, 128])
m.shape torch.Size([843, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4886746406555176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4886746406555176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 843, 128]), torch.Size([1, 843, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.48947858810424805  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5409932136535645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 843, 128])
m.shape torch.Size([7599, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5768260955810547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5768260955810547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 7599, 128]), torch.Size([1, 7599, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5840730667114258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0986080169677734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 7599, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0403456687927246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.060788631439209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0812315940856934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.060628890991211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([21436, 256])
first layer input nodes number: 34652
first layer output nodes number: 21436
edges number: 133917
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0814919471740723  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1019349098205566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1070456504821777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1070456504821777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1637, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.197883129119873  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.197883129119873  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1637, 256]), torch.Size([1, 1637, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.202317714691162  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2272963523864746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1637, 256])
m.shape torch.Size([1427, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2288217544555664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2288217544555664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1427, 256]), torch.Size([1, 1427, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.231649398803711  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2727937698364258  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1427, 256])
m.shape torch.Size([1168, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2747478485107422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2747478485107422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1168, 256]), torch.Size([1, 1168, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2770099639892578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3322105407714844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1168, 256])
m.shape torch.Size([921, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3343677520751953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3343677520751953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 921, 256]), torch.Size([1, 921, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3361244201660156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3870677947998047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 921, 256])
m.shape torch.Size([782, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3899478912353516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3899478912353516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.391439437866211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.445352554321289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([636, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4482746124267578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4482746124267578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4494876861572266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5021553039550781  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([535, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5051484107971191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5051484107971191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 535, 256]), torch.Size([1, 535, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5061688423156738  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5577082633972168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 535, 256])
m.shape torch.Size([465, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5607738494873047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5607738494873047  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 465, 256]), torch.Size([1, 465, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5616607666015625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6126861572265625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 465, 256])
m.shape torch.Size([409, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6157808303833008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6157808303833008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.616560935974121  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.667860984802246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([350, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.670835018157959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.670835018157959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 350, 256]), torch.Size([1, 350, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6715025901794434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7202377319335938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 350, 256])
m.shape torch.Size([310, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7231817245483398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7231817245483398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7237730026245117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.770503044128418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([250, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7730908393859863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7730908393859863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 250, 256]), torch.Size([1, 250, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7735676765441895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.814098834991455  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 250, 256])
m.shape torch.Size([229, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.817544937133789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.817544937133789  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8179817199707031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8581657409667969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8607730865478516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8607730865478516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8611736297607422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.900827407836914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([189, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9033522605895996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9033522605895996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9037127494812012  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9419245719909668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([141, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9439129829406738  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9439129829406738  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9441819190979004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.974571704864502  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([159, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9770355224609375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9770355224609375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9773387908935547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.013731002807617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0156211853027344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0156211853027344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0158462524414062  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0444297790527344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.04634428024292  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.04634428024292  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.046555995941162  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0749258995056152  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([120, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.077126979827881  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.077126979827881  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0773558616638184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.109628200531006  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1124987602233887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1124987602233887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1126914024353027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.141202449798584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1424174308776855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1424174308776855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.14253568649292  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.160865306854248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1624865531921387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1624865531921387  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1626315116882324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.18611478805542  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.187541961669922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.187541961669922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1876659393310547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2086181640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([983, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.232175827026367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.232175827026367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 983, 256]), torch.Size([1, 983, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.234050750732422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.573497772216797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 983, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.494997024536133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.496951103210449  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4986581802368164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4966187477111816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11454, 40])
input nodes number: 21436
output nodes number: 11454
edges number: 92173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.496798515319824  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4967989921569824  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03459310531616211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 2 input nodes size: 35826
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029666900634765625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.029666900634765625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04675006866455078  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04683685302734375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030228137969970703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03168344497680664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03168344497680664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03168344497680664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([35826, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03168344497680664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2747, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09207963943481445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09207963943481445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2747, 128]), torch.Size([1, 2747, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.09469938278198242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11565732955932617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2747, 128])
m.shape torch.Size([2717, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11693859100341797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11693859100341797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2717, 128]), torch.Size([1, 2717, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12008523941040039  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1590890884399414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2717, 128])
m.shape torch.Size([2362, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.16109418869018555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.16109418869018555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2362, 128]), torch.Size([1, 2362, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.16347217559814453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2140045166015625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2362, 128])
m.shape torch.Size([1988, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21633148193359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21633148193359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1988, 128]), torch.Size([1, 1988, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.21822738647460938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2741241455078125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1988, 128])
m.shape torch.Size([1694, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27742576599121094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27742576599121094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1694, 128]), torch.Size([1, 1694, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2790412902832031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3375053405761719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1694, 128])
m.shape torch.Size([1433, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34079742431640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34079742431640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3421640396118164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4009284973144531  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1155, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4041004180908203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4041004180908203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1155, 128]), torch.Size([1, 1155, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.40520191192626953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.46230506896972656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1155, 128])
m.shape torch.Size([1005, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4655880928039551  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4655880928039551  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1005, 128]), torch.Size([1, 1005, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.46654653549194336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5217900276184082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1005, 128])
m.shape torch.Size([844, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.524932861328125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.524932861328125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 844, 128]), torch.Size([1, 844, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5257377624511719  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5788702964782715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 844, 128])
m.shape torch.Size([5632, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.605811595916748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.605811595916748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 5632, 128]), torch.Size([1, 5632, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.611182689666748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.997657299041748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 5632, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.946742057800293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9673194885253906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9878969192504883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.967158317565918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([21577, 256])
first layer input nodes number: 35826
first layer output nodes number: 21577
edges number: 120328
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9881658554077148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0087432861328125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0148468017578125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0148468017578125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1931, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0893926620483398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0893926620483398  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1931, 256]), torch.Size([1, 1931, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0939946174621582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1234593391418457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1931, 256])
m.shape torch.Size([1682, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.125326156616211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.125326156616211  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1682, 256]), torch.Size([1, 1682, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1285343170166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1812686920166016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1682, 256])
m.shape torch.Size([1356, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1828060150146484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1828060150146484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1356, 256]), torch.Size([1, 1356, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1855387687683105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2432360649108887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1356, 256])
m.shape torch.Size([1032, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.24591064453125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.24591064453125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1032, 256]), torch.Size([1, 1032, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2479829788208008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3097343444824219  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1032, 256])
m.shape torch.Size([906, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3131041526794434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3131041526794434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 906, 256]), torch.Size([1, 906, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3148322105407715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3781638145446777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 906, 256])
m.shape torch.Size([733, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3815269470214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3815269470214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 733, 256]), torch.Size([1, 733, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.382925033569336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4437389373779297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 733, 256])
m.shape torch.Size([581, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4469490051269531  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4469490051269531  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 581, 256]), torch.Size([1, 581, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4480571746826172  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.504739761352539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 581, 256])
m.shape torch.Size([468, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.507784366607666  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.507784366607666  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 468, 256]), torch.Size([1, 468, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5086770057678223  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.559572696685791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 468, 256])
m.shape torch.Size([393, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5625262260437012  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5625262260437012  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 393, 256]), torch.Size([1, 393, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5632758140563965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.61253023147583  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 393, 256])
m.shape torch.Size([355, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.615567684173584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.615567684173584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 355, 256]), torch.Size([1, 355, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6162447929382324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6657452583312988  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 355, 256])
m.shape torch.Size([275, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6683144569396973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6683144569396973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6688389778137207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7116780281066895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([244, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7142300605773926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7142300605773926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7146954536437988  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.75425386428833  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([206, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7565951347351074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7565951347351074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 206, 256]), torch.Size([1, 206, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7569880485534668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7931361198425293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 206, 256])
m.shape torch.Size([158, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7950658798217773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7950658798217773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7953672409057617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8252019882202148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([163, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8274016380310059  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8274016380310059  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8277125358581543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8606677055358887  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([115, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8629264831542969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8629264831542969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8631458282470703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8879318237304688  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.889472484588623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.889472484588623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.889665126800537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9127821922302246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([84, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9141392707824707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9141392707824707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.914299488067627  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9346470832824707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([82, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9360647201538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9360647201538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9362211227416992  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.957179069519043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9584851264953613  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9584851264953613  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9586224555969238  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9779858589172363  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9791889190673828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9791889190673828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.97930908203125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9970932006835938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9981751441955566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9981751441955566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9982781410217285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.014242649078369  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([51, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0153188705444336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0153188705444336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.015416145324707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.031174659729004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0321412086486816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0321412086486816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0322251319885254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.046408176422119  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([455, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0572991371154785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0572991371154785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 455, 256]), torch.Size([1, 455, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.058166980743408  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2134995460510254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 455, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.151449680328369  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1532912254333496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1556639671325684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.153735637664795  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11604, 40])
input nodes number: 21577
output nodes number: 11604
edges number: 74787
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1538710594177246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.153871536254883  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03446483612060547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 3 input nodes size: 46634
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030115604400634766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.030115604400634766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0523524284362793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.052439212799072266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03526926040649414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03702688217163086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03702688217163086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03702688217163086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([46634, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03702688217163086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2453, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11184024810791016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11184024810791016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2453, 128]), torch.Size([1, 2453, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.11469793319702148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13424921035766602  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2453, 128])
m.shape torch.Size([2585, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13541889190673828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13541889190673828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2585, 128]), torch.Size([1, 2585, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.13788414001464844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1772613525390625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2585, 128])
m.shape torch.Size([2349, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17972660064697266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17972660064697266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2349, 128]), torch.Size([1, 2349, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.18196678161621094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.23130178451538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2349, 128])
m.shape torch.Size([2028, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.23466205596923828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.23466205596923828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2028, 128]), torch.Size([1, 2028, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.23659610748291016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29298877716064453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2028, 128])
m.shape torch.Size([1764, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29622745513916016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29622745513916016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1764, 128]), torch.Size([1, 1764, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2979097366333008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.35879039764404297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1764, 128])
m.shape torch.Size([1426, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3620290756225586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3620290756225586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1426, 128]), torch.Size([1, 1426, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3633890151977539  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42186641693115234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1426, 128])
m.shape torch.Size([1282, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42546558380126953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42546558380126953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42668819427490234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4906797409057617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1200, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4946460723876953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4946460723876953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1200, 128]), torch.Size([1, 1200, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4957904815673828  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5610218048095703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1200, 128])
m.shape torch.Size([967, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5645995140075684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5645995140075684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 967, 128]), torch.Size([1, 967, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5655217170715332  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6282377243041992  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 967, 128])
m.shape torch.Size([8222, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6669821739196777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6669821739196777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 8222, 128]), torch.Size([1, 8222, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6748232841491699  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2321267127990723  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 8222, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1679601669311523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1911115646362305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2142629623413086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.1909303665161133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([24276, 256])
first layer input nodes number: 46634
first layer output nodes number: 24276
edges number: 149655
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2146124839782715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2377638816833496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2435517311096191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2435517311096191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1732, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.32847261428833  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.32847261428833  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1732, 256]), torch.Size([1, 1732, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3321490287780762  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.359635829925537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1732, 256])
m.shape torch.Size([1544, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.361856460571289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.361856460571289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1544, 256]), torch.Size([1, 1544, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.364980697631836  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4113521575927734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1544, 256])
m.shape torch.Size([1263, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4128532409667969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4128532409667969  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1263, 256]), torch.Size([1, 1263, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.415327548980713  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4696564674377441  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1263, 256])
m.shape torch.Size([1036, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4726448059082031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4726448059082031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1036, 256]), torch.Size([1, 1036, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.474724292755127  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5337109565734863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1036, 256])
m.shape torch.Size([855, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5363798141479492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5363798141479492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 855, 256]), torch.Size([1, 855, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.538010597229004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6052789688110352  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 855, 256])
m.shape torch.Size([631, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6083412170410156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6083412170410156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 631, 256]), torch.Size([1, 631, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6095447540283203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6616249084472656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 631, 256])
m.shape torch.Size([575, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6648917198181152  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6648917198181152  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 575, 256]), torch.Size([1, 575, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6659884452819824  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7208247184753418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 575, 256])
m.shape torch.Size([524, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7243056297302246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7243056297302246  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 524, 256]), torch.Size([1, 524, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7253050804138184  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7828421592712402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 524, 256])
m.shape torch.Size([387, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7856903076171875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7856903076171875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.786428451538086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8364973068237305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([356, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8395500183105469  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8395500183105469  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8402290344238281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8903369903564453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([263, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8927783966064453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8927783966064453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.893280029296875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9334135055541992  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([270, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.936276912689209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.936276912689209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9367918968200684  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9807944297790527  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([211, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9831733703613281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9831733703613281  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9835758209228516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.020601272583008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([197, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0230512619018555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0230512619018555  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0234270095825195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0606260299682617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([192, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.063206195831299  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.063206195831299  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.063572406768799  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.102390766143799  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([134, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1042685508728027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1042685508728027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1045241355895996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1334052085876465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([135, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1354832649230957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1354832649230957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1357407569885254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.166639804840088  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([116, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.16851806640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.16851806640625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1687393188476562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.19683837890625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([89, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1986660957336426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1986660957336426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.198835849761963  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2215828895568848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([86, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.223151206970215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.223151206970215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2233152389526367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.246443748474121  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([73, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.247835159301758  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.247835159301758  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.247974395751953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2685813903808594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([80, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2702035903930664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2702035903930664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2703561782836914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2940073013305664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2950806617736816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2950806617736816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.295179843902588  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3112473487854004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.31242036819458  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.31242036819458  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.312521457672119  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3296055793762207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([791, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.349233627319336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.349233627319336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 791, 256]), torch.Size([1, 791, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3507423400878906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.6169166564941406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 791, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.544813632965088  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5466065406799316  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.548342227935791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5464625358581543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11645, 40])
input nodes number: 24276
output nodes number: 11645
edges number: 86062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5466246604919434  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5466251373291016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.040341854095458984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 4 input nodes size: 56256
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03516340255737305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.03516340255737305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.06250715255737305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.062591552734375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0402679443359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.042034149169921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.042034149169921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.042034149169921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([56256, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.042034149169921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2914, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12489032745361328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12489032745361328  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2914, 128]), torch.Size([1, 2914, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.12772893905639648  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15056371688842773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2914, 128])
m.shape torch.Size([3089, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15212011337280273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15212011337280273  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 3089, 128]), torch.Size([1, 3089, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.15517616271972656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20125770568847656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 3089, 128])
m.shape torch.Size([2815, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20403671264648438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20403671264648438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2815, 128]), torch.Size([1, 2815, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.20676851272583008  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2675204277038574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2815, 128])
m.shape torch.Size([2346, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27106475830078125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.27106475830078125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2346, 128]), torch.Size([1, 2346, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2735257148742676  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3392319679260254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2346, 128])
m.shape torch.Size([2110, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34314393997192383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.34314393997192383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2110, 128]), torch.Size([1, 2110, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.345308780670166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4197268486022949  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2110, 128])
m.shape torch.Size([1676, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42351579666137695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42351579666137695  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1676, 128]), torch.Size([1, 1676, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42511415481567383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4949650764465332  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1676, 128])
m.shape torch.Size([1456, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.499025821685791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.499025821685791  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1456, 128]), torch.Size([1, 1456, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5004143714904785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5700249671936035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1456, 128])
m.shape torch.Size([1261, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5741410255432129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5741410255432129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1261, 128]), torch.Size([1, 1261, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5753436088562012  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6446309089660645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1261, 128])
m.shape torch.Size([1098, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6487417221069336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6487417221069336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1098, 128]), torch.Size([1, 1098, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6497888565063477  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7181711196899414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1098, 128])
m.shape torch.Size([8839, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7597951889038086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7597951889038086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 8839, 128]), torch.Size([1, 8839, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.768855094909668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3673515319824219  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 8839, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.2951927185058594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3215179443359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3478431701660156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.3213119506835938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([27604, 256])
first layer input nodes number: 56256
first layer output nodes number: 27604
edges number: 166079
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.348264217376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.374589443206787  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.381467342376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.381467342376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2009, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.452160358428955  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.452160358428955  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2009, 256]), torch.Size([1, 2009, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4569077491760254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4905877113342285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2009, 256])
m.shape torch.Size([1705, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4913792610168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4913792610168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1705, 256]), torch.Size([1, 1705, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.4947504997253418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5445246696472168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1705, 256])
m.shape torch.Size([1348, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.547132968902588  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.547132968902588  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1348, 256]), torch.Size([1, 1348, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.5499954223632812  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6071720123291016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1348, 256])
m.shape torch.Size([1033, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6099209785461426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6099209785461426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.612013339996338  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6714301109313965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([914, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.674436092376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.674436092376709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 914, 256]), torch.Size([1, 914, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.6761794090270996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7398219108581543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 914, 256])
m.shape torch.Size([652, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7427105903625488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7427105903625488  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 652, 256]), torch.Size([1, 652, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.7439541816711426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8007588386535645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 652, 256])
m.shape torch.Size([503, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8035216331481934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8035216331481934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 503, 256]), torch.Size([1, 503, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.804481029510498  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8582415580749512  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 503, 256])
m.shape torch.Size([457, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8619704246520996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.8619704246520996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 457, 256]), torch.Size([1, 457, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.862842082977295  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.913236141204834  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 457, 256])
m.shape torch.Size([369, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.915992259979248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.915992259979248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 369, 256]), torch.Size([1, 369, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9166960716247559  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9622282981872559  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 369, 256])
m.shape torch.Size([294, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9647021293640137  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9647021293640137  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9652628898620605  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.006077289581299  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([242, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0083556175231934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0083556175231934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.008817195892334  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0448203086853027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([210, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0470118522644043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0470118522644043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.047412395477295  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.081458568572998  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([199, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.083745002746582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.083745002746582  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 199, 256]), torch.Size([1, 199, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0841245651245117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.119044303894043  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 199, 256])
m.shape torch.Size([159, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1209940910339355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1209940910339355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1212973594665527  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1513209342956543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([120, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.152899742126465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.152899742126465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1531286239624023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1773900985717773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([116, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1790595054626465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1790595054626465  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1792807579040527  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.204282283782959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2056589126586914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2056589126586914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2058324813842773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.22666072845459  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([79, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2279410362243652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2279410362243652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2280917167663574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2472281455993652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([71, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2484498023986816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2484498023986816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2485852241516113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2667317390441895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.267946243286133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.267946243286133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2680606842041016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2841968536376953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2853307723999023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2853307723999023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2854433059692383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.302098274230957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([33, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3027400970458984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3027400970458984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3028030395507812  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.312559127807617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3133678436279297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3133678436279297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3134403228759766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3251819610595703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.326045513153076  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.326045513153076  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.326119899749756  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.338691234588623  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([495, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.350548267364502  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.350548267364502  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 495, 256]), torch.Size([1, 495, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.351492404937744  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.520878314971924  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 495, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4626407623291016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4643239974975586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4660072326660156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4642395973205566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11295, 40])
input nodes number: 27604
output nodes number: 11295
edges number: 70834
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4644775390625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.464478015899658  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0454401969909668  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 5 input nodes size: 66879
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.040215492248535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.040215492248535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.07210588455200195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.0721888542175293  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.044760704040527344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.047295570373535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.047295570373535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.047295570373535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([66879, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.047295570373535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2664, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17131805419921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.17131805419921875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2664, 128]), torch.Size([1, 2664, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.173858642578125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.1949472427368164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2664, 128])
m.shape torch.Size([2678, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19621753692626953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19621753692626953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2678, 128]), torch.Size([1, 2678, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.19877147674560547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2378406524658203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2678, 128])
m.shape torch.Size([2255, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.24039459228515625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.24039459228515625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2255, 128]), torch.Size([1, 2255, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.24268293380737305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2917752265930176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2255, 128])
m.shape torch.Size([2058, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2940540313720703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2940540313720703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2058, 128]), torch.Size([1, 2058, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.29668188095092773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.35645008087158203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2058, 128])
m.shape torch.Size([1837, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3598484992980957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3598484992980957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.361600399017334  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4256715774536133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1582, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42990922927856445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.42990922927856445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1582, 128]), torch.Size([1, 1582, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.43141794204711914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4979062080383301  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1582, 128])
m.shape torch.Size([1479, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5020885467529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5020885467529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1479, 128]), torch.Size([1, 1479, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5034990310668945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5740232467651367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1479, 128])
m.shape torch.Size([1350, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.578467845916748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.578467845916748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5797553062438965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6536669731140137  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([1221, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.658348560333252  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.658348560333252  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1221, 128]), torch.Size([1, 1221, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.659512996673584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7360129356384277  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1221, 128])
m.shape torch.Size([17685, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8197593688964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8197593688964844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 17685, 128]), torch.Size([1, 17685, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8366250991821289  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0340919494628906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 17685, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.921159267425537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.954362392425537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.987565517425537  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9541029930114746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([34809, 256])
first layer input nodes number: 66879
first layer output nodes number: 34809
edges number: 250686
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.9880657196044922  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.021268844604492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0295681953430176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.0295681953430176  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1871, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.118046760559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.118046760559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1871, 256]), torch.Size([1, 1871, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.122321128845215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1522817611694336  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1871, 256])
m.shape torch.Size([1523, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1530723571777344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1530723571777344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1523, 256]), torch.Size([1, 1523, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.1561126708984375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2006869316101074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1523, 256])
m.shape torch.Size([1104, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2022604942321777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2022604942321777  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1104, 256]), torch.Size([1, 1104, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.204606056213379  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.254469394683838  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1104, 256])
m.shape torch.Size([884, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2568154335021973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2568154335021973  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 884, 256]), torch.Size([1, 884, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.2585015296936035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3073983192443848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 884, 256])
m.shape torch.Size([731, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3100686073303223  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3100686073303223  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 731, 256]), torch.Size([1, 731, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.311462879180908  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3617587089538574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 731, 256])
m.shape torch.Size([583, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3644237518310547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3644237518310547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 583, 256]), torch.Size([1, 583, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.3655357360839844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4148168563842773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 583, 256])
m.shape torch.Size([473, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.41744327545166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.41744327545166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 473, 256]), torch.Size([1, 473, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4183454513549805  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.4651784896850586  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 473, 256])
m.shape torch.Size([391, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.467733860015869  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.467733860015869  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 391, 256]), torch.Size([1, 391, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.468479633331299  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5111985206604004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 391, 256])
m.shape torch.Size([328, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5136632919311523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5136632919311523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 328, 256]), torch.Size([1, 328, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.514288902282715  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.555638313293457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 328, 256])
m.shape torch.Size([269, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5579113960266113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5579113960266113  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 269, 256]), torch.Size([1, 269, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.558424472808838  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.595752239227295  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 269, 256])
m.shape torch.Size([276, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5984139442443848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.5984139442443848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.598940372467041  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.6408448219299316  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([202, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.642911434173584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.642911434173584  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.643296718597412  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.6760458946228027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([147, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.677690029144287  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.677690029144287  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.6779704093933105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.703765392303467  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([134, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7054286003112793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7054286003112793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.705684185028076  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.730987071990967  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([119, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.732574939727783  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.732574939727783  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.732801914215088  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7568612098693848  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([113, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.758485794067383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.758485794067383  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7587013244628906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7830562591552734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([113, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7847952842712402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.7847952842712402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.785010814666748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8108744621276855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([107, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8126182556152344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8126182556152344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8128223419189453  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8387413024902344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8405022621154785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8405022621154785  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8406968116760254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8667664527893066  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([97, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8685340881347656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8685340881347656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8687191009521484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.894805908203125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8963565826416016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8963565826416016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8964805603027344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9148292541503906  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.916184425354004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.916184425354004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9163122177124023  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.93612003326416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9374732971191406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9374732971191406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9375648498535156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9523963928222656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9538731575012207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9538731575012207  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9539990425109863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.975273609161377  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1291, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0062313079833984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0062313079833984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1291, 256]), torch.Size([1, 1291, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0086936950683594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.4428577423095703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1291, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3661952018737793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3683323860168457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3699870109558105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.367766857147217  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11104, 40])
input nodes number: 34809
output nodes number: 11104
edges number: 89366
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.368563175201416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.368563652038574  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.052351951599121094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 6 input nodes size: 88020
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04521465301513672  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.04521465301513672  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08718585968017578  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.08726835250854492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05529499053955078  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05877113342285156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05877113342285156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05877113342285156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([88020, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.05877113342285156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([2663, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2389521598815918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2389521598815918  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2663, 128]), torch.Size([1, 2663, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.24222707748413086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.2628345489501953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2663, 128])
m.shape torch.Size([2884, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.264315128326416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.264315128326416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2884, 128]), torch.Size([1, 2884, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.26725053787231445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31021928787231445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2884, 128])
m.shape torch.Size([2545, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31198692321777344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31198692321777344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2545, 128]), torch.Size([1, 2545, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.31507349014282227  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.36920881271362305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2545, 128])
m.shape torch.Size([2261, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3728494644165039  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3728494644165039  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2261, 128]), torch.Size([1, 2261, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.3750920295715332  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.44014930725097656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2261, 128])
m.shape torch.Size([2140, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.44364213943481445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.44364213943481445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.4457669258117676  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.521644115447998  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1940, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.525855541229248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.525855541229248  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1940, 128]), torch.Size([1, 1940, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.5277056694030762  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6105570793151855  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1940, 128])
m.shape torch.Size([1811, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6156768798828125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6156768798828125  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1811, 128]), torch.Size([1, 1811, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.6174039840698242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7037591934204102  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1811, 128])
m.shape torch.Size([1724, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7094721794128418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7094721794128418  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1724, 128]), torch.Size([1, 1724, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.7111163139343262  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8049235343933105  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1724, 128])
m.shape torch.Size([1624, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8110709190368652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.8110709190368652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1624, 128]), torch.Size([1, 1624, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.812619686126709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 0.9149336814880371  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1624, 128])
m.shape torch.Size([27653, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0460190773010254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0460190773010254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 27653, 128]), torch.Size([1, 27653, 128])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 1.0723910331726074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9447999000549316  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 27653, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.779569625854492  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8246259689331055  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8696823120117188  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.8242735862731934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([47245, 256])
first layer input nodes number: 88020
first layer output nodes number: 47245
edges number: 365065
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.870340347290039  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.9153966903686523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.927096366882324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 2.927096366882324  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1630, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0267558097839355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0267558097839355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1630, 256]), torch.Size([1, 1630, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.030372142791748  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.056976318359375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1630, 256])
m.shape torch.Size([1462, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0578980445861816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0578980445861816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1462, 256]), torch.Size([1, 1462, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.0617852210998535  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.1108884811401367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1462, 256])
m.shape torch.Size([1062, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.112058639526367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.112058639526367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1062, 256]), torch.Size([1, 1062, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.1143503189086914  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.162919521331787  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1062, 256])
m.shape torch.Size([809, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.16475248336792  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.16475248336792  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 809, 256]), torch.Size([1, 809, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.1662955284118652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.2120375633239746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 809, 256])
m.shape torch.Size([663, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.214550018310547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.214550018310547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 663, 256]), torch.Size([1, 663, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.2158145904541016  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.2623066902160645  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 663, 256])
m.shape torch.Size([475, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.264413833618164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.264413833618164  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 475, 256]), torch.Size([1, 475, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.26531982421875  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.308316230773926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 475, 256])
m.shape torch.Size([426, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.310729503631592  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.310729503631592  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.31154203414917  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.352199077606201  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([356, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3545303344726562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3545303344726562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 356, 256]), torch.Size([1, 356, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3552093505859375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3955230712890625  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 356, 256])
m.shape torch.Size([318, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3979344367980957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.3979344367980957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 318, 256]), torch.Size([1, 318, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.39854097366333  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.437617778778076  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 318, 256])
m.shape torch.Size([281, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.4400153160095215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.4400153160095215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 281, 256]), torch.Size([1, 281, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.440551280975342  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.478921413421631  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 281, 256])
m.shape torch.Size([209, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.480863094329834  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.480863094329834  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.481261730194092  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.512355327606201  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.51462459564209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.51462459564209  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5150327682495117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.549727439880371  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([172, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5516724586486816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5516724586486816  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5520005226135254  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5821824073791504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([158, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5841445922851562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5841445922851562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.5844459533691406  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6142807006835938  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.616307258605957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.616307258605957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6165952682495117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6471242904663086  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6491026878356934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6491026878356934  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6493659019470215  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.6791090965270996  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([117, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.68088960647583  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.68088960647583  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.681112766265869  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7078919410705566  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([135, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.710115909576416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.710115909576416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7103734016418457  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.743074893951416  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([120, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7451376914978027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7451376914978027  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7453665733337402  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7760367393493652  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.777517795562744  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.777517795562744  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7776761054992676  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.7999978065490723  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([101, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.801957607269287  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.801957607269287  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.802150249481201  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.8306612968444824  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([75, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.832150936126709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.832150936126709  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.83229398727417  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.8544669151306152  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([67, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.855876922607422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.855876922607422  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.8560047149658203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.876707077026367  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([80, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.878488540649414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.878488540649414  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.878641128540039  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.904428482055664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([1733, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.945992946624756  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.945992946624756  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1733, 256]), torch.Size([1, 1733, 256])
----------------------------------------3
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 3.94929838180542  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.534048557281494  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1733, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.445104122161865  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.447047710418701  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.448692321777344  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.446666240692139  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([11035, 40])
input nodes number: 47245
output nodes number: 11035
edges number: 101347
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.4469075202941895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 4.446907997131348  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.06499099731445312  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

pseudo mini batch 7 input nodes size: 67466
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.05510139465332031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.05510139465332031  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.08727169036865234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.0873560905456543  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.045302391052246094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.048834800720214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.048834800720214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.048834800720214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([67466, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.048834800720214844  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1834, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.2150559425354004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.2150559425354004  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1834, 128]), torch.Size([1, 1834, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.21680498123168945  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.23131895065307617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1834, 128])
m.shape torch.Size([1860, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.23221826553344727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.23221826553344727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1860, 128]), torch.Size([1, 1860, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.2339920997619629  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.26059961318969727  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1860, 128])
m.shape torch.Size([1759, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.26261186599731445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.26261186599731445  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1759, 128]), torch.Size([1, 1759, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.26428937911987305  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.3011946678161621  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1759, 128])
m.shape torch.Size([1628, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.30346107482910156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.30346107482910156  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1628, 128]), torch.Size([1, 1628, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.30501365661621094  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.3502368927001953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1628, 128])
m.shape torch.Size([1573, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.3532109260559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.3532109260559082  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1573, 128]), torch.Size([1, 1573, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.35471105575561523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.40996313095092773  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1573, 128])
m.shape torch.Size([1452, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.41336727142333984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.41336727142333984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1452, 128]), torch.Size([1, 1452, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.4147520065307617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.4755430221557617  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1452, 128])
m.shape torch.Size([1424, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.47960376739501953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.47960376739501953  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1424, 128]), torch.Size([1, 1424, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.48096179962158203  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.548863410949707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1424, 128])
m.shape torch.Size([1352, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.5533418655395508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.5533418655395508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1352, 128]), torch.Size([1, 1352, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.554631233215332  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.6286835670471191  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1352, 128])
m.shape torch.Size([1327, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.6337337493896484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.6337337493896484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1327, 128]), torch.Size([1, 1327, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.6349992752075195  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.7177801132202148  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1327, 128])
m.shape torch.Size([26963, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.8460536003112793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.8460536003112793  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 26963, 128]), torch.Size([1, 26963, 128])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 0.872004508972168  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.6978611946105957  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 26963, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.5435123443603516  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.5827770233154297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.622041702270508  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.582469940185547  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

torch.Size([41172, 256])
first layer input nodes number: 67466
first layer output nodes number: 41172
edges number: 336277
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.622546672821045  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.661811351776123  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.6716275215148926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.6716275215148926  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

m.shape torch.Size([1229, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8057003021240234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8057003021240234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 1229, 256]), torch.Size([1, 1229, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8083133697509766  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.827604293823242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 1229, 256])
m.shape torch.Size([993, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.828299045562744  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.828299045562744  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 993, 256]), torch.Size([1, 993, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.830193042755127  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.858603000640869  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 993, 256])
m.shape torch.Size([803, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.860128879547119  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.860128879547119  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 803, 256]), torch.Size([1, 803, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8616604804992676  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8971238136291504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 803, 256])
m.shape torch.Size([621, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8992629051208496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.8992629051208496  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 621, 256]), torch.Size([1, 621, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.900447368621826  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.9373836517333984  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 621, 256])
m.shape torch.Size([566, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.939511775970459  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.939511775970459  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 566, 256]), torch.Size([1, 566, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.940591335296631  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.9803714752197266  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 566, 256])
m.shape torch.Size([454, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.982450008392334  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.982450008392334  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 454, 256]), torch.Size([1, 454, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 2.983315944671631  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.0235466957092285  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 454, 256])
m.shape torch.Size([363, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.0255560874938965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.0255560874938965  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 363, 256]), torch.Size([1, 363, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.0262484550476074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.061770439147949  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 363, 256])
m.shape torch.Size([316, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.063854217529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.063854217529297  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.0644569396972656  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1011486053466797  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([316, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.103580951690674  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.103580951690674  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 316, 256]), torch.Size([1, 316, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1041836738586426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1427578926086426  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 316, 256])
m.shape torch.Size([299, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1453304290771484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1453304290771484  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1459007263183594  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1874847412109375  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([271, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1900649070739746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.1900649070739746  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.190581798553467  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.233001232147217  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([259, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.2357301712036133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.2357301712036133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.2362241744995117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.2793655395507812  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([236, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.28206729888916  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.28206729888916  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.282517433166504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.323929786682129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3263020515441895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3263020515441895  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3266701698303223  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3631138801574707  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([192, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3656978607177734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3656978607177734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.3660640716552734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4048824310302734  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([181, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4074831008911133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4074831008911133  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4078283309936523  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4468393325805664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([155, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.449199676513672  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.449199676513672  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.449495315551758  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.4849720001220703  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([169, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.487748146057129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.487748146057129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.488070487976074  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.529007911682129  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([150, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.531586170196533  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.531586170196533  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.531872272491455  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.5702099800109863  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([168, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.573296546936035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.573296546936035  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.5736169815063477  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.61879825592041  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([153, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.6217265129089355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.6217265129089355  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.622018337249756  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.665208339691162  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.667448043823242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.667448043823242  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.6676387786865234  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.697202682495117  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([111, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.69956111907959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.69956111907959  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.699772834777832  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.7340707778930664  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([109, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.7364792823791504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.7364792823791504  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.0057373046875 GB
    Memory Allocated: 3.736687183380127  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0135498046875 GB
    Memory Allocated: 3.771822452545166  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([2920, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 3.8418807983398438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 3.8418807983398438  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

 h.shape torch.Size([1, 2920, 256]), torch.Size([1, 2920, 256])
----------------------------------------3
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 3.8474502563476562  GigaBytes
Max Memory Allocated: 4.894304275512695  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.829379081726074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2920, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.705988883972168  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.708378791809082  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.710066795349121  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.707592487335205  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11327, 40])
input nodes number: 41172
output nodes number: 11327
edges number: 137669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.707728385925293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0155029296875 GB
    Memory Allocated: 4.707728862762451  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.055637359619140625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.055637359619140625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.055637359619140625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017763614654541016 |0.002013087272644043 |0.12468922138214111 |9.566545486450195e-05 |0.08037912845611572 |0.0053253173828125 |
----------------------------------------------------------pseudo_mini_loss sum 4.6161274909973145
Total (block generation + training)time/epoch 25.327532529830933
Training time/epoch 1.8514337539672852
Training time without block to device /epoch 1.8353290557861328
Training time without total dataloading part /epoch 1.6466374397277832
load block tensor time/epoch 0.14210891723632812
block to device time/epoch 0.016104698181152344
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  666740
Number of first layer input nodes during this epoch:  428955
Number of first layer output nodes during this epoch:  237785
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05563688278198242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01625227928161621
global_2_local spend time (sec) 0.05008554458618164
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.005372762680053711
A = g.adjacency_matrix() spent  0.014018535614013672
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08962106704711914
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3702411651611328
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1916143894195557

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 18726793, 2.0: 3227048, 3.0: 807585, 4.0: 243406, 5.0: 88339, 6.0: 38420, 7.0: 17657, 8.0: 9197, 9.0: 4921, 10.0: 2773, 11.0: 1643, 12.0: 917, 13.0: 542, 14.0: 332, 15.0: 191, 16.0: 175, 17.0: 133, 18.0: 67, 19.0: 35, 20.0: 12, 21.0: 6})[05:08:34] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 27803442 edges into 8 parts and get 3967635 edge cuts

Convert a graph into a bidirected graph: 1.219 seconds
Metis partitioning: 5.410 seconds
Split the graph: 1.623 seconds
Construct subgraphs: 0.059 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.334123849868774
11570
11610
11230
11257
11278
11251
11036
11709
total k batches seeds list generation spend  20.79996395111084
after graph partition
graph partition algorithm spend time 20.918669939041138
11570
11610
11230
11257
11278
11251
11036
11709
partition_len_list
[20064, 24204, 19966, 20374, 26955, 29906, 44144, 42231]
shared_neighbor_graph_partition_s0 selection method  spend 21.028093099594116
time for parepare:  0.017596721649169922
local_output_nid generation:  0.0023851394653320312
local_in_edges_tensor generation:  0.0025293827056884766
mini_batch_src_global generation:  0.010038375854492188
r_  generation:  0.036499738693237305
local_output_nid generation:  0.003487825393676758
local_in_edges_tensor generation:  0.002527952194213867
mini_batch_src_global generation:  0.011487483978271484
r_  generation:  0.05669736862182617
local_output_nid generation:  0.0034797191619873047
local_in_edges_tensor generation:  0.0029740333557128906
mini_batch_src_global generation:  0.0043981075286865234
r_  generation:  0.03248786926269531
local_output_nid generation:  0.002981424331665039
local_in_edges_tensor generation:  0.002235889434814453
mini_batch_src_global generation:  0.003518342971801758
r_  generation:  0.03050541877746582
local_output_nid generation:  0.0035316944122314453
local_in_edges_tensor generation:  0.0025720596313476562
mini_batch_src_global generation:  0.0028655529022216797
r_  generation:  0.02695941925048828
local_output_nid generation:  0.0029342174530029297
local_in_edges_tensor generation:  0.002170562744140625
mini_batch_src_global generation:  0.002766132354736328
r_  generation:  0.028491973876953125
local_output_nid generation:  0.002843618392944336
local_in_edges_tensor generation:  0.002401590347290039
mini_batch_src_global generation:  0.004110574722290039
r_  generation:  0.03892683982849121
local_output_nid generation:  0.0030946731567382812
local_in_edges_tensor generation:  0.0034799575805664062
mini_batch_src_global generation:  0.005817413330078125
r_  generation:  0.048085689544677734
----------------------check_connections_block total spend ----------------------------- 0.4878852367401123
generate_one_block  0.04447007179260254
generate_one_block  0.042151689529418945
generate_one_block  0.040767669677734375
generate_one_block  0.04189109802246094
generate_one_block  0.03580832481384277
generate_one_block  0.03594064712524414
generate_one_block  0.05821418762207031
generate_one_block  0.06846809387207031
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04168057441711426
gen group dst list time:  0.006642580032348633
time for parepare:  0.02059769630432129
local_output_nid generation:  0.0037751197814941406
local_in_edges_tensor generation:  0.018003225326538086
mini_batch_src_global generation:  0.00416111946105957
r_  generation:  0.041628360748291016
local_output_nid generation:  0.006439685821533203
local_in_edges_tensor generation:  0.005915641784667969
mini_batch_src_global generation:  0.00568842887878418
r_  generation:  0.05869150161743164
local_output_nid generation:  0.006377220153808594
local_in_edges_tensor generation:  0.004340410232543945
mini_batch_src_global generation:  0.004593372344970703
r_  generation:  0.04667401313781738
local_output_nid generation:  0.005380392074584961
local_in_edges_tensor generation:  0.0045969486236572266
mini_batch_src_global generation:  0.004349231719970703
r_  generation:  0.04876089096069336
local_output_nid generation:  0.006846427917480469
local_in_edges_tensor generation:  0.009088277816772461
mini_batch_src_global generation:  0.0073719024658203125
r_  generation:  0.06508207321166992
local_output_nid generation:  0.007867574691772461
local_in_edges_tensor generation:  0.009393453598022461
mini_batch_src_global generation:  0.008081912994384766
r_  generation:  0.07734012603759766
local_output_nid generation:  0.010476350784301758
local_in_edges_tensor generation:  0.014064311981201172
mini_batch_src_global generation:  0.014262914657592773
r_  generation:  0.13208961486816406
local_output_nid generation:  0.012234687805175781
local_in_edges_tensor generation:  0.011842012405395508
mini_batch_src_global generation:  0.01502680778503418
r_  generation:  0.13252806663513184
----------------------check_connections_block total spend ----------------------------- 0.9730610847473145
generate_one_block  0.05148506164550781
generate_one_block  0.07227802276611328
generate_one_block  0.05698537826538086
generate_one_block  0.05603790283203125
generate_one_block  0.08195328712463379
generate_one_block  0.0987844467163086
generate_one_block  0.18819832801818848
generate_one_block  0.15898633003234863
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05563688278198242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

connection checking time:  0.9730610847473145
block generation total time  0.7647087574005127
average batch blocks generation time:  0.09558859467506409
block dataloader generation time/epoch 23.63134503364563
pseudo mini batch 0 input nodes size: 31837
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04504585266113281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04504585266113281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.06067085266113281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.06075716018676758  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.028502464294433594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029845237731933594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029845237731933594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029845237731933594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([31837, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029845237731933594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2688, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0841379165649414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0841379165649414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2688, 128]), torch.Size([1, 2688, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0867013931274414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1080942153930664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2688, 128])
m.shape torch.Size([2702, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1093893051147461  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1093893051147461  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2702, 128]), torch.Size([1, 2702, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11241817474365234  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.15131664276123047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2702, 128])
m.shape torch.Size([2299, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.15331697463989258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.15331697463989258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2299, 128]), torch.Size([1, 2299, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.15588712692260742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.20522546768188477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2299, 128])
m.shape torch.Size([1922, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.20851421356201172  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.20851421356201172  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1922, 128]), torch.Size([1, 1922, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21034717559814453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2654256820678711  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1922, 128])
m.shape torch.Size([1669, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2691364288330078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2691364288330078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1669, 128]), torch.Size([1, 1669, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.27072811126708984  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.32802867889404297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1669, 128])
m.shape torch.Size([1347, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3310866355895996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3310866355895996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1347, 128]), torch.Size([1, 1347, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.33237123489379883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3889956474304199  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1347, 128])
m.shape torch.Size([1070, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3919248580932617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3919248580932617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3929452896118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.44446325302124023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([945, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4475579261779785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4475579261779785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 945, 128]), torch.Size([1, 945, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4484591484069824  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5003190040588379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 945, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5031814575195312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5031814575195312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5039176940917969  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.553192138671875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([4650, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5749969482421875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5749969482421875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 4650, 128]), torch.Size([1, 4650, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5794315338134766  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8944950103759766  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 4650, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8501543998718262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8696856498718262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8892168998718262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8695359230041504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([20064, 256])
first layer input nodes number: 31837
first layer output nodes number: 20064
edges number: 107602
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8894562721252441  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9089875221252441  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9137711524963379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9137711524963379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1929, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9857683181762695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9857683181762695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1929, 256]), torch.Size([1, 1929, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9894475936889648  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0196475982666016  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1929, 256])
m.shape torch.Size([1688, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.021512508392334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.021512508392334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1688, 256]), torch.Size([1, 1688, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.024916172027588  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0747361183166504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1688, 256])
m.shape torch.Size([1381, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0777883529663086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0777883529663086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1381, 256]), torch.Size([1, 1381, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0804662704467773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1416015625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1381, 256])
m.shape torch.Size([1055, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.143864631652832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.143864631652832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1055, 256]), torch.Size([1, 1055, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.146120548248291  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2085795402526855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1055, 256])
m.shape torch.Size([949, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2121343612670898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2121343612670898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 949, 256]), torch.Size([1, 949, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.213944435119629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2795486450195312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 949, 256])
m.shape torch.Size([701, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2826862335205078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2826862335205078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 701, 256]), torch.Size([1, 701, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2840232849121094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3446598052978516  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 701, 256])
m.shape torch.Size([570, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3478264808654785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3478264808654785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 570, 256]), torch.Size([1, 570, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3489136695861816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.403273105621338  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 570, 256])
m.shape torch.Size([485, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.406458854675293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.406458854675293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.407383918762207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.461390495300293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([416, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.464526653289795  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.464526653289795  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.465320110321045  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.517045497894287  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([347, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5203371047973633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5203371047973633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5209989547729492  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5681943893432617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([285, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5708765983581543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5708765983581543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5714201927185059  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6140542030334473  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([239, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6165390014648438  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6165390014648438  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.616994857788086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6557426452636719  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([196, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.657963752746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.657963752746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6583375930786133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6927309036254883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([166, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6947779655456543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6947779655456543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 166, 256]), torch.Size([1, 166, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6950945854187012  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7264399528503418  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 166, 256])
m.shape torch.Size([151, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7284588813781738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7284588813781738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7287468910217285  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7592759132385254  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([126, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7610697746276855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7610697746276855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.76131010055542  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7884669303894043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7898173332214355  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7898173332214355  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7899889945983887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8105883598327637  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([75, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.811800479888916  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.811800479888916  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.811943531036377  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.830111026763916  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([80, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.83150053024292  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.83150053024292  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.831653118133545  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.852099895477295  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([62, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8532156944274902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8532156944274902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8533339500427246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8700079917907715  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8709869384765625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8709869384765625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.871084213256836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8854808807373047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8864798545837402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8864798545837402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8865714073181152  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9007620811462402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9015345573425293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9015345573425293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9016051292419434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9130377769470215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9139251708984375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9139251708984375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.91400146484375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9268951416015625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([403, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9365406036376953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9365406036376953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 403, 256]), torch.Size([1, 403, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9373092651367188  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0733566284179688  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 403, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0139613151550293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.015754222869873  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0175938606262207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.015714645385742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11570, 40])
input nodes number: 20064
output nodes number: 11570
edges number: 72512
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0160555839538574  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.016056537628174  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03265094757080078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 1 input nodes size: 47988
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.028608322143554688  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.028608322143554688  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05149078369140625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05157756805419922  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03586626052856445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03767728805541992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03767728805541992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03767728805541992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([47988, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03767728805541992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2211, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11395025253295898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11395025253295898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2211, 128]), torch.Size([1, 2211, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11645841598510742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.13332700729370117  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2211, 128])
m.shape torch.Size([2450, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.13460922241210938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.13460922241210938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2450, 128]), torch.Size([1, 2450, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.13695335388183594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.17319488525390625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2450, 128])
m.shape torch.Size([2215, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.17553138732910156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.17553138732910156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2215, 128]), torch.Size([1, 2215, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1776437759399414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22663116455078125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2215, 128])
m.shape torch.Size([1975, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22974157333374023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22974157333374023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1975, 128]), torch.Size([1, 1975, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.23162508010864258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.28736066818237305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1975, 128])
m.shape torch.Size([1743, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2905745506286621  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2905745506286621  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1743, 128]), torch.Size([1, 1743, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2922368049621582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3520779609680176  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1743, 128])
m.shape torch.Size([1451, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.35539817810058594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.35539817810058594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3567819595336914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.41628456115722656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1282, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.41987180709838867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.41987180709838867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1282, 128]), torch.Size([1, 1282, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4210944175720215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4843010902404785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1282, 128])
m.shape torch.Size([1198, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.48825979232788086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.48825979232788086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1198, 128]), torch.Size([1, 1198, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.48940229415893555  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5546507835388184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1198, 128])
m.shape torch.Size([1007, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5584011077880859  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5584011077880859  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1007, 128]), torch.Size([1, 1007, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.559361457824707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6221356391906738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1007, 128])
m.shape torch.Size([8672, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6630067825317383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6630067825317383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 8672, 128]), torch.Size([1, 8672, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6712770462036133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2584657669067383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 8672, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1922578811645508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2153406143188477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2384233474731445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2151598930358887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([24204, 256])
first layer input nodes number: 47988
first layer output nodes number: 24204
edges number: 153418
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2387828826904297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2618656158447266  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2676362991333008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2676362991333008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1603, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.355909824371338  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.355909824371338  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1603, 256]), torch.Size([1, 1603, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3594841957092285  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3858799934387207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1603, 256])
m.shape torch.Size([1490, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.386784553527832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.386784553527832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1490, 256]), torch.Size([1, 1490, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.39080810546875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4357757568359375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1490, 256])
m.shape torch.Size([1187, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4376449584960938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4376449584960938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1187, 256]), torch.Size([1, 1187, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4400558471679688  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.492767333984375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1187, 256])
m.shape torch.Size([1032, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4956717491149902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4956717491149902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1032, 256]), torch.Size([1, 1032, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4977836608886719  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5552892684936523  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1032, 256])
m.shape torch.Size([839, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5583372116088867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5583372116088867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 839, 256]), torch.Size([1, 839, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5599374771118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6206512451171875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 839, 256])
m.shape torch.Size([656, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6236343383789062  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6236343383789062  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 656, 256]), torch.Size([1, 656, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6248855590820312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6874618530273438  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 656, 256])
m.shape torch.Size([558, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6905908584594727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6905908584594727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.691655158996582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.753535270690918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([523, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7570247650146484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7570247650146484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7580223083496094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8148822784423828  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([413, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8179564476013184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8179564476013184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.81874418258667  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.870333194732666  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([381, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8736014366149902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8736014366149902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8743281364440918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9277071952819824  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([295, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9304628372192383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9304628372192383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 295, 256]), torch.Size([1, 295, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.931025505065918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.975667953491211  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 295, 256])
m.shape torch.Size([270, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9785008430480957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9785008430480957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 270, 256]), torch.Size([1, 270, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.979015827178955  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0235066413879395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 270, 256])
m.shape torch.Size([229, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0261106491088867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0261106491088867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.026547431945801  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0667314529418945  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([204, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.069258213043213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.069258213043213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 204, 256]), torch.Size([1, 204, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0696473121643066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.108168125152588  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 204, 256])
m.shape torch.Size([203, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.110900402069092  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.110900402069092  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1112875938415527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.152329921722412  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1543354988098145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1543354988098145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1546082496643066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.185429096221924  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([139, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.187563896179199  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.187563896179199  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.18782901763916  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2196435928344727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.221552848815918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.221552848815918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.22177791595459  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.250361442565918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([99, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2520570755004883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2520570755004883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2522459030151367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2775487899780273  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([93, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.279242515563965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.279242515563965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2794198989868164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3044309616088867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3061184883117676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3061184883117676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.306286334991455  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.331127643585205  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.332798957824707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.332798957824707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3329572677612305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3574953079223633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([58, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.35890531539917  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.35890531539917  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.359015941619873  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3769373893737793  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3782200813293457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3782200813293457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.378330707550049  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.397026538848877  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([848, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4173474311828613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4173474311828613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 848, 256]), torch.Size([1, 848, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4189648628234863  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.708805561065674  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 848, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.632169246673584  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6340279579162598  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.636664867401123  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6347193717956543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11610, 40])
input nodes number: 24204
output nodes number: 11610
edges number: 89499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6350526809692383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6350531578063965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04125213623046875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 2 input nodes size: 34168
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.035932064056396484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.035932064056396484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05222463607788086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05230855941772461  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029339313507080078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03092813491821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03092813491821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03092813491821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([34168, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03092813491821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1881, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09260034561157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09260034561157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1881, 128]), torch.Size([1, 1881, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09439420700073242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.10874509811401367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1881, 128])
m.shape torch.Size([2174, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.10992145538330078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.10992145538330078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2174, 128]), torch.Size([1, 2174, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11306619644165039  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14519357681274414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2174, 128])
m.shape torch.Size([1892, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14654779434204102  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14654779434204102  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1892, 128]), torch.Size([1, 1892, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14835214614868164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1880478858947754  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1892, 128])
m.shape torch.Size([1686, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19036149978637695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19036149978637695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1919693946838379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.23859834671020508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1389, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2411060333251953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2411060333251953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1389, 128]), torch.Size([1, 1389, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2424306869506836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.29045581817626953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1389, 128])
m.shape torch.Size([1256, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.29338693618774414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.29338693618774414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1256, 128]), torch.Size([1, 1256, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2945847511291504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.34609079360961914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1256, 128])
m.shape torch.Size([1100, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3491635322570801  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3491635322570801  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1100, 128]), torch.Size([1, 1100, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.35021257400512695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.40482187271118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1100, 128])
m.shape torch.Size([977, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.40802431106567383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.40802431106567383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 977, 128]), torch.Size([1, 977, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.40895605087280273  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46419191360473633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 977, 128])
m.shape torch.Size([813, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46721506118774414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46721506118774414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 813, 128]), torch.Size([1, 813, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4679903984069824  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5185041427612305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 813, 128])
m.shape torch.Size([6798, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5513195991516113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5513195991516113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 6798, 128]), torch.Size([1, 6798, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.557802677154541  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0189213752746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 6798, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9658136367797852  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9853448867797852  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0048761367797852  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9851961135864258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([19966, 256])
first layer input nodes number: 34168
first layer output nodes number: 19966
edges number: 123943
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0051326751708984  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0246639251708984  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0294241905212402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0294241905212402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1385, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.116948127746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.116948127746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1385, 256]), torch.Size([1, 1385, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.119734764099121  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1415114402770996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1385, 256])
m.shape torch.Size([1384, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1428532600402832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1428532600402832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1384, 256]), torch.Size([1, 1384, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1455111503601074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.185305118560791  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1384, 256])
m.shape torch.Size([1133, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1870932579040527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1870932579040527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1133, 256]), torch.Size([1, 1133, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1894330978393555  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2392826080322266  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1133, 256])
m.shape torch.Size([961, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2416958808898926  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2416958808898926  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 961, 256]), torch.Size([1, 961, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2435288429260254  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2976279258728027  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 961, 256])
m.shape torch.Size([798, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.300546646118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.300546646118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 798, 256]), torch.Size([1, 798, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3020687103271484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.356863021850586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 798, 256])
m.shape torch.Size([702, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3601503372192383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3601503372192383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 702, 256]), torch.Size([1, 702, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3614892959594727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4202852249145508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 702, 256])
m.shape torch.Size([582, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4235315322875977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4235315322875977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 582, 256]), torch.Size([1, 582, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4246416091918945  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4807767868041992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 582, 256])
m.shape torch.Size([484, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4839434623718262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4839434623718262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 484, 256]), torch.Size([1, 484, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4848666191101074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5379223823547363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 484, 256])
m.shape torch.Size([421, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5411028861999512  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5411028861999512  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 421, 256]), torch.Size([1, 421, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5419058799743652  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5937209129333496  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 421, 256])
m.shape torch.Size([382, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5969910621643066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5969910621643066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.597719669342041  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6506390571594238  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 382, 256])
m.shape torch.Size([339, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6538591384887695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6538591384887695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 339, 256]), torch.Size([1, 339, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.654505729675293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7053165435791016  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 339, 256])
m.shape torch.Size([277, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7081880569458008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7081880569458008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 277, 256]), torch.Size([1, 277, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7087163925170898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7557649612426758  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 277, 256])
m.shape torch.Size([254, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7586746215820312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7586746215820312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7591590881347656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8037300109863281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([213, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.80635404586792  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.80635404586792  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.806760311126709  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8469805717468262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([158, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8490557670593262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8490557670593262  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8493571281433105  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8813014030456543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8834881782531738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8834881782531738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8837780952453613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9165387153625488  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([152, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9188776016235352  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9188776016235352  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9191675186157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9539575576782227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([135, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9561481475830078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9561481475830078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9564056396484375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9891071319580078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([107, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9909324645996094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9909324645996094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9911365509033203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.018484115600586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([116, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0206122398376465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0206122398376465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0208334922790527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.052030086517334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0539379119873047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0539379119873047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.054128646850586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.082357406616211  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0841898918151855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0841898918151855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.084336757659912  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1071009635925293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([72, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.108619213104248  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.108619213104248  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1087565422058105  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1310038566589355  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1333842277526855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1333842277526855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.133513927459717  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.155433177947998  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([778, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1740622520446777  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1740622520446777  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 778, 256]), torch.Size([1, 778, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.175546169281006  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.436715602874756  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 778, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.361191749572754  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3629159927368164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.364640235900879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3628320693969727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11230, 40])
input nodes number: 19966
output nodes number: 11230
edges number: 89191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3629302978515625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3629307746887207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0338740348815918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 3 input nodes size: 32282
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029204845428466797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.029204845428466797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0448298454284668  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04491376876831055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.028537273406982422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.030120372772216797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.030120372772216797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.030120372772216797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([32282, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.030120372772216797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2262, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09194040298461914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09194040298461914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2262, 128]), torch.Size([1, 2262, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.09409761428833008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11229801177978516  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2262, 128])
m.shape torch.Size([2205, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11238956451416016  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11238956451416016  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2205, 128]), torch.Size([1, 2205, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.11449241638183594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1471104621887207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2205, 128])
m.shape torch.Size([2007, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1480250358581543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1480250358581543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2007, 128]), torch.Size([1, 2007, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14993906021118164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19236040115356445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2007, 128])
m.shape torch.Size([1657, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1945638656616211  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1945638656616211  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1657, 128]), torch.Size([1, 1657, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19614410400390625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.24197101593017578  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1657, 128])
m.shape torch.Size([1482, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.24471426010131836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.24471426010131836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1482, 128]), torch.Size([1, 1482, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.24612760543823242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2982621192932129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1482, 128])
m.shape torch.Size([1213, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3010258674621582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3010258674621582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1213, 128]), torch.Size([1, 1213, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.302182674407959  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3519253730773926  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1213, 128])
m.shape torch.Size([1030, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3554039001464844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3554039001464844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1030, 128]), torch.Size([1, 1030, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3563861846923828  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4056386947631836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1030, 128])
m.shape torch.Size([908, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4089851379394531  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4089851379394531  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 908, 128]), torch.Size([1, 908, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.40985107421875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46002721786499023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 908, 128])
m.shape torch.Size([746, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4627957344055176  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4627957344055176  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 746, 128]), torch.Size([1, 746, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46350717544555664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5091080665588379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 746, 128])
m.shape torch.Size([6864, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5419554710388184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5419554710388184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 6864, 128]), torch.Size([1, 6864, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5494704246520996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.014237880706787  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 6864, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9612421989440918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9807734489440918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0003046989440918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.980621337890625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([20374, 256])
first layer input nodes number: 32282
first layer output nodes number: 20374
edges number: 123837
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0005474090576172  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0200786590576172  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0249361991882324  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.0249361991882324  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1723, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1129851341247559  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1129851341247559  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1723, 256]), torch.Size([1, 1723, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1461215019226074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1723, 256])
m.shape torch.Size([1402, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1476655006408691  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1476655006408691  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1402, 256]), torch.Size([1, 1402, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1504225730895996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1915616989135742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1402, 256])
m.shape torch.Size([1208, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1932158470153809  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1932158470153809  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1208, 256]), torch.Size([1, 1208, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.1968741416931152  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2506985664367676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1208, 256])
m.shape torch.Size([917, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2530722618103027  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2530722618103027  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 917, 256]), torch.Size([1, 917, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.2548213005065918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3055434226989746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 917, 256])
m.shape torch.Size([767, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3083548545837402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3083548545837402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 767, 256]), torch.Size([1, 767, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3098177909851074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3656220436096191  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 767, 256])
m.shape torch.Size([605, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3683795928955078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3683795928955078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 605, 256]), torch.Size([1, 605, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3695335388183594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4191532135009766  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 605, 256])
m.shape torch.Size([521, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.422081470489502  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.422081470489502  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 521, 256]), torch.Size([1, 521, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4230751991271973  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.474210262298584  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 521, 256])
m.shape torch.Size([443, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4771199226379395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4771199226379395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 443, 256]), torch.Size([1, 443, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4779648780822754  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5270695686340332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 443, 256])
m.shape torch.Size([373, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5298738479614258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5298738479614258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 373, 256]), torch.Size([1, 373, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5305852890014648  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5763578414916992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 373, 256])
m.shape torch.Size([333, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5792031288146973  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5792031288146973  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5798382759094238  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.625410556793213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([292, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6281805038452148  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6281805038452148  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.628737449645996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6734142303466797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([247, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6759848594665527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6759848594665527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 247, 256]), torch.Size([1, 247, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6764559745788574  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7165007591247559  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 247, 256])
m.shape torch.Size([200, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.718764305114746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.718764305114746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7191457748413086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7542409896850586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([192, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7566337585449219  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7566337585449219  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7569999694824219  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7932548522949219  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([179, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7956523895263672  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7956523895263672  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7959938049316406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.832183837890625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([139, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.834150791168213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.834150791168213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8344159126281738  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8643746376037598  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8667912483215332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8667912483215332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.867088794708252  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.902794361114502  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([108, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9048833847045898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9048833847045898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9050893783569336  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9312505722045898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9329190254211426  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9329190254211426  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9331040382385254  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9578957557678223  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([111, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9599370956420898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9599370956420898  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.960148811340332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9900007247924805  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([100, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9919133186340332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9919133186340332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9921040534973145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0203328132629395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0215063095092773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0215063095092773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.021620750427246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0393590927124023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([70, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0408496856689453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0408496856689453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.040983200073242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.062612533569336  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0640454292297363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0640454292297363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.064169406890869  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0851216316223145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([949, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1078624725341797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1078624725341797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 949, 256]), torch.Size([1, 949, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1096725463867188  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.428295135498047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 949, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.353492259979248  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.355623722076416  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3573012351989746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.355085849761963  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11257, 40])
input nodes number: 20374
output nodes number: 11257
edges number: 88509
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.355729103088379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.355729579925537  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.03359413146972656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 4 input nodes size: 53914
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.02894449234008789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.02894449234008789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05465269088745117  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.054737091064453125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.039028167724609375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([53914, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04083442687988281  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2917, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.12560176849365234  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.12560176849365234  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2917, 128]), torch.Size([1, 2917, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.12838363647460938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.15182113647460938  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2917, 128])
m.shape torch.Size([2883, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1532120704650879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1532120704650879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2883, 128]), torch.Size([1, 2883, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1559615135192871  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1977062225341797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2883, 128])
m.shape torch.Size([2422, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19979619979858398  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.19979619979858398  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2422, 128]), torch.Size([1, 2422, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2023024559020996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2568373680114746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2422, 128])
m.shape torch.Size([1996, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2585468292236328  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2585468292236328  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1996, 128]), torch.Size([1, 1996, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2604503631591797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.31644630432128906  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1996, 128])
m.shape torch.Size([1781, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.31974077224731445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.31974077224731445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1781, 128]), torch.Size([1, 1781, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.321439266204834  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.38345956802368164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1781, 128])
m.shape torch.Size([1453, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3867673873901367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3867673873901367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1453, 128]), torch.Size([1, 1453, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.388153076171875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.44835758209228516  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1453, 128])
m.shape torch.Size([1273, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.45191383361816406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.45191383361816406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1273, 128]), torch.Size([1, 1273, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4531278610229492  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.513829231262207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1273, 128])
m.shape torch.Size([1111, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5174603462219238  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5174603462219238  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1111, 128]), torch.Size([1, 1111, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5185198783874512  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5812878608703613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1111, 128])
m.shape torch.Size([976, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5857877731323242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5857877731323242  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5867185592651367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6483817100524902  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([10143, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.696281909942627  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.696281909942627  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 10143, 128]), torch.Size([1, 10143, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7059550285339355  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.399406909942627  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 10143, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3258733749389648  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3515796661376953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3772859573364258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3513784408569336  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([26955, 256])
first layer input nodes number: 53914
first layer output nodes number: 26955
edges number: 169569
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.3776898384094238  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4033961296081543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.410074234008789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.410074234008789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2104, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4833898544311523  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4833898544311523  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2104, 256]), torch.Size([1, 2104, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4877586364746094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5208773612976074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2104, 256])
m.shape torch.Size([1736, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5229101181030273  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5229101181030273  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1736, 256]), torch.Size([1, 1736, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5264463424682617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.579026222229004  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1736, 256])
m.shape torch.Size([1257, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5809950828552246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5809950828552246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1257, 256]), torch.Size([1, 1257, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5836901664733887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6390953063964844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1257, 256])
m.shape torch.Size([981, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6422719955444336  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6422719955444336  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 981, 256]), torch.Size([1, 981, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6441431045532227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6992254257202148  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 981, 256])
m.shape torch.Size([853, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7028841972351074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7028841972351074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7045111656188965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7630972862243652  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([630, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7659173011779785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7659173011779785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 630, 256]), torch.Size([1, 630, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7671189308166504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.819399356842041  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 630, 256])
m.shape torch.Size([540, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.822432041168213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.822432041168213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 540, 256]), torch.Size([1, 540, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8234620094299316  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8749604225158691  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 540, 256])
m.shape torch.Size([439, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8778209686279297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8778209686279297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8786582946777344  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9272441864013672  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([342, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9297842979431152  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9297842979431152  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 342, 256]), torch.Size([1, 342, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.930436611175537  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9735560417175293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 342, 256])
m.shape torch.Size([286, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9759788513183594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9759788513183594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 286, 256]), torch.Size([1, 286, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9765243530273438  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.015834331512451  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 286, 256])
m.shape torch.Size([241, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0181097984313965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0181097984313965  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 241, 256]), torch.Size([1, 241, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0185694694519043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0544238090515137  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 241, 256])
m.shape torch.Size([201, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0565123558044434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0565123558044434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0568957328796387  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0894827842712402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([175, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.091477870941162  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.091477870941162  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0918116569519043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1225199699401855  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([146, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1243176460266113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1243176460266113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.124596118927002  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.152164936065674  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([107, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.153568744659424  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.153568744659424  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1537728309631348  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.175405979156494  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([107, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.177824020385742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.177824020385742  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.178028106689453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.201089859008789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([92, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.202491283416748  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.202491283416748  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.202666759490967  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.223723888397217  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([96, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.225296974182129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.225296974182129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.225480079650879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.248734474182129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([80, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2501039505004883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2501039505004883  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2502565383911133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2707033157348633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([72, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2720112800598145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2720112800598145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.272148609161377  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2915120124816895  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([49, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.292435646057129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.292435646057129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2925291061401367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.306361198425293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3075408935546875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3075408935546875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3076515197753906  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.324798583984375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([36, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3255391120910645  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3255391120910645  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3256077766418457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.336731433868408  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([52, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3378968238830566  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3378968238830566  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.337996006011963  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.354757785797119  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([598, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.369077205657959  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.369077205657959  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.370217800140381  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5722689628601074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 598, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.511256217956543  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5132932662963867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5149741172790527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.512852668762207  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11278, 40])
input nodes number: 26955
output nodes number: 11278
edges number: 72828
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5130438804626465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5130443572998047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04422140121459961  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 5 input nodes size: 64361
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.038933753967285156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.038933753967285156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.06962347030639648  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.06970739364624023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.043914794921875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04588508605957031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04588508605957031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04588508605957031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([64361, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04588508605957031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2904, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14087724685668945  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.14087724685668945  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2904, 128]), torch.Size([1, 2904, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1436467170715332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1664433479309082  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2904, 128])
m.shape torch.Size([3071, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.16798734664916992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.16798734664916992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 3071, 128]), torch.Size([1, 3071, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.1714773178100586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21541213989257812  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 3071, 128])
m.shape torch.Size([2701, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21785783767700195  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21785783767700195  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2701, 128]), torch.Size([1, 2701, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2206273078918457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.27820491790771484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2701, 128])
m.shape torch.Size([2299, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.28206872940063477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.28206872940063477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2299, 128]), torch.Size([1, 2299, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.28429365158081055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3492097854614258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2299, 128])
m.shape torch.Size([1989, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3535947799682617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3535947799682617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1989, 128]), torch.Size([1, 1989, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.35549163818359375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4251289367675781  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1989, 128])
m.shape torch.Size([1665, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.42894411087036133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.42894411087036133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1665, 128]), torch.Size([1, 1665, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.43053197860717773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4988102912902832  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1665, 128])
m.shape torch.Size([1444, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5028362274169922  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5028362274169922  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1444, 128]), torch.Size([1, 1444, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5042133331298828  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5735721588134766  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1444, 128])
m.shape torch.Size([1317, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5779075622558594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5779075622558594  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1317, 128]), torch.Size([1, 1317, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5791635513305664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6524829864501953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1317, 128])
m.shape torch.Size([1114, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6566357612609863  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6566357612609863  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1114, 128]), torch.Size([1, 1114, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6576981544494629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.727048397064209  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1114, 128])
m.shape torch.Size([11402, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7812047004699707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7812047004699707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 11402, 128]), torch.Size([1, 11402, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7920784950256348  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5695128440856934  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 11402, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.4858503341674805  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5143709182739258  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.542891502380371  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5141477584838867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([29906, 256])
first layer input nodes number: 64361
first layer output nodes number: 29906
edges number: 190970
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5433731079101562  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.5718936920166016  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.579023838043213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.579023838043213  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2007, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.652867317199707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.652867317199707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2007, 256]), torch.Size([1, 2007, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6566953659057617  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6873197555541992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2007, 256])
m.shape torch.Size([1728, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6892309188842773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6892309188842773  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1728, 256]), torch.Size([1, 1728, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.6926593780517578  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7430343627929688  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1728, 256])
m.shape torch.Size([1314, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7449779510498047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.7449779510498047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1314, 256]), torch.Size([1, 1314, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.747572422027588  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8046774864196777  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1314, 256])
m.shape torch.Size([1009, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8075690269470215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8075690269470215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1009, 256]), torch.Size([1, 1009, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8094935417175293  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8655905723571777  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1009, 256])
m.shape torch.Size([817, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8685545921325684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8685545921325684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 817, 256]), torch.Size([1, 817, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.8701128959655762  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9281058311462402  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 817, 256])
m.shape torch.Size([624, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9309253692626953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9309253692626953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 624, 256]), torch.Size([1, 624, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9321155548095703  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.983987808227539  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 624, 256])
m.shape torch.Size([500, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9867568016052246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9867568016052246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 500, 256]), torch.Size([1, 500, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 1.9877104759216309  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.036102771759033  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 500, 256])
m.shape torch.Size([449, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.039078712463379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.039078712463379  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.0399351119995117  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.09078311920166  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([358, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.093451976776123  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.093451976776123  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 358, 256]), torch.Size([1, 358, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.09413480758667  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1387414932250977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 358, 256])
m.shape torch.Size([285, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.141139507293701  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.141139507293701  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1416831016540527  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1808104515075684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([236, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1830339431762695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1830339431762695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.1834840774536133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.218594551086426  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([207, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.220757007598877  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.220757007598877  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 207, 256]), torch.Size([1, 207, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.221151828765869  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.254711627960205  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 207, 256])
m.shape torch.Size([186, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.256838321685791  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.256838321685791  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.257193088531494  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2898316383361816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([142, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.291565418243408  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.291565418243408  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.2918362617492676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3186497688293457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([131, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3204030990600586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3204030990600586  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.320652961730957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3471384048461914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3488283157348633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3488283157348633  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.349053382873535  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.374485969543457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([109, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3761544227600098  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3761544227600098  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.3763623237609863  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.401310443878174  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([98, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.402902126312256  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.402902126312256  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4030890464782715  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.426827907562256  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([74, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4280858039855957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4280858039855957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.428226947784424  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4471402168273926  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4484729766845703  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4484729766845703  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4486122131347656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4682445526123047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4693703651428223  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4693703651428223  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4694771766662598  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4852852821350098  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4860358238220215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4860358238220215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.4861083030700684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.497342586517334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.498363494873047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.498363494873047  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.498453140258789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5129756927490234  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5138306617736816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5138306617736816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5139050483703613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5264763832092285  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([606, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5410003662109375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.5410003662109375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 606, 256]), torch.Size([1, 606, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.542156219482422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.745624542236328  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 606, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6846060752868652  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6862826347351074  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6879591941833496  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6861987113952637  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11251, 40])
input nodes number: 29906
output nodes number: 11251
edges number: 73435
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6869702339172363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6869707107543945  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05014228820800781  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 6 input nodes size: 76594
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.044379234313964844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.044379234313964844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.080902099609375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.08098459243774414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05021095275878906  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05368328094482422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05368328094482422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05368328094482422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([76594, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05368328094482422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([2259, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22590112686157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22590112686157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2259, 128]), torch.Size([1, 2259, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.22821426391601562  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.24707508087158203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2259, 128])
m.shape torch.Size([2393, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2481522560119629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2481522560119629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2393, 128]), torch.Size([1, 2393, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.25043439865112305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2857656478881836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2393, 128])
m.shape torch.Size([2175, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2877359390258789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2877359390258789  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2175, 128]), torch.Size([1, 2175, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2899141311645508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.33700084686279297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2175, 128])
m.shape torch.Size([1907, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3396010398864746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3396010398864746  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1907, 128]), torch.Size([1, 1907, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.34141969680786133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3942141532897949  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1907, 128])
m.shape torch.Size([1848, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.39801788330078125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.39801788330078125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1848, 128]), torch.Size([1, 1848, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3997802734375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.463226318359375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1848, 128])
m.shape torch.Size([1683, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4673957824707031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4673957824707031  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1683, 128]), torch.Size([1, 1683, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.46900081634521484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5380172729492188  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1683, 128])
m.shape torch.Size([1631, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.542658805847168  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.542658805847168  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1631, 128]), torch.Size([1, 1631, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5442142486572266  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6229186058044434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1631, 128])
m.shape torch.Size([1509, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6278972625732422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6278972625732422  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1509, 128]), torch.Size([1, 1509, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6293363571166992  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.71136474609375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1509, 128])
m.shape torch.Size([1575, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7174043655395508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7174043655395508  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1575, 128]), torch.Size([1, 1575, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7189064025878906  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8150367736816406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1575, 128])
m.shape torch.Size([27164, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9438138008117676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.9438138008117676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 27164, 128]), torch.Size([1, 27164, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.969719409942627  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.8265576362609863  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 27164, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6669411659240723  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.7090401649475098  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.7511391639709473  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.7087111473083496  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([44144, 256])
first layer input nodes number: 76594
first layer output nodes number: 44144
edges number: 349840
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.751711845397949  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.7938108444213867  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.804335594177246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.804335594177246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1475, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.917792320251465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.917792320251465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1475, 256]), torch.Size([1, 1475, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9208059310913086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9474000930786133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1475, 256])
m.shape torch.Size([1255, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9481945037841797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9481945037841797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1255, 256]), torch.Size([1, 1255, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.950662612915039  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9877376556396484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1255, 256])
m.shape torch.Size([948, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.989017963409424  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.989017963409424  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 948, 256]), torch.Size([1, 948, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.99082612991333  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0313305854797363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 948, 256])
m.shape torch.Size([681, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.033231735229492  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.033231735229492  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 681, 256]), torch.Size([1, 681, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0345306396484375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0755348205566406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 681, 256])
m.shape torch.Size([601, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0778698921203613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0778698921203613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 601, 256]), torch.Size([1, 601, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0790162086486816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1249914169311523  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 601, 256])
m.shape torch.Size([471, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1271347999572754  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1271347999572754  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 471, 256]), torch.Size([1, 471, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.12803316116333  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1682968139648438  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 471, 256])
m.shape torch.Size([380, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1711997985839844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1711997985839844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.171924591064453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.210634231567383  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([312, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2126708030700684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2126708030700684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.213265895843506  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2471861839294434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([319, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.249648094177246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.249648094177246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 319, 256]), torch.Size([1, 319, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2502565383911133  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2893619537353516  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 319, 256])
m.shape torch.Size([276, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.29171085357666  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.29171085357666  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 276, 256]), torch.Size([1, 276, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2922372817993164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3312482833862305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 276, 256])
m.shape torch.Size([244, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3335647583007812  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3335647583007812  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3340301513671875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.370330810546875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([224, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3726816177368164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3726816177368164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3731088638305664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4094247817993164  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([187, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4115476608276367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4115476608276367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4119043350219727  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.444718360900879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([174, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4468817710876465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4468817710876465  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.447213649749756  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.480069637298584  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([179, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4824843406677246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4824843406677246  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 179, 256]), torch.Size([1, 179, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.482825756072998  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5190157890319824  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 179, 256])
m.shape torch.Size([143, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5210442543029785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5210442543029785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5213170051574707  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.552137851715088  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([131, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5541419982910156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5541419982910156  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.554391860961914  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5843753814697266  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([142, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.58670711517334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.58670711517334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.586977958679199  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.62137508392334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6237783432006836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6237783432006836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6240434646606445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.65956974029541  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([123, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.661801815032959  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.661801815032959  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.662036418914795  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.695115566253662  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([128, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6975817680358887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6975817680358887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6978259086608887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7339587211608887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([98, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7359089851379395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7359089851379395  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.736095905303955  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.765068531036377  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.766836166381836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.766836166381836  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.766986846923828  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7913970947265625  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.793259620666504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.793259620666504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.79341983795166  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.8204965591430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([2243, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.874311923980713  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.874311923980713  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 2243, 256]), torch.Size([1, 2243, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.8785901069641113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.641056537628174  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 2243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.537270545959473  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.539061546325684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.5411787033081055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.539305210113525  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([11036, 40])
input nodes number: 44144
output nodes number: 11036
edges number: 116019
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.539006233215332  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 4.53900671005249  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.05899190902709961  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

pseudo mini batch 7 input nodes size: 68616
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.049500465393066406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.049500465393066406  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.0827035903930664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.08279085159301758  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04618549346923828  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04980945587158203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04980945587158203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04980945587158203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([68616, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.04980945587158203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1852, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21884393692016602  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.21884393692016602  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1852, 128]), torch.Size([1, 1852, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2206101417541504  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2347397804260254  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1852, 128])
m.shape torch.Size([1932, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.23569917678833008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.23569917678833008  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1932, 128]), torch.Size([1, 1932, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.23754167556762695  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.2668118476867676  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1932, 128])
m.shape torch.Size([1837, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.26851844787597656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.26851844787597656  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1837, 128]), torch.Size([1, 1837, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.27027034759521484  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.30881214141845703  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1837, 128])
m.shape torch.Size([1718, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.31121301651000977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.31121301651000977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1718, 128]), torch.Size([1, 1718, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3128514289855957  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3603653907775879  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1718, 128])
m.shape torch.Size([1640, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.36345624923706055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.36345624923706055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1640, 128]), torch.Size([1, 1640, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.3650202751159668  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4213252067565918  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1640, 128])
m.shape torch.Size([1569, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4250321388244629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4250321388244629  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1569, 128]), torch.Size([1, 1569, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4265284538269043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4925541877746582  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1569, 128])
m.shape torch.Size([1465, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.49669599533081055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.49669599533081055  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1465, 128]), torch.Size([1, 1465, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.4980931282043457  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.568809986114502  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1465, 128])
m.shape torch.Size([1408, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5734825134277344  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5734825134277344  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.5748252868652344  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6513633728027344  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1408, 128])
m.shape torch.Size([1380, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6566143035888672  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6566143035888672  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1380, 128]), torch.Size([1, 1380, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.6579303741455078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.7421588897705078  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1380, 128])
m.shape torch.Size([27430, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8723602294921875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8723602294921875  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 27430, 128]), torch.Size([1, 27430, 128])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 0.8985195159912109  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.7637290954589844  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 27430, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.605985641479492  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6462602615356445  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.686534881591797  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6459455490112305  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

torch.Size([42231, 256])
first layer input nodes number: 68616
first layer output nodes number: 42231
edges number: 343952
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.6870484352111816  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.727323055267334  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.737391948699951  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.737391948699951  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

m.shape torch.Size([1202, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.8757996559143066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.8757996559143066  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1202, 256]), torch.Size([1, 1202, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.879019260406494  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9001708030700684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1202, 256])
m.shape torch.Size([1023, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.900512218475342  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.900512218475342  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 1023, 256]), torch.Size([1, 1023, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.902463436126709  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.931731700897217  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 1023, 256])
m.shape torch.Size([849, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.933239459991455  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.933239459991455  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 849, 256]), torch.Size([1, 849, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.934858798980713  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.971065044403076  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 849, 256])
m.shape torch.Size([684, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9734888076782227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9734888076782227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 684, 256]), torch.Size([1, 684, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 2.9747934341430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0168533325195312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 684, 256])
m.shape torch.Size([598, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0190749168395996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0190749168395996  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 598, 256]), torch.Size([1, 598, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.0202155113220215  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.062784194946289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 598, 256])
m.shape torch.Size([479, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.064976215362549  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.064976215362549  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 479, 256]), torch.Size([1, 479, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.065889835357666  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1130709648132324  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 479, 256])
m.shape torch.Size([394, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.115265369415283  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.115265369415283  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 394, 256]), torch.Size([1, 394, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1160168647766113  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1543326377868652  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 394, 256])
m.shape torch.Size([337, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.156975746154785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.156975746154785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 337, 256]), torch.Size([1, 337, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.157618522644043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.194504737854004  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 337, 256])
m.shape torch.Size([334, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1970725059509277  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.1970725059509277  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.197709560394287  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.238900661468506  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([309, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2415523529052734  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2415523529052734  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2421417236328125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.285278797149658  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([271, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2878494262695312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2878494262695312  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 271, 256]), torch.Size([1, 271, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.2883663177490234  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.329965591430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 271, 256])
m.shape torch.Size([272, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3328442573547363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3328442573547363  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 272, 256]), torch.Size([1, 272, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3333630561828613  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.3791890144348145  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 272, 256])
m.shape torch.Size([229, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.381791114807129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.381791114807129  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 229, 256]), torch.Size([1, 229, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.382227897644043  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4224119186401367  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 229, 256])
m.shape torch.Size([197, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.424844741821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.424844741821289  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 197, 256]), torch.Size([1, 197, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.425220489501953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.4624195098876953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 197, 256])
m.shape torch.Size([181, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.464841365814209  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.464841365814209  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 181, 256]), torch.Size([1, 181, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.465186595916748  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5017809867858887  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 181, 256])
m.shape torch.Size([183, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5048022270202637  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5048022270202637  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 183, 256]), torch.Size([1, 183, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5051512718200684  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.544593334197998  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 183, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5470495223999023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5470495223999023  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.547356605529785  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5842065811157227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([176, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5870981216430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5870981216430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.5874338150024414  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6300668716430664  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([160, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6328210830688477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6328210830688477  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6331262588500977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6740198135375977  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([157, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6768856048583984  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.6768856048583984  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.67718505859375  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7194080352783203  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([145, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7221851348876953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7221851348876953  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes
Using backend: pytorch

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.722461700439453  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7633934020996094  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([94, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7652430534362793  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7652430534362793  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7654223442077637  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.793212413787842  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([120, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.796273708343506  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.796273708343506  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.7965025901794434  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.8335814476013184  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([119, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.836212158203125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.836212158203125  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 8.0174560546875 GB
    Memory Allocated: 3.8364391326904297  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 3.874797821044922  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([3035, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 3.9476099014282227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 3.9476099014282227  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

 h.shape torch.Size([1, 3035, 256]), torch.Size([1, 3035, 256])
----------------------------------------3
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 3.9533987045288086  GigaBytes
Max Memory Allocated: 4.8989973068237305  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.972620964050293  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

rst.shape  torch.Size([1, 3035, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.844362258911133  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.846136569976807  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.848301410675049  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.846439838409424  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

torch.Size([11709, 40])
input nodes number: 42231
output nodes number: 11709
edges number: 142257
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.846825122833252  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0194091796875 GB
    Memory Allocated: 4.84682559967041  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1600341796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.1600341796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.1600341796875 GB
    Memory Allocated: 0.05606412887573242  GigaBytes
Max Memory Allocated: 5.044981002807617  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02177572250366211 |0.003241509199142456 |0.12607070803642273 |9.968876838684082e-05 |0.07691150903701782 |0.004715442657470703 |
----------------------------------------------------------pseudo_mini_loss sum 3.6591079235076904
Total (block generation + training)time/epoch 25.497158408164978
Training time/epoch 1.8795409202575684
Training time without block to device /epoch 1.8536088466644287
Training time without total dataloading part /epoch 1.6293706893920898
load block tensor time/epoch 0.17420578002929688
block to device time/epoch 0.02593207359313965
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  637604
Number of first layer input nodes during this epoch:  409760
Number of first layer output nodes during this epoch:  227844
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
