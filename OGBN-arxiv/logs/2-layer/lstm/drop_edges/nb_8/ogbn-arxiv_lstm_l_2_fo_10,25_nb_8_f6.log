[05:14:29] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28897942 edges into 8 parts and get 4581936 edge cuts
main start at this time 1651554848.5169868
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03446006774902344
global_2_local spend time (sec) 0.036042213439941406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004846334457397461
A = g.adjacency_matrix() spent  0.007581233978271484
auxiliary_graph
Graph(num_nodes=154565, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08901453018188477
remove nodes length
63624
auxiliary_graph.remove_nodes spent  1.3134160041809082
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=28988883,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2003576755523682

the counter of shared neighbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
28897942
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28897939, 28897940, 28897941])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23358328, 2.0: 4020686, 3.0: 1008366, 4.0: 304322, 5.0: 110088, 6.0: 47710, 7.0: 22152, 8.0: 11454, 9.0: 6270, 10.0: 3474, 11.0: 1996, 12.0: 1146, 13.0: 682, 14.0: 456, 15.0: 284, 16.0: 196, 17.0: 160, 18.0: 96, 19.0: 50, 20.0: 18, 21.0: 8})
Convert a graph into a bidirected graph: 1.266 seconds
Metis partitioning: 5.088 seconds
Split the graph: 2.110 seconds
Construct subgraphs: 0.076 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.55333685874939
11624
11617
11633
11636
11035
11107
11035
11254
total k batches seeds list generation spend  18.534276008605957
after graph partition
graph partition algorithm spend time 18.626896858215332
11624
11617
11633
11636
11035
11107
11035
11254
partition_len_list
[19825, 20986, 25664, 21915, 34531, 23873, 47601, 42113]
shared_neighbor_graph_partition_s0 selection method  spend 18.713557720184326
time for parepare:  0.018570423126220703
local_output_nid generation:  0.0020482540130615234
local_in_edges_tensor generation:  0.0026154518127441406
mini_batch_src_global generation:  0.003040790557861328
r_  generation:  0.027745723724365234
local_output_nid generation:  0.002252340316772461
local_in_edges_tensor generation:  0.0025179386138916016
mini_batch_src_global generation:  0.003587007522583008
r_  generation:  0.030965328216552734
local_output_nid generation:  0.0024073123931884766
local_in_edges_tensor generation:  0.002544879913330078
mini_batch_src_global generation:  0.003017902374267578
r_  generation:  0.029803752899169922
local_output_nid generation:  0.0024635791778564453
local_in_edges_tensor generation:  0.0024983882904052734
mini_batch_src_global generation:  0.0028285980224609375
r_  generation:  0.027709484100341797
local_output_nid generation:  0.002354145050048828
local_in_edges_tensor generation:  0.002128124237060547
mini_batch_src_global generation:  0.002962350845336914
r_  generation:  0.031031370162963867
local_output_nid generation:  0.002460002899169922
local_in_edges_tensor generation:  0.0023055076599121094
mini_batch_src_global generation:  0.002531290054321289
r_  generation:  0.02561163902282715
local_output_nid generation:  0.0025124549865722656
local_in_edges_tensor generation:  0.0023534297943115234
mini_batch_src_global generation:  0.003206014633178711
r_  generation:  0.03451991081237793
local_output_nid generation:  0.002748250961303711
local_in_edges_tensor generation:  0.0028378963470458984
mini_batch_src_global generation:  0.005343914031982422
r_  generation:  0.04560542106628418
----------------------check_connections_block total spend ----------------------------- 0.4024937152862549
generate_one_block  0.03610372543334961
generate_one_block  0.04070568084716797
generate_one_block  0.03853559494018555
generate_one_block  0.034503936767578125
generate_one_block  0.04265904426574707
generate_one_block  0.03035449981689453
generate_one_block  0.05169057846069336
generate_one_block  0.07208776473999023
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.05737423896789551
gen group dst list time:  0.006692409515380859
time for parepare:  0.0221860408782959
local_output_nid generation:  0.003441333770751953
local_in_edges_tensor generation:  0.014379024505615234
mini_batch_src_global generation:  0.0037610530853271484
r_  generation:  0.041439056396484375
local_output_nid generation:  0.005025625228881836
local_in_edges_tensor generation:  0.004390239715576172
mini_batch_src_global generation:  0.004960775375366211
r_  generation:  0.04504823684692383
local_output_nid generation:  0.0062487125396728516
local_in_edges_tensor generation:  0.006697893142700195
mini_batch_src_global generation:  0.008294820785522461
r_  generation:  0.05818486213684082
local_output_nid generation:  0.0054531097412109375
local_in_edges_tensor generation:  0.004259824752807617
mini_batch_src_global generation:  0.004785299301147461
r_  generation:  0.04686141014099121
local_output_nid generation:  0.008301734924316406
local_in_edges_tensor generation:  0.007090568542480469
mini_batch_src_global generation:  0.008899688720703125
r_  generation:  0.08937263488769531
local_output_nid generation:  0.0060575008392333984
local_in_edges_tensor generation:  0.006600618362426758
mini_batch_src_global generation:  0.006174564361572266
r_  generation:  0.05298304557800293
local_output_nid generation:  0.01111602783203125
local_in_edges_tensor generation:  0.017015695571899414
mini_batch_src_global generation:  0.012554407119750977
r_  generation:  0.13149785995483398
local_output_nid generation:  0.009380817413330078
local_in_edges_tensor generation:  0.015331506729125977
mini_batch_src_global generation:  0.014213085174560547
r_  generation:  0.1194295883178711
----------------------check_connections_block total spend ----------------------------- 0.9572443962097168
generate_one_block  0.05308890342712402
generate_one_block  0.05754446983337402
generate_one_block  0.07258749008178711
generate_one_block  0.05687069892883301
generate_one_block  0.11604738235473633
generate_one_block  0.06642770767211914
generate_one_block  0.17643165588378906
generate_one_block  0.15741968154907227
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

connection checking time:  0.9572443962097168
block generation total time  0.756417989730835
average batch blocks generation time:  0.09455224871635437
pseudo mini batch 0 input nodes size: 34460
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.002777576446533203  GigaBytes
Max Memory Allocated: 0.002777576446533203  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01920938491821289  GigaBytes
Max Memory Allocated: 0.01920938491821289  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01929616928100586  GigaBytes
Max Memory Allocated: 0.01929616928100586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01929616928100586  GigaBytes
Max Memory Allocated: 0.01929616928100586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

torch.Size([34460, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1033935546875 GB
    Memory Allocated: 0.02082967758178711  GigaBytes
Max Memory Allocated: 0.02082967758178711  GigaBytes

m.shape torch.Size([2138, 1, 128])
----------------------------------------1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.08046913146972656  GigaBytes
Max Memory Allocated: 0.08102035522460938  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.08046913146972656  GigaBytes
Max Memory Allocated: 0.08102035522460938  GigaBytes

 h.shape torch.Size([1, 2138, 128]), torch.Size([1, 2138, 128])
----------------------------------------3
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.08322429656982422  GigaBytes
Max Memory Allocated: 0.08322429656982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.09953594207763672  GigaBytes
Max Memory Allocated: 0.100555419921875  GigaBytes

rst.shape  torch.Size([1, 2138, 128])
m.shape torch.Size([2236, 2, 128])
----------------------------------------1
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10064888000488281  GigaBytes
Max Memory Allocated: 0.10069894790649414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10064888000488281  GigaBytes
Max Memory Allocated: 0.10069894790649414  GigaBytes

 h.shape torch.Size([1, 2236, 128]), torch.Size([1, 2236, 128])
----------------------------------------3
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.10386848449707031  GigaBytes
Max Memory Allocated: 0.10386848449707031  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13619422912597656  GigaBytes
Max Memory Allocated: 0.13832664489746094  GigaBytes

rst.shape  torch.Size([1, 2236, 128])
m.shape torch.Size([2004, 3, 128])
----------------------------------------1
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 0.13839387893676758  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.13832664489746094  GigaBytes
Max Memory Allocated: 0.13839387893676758  GigaBytes

 h.shape torch.Size([1, 2004, 128]), torch.Size([1, 2004, 128])
----------------------------------------3
 Nvidia-smi: 1.3260498046875 GB
    Memory Allocated: 0.14023780822753906  GigaBytes
Max Memory Allocated: 0.14023780822753906  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18270301818847656  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

rst.shape  torch.Size([1, 2004, 128])
m.shape torch.Size([1684, 4, 128])
----------------------------------------1
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18495941162109375  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18495941162109375  GigaBytes
Max Memory Allocated: 0.18556976318359375  GigaBytes

 h.shape torch.Size([1, 1684, 128]), torch.Size([1, 1684, 128])
----------------------------------------3
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.18656539916992188  GigaBytes
Max Memory Allocated: 0.18656539916992188  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2336578369140625  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

rst.shape  torch.Size([1, 1684, 128])
m.shape torch.Size([1419, 5, 128])
----------------------------------------1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2362380027770996  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.2362380027770996  GigaBytes
Max Memory Allocated: 0.23686981201171875  GigaBytes

 h.shape torch.Size([1, 1419, 128]), torch.Size([1, 1419, 128])
----------------------------------------3
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.23759126663208008  GigaBytes
Max Memory Allocated: 0.23759126663208008  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2868943214416504  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

rst.shape  torch.Size([1, 1419, 128])
m.shape torch.Size([1223, 6, 128])
----------------------------------------1
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2897167205810547  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.2897167205810547  GigaBytes
Max Memory Allocated: 0.29027748107910156  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.29088306427001953  GigaBytes
Max Memory Allocated: 0.29088306427001953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.34324216842651367  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([1062, 7, 128])
----------------------------------------1
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3462038040161133  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3462038040161133  GigaBytes
Max Memory Allocated: 0.3467411994934082  GigaBytes

 h.shape torch.Size([1, 1062, 128]), torch.Size([1, 1062, 128])
----------------------------------------3
 Nvidia-smi: 1.5389404296875 GB
    Memory Allocated: 0.3472166061401367  GigaBytes
Max Memory Allocated: 0.3472166061401367  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.3981285095214844  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

rst.shape  torch.Size([1, 1062, 128])
m.shape torch.Size([907, 8, 128])
----------------------------------------1
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.40108203887939453  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.40108203887939453  GigaBytes
Max Memory Allocated: 0.4016733169555664  GigaBytes

 h.shape torch.Size([1, 907, 128]), torch.Size([1, 907, 128])
----------------------------------------3
 Nvidia-smi: 1.6072998046875 GB
    Memory Allocated: 0.401947021484375  GigaBytes
Max Memory Allocated: 0.401947021484375  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.45195865631103516  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

rst.shape  torch.Size([1, 907, 128])
m.shape torch.Size([761, 9, 128])
----------------------------------------1
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4547920227050781  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4547920227050781  GigaBytes
Max Memory Allocated: 0.45541858673095703  GigaBytes

 h.shape torch.Size([1, 761, 128]), torch.Size([1, 761, 128])
----------------------------------------3
 Nvidia-smi: 1.6541748046875 GB
    Memory Allocated: 0.4555177688598633  GigaBytes
Max Memory Allocated: 0.4555177688598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7010498046875 GB
    Memory Allocated: 0.5029854774475098  GigaBytes
Max Memory Allocated: 0.506251335144043  GigaBytes

rst.shape  torch.Size([1, 761, 128])
m.shape torch.Size([6391, 10, 128])
----------------------------------------1
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5338726043701172  GigaBytes
Max Memory Allocated: 0.5345873832702637  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5338726043701172  GigaBytes
Max Memory Allocated: 0.5345873832702637  GigaBytes

 h.shape torch.Size([1, 6391, 128]), torch.Size([1, 6391, 128])
----------------------------------------3
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.5403404235839844  GigaBytes
Max Memory Allocated: 0.5403404235839844  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9730806350708008  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

rst.shape  torch.Size([1, 6391, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9222517013549805  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9411582946777344  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9602031707763672  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9411487579345703  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

torch.Size([19825, 256])
first layer input nodes number: 34460
first layer output nodes number: 19825
edges number: 119240
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9604620933532715  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2459716796875 GB
    Memory Allocated: 0.9793686866760254  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.9847202301025391  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.2655029296875 GB
    Memory Allocated: 0.9847202301025391  GigaBytes
Max Memory Allocated: 1.0043306350708008  GigaBytes

m.shape torch.Size([1645, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0698442459106445  GigaBytes
Max Memory Allocated: 1.0698504447937012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0698442459106445  GigaBytes
Max Memory Allocated: 1.0698504447937012  GigaBytes

 h.shape torch.Size([1, 1645, 256]), torch.Size([1, 1645, 256])
----------------------------------------3
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.072981834411621  GigaBytes
Max Memory Allocated: 1.072981834411621  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.0989885330200195  GigaBytes
Max Memory Allocated: 1.1005573272705078  GigaBytes

rst.shape  torch.Size([1, 1645, 256])
m.shape torch.Size([1511, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1005802154541016  GigaBytes
Max Memory Allocated: 1.1005916595458984  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1005802154541016  GigaBytes
Max Memory Allocated: 1.1005916595458984  GigaBytes

 h.shape torch.Size([1, 1511, 256]), torch.Size([1, 1511, 256])
----------------------------------------3
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1035442352294922  GigaBytes
Max Memory Allocated: 1.1035442352294922  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1476125717163086  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

rst.shape  torch.Size([1, 1511, 256])
m.shape torch.Size([1246, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1497235298156738  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1497235298156738  GigaBytes
Max Memory Allocated: 1.1504945755004883  GigaBytes

 h.shape torch.Size([1, 1246, 256]), torch.Size([1, 1246, 256])
----------------------------------------3
 Nvidia-smi: 2.3885498046875 GB
    Memory Allocated: 1.1522164344787598  GigaBytes
Max Memory Allocated: 1.1522164344787598  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2060580253601074  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

rst.shape  torch.Size([1, 1246, 256])
m.shape torch.Size([1038, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2092809677124023  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2092809677124023  GigaBytes
Max Memory Allocated: 1.210496425628662  GigaBytes

 h.shape torch.Size([1, 1038, 256]), torch.Size([1, 1038, 256])
----------------------------------------3
 Nvidia-smi: 2.4471435546875 GB
    Memory Allocated: 1.2113304138183594  GigaBytes
Max Memory Allocated: 1.2113304138183594  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2726731300354004  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

rst.shape  torch.Size([1, 1038, 256])
m.shape torch.Size([830, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2751798629760742  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2751798629760742  GigaBytes
Max Memory Allocated: 1.2766327857971191  GigaBytes

 h.shape torch.Size([1, 830, 256]), torch.Size([1, 830, 256])
----------------------------------------3
 Nvidia-smi: 2.5057373046875 GB
    Memory Allocated: 1.2767629623413086  GigaBytes
Max Memory Allocated: 1.2767629623413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.335341453552246  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

rst.shape  torch.Size([1, 830, 256])
m.shape torch.Size([719, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.3386964797973633  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.3386964797973633  GigaBytes
Max Memory Allocated: 1.339299201965332  GigaBytes

 h.shape torch.Size([1, 719, 256]), torch.Size([1, 719, 256])
----------------------------------------3
 Nvidia-smi: 2.5565185546875 GB
    Memory Allocated: 1.3400678634643555  GigaBytes
Max Memory Allocated: 1.3400678634643555  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.399867057800293  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

rst.shape  torch.Size([1, 719, 256])
m.shape torch.Size([565, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4029827117919922  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4029827117919922  GigaBytes
Max Memory Allocated: 1.4039812088012695  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.4040603637695312  GigaBytes
Max Memory Allocated: 1.4040603637695312  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.458160400390625  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([469, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4620938301086426  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4620938301086426  GigaBytes
Max Memory Allocated: 1.4626045227050781  GigaBytes

 h.shape torch.Size([1, 469, 256]), torch.Size([1, 469, 256])
----------------------------------------3
 Nvidia-smi: 2.6717529296875 GB
    Memory Allocated: 1.4629883766174316  GigaBytes
Max Memory Allocated: 1.4629883766174316  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5143036842346191  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

rst.shape  torch.Size([1, 469, 256])
m.shape torch.Size([428, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5175590515136719  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5175590515136719  GigaBytes
Max Memory Allocated: 1.5178818702697754  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 2.7401123046875 GB
    Memory Allocated: 1.5183753967285156  GigaBytes
Max Memory Allocated: 1.5183753967285156  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5713510513305664  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([359, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5743937492370605  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5743937492370605  GigaBytes
Max Memory Allocated: 1.5750246047973633  GigaBytes

 h.shape torch.Size([1, 359, 256]), torch.Size([1, 359, 256])
----------------------------------------3
 Nvidia-smi: 2.7869873046875 GB
    Memory Allocated: 1.5750784873962402  GigaBytes
Max Memory Allocated: 1.5750784873962402  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6260085105895996  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

rst.shape  torch.Size([1, 359, 256])
m.shape torch.Size([332, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6291766166687012  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.6291766166687012  GigaBytes
Max Memory Allocated: 1.629432201385498  GigaBytes

 h.shape torch.Size([1, 332, 256]), torch.Size([1, 332, 256])
----------------------------------------3
 Nvidia-smi: 2.8319091796875 GB
    Memory Allocated: 1.629809856414795  GigaBytes
Max Memory Allocated: 1.629809856414795  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6803812980651855  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

rst.shape  torch.Size([1, 332, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6831097602844238  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6831097602844238  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 2.8768310546875 GB
    Memory Allocated: 1.6836133003234863  GigaBytes
Max Memory Allocated: 1.6838641166687012  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7271466255187988  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7297687530517578  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7297687530517578  GigaBytes
Max Memory Allocated: 1.7301678657531738  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.7302074432373047  GigaBytes
Max Memory Allocated: 1.7302074432373047  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7705669403076172  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7731733322143555  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.7731733322143555  GigaBytes
Max Memory Allocated: 1.7734184265136719  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.773573875427246  GigaBytes
Max Memory Allocated: 1.773573875427246  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.813227653503418  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([155, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.815843105316162  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.815843105316162  GigaBytes
Max Memory Allocated: 1.8160314559936523  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 3.0291748046875 GB
    Memory Allocated: 1.816138744354248  GigaBytes
Max Memory Allocated: 1.816138744354248  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8474764823913574  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([153, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8496818542480469  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8496818542480469  GigaBytes
Max Memory Allocated: 1.849693775177002  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.8499736785888672  GigaBytes
Max Memory Allocated: 1.8499736785888672  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8829498291015625  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([141, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8851079940795898  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8851079940795898  GigaBytes
Max Memory Allocated: 1.885284423828125  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 3.0897216796875 GB
    Memory Allocated: 1.8853769302368164  GigaBytes
Max Memory Allocated: 1.8853769302368164  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.917649269104004  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([133, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.919816017150879  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.919816017150879  GigaBytes
Max Memory Allocated: 1.9199352264404297  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 3.1229248046875 GB
    Memory Allocated: 1.920069694519043  GigaBytes
Max Memory Allocated: 1.920069694519043  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.952286720275879  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9539313316345215  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9539313316345215  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 3.1580810546875 GB
    Memory Allocated: 1.9541163444519043  GigaBytes
Max Memory Allocated: 1.9545698165893555  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.9789080619812012  GigaBytes
Max Memory Allocated: 1.980665683746338  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.98085355758667  GigaBytes
Max Memory Allocated: 1.9808616638183594  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.98085355758667  GigaBytes
Max Memory Allocated: 1.9808616638183594  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 3.1795654296875 GB
    Memory Allocated: 1.981055736541748  GigaBytes
Max Memory Allocated: 1.981055736541748  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.0095629692077637  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([96, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011399745941162  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011399745941162  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 3.2088623046875 GB
    Memory Allocated: 2.011582851409912  GigaBytes
Max Memory Allocated: 2.011584758758545  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.038682460784912  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040261745452881  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040261745452881  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 3.2362060546875 GB
    Memory Allocated: 2.040412425994873  GigaBytes
Max Memory Allocated: 2.040605068206787  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.063767910003662  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([68, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0651960372924805  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0651960372924805  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 3.2596435546875 GB
    Memory Allocated: 2.0653257369995117  GigaBytes
Max Memory Allocated: 2.065425395965576  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.086337089538574  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([65, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0877718925476074  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0877718925476074  GigaBytes
Max Memory Allocated: 2.0878286361694336  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 3.2791748046875 GB
    Memory Allocated: 2.0878958702087402  GigaBytes
Max Memory Allocated: 2.0878958702087402  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.2987060546875 GB
    Memory Allocated: 2.1088480949401855  GigaBytes
Max Memory Allocated: 2.1111369132995605  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([685, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 2.1252455711364746  GigaBytes
Max Memory Allocated: 2.125309467315674  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.3162841796875 GB
    Memory Allocated: 2.1252455711364746  GigaBytes
Max Memory Allocated: 2.125309467315674  GigaBytes

 h.shape torch.Size([1, 685, 256]), torch.Size([1, 685, 256])
----------------------------------------3
 Nvidia-smi: 3.3182373046875 GB
    Memory Allocated: 2.126552104949951  GigaBytes
Max Memory Allocated: 2.126552104949951  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.6014404296875 GB
    Memory Allocated: 2.356502056121826  GigaBytes
Max Memory Allocated: 2.372833728790283  GigaBytes

rst.shape  torch.Size([1, 685, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.28424072265625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.286529541015625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.288261890411377  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.285886287689209  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([11624, 40])
input nodes number: 19825
output nodes number: 11624
edges number: 86450
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.287853240966797  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6248779296875 GB
    Memory Allocated: 2.2878541946411133  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.028347015380859375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

pseudo mini batch 1 input nodes size: 32727
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.023804664611816406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.03941011428833008  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.03949689865112305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.02297830581665039  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([32727, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7947998046875 GB
    Memory Allocated: 0.024681568145751953  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

m.shape torch.Size([2076, 1, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09039068222045898  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09039068222045898  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 2076, 128]), torch.Size([1, 2076, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.09237051010131836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.10981273651123047  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 2076, 128])
m.shape torch.Size([2107, 2, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11083221435546875  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11083221435546875  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 2107, 128]), torch.Size([1, 2107, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.11381673812866211  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1452946662902832  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 2107, 128])
m.shape torch.Size([1950, 3, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1470794677734375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1470794677734375  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1950, 128]), torch.Size([1, 1950, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1489391326904297  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1898517608642578  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1950, 128])
m.shape torch.Size([1646, 4, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.1920614242553711  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1646, 128]), torch.Size([1, 1646, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.19363117218017578  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.23968791961669922  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1646, 128])
m.shape torch.Size([1526, 5, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24254131317138672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24254131317138672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1526, 128]), torch.Size([1, 1526, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.24399662017822266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.29723167419433594  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1526, 128])
m.shape torch.Size([1253, 6, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.30008888244628906  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.30008888244628906  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1253, 128]), torch.Size([1, 1253, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.3012838363647461  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35291481018066406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1253, 128])
m.shape torch.Size([1121, 7, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35605907440185547  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.35605907440185547  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1121, 128]), torch.Size([1, 1121, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.3571281433105469  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41226768493652344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1121, 128])
m.shape torch.Size([976, 8, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41545629501342773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41545629501342773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 976, 128]), torch.Size([1, 976, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.41638708114624023  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.4713935852050781  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 976, 128])
m.shape torch.Size([827, 9, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.47447729110717773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.47447729110717773  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 827, 128]), torch.Size([1, 827, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.4752659797668457  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5270066261291504  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 827, 128])
m.shape torch.Size([7504, 10, 128])
----------------------------------------1
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5623941421508789  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5623941421508789  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 7504, 128]), torch.Size([1, 7504, 128])
----------------------------------------3
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 0.5695505142211914  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.077652931213379  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 7504, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0199079513549805  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.039921760559082  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0599355697631836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0397653579711914  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

torch.Size([20986, 256])
first layer input nodes number: 32727
first layer output nodes number: 20986
edges number: 132010
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.0601816177368164  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.080195426940918  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.085413932800293  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 3.7967529296875 GB
    Memory Allocated: 1.085413932800293  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

m.shape torch.Size([1549, 1, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1802473068237305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.1802473068237305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1549, 256]), torch.Size([1, 1549, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.183527946472168  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2078161239624023  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1549, 256])
m.shape torch.Size([1361, 2, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2089943885803223  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2089943885803223  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1361, 256]), torch.Size([1, 1361, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.211806297302246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2529592514038086  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1361, 256])
m.shape torch.Size([1207, 3, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2549614906311035  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2549614906311035  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1207, 256]), torch.Size([1, 1207, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.2578840255737305  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3150110244750977  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 1207, 256])
m.shape torch.Size([909, 4, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3178114891052246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3178114891052246  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 909, 256]), torch.Size([1, 909, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3195452690124512  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3698248863220215  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 909, 256])
m.shape torch.Size([815, 5, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3728747367858887  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3728747367858887  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 815, 256]), torch.Size([1, 815, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.3744292259216309  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.432145595550537  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 815, 256])
m.shape torch.Size([643, 6, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4350767135620117  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4350767135620117  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 643, 256]), torch.Size([1, 643, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4363031387329102  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4894371032714844  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 643, 256])
m.shape torch.Size([558, 7, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4925785064697266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.4925785064697266  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 558, 256]), torch.Size([1, 558, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.493642807006836  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5479555130004883  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 558, 256])
m.shape torch.Size([485, 8, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5511527061462402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5511527061462402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 485, 256]), torch.Size([1, 485, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.5520777702331543  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6049656867980957  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 485, 256])
m.shape torch.Size([402, 9, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.607980728149414  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.607980728149414  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 402, 256]), torch.Size([1, 402, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6087474822998047  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6590518951416016  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 402, 256])
m.shape torch.Size([372, 10, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6622443199157715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6622443199157715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 372, 256]), torch.Size([1, 372, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.6629538536071777  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7135443687438965  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 372, 256])
m.shape torch.Size([315, 11, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7165203094482422  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7165203094482422  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7171211242675781  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7645750045776367  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([274, 12, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.767435073852539  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.767435073852539  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 274, 256]), torch.Size([1, 274, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.7679576873779297  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8144512176513672  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 274, 256])
m.shape torch.Size([238, 13, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8171639442443848  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8171639442443848  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 238, 256]), torch.Size([1, 238, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8176178932189941  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8593811988830566  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 238, 256])
m.shape torch.Size([214, 14, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8620338439941406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8620338439941406  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.8624420166015625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9028511047363281  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([200, 15, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9055304527282715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9055304527282715  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 200, 256]), torch.Size([1, 200, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.905911922454834  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.946347713470459  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 200, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9484944343566895  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9484944343566895  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.948784351348877  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9815449714660645  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([174, 17, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.984243392944336  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.984243392944336  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 1.9845752716064453  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0244007110595703  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([122, 18, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026477336883545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026477336883545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.026710033416748  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.056262493133545  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.058246612548828  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.058246612548828  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0584659576416016  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.087858200073242  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([130, 20, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.090247631072998  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.090247631072998  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.0904955863952637  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.125457286834717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([115, 21, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.127654552459717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.127654552459717  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1278738975524902  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.160336971282959  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([63, 22, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161559581756592  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161559581756592  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.161679744720459  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.180305004119873  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1818809509277344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1818809509277344  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.1820220947265625  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2048873901367188  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2065482139587402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2065482139587402  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2066855430603027  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2298941612243652  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([1058, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2552475929260254  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.2552475929260254  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

 h.shape torch.Size([1, 1058, 256]), torch.Size([1, 1058, 256])
----------------------------------------3
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.257307529449463  GigaBytes
Max Memory Allocated: 2.390413761138916  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.6167187690734863  GigaBytes
Max Memory Allocated: 2.6419434547424316  GigaBytes

rst.shape  torch.Size([1, 1058, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5335488319396973  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.535280227661133  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5370116233825684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.53519344329834  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([11617, 40])
input nodes number: 20986
output nodes number: 11617
edges number: 96480
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.535435676574707  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8905029296875 GB
    Memory Allocated: 2.5354361534118652  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.02794647216796875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

pseudo mini batch 2 input nodes size: 50550
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.022977352142333984  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.022977352142333984  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.04708147048950195  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.04716825485229492  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.03147602081298828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([50550, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0760498046875 GB
    Memory Allocated: 0.033318519592285156  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

m.shape torch.Size([2462, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11297941207885742  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11297941207885742  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2462, 128]), torch.Size([1, 2462, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.11532735824584961  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1341109275817871  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2462, 128])
m.shape torch.Size([2709, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2709, 128]), torch.Size([1, 2709, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1385955810546875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.17819547653198242  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2709, 128])
m.shape torch.Size([2409, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18034982681274414  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.18034982681274414  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2409, 128]), torch.Size([1, 2409, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.1826767921447754  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23366785049438477  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2409, 128])
m.shape torch.Size([2140, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2370014190673828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.2370014190673828  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 2140, 128]), torch.Size([1, 2140, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.23919057846069336  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3014531135559082  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 2140, 128])
m.shape torch.Size([1851, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3044395446777344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.3044395446777344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1851, 128]), torch.Size([1, 1851, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.30620479583740234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37093114852905273  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1851, 128])
m.shape torch.Size([1528, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.374420166015625  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.374420166015625  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1528, 128]), torch.Size([1, 1528, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.37587738037109375  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.43920135498046875  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1528, 128])
m.shape torch.Size([1364, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4430255889892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.4430255889892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1364, 128]), torch.Size([1, 1364, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.44432640075683594  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5096206665039062  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1364, 128])
m.shape torch.Size([1250, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5137386322021484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5137386322021484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1250, 128]), torch.Size([1, 1250, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5149307250976562  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5842533111572266  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1250, 128])
m.shape torch.Size([1070, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5882492065429688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5882492065429688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1070, 128]), torch.Size([1, 1070, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.5892696380615234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6545772552490234  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1070, 128])
m.shape torch.Size([8881, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6964149475097656  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.6964149475097656  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 8881, 128]), torch.Size([1, 8881, 128])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 0.7057418823242188  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.307082176208496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 8881, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.238269329071045  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.262744426727295  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.287219524383545  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2625532150268555  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

torch.Size([25664, 256])
first layer input nodes number: 50550
first layer output nodes number: 25664
edges number: 160078
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.2875981330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3120732307434082  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3188481330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.3188481330871582  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

m.shape torch.Size([1727, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4059157371520996  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4059157371520996  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1727, 256]), torch.Size([1, 1727, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4098525047302246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4396557807922363  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1727, 256])
m.shape torch.Size([1554, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.441206455230713  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.441206455230713  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1554, 256]), torch.Size([1, 1554, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.445234775543213  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4905872344970703  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1554, 256])
m.shape torch.Size([1212, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4925999641418457  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.4925999641418457  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1212, 256]), torch.Size([1, 1212, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.494926929473877  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5467700958251953  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1212, 256])
m.shape torch.Size([1025, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5495553016662598  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.5495553016662598  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 1025, 256]), torch.Size([1, 1025, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.551577091217041  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6097822189331055  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 1025, 256])
m.shape torch.Size([862, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6129474639892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6129474639892578  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 862, 256]), torch.Size([1, 862, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6145915985107422  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6755404472351074  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 862, 256])
m.shape torch.Size([625, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6783227920532227  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6783227920532227  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 625, 256]), torch.Size([1, 625, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.6795148849487305  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7345170974731445  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 625, 256])
m.shape torch.Size([553, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7376418113708496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7376418113708496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 553, 256]), torch.Size([1, 553, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.738696575164795  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7963147163391113  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 553, 256])
m.shape torch.Size([520, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.7997856140136719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 520, 256]), torch.Size([1, 520, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8007774353027344  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8582344055175781  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 520, 256])
m.shape torch.Size([398, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8611812591552734  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8611812591552734  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.8619403839111328  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9109687805175781  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([371, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9141550064086914  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9141550064086914  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 371, 256]), torch.Size([1, 371, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9148626327514648  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.966017723083496  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 371, 256])
m.shape torch.Size([267, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9684867858886719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9684867858886719  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 1.9689960479736328  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0095033645629883  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([248, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0121092796325684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0121092796325684  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.012582302093506  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0527892112731934  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([213, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0552144050598145  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0552144050598145  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 213, 256]), torch.Size([1, 213, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0556206703186035  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0929970741271973  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 213, 256])
m.shape torch.Size([203, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0955257415771484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0955257415771484  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.0959129333496094  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.134244918823242  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([198, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.136906147003174  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.136906147003174  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 198, 256]), torch.Size([1, 198, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1372838020324707  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1773152351379395  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 198, 256])
m.shape torch.Size([132, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1791563034057617  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.1791563034057617  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.179408073425293  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.207858085632324  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([137, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2099709510803223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2099709510803223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2102322578430176  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.241589069366455  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2434134483337402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2434134483337402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.243628978729248  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2710013389587402  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([94, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2732415199279785  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2732415199279785  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.273420810699463  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.297445774078369  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2989516258239746  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.2989516258239746  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.299109935760498  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3214316368103027  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3228864669799805  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3228864669799805  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.323031425476074  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.344485282897949  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([79, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.346083641052246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.346083641052246  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3462343215942383  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3695898056030273  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3707218170166016  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3707218170166016  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3708229064941406  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3871994018554688  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3885560035705566  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.3885560035705566  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.388672351837158  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.4083352088928223  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([829, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.428591251373291  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.428591251373291  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

 h.shape torch.Size([1, 829, 256]), torch.Size([1, 829, 256])
----------------------------------------3
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.4301724433898926  GigaBytes
Max Memory Allocated: 2.6489920616149902  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.710299015045166  GigaBytes
Max Memory Allocated: 2.7300639152526855  GigaBytes

rst.shape  torch.Size([1, 829, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.634647846221924  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.636688709259033  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.639153003692627  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.6370253562927246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([11633, 40])
input nodes number: 25664
output nodes number: 11633
edges number: 87111
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.637612819671631  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.637613296508789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.037200927734375  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

pseudo mini batch 3 input nodes size: 36495
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.03178548812866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.03178548812866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.04936361312866211  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.04945039749145508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02525949478149414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([36495, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([2547, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2547, 128]), torch.Size([1, 2547, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.09205198287963867  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.11227226257324219  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2547, 128])
m.shape torch.Size([2668, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.1136021614074707  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.1136021614074707  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2668, 128]), torch.Size([1, 2668, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.11687707901000977  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15694284439086914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2668, 128])
m.shape torch.Size([2364, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15810251235961914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.15810251235961914  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2364, 128]), torch.Size([1, 2364, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.16070175170898438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21102523803710938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2364, 128])
m.shape torch.Size([1975, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21440696716308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21440696716308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1975, 128]), torch.Size([1, 1975, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.21629047393798828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.27091217041015625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1975, 128])
m.shape torch.Size([1703, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.2740306854248047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.2740306854248047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1703, 128]), torch.Size([1, 1703, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.27565479278564453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33629322052001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1703, 128])
m.shape torch.Size([1432, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33957815170288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.33957815170288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1432, 128]), torch.Size([1, 1432, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.3409438133239746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.4000816345214844  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1432, 128])
m.shape torch.Size([1210, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40343761444091797  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40343761444091797  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1210, 128]), torch.Size([1, 1210, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.40459156036376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.4633808135986328  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1210, 128])
m.shape torch.Size([1073, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46689701080322266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46689701080322266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.46792030334472656  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5262479782104492  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([901, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5296030044555664  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5296030044555664  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 901, 128]), torch.Size([1, 901, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5304622650146484  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.5869369506835938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 901, 128])
m.shape torch.Size([6042, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6153178215026855  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6153178215026855  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 6042, 128]), torch.Size([1, 6042, 128])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.6210799217224121  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.030189037322998  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 6042, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9774689674377441  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9983687400817871  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.01926851272583  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.9982051849365234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([21915, 256])
first layer input nodes number: 36495
first layer output nodes number: 21915
edges number: 125565
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0195426940917969  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0404424667358398  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0456676483154297  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.0456676483154297  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([1806, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1230812072753906  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1230812072753906  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1806, 256]), torch.Size([1, 1806, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1275711059570312  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1572189331054688  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1806, 256])
m.shape torch.Size([1656, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1581573486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1581573486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1656, 256]), torch.Size([1, 1656, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.1620688438415527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.210111141204834  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1656, 256])
m.shape torch.Size([1332, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2122621536254883  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2122621536254883  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1332, 256]), torch.Size([1, 1332, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2148065567016602  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.274306297302246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1332, 256])
m.shape torch.Size([1046, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2770576477050781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.2770576477050781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1046, 256]), torch.Size([1, 1046, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.279160499572754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3397250175476074  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1046, 256])
m.shape torch.Size([882, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3428363800048828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3428363800048828  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 882, 256]), torch.Size([1, 882, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.3445186614990234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.405080795288086  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 882, 256])
m.shape torch.Size([712, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4083456993103027  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4083456993103027  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 712, 256]), torch.Size([1, 712, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4097037315368652  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.470567226409912  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 712, 256])
m.shape torch.Size([617, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4740395545959473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4740395545959473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 617, 256]), torch.Size([1, 617, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.4752163887023926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5364365577697754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 617, 256])
m.shape torch.Size([508, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5397543907165527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5397543907165527  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 508, 256]), torch.Size([1, 508, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5407233238220215  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.5971007347106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 508, 256])
m.shape torch.Size([408, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6001458168029785  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 408, 256]), torch.Size([1, 408, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.600924015045166  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6523699760437012  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 408, 256])
m.shape torch.Size([344, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.655287265777588  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.655287265777588  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.6559433937072754  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7035670280456543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([306, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7064743041992188  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7064743041992188  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7070579528808594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7536344528198242  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([254, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.756272315979004  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.756272315979004  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 254, 256]), torch.Size([1, 254, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7567567825317383  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.7979364395141602  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 254, 256])
m.shape torch.Size([208, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8002934455871582  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8002934455871582  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8006901741027832  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8371891975402832  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([175, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.839345932006836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.839345932006836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8396797180175781  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8727245330810547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([169, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8749942779541016  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8749942779541016  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.8753166198730469  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.90948486328125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([145, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9115538597106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9115538597106934  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9118304252624512  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.943082332611084  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([97, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9445290565490723  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9445290565490723  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.944714069366455  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9669156074523926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([86, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9683113098144531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9683113098144531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.968475341796875  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9893074035644531  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9907960891723633  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9907960891723633  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 1.9909601211547852  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0129404067993164  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([82, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.014434814453125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.014434814453125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0145912170410156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0366439819335938  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.037837505340576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.037837505340576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0379576683044434  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.055741786956787  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.056896686553955  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.056896686553955  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0570054054260254  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.073856830596924  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.074965476989746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.074965476989746  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0750646591186523  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.091132164001465  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920052528381348  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920052528381348  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.0920815467834473  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1049752235412598  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([505, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1170716285705566  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.1170716285705566  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 505, 256]), torch.Size([1, 505, 256])
----------------------------------------3
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.118034839630127  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.289429187774658  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 505, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2248363494873047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.227081298828125  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2288155555725098  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264838218688965  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([11636, 40])
input nodes number: 21915
output nodes number: 11636
edges number: 77727
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264275550842285  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 2.2264280319213867  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02945709228515625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

pseudo mini batch 4 input nodes size: 66740
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02495288848876953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.02495288848876953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.056777000427246094  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.056859493255615234  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.039194583892822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([66740, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.0858154296875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([2575, 1, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1659865379333496  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1659865379333496  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2575, 128]), torch.Size([1, 2575, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.1684422492980957  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18869495391845703  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2575, 128])
m.shape torch.Size([2609, 2, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18992280960083008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.18992280960083008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2609, 128]), torch.Size([1, 2609, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.19241094589233398  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23085832595825195  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2609, 128])
m.shape torch.Size([2193, 3, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23333358764648438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.23333358764648438  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2358088493347168  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.282900333404541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
m.shape torch.Size([1966, 4, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2860374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.2860374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1966, 128]), torch.Size([1, 1966, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.28791236877441406  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34228515625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1966, 128])
m.shape torch.Size([1850, 5, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34575843811035156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.34575843811035156  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1850, 128]), torch.Size([1, 1850, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.3475227355957031  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4110374450683594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1850, 128])
m.shape torch.Size([1572, 6, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.41465282440185547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.41465282440185547  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1572, 128]), torch.Size([1, 1572, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4161520004272461  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4811840057373047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1572, 128])
m.shape torch.Size([1430, 7, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.48520755767822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.48520755767822266  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1430, 128]), torch.Size([1, 1430, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.4865713119506836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.5555095672607422  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1430, 128])
m.shape torch.Size([1378, 8, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.560084342956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.560084342956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1378, 128]), torch.Size([1, 1378, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.5613985061645508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6363248825073242  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1378, 128])
m.shape torch.Size([1223, 9, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6409163475036621  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.6409163475036621  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.642082691192627  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.7191133499145508  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([17735, 10, 128])
----------------------------------------1
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8030972480773926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8030972480773926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 17735, 128]), torch.Size([1, 17735, 128])
----------------------------------------3
 Nvidia-smi: 4.2069091796875 GB
    Memory Allocated: 0.8207368850708008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0215892791748047  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 17735, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.909590244293213  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.942521572113037  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9754528999328613  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9422640800476074  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

torch.Size([34531, 256])
first layer input nodes number: 66740
first layer output nodes number: 34531
edges number: 250309
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 1.9759521484375  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.008883476257324  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0171165466308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.9959716796875 GB
    Memory Allocated: 2.0171165466308594  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

m.shape torch.Size([1775, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.105952739715576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.105952739715576  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1775, 256]), torch.Size([1, 1775, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.110034465789795  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1408190727233887  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1775, 256])
m.shape torch.Size([1491, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.141289234161377  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.141289234161377  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1491, 256]), torch.Size([1, 1491, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1443963050842285  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1875672340393066  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1491, 256])
m.shape torch.Size([1131, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1894068717956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.1894068717956543  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 1131, 256]), torch.Size([1, 1131, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.191612720489502  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2398571968078613  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 1131, 256])
m.shape torch.Size([837, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2425107955932617  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2425107955932617  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 837, 256]), torch.Size([1, 837, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.244107246398926  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.291152000427246  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 837, 256])
m.shape torch.Size([768, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2940444946289062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2940444946289062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 768, 256]), torch.Size([1, 768, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.2955093383789062  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.348379611968994  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 768, 256])
m.shape torch.Size([580, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.350992202758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.350992202758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.3520984649658203  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4023590087890625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([439, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4047598838806152  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4047598838806152  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 439, 256]), torch.Size([1, 439, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.40559720993042  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.4478983879089355  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 439, 256])
m.shape torch.Size([406, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.450601577758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.450601577758789  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 406, 256]), torch.Size([1, 406, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.451375961303711  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.497407913208008  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 406, 256])
m.shape torch.Size([320, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.499788761138916  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.499788761138916  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 320, 256]), torch.Size([1, 320, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.500399112701416  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.541982650756836  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 320, 256])
m.shape torch.Size([290, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5444650650024414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5444650650024414  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 290, 256]), torch.Size([1, 290, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.545018196105957  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5851221084594727  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 290, 256])
m.shape torch.Size([255, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5875415802001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5875415802001953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.5880279541015625  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.625965118408203  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([225, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628317356109619  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628317356109619  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 225, 256]), torch.Size([1, 225, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.628746509552002  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.665224552154541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 225, 256])
m.shape torch.Size([160, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6670093536376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6670093536376953  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6673145294189453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6953907012939453  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([137, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6970815658569336  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.6970815658569336  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.697342872619629  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.723212242126465  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([133, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.72499942779541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.72499942779541  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.725253105163574  GigaBytes
Max Memory Allocated: 2.7428340911865234  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.752142906188965  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([119, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7538461685180664  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7538461685180664  GigaBytes
Max Memory Allocated: 2.7540454864501953  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.754073143005371  GigaBytes
Max Memory Allocated: 2.754073143005371  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.779721260070801  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([103, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7812910079956055  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.7812910079956055  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.781487464904785  GigaBytes
Max Memory Allocated: 2.7815370559692383  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8050622940063477  GigaBytes
Max Memory Allocated: 2.806732177734375  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.806884765625  GigaBytes
Max Memory Allocated: 2.8068923950195312  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.806884765625  GigaBytes
Max Memory Allocated: 2.8068923950195312  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.807096481323242  GigaBytes
Max Memory Allocated: 2.807096481323242  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.833984375  GigaBytes
Max Memory Allocated: 2.8358898162841797  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8358874320983887  GigaBytes
Max Memory Allocated: 2.835895538330078  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8358874320983887  GigaBytes
Max Memory Allocated: 2.835895538330078  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.836097240447998  GigaBytes
Max Memory Allocated: 2.836097240447998  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8642115592956543  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.865856170654297  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.865856170654297  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.866029739379883  GigaBytes
Max Memory Allocated: 2.8662047386169434  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8905029296875  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8919100761413574  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8919100761413574  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.8920512199401855  GigaBytes
Max Memory Allocated: 2.8922386169433594  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.912940502166748  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9140982627868652  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9140982627868652  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9142088890075684  GigaBytes
Max Memory Allocated: 2.9144225120544434  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9313559532165527  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.932405948638916  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.932405948638916  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9325013160705566  GigaBytes
Max Memory Allocated: 2.932572841644287  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.947950839996338  GigaBytes
Max Memory Allocated: 2.949047565460205  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([69, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9494948387145996  GigaBytes
Max Memory Allocated: 2.9495010375976562  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9494948387145996  GigaBytes
Max Memory Allocated: 2.9495010375976562  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9496264457702637  GigaBytes
Max Memory Allocated: 2.9496264457702637  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 2.9718680381774902  GigaBytes
Max Memory Allocated: 2.973447322845459  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([1303, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0032949447631836  GigaBytes
Max Memory Allocated: 3.0034165382385254  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0032949447631836  GigaBytes
Max Memory Allocated: 3.0034165382385254  GigaBytes

 h.shape torch.Size([1, 1303, 256]), torch.Size([1, 1303, 256])
----------------------------------------3
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.0057802200317383  GigaBytes
Max Memory Allocated: 3.0057802200317383  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.45896053314209  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1303, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3800406455993652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3821749687194824  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.383819580078125  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.3816027641296387  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([11035, 40])
input nodes number: 34531
output nodes number: 11035
edges number: 90191
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.38234281539917  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0838623046875 GB
    Memory Allocated: 3.382343292236328  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.04673624038696289  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

pseudo mini batch 5 input nodes size: 49175
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03959465026855469  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.06304311752319336  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.0631260871887207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.031219482421875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([49175, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03271484375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2916, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1006784439086914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2916, 128]), torch.Size([1, 2916, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.10399961471557617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.12684202194213867  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2916, 128])
m.shape torch.Size([2952, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1282668113708496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1282668113708496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2952, 128]), torch.Size([1, 2952, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.13165998458862305  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1738886833190918  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2952, 128])
m.shape torch.Size([2595, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1761932373046875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.1761932373046875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2595, 128]), torch.Size([1, 2595, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.17909765243530273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23366403579711914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2595, 128])
m.shape torch.Size([2164, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23649358749389648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23649358749389648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2164, 128]), torch.Size([1, 2164, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.23865890502929688  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3000655174255371  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2164, 128])
m.shape torch.Size([1872, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3034968376159668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3034968376159668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1872, 128]), torch.Size([1, 1872, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3052821159362793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3695521354675293  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1872, 128])
m.shape torch.Size([1485, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.3729081153869629  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1485, 128]), torch.Size([1, 1485, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.37432432174682617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.43592023849487305  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1485, 128])
m.shape torch.Size([1235, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4393343925476074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4393343925476074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1235, 128]), torch.Size([1, 1235, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.44051218032836914  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.4994015693664551  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1235, 128])
m.shape torch.Size([1080, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5029325485229492  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1080, 128]), torch.Size([1, 1080, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.503962516784668  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5640230178833008  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1080, 128])
m.shape torch.Size([944, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5675592422485352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5675592422485352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 944, 128]), torch.Size([1, 944, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.5684595108032227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.6262211799621582  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 944, 128])
m.shape torch.Size([6630, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.657595157623291  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.657595157623291  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 6630, 128]), torch.Size([1, 6630, 128])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.6639180183410645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1188483238220215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 6630, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.0610108375549316  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.083777904510498  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1065449714660645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.08359956741333  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([23873, 256])
first layer input nodes number: 49175
first layer output nodes number: 23873
edges number: 135612
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1069135665893555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1296806335449219  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1353726387023926  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.1353726387023926  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2128, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.20097017288208  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.20097017288208  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2128, 256]), torch.Size([1, 2128, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2058444023132324  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2395377159118652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2128, 256])
m.shape torch.Size([1755, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2400846481323242  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2400846481323242  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1755, 256]), torch.Size([1, 1755, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2435226440429688  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2948780059814453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1755, 256])
m.shape torch.Size([1341, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2970709800720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2970709800720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1341, 256]), torch.Size([1, 1341, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.2998690605163574  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.3587708473205566  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1341, 256])
m.shape torch.Size([1084, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.361168384552002  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.361168384552002  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1084, 256]), torch.Size([1, 1084, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.3633465766906738  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4288783073425293  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1084, 256])
m.shape torch.Size([864, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.431260585784912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.431260585784912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 864, 256]), torch.Size([1, 864, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.432908535003662  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.494091510772705  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 864, 256])
m.shape torch.Size([627, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4968833923339844  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4968833923339844  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 627, 256]), torch.Size([1, 627, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.4980792999267578  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5534248352050781  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 627, 256])
m.shape torch.Size([506, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5562314987182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5562314987182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 506, 256]), torch.Size([1, 506, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.5571966171264648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.605910301208496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 506, 256])
m.shape torch.Size([413, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6086034774780273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6086034774780273  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 413, 256]), torch.Size([1, 413, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.609391212463379  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6556272506713867  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 413, 256])
m.shape torch.Size([387, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.658581256866455  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.658581256866455  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 387, 256]), torch.Size([1, 387, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.6593194007873535  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7069001197814941  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 387, 256])
m.shape torch.Size([280, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7092223167419434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7092223167419434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7097563743591309  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7486329078674316  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([208, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7505650520324707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7505650520324707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 208, 256]), torch.Size([1, 208, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7509617805480957  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7819066047668457  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 208, 256])
m.shape torch.Size([196, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7839689254760742  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7839689254760742  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 196, 256]), torch.Size([1, 196, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.7843427658081055  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8161191940307617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 196, 256])
m.shape torch.Size([180, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8181815147399902  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8181815147399902  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 180, 256]), torch.Size([1, 180, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8185248374938965  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8501105308532715  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 180, 256])
m.shape torch.Size([141, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8518362045288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8518362045288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8521051406860352  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.8787298202514648  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880051612854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880051612854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.880244255065918  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9006643295288086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.902029037475586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.902029037475586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9022102355957031  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9226856231689453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([90, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9240655899047852  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9240655899047852  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9242372512817383  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9448366165161133  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.945927619934082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.945927619934082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9460573196411133  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.962529182434082  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([66, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.963669776916504  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.963669776916504  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9637956619262695  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9806642532348633  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9817166328430176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9817166328430176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9818272590637207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9974255561828613  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9981374740600586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9981374740600586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 1.9982099533081055  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.008936882019043  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0095772743225098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0095772743225098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0096383094787598  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0190987586975098  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019775867462158  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019775867462158  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.019836902618408  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.029724597930908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305018424987793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305018424987793  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0305685997009277  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0418505668640137  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([382, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0509963035583496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.0509963035583496  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 382, 256]), torch.Size([1, 382, 256])
----------------------------------------3
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.051724910736084  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1837639808654785  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 382, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1305580139160156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1322317123413086  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1340017318725586  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1322450637817383  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([11107, 40])
input nodes number: 23873
output nodes number: 11107
edges number: 64993
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1320457458496094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 2.1320462226867676  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03526020050048828  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

pseudo mini batch 6 input nodes size: 87478
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03075885772705078  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.03075885772705078  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.07247161865234375  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.07255411148071289  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.049022674560546875  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([87478, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.1717529296875 GB
    Memory Allocated: 0.053328514099121094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([2521, 1, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23632240295410156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23632240295410156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2521, 128]), torch.Size([1, 2521, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.23872661590576172  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.25886011123657227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2521, 128])
m.shape torch.Size([2795, 2, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2611265182495117  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2611265182495117  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2795, 128]), torch.Size([1, 2795, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.2637920379638672  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.30446338653564453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2795, 128])
m.shape torch.Size([2550, 3, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3067784309387207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3067784309387207  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2550, 128]), torch.Size([1, 2550, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.3093271255493164  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36429595947265625  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2550, 128])
m.shape torch.Size([2229, 4, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36733150482177734  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36733150482177734  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2229, 128]), torch.Size([1, 2229, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.36960935592651367  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.4361395835876465  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2229, 128])
m.shape torch.Size([2132, 5, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44039106369018555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44039106369018555  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 2132, 128]), torch.Size([1, 2132, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.44242429733276367  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5180783271789551  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 2132, 128])
m.shape torch.Size([1987, 6, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5231614112854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5231614112854004  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1987, 128]), torch.Size([1, 1987, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.5250563621520996  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.606539249420166  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1987, 128])
m.shape torch.Size([1866, 7, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6118202209472656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6118202209472656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1866, 128]), torch.Size([1, 1866, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.6135997772216797  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7025775909423828  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1866, 128])
m.shape torch.Size([1787, 8, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7085046768188477  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7085046768188477  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1787, 128]), torch.Size([1, 1787, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.7102088928222656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8073492050170898  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1787, 128])
m.shape torch.Size([1661, 9, 128])
----------------------------------------1
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8136253356933594  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8136253356933594  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1661, 128]), torch.Size([1, 1661, 128])
----------------------------------------3
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.8152093887329102  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.3514404296875 GB
    Memory Allocated: 0.9186792373657227  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1661, 128])
m.shape torch.Size([28073, 10, 128])
----------------------------------------1
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.0526528358459473  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.0526528358459473  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 28073, 128]), torch.Size([1, 28073, 128])
----------------------------------------3
 Nvidia-smi: 5.4862060546875 GB
    Memory Allocated: 1.07942533493042  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9808902740478516  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 28073, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.8124423027038574  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.8578381538391113  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9032340049743652  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.857483386993408  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

torch.Size([47601, 256])
first layer input nodes number: 87478
first layer output nodes number: 47601
edges number: 370296
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9038877487182617  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.9492835998535156  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.960632801055908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.6600341796875 GB
    Memory Allocated: 2.960632801055908  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

m.shape torch.Size([1582, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0616002082824707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0616002082824707  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1582, 256]), torch.Size([1, 1582, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0650715827941895  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.0921406745910645  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1582, 256])
m.shape torch.Size([1408, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.092625141143799  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.092625141143799  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1408, 256]), torch.Size([1, 1408, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.096177577972412  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.142063617706299  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1408, 256])
m.shape torch.Size([1060, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.143777370452881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.143777370452881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 1060, 256]), torch.Size([1, 1060, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.1458568572998047  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.1913223266601562  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 1060, 256])
m.shape torch.Size([763, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.19315242767334  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.19315242767334  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 763, 256]), torch.Size([1, 763, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.194607734680176  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2377829551696777  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 763, 256])
m.shape torch.Size([657, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.240212917327881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.240212917327881  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 657, 256]), torch.Size([1, 657, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2414660453796387  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2870655059814453  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 657, 256])
m.shape torch.Size([516, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.289414882659912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.289414882659912  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.2903990745544434  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3348965644836426  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([428, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3372840881347656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3372840881347656  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3381004333496094  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3794655799865723  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([362, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3822836875915527  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.3822836875915527  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.382974147796631  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4225287437438965  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([306, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.424830913543701  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.424830913543701  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 306, 256]), torch.Size([1, 306, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.425414562225342  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4646029472351074  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

rst.shape  torch.Size([1, 306, 256])
m.shape torch.Size([279, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4669928550720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.4669928550720215  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

 h.shape torch.Size([1, 279, 256]), torch.Size([1, 279, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.467525005340576  GigaBytes
Max Memory Allocated: 3.49021053314209  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5068583488464355  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

rst.shape  torch.Size([1, 279, 256])
m.shape torch.Size([258, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5093202590942383  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5093202590942383  GigaBytes
Max Memory Allocated: 3.509519100189209  GigaBytes

 h.shape torch.Size([1, 258, 256]), torch.Size([1, 258, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.509812355041504  GigaBytes
Max Memory Allocated: 3.509812355041504  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5497045516967773  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

rst.shape  torch.Size([1, 258, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.551927089691162  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.551927089691162  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.552335262298584  GigaBytes
Max Memory Allocated: 3.5524110794067383  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5870299339294434  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([191, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.589212417602539  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.589212417602539  GigaBytes
Max Memory Allocated: 3.5894789695739746  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.5895767211914062  GigaBytes
Max Memory Allocated: 3.5895767211914062  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6230926513671875  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([161, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.625077247619629  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.625077247619629  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6253843307495117  GigaBytes
Max Memory Allocated: 3.625460624694824  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.65578556060791  GigaBytes
Max Memory Allocated: 3.65793514251709  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6579675674438477  GigaBytes
Max Memory Allocated: 3.6579766273498535  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6579675674438477  GigaBytes
Max Memory Allocated: 3.6579766273498535  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6582765579223633  GigaBytes
Max Memory Allocated: 3.6582765579223633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.6910295486450195  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([138, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.692997455596924  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.692997455596924  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.693260669708252  GigaBytes
Max Memory Allocated: 3.6933469772338867  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.72300386428833  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([119, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7248167991638184  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7248167991638184  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.725043773651123  GigaBytes
Max Memory Allocated: 3.725109577178955  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7522807121276855  GigaBytes
Max Memory Allocated: 3.7542099952697754  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([138, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7554454803466797  GigaBytes
Max Memory Allocated: 3.7554550170898438  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7554454803466797  GigaBytes
Max Memory Allocated: 3.7554550170898438  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.755708694458008  GigaBytes
Max Memory Allocated: 3.755708694458008  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7891368865966797  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([111, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.791032314300537  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.791032314300537  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.7912440299987793  GigaBytes
Max Memory Allocated: 3.791505813598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8196139335632324  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([96, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8213534355163574  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8213534355163574  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8215365409851074  GigaBytes
Max Memory Allocated: 3.821625232696533  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8473544120788574  GigaBytes
Max Memory Allocated: 3.8491854667663574  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([104, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.849362373352051  GigaBytes
Max Memory Allocated: 3.8493709564208984  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.849362373352051  GigaBytes
Max Memory Allocated: 3.8493709564208984  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8495607376098633  GigaBytes
Max Memory Allocated: 3.8495607376098633  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8789186477661133  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8807015419006348  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.8807015419006348  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.880871295928955  GigaBytes
Max Memory Allocated: 3.8810014724731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9071831703186035  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908623695373535  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908623695373535  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.908755302429199  GigaBytes
Max Memory Allocated: 3.909050464630127  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9300756454467773  GigaBytes
Max Memory Allocated: 3.931589126586914  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([76, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931763172149658  GigaBytes
Max Memory Allocated: 3.9317703247070312  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931763172149658  GigaBytes
Max Memory Allocated: 3.9317703247070312  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.931908130645752  GigaBytes
Max Memory Allocated: 3.931908130645752  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9564061164855957  GigaBytes
Max Memory Allocated: 3.9581456184387207  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([1748, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9989309310913086  GigaBytes
Max Memory Allocated: 3.999094009399414  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 3.9989309310913086  GigaBytes
Max Memory Allocated: 3.999094009399414  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.002264976501465  GigaBytes
Max Memory Allocated: 4.002264976501465  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.590806007385254  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.500152587890625  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.502571105957031  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.504215717315674  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.501714706420898  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([11035, 40])
input nodes number: 47601
output nodes number: 11035
edges number: 103017
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.50212287902832  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.7596435546875 GB
    Memory Allocated: 4.5021233558654785  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.06011676788330078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

pseudo mini batch 7 input nodes size: 68973
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.048993587493896484  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.08188247680664062  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.08196640014648438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.040171146392822266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([68973, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.04376840591430664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

m.shape torch.Size([1857, 1, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21333694458007812  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1857, 128]), torch.Size([1, 1857, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.21510791778564453  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.22927570343017578  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1857, 128])
m.shape torch.Size([1853, 2, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23015737533569336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23015737533569336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1853, 128]), torch.Size([1, 1853, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.23192453384399414  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.25843191146850586  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1853, 128])
m.shape torch.Size([1765, 3, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26045751571655273  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26045751571655273  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1765, 128]), torch.Size([1, 1765, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.26214075088500977  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.29941606521606445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1765, 128])
m.shape torch.Size([1662, 4, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3017444610595703  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3017444610595703  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.3033294677734375  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.34989356994628906  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([1603, 5, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35326290130615234  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35326290130615234  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1603, 128]), torch.Size([1, 1603, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.35479164123535156  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.40982627868652344  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1603, 128])
m.shape torch.Size([1541, 6, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4135613441467285  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4135613441467285  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1541, 128]), torch.Size([1, 1541, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.41503095626831055  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.4782242774963379  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1541, 128])
m.shape torch.Size([1503, 7, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48250627517700195  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48250627517700195  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1503, 128]), torch.Size([1, 1503, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.48393964767456055  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5556082725524902  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1503, 128])
m.shape torch.Size([1406, 8, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5602550506591797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5602550506591797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1406, 128]), torch.Size([1, 1406, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.5615959167480469  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6381983757019043  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1406, 128])
m.shape torch.Size([1367, 9, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6433944702148438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6433944702148438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1367, 128]), torch.Size([1, 1367, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.6446981430053711  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.7281332015991211  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1367, 128])
m.shape torch.Size([27556, 10, 128])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8588786125183105  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8588786125183105  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 27556, 128]), torch.Size([1, 27556, 128])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 0.8851580619812012  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7509989738464355  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 27556, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.592926502227783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.6330885887145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.673250675201416  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.6327743530273438  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

torch.Size([42113, 256])
first layer input nodes number: 68973
first layer output nodes number: 42113
edges number: 344399
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.673766613006592  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.713928699493408  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7239694595336914  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.7239694595336914  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

m.shape torch.Size([1216, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.858600616455078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.858600616455078  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 1216, 256]), torch.Size([1, 1216, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8611602783203125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8808441162109375  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 1216, 256])
m.shape torch.Size([970, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8813319206237793  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8813319206237793  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.8831820487976074  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.911120891571045  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 970, 256])
m.shape torch.Size([748, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9124178886413574  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9124178886413574  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 748, 256]), torch.Size([1, 748, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.913844585418701  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.947838306427002  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 748, 256])
m.shape torch.Size([618, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9498348236083984  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9498348236083984  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 618, 256]), torch.Size([1, 618, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9510135650634766  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.986532211303711  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 618, 256])
m.shape torch.Size([544, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9885573387145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9885573387145996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 544, 256]), torch.Size([1, 544, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 2.9895949363708496  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.027749538421631  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 544, 256])
m.shape torch.Size([446, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.0298027992248535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.0298027992248535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 446, 256]), torch.Size([1, 446, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.030653476715088  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.072136402130127  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 446, 256])
m.shape torch.Size([379, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.07426118850708  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.07426118850708  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 379, 256]), torch.Size([1, 379, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.074984073638916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.114945411682129  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 379, 256])
m.shape torch.Size([309, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.116960048675537  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.116960048675537  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 309, 256]), torch.Size([1, 309, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.117549419403076  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.153008460998535  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 309, 256])
m.shape torch.Size([327, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1555423736572266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1555423736572266  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 327, 256]), torch.Size([1, 327, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.1561660766601562  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.197617530822754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 327, 256])
m.shape torch.Size([304, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200227737426758  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200227737426758  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 304, 256]), torch.Size([1, 304, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.200807571411133  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.243173599243164  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 304, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2456541061401367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2456541061401367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2461538314819336  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.285900115966797  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([262, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.28867244720459  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.28867244720459  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.2891721725463867  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3327322006225586  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([236, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.336045265197754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.336045265197754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3364953994750977  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.3779077529907227  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380280017852783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380280017852783  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.380648136138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4170918464660645  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([171, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4193735122680664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4193735122680664  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 171, 256]), torch.Size([1, 171, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4196996688842773  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4542722702026367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 171, 256])
m.shape torch.Size([177, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.456831455230713  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.456831455230713  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4571690559387207  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.4953179359436035  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([169, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.497910499572754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.497910499572754  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.498232841491699  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5369138717651367  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([177, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5398149490356445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5398149490356445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5401525497436523  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5830278396606445  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([157, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.585726261138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.585726261138916  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.5860257148742676  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.626152515411377  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([161, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.62921142578125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.62921142578125  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.629518508911133  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6728172302246094  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([151, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6757116317749023  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.6757116317749023  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.675999641418457  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.718625068664551  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([99, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.7205748558044434  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.7205748558044434  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 6.8592529296875 GB
    Memory Allocated: 3.720763683319092  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.7500319480895996  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([121, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.752612590789795  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.752612590789795  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 6.8651123046875 GB
    Memory Allocated: 3.7528433799743652  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.790231227874756  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.7925844192504883  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.7925844192504883  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 6.9022216796875 GB
    Memory Allocated: 3.792788505554199  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8272790908813477  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([2950, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8980603218078613  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.8980603218078613  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

 h.shape torch.Size([1, 2950, 256]), torch.Size([1, 2950, 256])
----------------------------------------3
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 3.903687000274658  GigaBytes
Max Memory Allocated: 4.632481575012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.894869327545166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2950, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.770498275756836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.77293586730957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.77558708190918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.773065567016602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11254, 40])
input nodes number: 42113
output nodes number: 11254
edges number: 138281
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.774256706237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.9373779296875 GB
    Memory Allocated: 4.774257183074951  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05108976364135742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0566401481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0566401481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.022721916437149048 |0.04270121455192566 |0.19005808234214783 |0.00011402368545532227 |0.0792492926120758 |0.0057888031005859375 |
----------------------------------------------------------pseudo_mini_loss sum 5.337371349334717
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  663106
Number of first layer input nodes during this epoch:  426598
Number of first layer output nodes during this epoch:  236508
----------------------------------------before generate dataloader block 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.056639671325683594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes
[05:14:54] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28960368 edges into 8 parts and get 4576061 edge cuts

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.018486976623535156
global_2_local spend time (sec) 0.044968366622924805
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.00436711311340332
A = g.adjacency_matrix() spent  0.008253335952758789
auxiliary_graph
Graph(num_nodes=154588, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07741212844848633
remove nodes length
63647
auxiliary_graph.remove_nodes spent  1.384242057800293
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29051309,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2025973796844482

the counter of shared neighbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
28960368
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28960365, 28960366, 28960367])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23400434, 2.0: 4036754, 3.0: 1010432, 4.0: 304962, 5.0: 111600, 6.0: 47598, 7.0: 22426, 8.0: 11400, 9.0: 6184, 10.0: 3450, 11.0: 2064, 12.0: 1124, 13.0: 706, 14.0: 442, 15.0: 244, 16.0: 210, 17.0: 164, 18.0: 88, 19.0: 62, 20.0: 12, 21.0: 12})
Convert a graph into a bidirected graph: 1.358 seconds
Metis partitioning: 5.204 seconds
Split the graph: 1.989 seconds
Construct subgraphs: 0.060 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.625257015228271
11390
11508
11595
11602
11529
11035
11181
11101
total k batches seeds list generation spend  18.963656663894653
after graph partition
graph partition algorithm spend time 19.0554039478302
11390
11508
11595
11602
11529
11035
11181
11101
partition_len_list
[19784, 22154, 21560, 23764, 41753, 47118, 28979, 31492]
shared_neighbor_graph_partition_s0 selection method  spend 19.153284072875977
time for parepare:  0.017482995986938477
local_output_nid generation:  0.0021555423736572266
local_in_edges_tensor generation:  0.002237558364868164
mini_batch_src_global generation:  0.003183126449584961
r_  generation:  0.029636859893798828
local_output_nid generation:  0.0027871131896972656
local_in_edges_tensor generation:  0.0023844242095947266
mini_batch_src_global generation:  0.0035789012908935547
r_  generation:  0.029125213623046875
local_output_nid generation:  0.002895832061767578
local_in_edges_tensor generation:  0.002050161361694336
mini_batch_src_global generation:  0.0026383399963378906
r_  generation:  0.027055025100708008
local_output_nid generation:  0.004041194915771484
local_in_edges_tensor generation:  0.002099752426147461
mini_batch_src_global generation:  0.0033664703369140625
r_  generation:  0.03088092803955078
local_output_nid generation:  0.0030291080474853516
local_in_edges_tensor generation:  0.0030794143676757812
mini_batch_src_global generation:  0.00479888916015625
r_  generation:  0.04421806335449219
local_output_nid generation:  0.003947019577026367
local_in_edges_tensor generation:  0.0029153823852539062
mini_batch_src_global generation:  0.004590511322021484
r_  generation:  0.03923320770263672
local_output_nid generation:  0.0034122467041015625
local_in_edges_tensor generation:  0.002067089080810547
mini_batch_src_global generation:  0.0027434825897216797
r_  generation:  0.027788877487182617
local_output_nid generation:  0.003239154815673828
local_in_edges_tensor generation:  0.0020232200622558594
mini_batch_src_global generation:  0.002352476119995117
r_  generation:  0.026959657669067383
----------------------check_connections_block total spend ----------------------------- 0.4058396816253662
generate_one_block  0.04798555374145508
generate_one_block  0.04102373123168945
generate_one_block  0.03469729423522949
generate_one_block  0.03960871696472168
generate_one_block  0.06847929954528809
generate_one_block  0.05921792984008789
generate_one_block  0.03573012351989746
generate_one_block  0.03678250312805176
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.048944711685180664
gen group dst list time:  0.006788492202758789
time for parepare:  0.022504091262817383
local_output_nid generation:  0.0036590099334716797
local_in_edges_tensor generation:  0.016228437423706055
mini_batch_src_global generation:  0.0039827823638916016
r_  generation:  0.04279065132141113
local_output_nid generation:  0.005405426025390625
local_in_edges_tensor generation:  0.0060367584228515625
mini_batch_src_global generation:  0.007426738739013672
r_  generation:  0.04828476905822754
local_output_nid generation:  0.005391836166381836
local_in_edges_tensor generation:  0.004302501678466797
mini_batch_src_global generation:  0.004114389419555664
r_  generation:  0.04411816596984863
local_output_nid generation:  0.006029605865478516
local_in_edges_tensor generation:  0.004836320877075195
mini_batch_src_global generation:  0.005177736282348633
r_  generation:  0.05580615997314453
local_output_nid generation:  0.008980751037597656
local_in_edges_tensor generation:  0.01387476921081543
mini_batch_src_global generation:  0.011858224868774414
r_  generation:  0.11762356758117676
local_output_nid generation:  0.01094961166381836
local_in_edges_tensor generation:  0.012953519821166992
mini_batch_src_global generation:  0.014528274536132812
r_  generation:  0.13329076766967773
local_output_nid generation:  0.007597446441650391
local_in_edges_tensor generation:  0.0064487457275390625
mini_batch_src_global generation:  0.009051322937011719
r_  generation:  0.07057905197143555
local_output_nid generation:  0.008026599884033203
local_in_edges_tensor generation:  0.007396697998046875
mini_batch_src_global generation:  0.00882267951965332
r_  generation:  0.08272790908813477
----------------------check_connections_block total spend ----------------------------- 0.9645593166351318
generate_one_block  0.05933189392089844
generate_one_block  0.06647658348083496
generate_one_block  0.05796241760253906
generate_one_block  0.09044194221496582
generate_one_block  0.15500402450561523
generate_one_block  0.17668867111206055
generate_one_block  0.08939075469970703
generate_one_block  0.10301470756530762
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.056639671325683594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

connection checking time:  0.9645593166351318
block generation total time  0.7983109951019287
average batch blocks generation time:  0.09978887438774109
block dataloader generation time/epoch 21.872883081436157
pseudo mini batch 0 input nodes size: 33488
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04651355743408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06248188018798828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06256675720214844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.029593944549560547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.031208515167236328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.031208515167236328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.031208515167236328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([33488, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.031208515167236328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1855, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09340238571166992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09340238571166992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1855, 128]), torch.Size([1, 1855, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09517145156860352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.10932397842407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1855, 128])
m.shape torch.Size([2017, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11036300659179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11036300659179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2017, 128]), torch.Size([1, 2017, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11228656768798828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14113998413085938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2017, 128])
m.shape torch.Size([1825, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14278888702392578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.14278888702392578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1825, 128]), torch.Size([1, 1825, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1445293426513672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18307161331176758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1825, 128])
m.shape torch.Size([1617, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18543052673339844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18543052673339844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1617, 128]), torch.Size([1, 1617, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.18697261810302734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23277664184570312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1617, 128])
m.shape torch.Size([1346, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2352147102355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2352147102355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1346, 128]), torch.Size([1, 1346, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23649835586547852  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.284574031829834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1346, 128])
m.shape torch.Size([1226, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28743982315063477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28743982315063477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1226, 128]), torch.Size([1, 1226, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28860902786254883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.33946657180786133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1226, 128])
m.shape torch.Size([1058, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.34241342544555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.34241342544555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.34342241287231445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3941178321838379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([935, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.39718008041381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.39718008041381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 935, 128]), torch.Size([1, 935, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3980717658996582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.45020627975463867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 935, 128])
m.shape torch.Size([798, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4531850814819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4531850814819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 798, 128]), torch.Size([1, 798, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4539461135864258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5045642852783203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 798, 128])
m.shape torch.Size([7107, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5380725860595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5380725860595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 7107, 128]), torch.Size([1, 7107, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5448503494262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.026071548461914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 7107, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9727721214294434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9923033714294434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0118346214294434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9921555519104004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([19784, 256])
first layer input nodes number: 33488
first layer output nodes number: 19784
edges number: 125056
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0120863914489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0316176414489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.03633451461792  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.03633451461792  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1445, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1267390251159668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1267390251159668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1445, 256]), torch.Size([1, 1445, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1294951438903809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1529345512390137  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1445, 256])
m.shape torch.Size([1348, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1541638374328613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1541638374328613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1348, 256]), torch.Size([1, 1348, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1568341255187988  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.200448989868164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1348, 256])
m.shape torch.Size([1169, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2025341987609863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2025341987609863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1169, 256]), torch.Size([1, 1169, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2049107551574707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.254824161529541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1169, 256])
m.shape torch.Size([955, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2572369575500488  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2572369575500488  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 955, 256]), torch.Size([1, 955, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2590584754943848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.311882495880127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 955, 256])
m.shape torch.Size([795, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3147926330566406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3147926330566406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 795, 256]), torch.Size([1, 795, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3163089752197266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3711843490600586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 795, 256])
m.shape torch.Size([703, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3744802474975586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3744802474975586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 703, 256]), torch.Size([1, 703, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3758211135864258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4349966049194336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 703, 256])
m.shape torch.Size([571, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4381680488586426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4381680488586426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4392571449279785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4982705116271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([466, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5013093948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5013093948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 466, 256]), torch.Size([1, 466, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5021982192993164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5530147552490234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 466, 256])
m.shape torch.Size([411, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5561304092407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5561304092407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 411, 256]), torch.Size([1, 411, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5569143295288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6084842681884766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 411, 256])
m.shape torch.Size([396, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6119747161865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6119747161865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6127300262451172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6663570404052734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([345, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6696271896362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6696271896362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 345, 256]), torch.Size([1, 345, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6702852249145508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7220935821533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 345, 256])
m.shape torch.Size([285, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7250518798828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7250518798828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 285, 256]), torch.Size([1, 285, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.725595474243164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.772512435913086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 285, 256])
m.shape torch.Size([248, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7753396034240723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7753396034240723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 248, 256]), torch.Size([1, 248, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7758126258850098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8193306922912598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 248, 256])
m.shape torch.Size([219, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8220410346984863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8220410346984863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 219, 256]), torch.Size([1, 219, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8224587440490723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.86381196975708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 219, 256])
m.shape torch.Size([173, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8662834167480469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8662834167480469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8666133880615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.901590347290039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([172, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9040703773498535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9040703773498535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9043984413146973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.941469669342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([168, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9440507888793945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9440507888793945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 168, 256]), torch.Size([1, 168, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.944371223449707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.982823371887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 168, 256])
m.shape torch.Size([144, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.985154628753662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.985154628753662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.985429286956787  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.020310878753662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([113, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0222373008728027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0222373008728027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0224528312683105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0513339042663574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([121, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0535521507263184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0535521507263184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0537829399108887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0863242149353027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([111, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.088449478149414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.088449478149414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0886611938476562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1199951171875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([76, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1214966773986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1214966773986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1216416358947754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1441102027893066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([75, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.145695686340332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.145695686340332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.145838737487793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.169013023376465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.170846939086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.170846939086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1709766387939453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1928958892822266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([813, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2125139236450195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2125139236450195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.214064598083496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4948415756225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 813, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4167866706848145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4184842109680176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4201817512512207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4183993339538574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11390, 40])
input nodes number: 19784
output nodes number: 11390
edges number: 91597
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4178919792175293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4178929328918457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03358745574951172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 1 input nodes size: 36843
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.028854846954345703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0464329719543457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.046518802642822266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03046560287475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03216218948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03216218948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03216218948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([36843, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03216218948364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2285, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.10090303421020508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.10090303421020508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2285, 128]), torch.Size([1, 2285, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.10308218002319336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1221613883972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2285, 128])
m.shape torch.Size([2309, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.12327384948730469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.12327384948730469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2309, 128]), torch.Size([1, 2309, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.12547588348388672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1594257354736328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2309, 128])
m.shape torch.Size([2075, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2075, 128]), torch.Size([1, 2075, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16347217559814453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21022939682006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2075, 128])
m.shape torch.Size([1754, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2117762565612793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2117762565612793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1754, 128]), torch.Size([1, 1754, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21344900131225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26282835006713867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1754, 128])
m.shape torch.Size([1577, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26575183868408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26575183868408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1577, 128]), torch.Size([1, 1577, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2672557830810547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.32228612899780273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1577, 128])
m.shape torch.Size([1329, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3253364562988281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3253364562988281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.32660388946533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.38153696060180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1329, 128])
m.shape torch.Size([1105, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.38459157943725586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.38459157943725586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1105, 128]), torch.Size([1, 1105, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.38564538955688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4387965202331543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1105, 128])
m.shape torch.Size([1039, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4422330856323242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4422330856323242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1039, 128]), torch.Size([1, 1039, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4432239532470703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5000629425048828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1039, 128])
m.shape torch.Size([890, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5033869743347168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5033869743347168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 890, 128]), torch.Size([1, 890, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5042357444763184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5595431327819824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 890, 128])
m.shape torch.Size([7791, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5962691307067871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5962691307067871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 7791, 128]), torch.Size([1, 7791, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6042375564575195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.152806282043457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 7791, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0907106399536133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1118383407592773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1329660415649414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1116728782653809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([22154, 256])
first layer input nodes number: 36843
first layer output nodes number: 22154
edges number: 137970
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1332426071166992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1543703079223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1596522331237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1596522331237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1702, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2483601570129395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2483601570129395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1702, 256]), torch.Size([1, 1702, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.251640796661377  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2782840728759766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1702, 256])
m.shape torch.Size([1484, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2803688049316406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2803688049316406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1484, 256]), torch.Size([1, 1484, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2832660675048828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3273515701293945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1484, 256])
m.shape torch.Size([1200, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3289713859558105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3289713859558105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1200, 256]), torch.Size([1, 1200, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3314881324768066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.382683277130127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1200, 256])
m.shape torch.Size([948, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3861451148986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3861451148986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 948, 256]), torch.Size([1, 948, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.387953281402588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4403901100158691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 948, 256])
m.shape torch.Size([782, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.443244457244873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.443244457244873  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 782, 256]), torch.Size([1, 782, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4447360038757324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.49843168258667  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 782, 256])
m.shape torch.Size([636, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5013537406921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5013537406921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 636, 256]), torch.Size([1, 636, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5025668144226074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5558066368103027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 636, 256])
m.shape torch.Size([533, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.558786392211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.558786392211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 533, 256]), torch.Size([1, 533, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5598030090332031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6108026504516602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 533, 256])
m.shape torch.Size([480, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6139850616455078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6139850616455078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 480, 256]), torch.Size([1, 480, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6149005889892578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6670856475830078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 480, 256])
m.shape torch.Size([424, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6702957153320312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6702957153320312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 424, 256]), torch.Size([1, 424, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6711044311523438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7230682373046875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 424, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7260470390319824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7260470390319824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7267107963562012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7759737968444824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([315, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7789726257324219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7789726257324219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 315, 256]), torch.Size([1, 315, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7795734405517578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8272218704223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 315, 256])
m.shape torch.Size([259, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.829908847808838  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.829908847808838  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 259, 256]), torch.Size([1, 259, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8304028511047363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.874025821685791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 259, 256])
m.shape torch.Size([218, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8765029907226562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8765029907226562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 218, 256]), torch.Size([1, 218, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8769187927246094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9151725769042969  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 218, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9175620079040527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9175620079040527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9179301261901855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.954373836517334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([172, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.956669807434082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.956669807434082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9569978713989258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9917726516723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([135, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9940204620361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9940204620361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9942779541015625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.023374557495117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([143, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0255823135375977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0255823135375977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.02585506439209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0585851669311523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([106, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0602827072143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0602827072143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0604848861694336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0861616134643555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.087831974029541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.087831974029541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.088016986846924  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1128087043762207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.11483097076416  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.11483097076416  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1150407791137695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1446237564086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([97, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1464767456054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1464767456054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1466617584228516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.174043655395508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([65, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.175325870513916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.175325870513916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.175449848175049  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1946663856506348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([74, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1962404251098633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1962404251098633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1963815689086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2192468643188477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.220698833465576  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.220698833465576  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.220824718475342  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2420992851257324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([921, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2641663551330566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2641663551330566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 921, 256]), torch.Size([1, 921, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.265923023223877  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5751423835754395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 921, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.4986839294433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5006484985351562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.502613067626953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5005626678466797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11508, 40])
input nodes number: 22154
output nodes number: 11508
edges number: 89664
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5010809898376465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5010814666748047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03569459915161133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 2 input nodes size: 35542
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03073263168334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03073263168334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.048299312591552734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0483860969543457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03072214126586914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03215646743774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03215646743774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03215646743774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([35542, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03215646743774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2745, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09244680404663086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09244680404663086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2745, 128]), torch.Size([1, 2745, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.09506464004516602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11600732803344727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2745, 128])
m.shape torch.Size([2807, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11737537384033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11737537384033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2807, 128]), torch.Size([1, 2807, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.12005233764648438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16115665435791016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2807, 128])
m.shape torch.Size([2429, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1638336181640625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1638336181640625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2429, 128]), torch.Size([1, 2429, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16632843017578125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21899080276489258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2429, 128])
m.shape torch.Size([2028, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22223854064941406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22223854064941406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2028, 128]), torch.Size([1, 2028, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22417259216308594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28079795837402344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2028, 128])
m.shape torch.Size([1666, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28380298614501953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28380298614501953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1666, 128]), torch.Size([1, 1666, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28539180755615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3456401824951172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1666, 128])
m.shape torch.Size([1403, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3488597869873047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3488597869873047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1403, 128]), torch.Size([1, 1403, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35019779205322266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.40860748291015625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1403, 128])
m.shape torch.Size([1161, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41181373596191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41181373596191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1161, 128]), torch.Size([1, 1161, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4129209518432617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4692206382751465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1161, 128])
m.shape torch.Size([1020, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47255802154541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47255802154541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1020, 128]), torch.Size([1, 1020, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.47353076934814453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5298271179199219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1020, 128])
m.shape torch.Size([860, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5330314636230469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5330314636230469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 860, 128]), torch.Size([1, 860, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5338516235351562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5863418579101562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 860, 128])
m.shape torch.Size([5441, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6118764877319336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6118764877319336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 5441, 128]), torch.Size([1, 5441, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6171817779541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9863967895507812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 5441, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9368424415588379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9574036598205566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9779648780822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9572429656982422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([21560, 256])
first layer input nodes number: 35542
first layer output nodes number: 21560
edges number: 118943
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9782319068908691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.9987931251525879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0039334297180176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0039334297180176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1942, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.077268123626709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.077268123626709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1942, 256]), torch.Size([1, 1942, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.0812811851501465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1109137535095215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1942, 256])
m.shape torch.Size([1729, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1123857498168945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1123857498168945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1729, 256]), torch.Size([1, 1729, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1158761978149414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.170283317565918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1729, 256])
m.shape torch.Size([1368, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1716704368591309  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1716704368591309  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1368, 256]), torch.Size([1, 1368, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1743178367614746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2325005531311035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1368, 256])
m.shape torch.Size([1053, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2350611686706543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2350611686706543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1053, 256]), torch.Size([1, 1053, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2374606132507324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.298433780670166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1053, 256])
m.shape torch.Size([886, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3016877174377441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3016877174377441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 886, 256]), torch.Size([1, 886, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.303377628326416  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.368654727935791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 886, 256])
m.shape torch.Size([691, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3717947006225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3717947006225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 691, 256]), torch.Size([1, 691, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.373112678527832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.429804801940918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 691, 256])
m.shape torch.Size([577, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.433028221130371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.433028221130371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 577, 256]), torch.Size([1, 577, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.434128761291504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.489670753479004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 577, 256])
m.shape torch.Size([523, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4932756423950195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4932756423950195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4942731857299805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.551133155822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([409, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5541725158691406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5541725158691406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 409, 256]), torch.Size([1, 409, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.554952621459961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6070537567138672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 409, 256])
m.shape torch.Size([341, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6099414825439453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6099414825439453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 341, 256]), torch.Size([1, 341, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6105918884277344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6577262878417969  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 341, 256])
m.shape torch.Size([261, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6601605415344238  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6601605415344238  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.660658359527588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7011818885803223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([234, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.70363187789917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.70363187789917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 234, 256]), torch.Size([1, 234, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.704078197479248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7420153617858887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 234, 256])
m.shape torch.Size([193, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.744204044342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.744204044342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7445721626281738  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7784390449523926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([160, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7804079055786133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7804079055786133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7807130813598633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8109254837036133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([153, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.812978744506836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.812978744506836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8132705688476562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8442039489746094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.845749855041504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.845749855041504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8459596633911133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8696680068969727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([107, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8713116645812988  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8713116645812988  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8715157508850098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8960061073303223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8975305557250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8975305557250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.897709846496582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9204797744750977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9217734336853027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9217734336853027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9219164848327637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9410853385925293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9422636032104492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9422636032104492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.942387580871582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9598684310913086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9609370231628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9609370231628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9610438346862793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9768519401550293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.977982997894287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.977982997894287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9780898094177246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.994645595550537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9955430030822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9955430030822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9956250190734863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.008911609649658  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0098628997802734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0098628997802734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0099449157714844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.023805618286133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([426, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.034000873565674  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.034000873565674  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.034813404083252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.177971363067627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 426, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1167426109313965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1185946464538574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1203227043151855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1183838844299316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11595, 40])
input nodes number: 21560
output nodes number: 11595
edges number: 73404
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.118518829345703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1185193061828613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.034903526306152344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 3 input nodes size: 45035
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030609607696533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.030609607696533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05208396911621094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.052170753479003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03451728820800781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03629302978515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03629302978515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03629302978515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([45035, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03629302978515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2268, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1105489730834961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1105489730834961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2268, 128]), torch.Size([1, 2268, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.11271190643310547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13087034225463867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2268, 128])
m.shape torch.Size([2405, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13195180892944336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.13195180892944336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2405, 128]), torch.Size([1, 2405, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1342453956604004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.16915082931518555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2405, 128])
m.shape torch.Size([2233, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17119836807250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.17119836807250977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2233, 128]), torch.Size([1, 2233, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.1736903190612793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22466611862182617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2233, 128])
m.shape torch.Size([1920, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22636890411376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22636890411376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1920, 128]), torch.Size([1, 1920, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.22819995880126953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.28130054473876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1920, 128])
m.shape torch.Size([1778, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2846240997314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2846240997314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1778, 128]), torch.Size([1, 1778, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2863197326660156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3476829528808594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1778, 128])
m.shape torch.Size([1409, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35086631774902344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35086631774902344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1409, 128]), torch.Size([1, 1409, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.35221004486083984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41137170791625977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1409, 128])
m.shape torch.Size([1266, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41492557525634766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41492557525634766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1266, 128]), torch.Size([1, 1266, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41613292694091797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4775838851928711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1266, 128])
m.shape torch.Size([1148, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48135948181152344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.48135948181152344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1148, 128]), torch.Size([1, 1148, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4824542999267578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5457048416137695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1148, 128])
m.shape torch.Size([960, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5492773056030273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5492773056030273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 960, 128]), torch.Size([1, 960, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5501928329467773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6090130805969238  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 960, 128])
m.shape torch.Size([8377, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6484999656677246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6484999656677246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 8377, 128]), torch.Size([1, 8377, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6564888954162598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2237029075622559  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 8377, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1585273742675781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1811904907226562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2038536071777344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.1810131072998047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([23764, 256])
first layer input nodes number: 45035
first layer output nodes number: 23764
edges number: 149257
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2041912078857422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2268543243408203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2325201034545898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.2325201034545898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1609, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3199820518493652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3199820518493652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1609, 256]), torch.Size([1, 1609, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.323178768157959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3486824035644531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1609, 256])
m.shape torch.Size([1497, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3507237434387207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.3507237434387207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1497, 256]), torch.Size([1, 1497, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.353579044342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.399421215057373  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1497, 256])
m.shape torch.Size([1232, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.400876522064209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.400876522064209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1232, 256]), torch.Size([1, 1232, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4032988548278809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4587078094482422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1232, 256])
m.shape torch.Size([1005, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4614486694335938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4614486694335938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1005, 256]), torch.Size([1, 1005, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.4633655548095703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.519317626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1005, 256])
m.shape torch.Size([872, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5225882530212402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5225882530212402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 872, 256]), torch.Size([1, 872, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5242514610290527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.587308406829834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 872, 256])
m.shape torch.Size([649, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.590219497680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.590219497680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 649, 256]), torch.Size([1, 649, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.5914573669433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6446857452392578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 649, 256])
m.shape torch.Size([580, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6479692459106445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6479692459106445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.6490755081176758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7043886184692383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([483, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7075495719909668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7075495719909668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 483, 256]), torch.Size([1, 483, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7084708213806152  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7611823081970215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 483, 256])
m.shape torch.Size([395, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7641386985778809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7641386985778809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 395, 256]), torch.Size([1, 395, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.7648921012878418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.81449556350708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 395, 256])
m.shape torch.Size([365, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8176274299621582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8176274299621582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 365, 256]), torch.Size([1, 365, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8183236122131348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8681244850158691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 365, 256])
m.shape torch.Size([292, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.870863914489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.870863914489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 292, 256]), torch.Size([1, 292, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.8714208602905273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9164252281188965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 292, 256])
m.shape torch.Size([262, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9191689491271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9191689491271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9196686744689941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9642329216003418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([239, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9669694900512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9669694900512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 239, 256]), torch.Size([1, 239, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 1.9674253463745117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.009364128112793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 239, 256])
m.shape torch.Size([211, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0119757652282715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0119757652282715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 211, 256]), torch.Size([1, 211, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.012378215789795  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0522208213806152  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 211, 256])
m.shape torch.Size([201, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0557990074157715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0557990074157715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.056182384490967  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.09682035446167  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.098874092102051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.098874092102051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.0991525650024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.130620002746582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([129, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1325888633728027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1325888633728027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.1328349113464355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.162360668182373  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([117, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.164261817932129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.164261817932129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.164484977722168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.192826271057129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.194650650024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.194650650024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.194852828979492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.221944808959961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2239584922790527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2239584922790527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.224168300628662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.253751277923584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2551403045654297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2551403045654297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.255281448364258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2761707305908203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([74, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.277665138244629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.277665138244629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.277806282043457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.2996835708618164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.30076265335083  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.30076265335083  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3008618354797363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.316929340362549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3182411193847656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3182411193847656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3183536529541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.337371826171875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([843, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.357571601867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.357571601867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 843, 256]), torch.Size([1, 843, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.3591794967651367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.644268035888672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 843, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.569528579711914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.571491241455078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5732202529907227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5711708068847656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11602, 40])
input nodes number: 23764
output nodes number: 11602
edges number: 88852
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5715456008911133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.5715460777282715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0398402214050293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 4 input nodes size: 67968
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03462791442871094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.03462791442871094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06782150268554688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.06790781021118164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04634666442871094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04991436004638672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04991436004638672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04991436004638672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([67968, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.04991436004638672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1879, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21717166900634766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.21717166900634766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1879, 128]), torch.Size([1, 1879, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.218963623046875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23329925537109375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1879, 128])
m.shape torch.Size([1885, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23420095443725586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23420095443725586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1885, 128]), torch.Size([1, 1885, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.23599863052368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2639193534851074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1885, 128])
m.shape torch.Size([1801, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26590633392333984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.26590633392333984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1801, 128]), torch.Size([1, 1801, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.2676239013671875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30541038513183594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1801, 128])
m.shape torch.Size([1670, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30791807174682617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.30791807174682617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1670, 128]), torch.Size([1, 1670, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3095107078552246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3581709861755371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1670, 128])
m.shape torch.Size([1639, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3612823486328125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.3612823486328125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1639, 128]), torch.Size([1, 1639, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.36284542083740234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.41944265365600586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1639, 128])
m.shape torch.Size([1491, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4229269027709961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4229269027709961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1491, 128]), torch.Size([1, 1491, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4243488311767578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.4862861633300781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1491, 128])
m.shape torch.Size([1459, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.49071550369262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.49071550369262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1459, 128]), torch.Size([1, 1459, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.49210691452026367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5616774559020996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1459, 128])
m.shape torch.Size([1371, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5662117004394531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5662117004394531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1371, 128]), torch.Size([1, 1371, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.5675191879272461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6420459747314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1371, 128])
m.shape torch.Size([1350, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6471858024597168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6471858024597168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1350, 128]), torch.Size([1, 1350, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.6484732627868652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.7315735816955566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1350, 128])
m.shape torch.Size([27208, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8606677055358887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8606677055358887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 27208, 128]), torch.Size([1, 27208, 128])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.8866152763366699  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7288928031921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 27208, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.572781562805176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.612600326538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.652419090270996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6122889518737793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([41753, 256])
first layer input nodes number: 67968
first layer output nodes number: 41753
edges number: 340284
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.6529273986816406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.692746162414551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7027010917663574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.7027010917663574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1239, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.837521553039551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.837521553039551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1239, 256]), torch.Size([1, 1239, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.840414047241211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.861268997192383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1239, 256])
m.shape torch.Size([1018, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8614892959594727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8614892959594727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1018, 256]), torch.Size([1, 1018, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.863430976867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8925561904907227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1018, 256])
m.shape torch.Size([835, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8941450119018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.8941450119018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 835, 256]), torch.Size([1, 835, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.895737648010254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.931523323059082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 835, 256])
m.shape torch.Size([677, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9334216117858887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9334216117858887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 677, 256]), torch.Size([1, 677, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9347128868103027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9739956855773926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 677, 256])
m.shape torch.Size([580, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9761643409729004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9761643409729004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 580, 256]), torch.Size([1, 580, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 2.9772706031799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.022737979888916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 580, 256])
m.shape torch.Size([464, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.024998188018799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.024998188018799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 464, 256]), torch.Size([1, 464, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.025883197784424  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0646815299987793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 464, 256])
m.shape torch.Size([398, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0669169425964355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.0669169425964355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 398, 256]), torch.Size([1, 398, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.067676067352295  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.108518123626709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 398, 256])
m.shape torch.Size([324, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1106300354003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1106300354003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 324, 256]), torch.Size([1, 324, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.111248016357422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1480398178100586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 324, 256])
m.shape torch.Size([347, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1507325172424316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1507325172424316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 347, 256]), torch.Size([1, 347, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1513943672180176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.194127082824707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 347, 256])
m.shape torch.Size([298, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1966605186462402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1966605186462402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 298, 256]), torch.Size([1, 298, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.1972289085388184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.237882137298584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 298, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.240368366241455  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.240368366241455  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.240868091583252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.2810845375061035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([280, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.284064292907715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.284064292907715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 280, 256]), torch.Size([1, 280, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.2845983505249023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.3307409286499023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 280, 256])
m.shape torch.Size([233, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.333385467529297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.333385467529297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 233, 256]), torch.Size([1, 233, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.333829879760742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.374715805053711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 233, 256])
m.shape torch.Size([187, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.377009868621826  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.377009868621826  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 187, 256]), torch.Size([1, 187, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.377366542816162  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.41267728805542  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 187, 256])
m.shape torch.Size([182, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4151229858398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4151229858398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4154701232910156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4522666931152344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([175, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.454784393310547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.454784393310547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.455118179321289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4928359985351562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([165, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4962215423583984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4962215423583984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.4965362548828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5343017578125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([163, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5369644165039062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5369644165039062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 163, 256]), torch.Size([1, 163, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5372753143310547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.5767593383789062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 163, 256])
m.shape torch.Size([150, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.579343318939209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.579343318939209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.579629421234131  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.617967128753662  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([155, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6208038330078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6208038330078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6210994720458984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.6627845764160156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([144, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.665543556213379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.665543556213379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.665818214416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.706467628479004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7084450721740723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7084450721740723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7086358070373535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7381997108459473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([110, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7405362129211426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7405362129211426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.740746021270752  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.7747349739074707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([111, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.777190685272217  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.777190685272217  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.777402400970459  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8131823539733887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([2932, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8835272789001465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8835272789001465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2932, 256]), torch.Size([1, 2932, 256])
----------------------------------------3
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 3.8891196250915527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.873860836029053  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2932, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.749112606048584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.750855922698975  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.752686977386475  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.750857353210449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11529, 40])
input nodes number: 41753
output nodes number: 11529
edges number: 138479
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.751035690307617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 4.751036167144775  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05586528778076172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 5 input nodes size: 82691
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0461273193359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.0461273193359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08555746078491211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.08563995361328125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05236005783081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05603170394897461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05603170394897461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05603170394897461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([82691, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.0760498046875 GB
    Memory Allocated: 0.05603170394897461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2225, 1, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2418842315673828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2418842315673828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2225, 128]), torch.Size([1, 2225, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.24400615692138672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26131153106689453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2225, 128])
m.shape torch.Size([2506, 2, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26264047622680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.26264047622680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2506, 128]), torch.Size([1, 2506, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.2659573554992676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.30233335494995117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2506, 128])
m.shape torch.Size([2255, 3, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3043642044067383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3043642044067383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2255, 128]), torch.Size([1, 2255, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.30663442611694336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.3570694923400879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2255, 128])
m.shape torch.Size([2059, 4, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36029529571533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36029529571533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2059, 128]), torch.Size([1, 2059, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.36234045028686523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4231729507446289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2059, 128])
m.shape torch.Size([2060, 5, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4261941909790039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.4261941909790039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2060, 128]), torch.Size([1, 2060, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.42906665802001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5052065849304199  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2060, 128])
m.shape torch.Size([1843, 6, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5101180076599121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5101180076599121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1843, 128]), torch.Size([1, 1843, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5118756294250488  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5874552726745605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1843, 128])
m.shape torch.Size([1793, 7, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5925612449645996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.5925612449645996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1793, 128]), torch.Size([1, 1793, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.594271183013916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6802468299865723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1793, 128])
m.shape torch.Size([1700, 8, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6858768463134766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6858768463134766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1700, 128]), torch.Size([1, 1700, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.6874980926513672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7802524566650391  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1700, 128])
m.shape torch.Size([1662, 9, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7865743637084961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7865743637084961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1662, 128]), torch.Size([1, 1662, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.7881593704223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 0.8916444778442383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1662, 128])
m.shape torch.Size([29015, 10, 128])
----------------------------------------1
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0292062759399414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0292062759399414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 29015, 128]), torch.Size([1, 29015, 128])
----------------------------------------3
 Nvidia-smi: 7.2557373046875 GB
    Memory Allocated: 1.0568771362304688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.02150821685791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 29015, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.849518299102783  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.894453525543213  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.9393887519836426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.894102096557617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([47118, 256])
first layer input nodes number: 82691
first layer output nodes number: 47118
edges number: 374855
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.940007209777832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.9849424362182617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.996176242828369  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 2.996176242828369  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1395, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1115169525146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1115169525146484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1395, 256]), torch.Size([1, 1395, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.114809513092041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.137373924255371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1395, 256])
m.shape torch.Size([1230, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1385879516601562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1385879516601562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1230, 256]), torch.Size([1, 1230, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.140979290008545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1769251823425293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1230, 256])
m.shape torch.Size([904, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1787729263305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.1787729263305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 904, 256]), torch.Size([1, 904, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.180497169494629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.218430519104004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 904, 256])
m.shape torch.Size([675, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.220715045928955  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.220715045928955  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 675, 256]), torch.Size([1, 675, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.2220025062561035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.2622265815734863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 675, 256])
m.shape torch.Size([632, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.264620304107666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.264620304107666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 632, 256]), torch.Size([1, 632, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.2658257484436035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.3102059364318848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 632, 256])
m.shape torch.Size([459, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.3122506141662598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.3122506141662598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 459, 256]), torch.Size([1, 459, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.3131260871887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.355891227722168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 459, 256])
m.shape torch.Size([416, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.35825252532959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.35825252532959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 416, 256]), torch.Size([1, 416, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.35904598236084  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.399603843688965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 416, 256])
m.shape torch.Size([334, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.401775360107422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.401775360107422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 334, 256]), torch.Size([1, 334, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4024124145507812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4401254653930664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 334, 256])
m.shape torch.Size([312, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4425058364868164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4425058364868164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.443100929260254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.481675148010254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([291, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4841747283935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.4841747283935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 291, 256]), torch.Size([1, 291, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.484729766845703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.5248303413391113  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 291, 256])
m.shape torch.Size([256, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.527259349822998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.527259349822998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 256, 256]), torch.Size([1, 256, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.527747631072998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.565833568572998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 256, 256])
m.shape torch.Size([214, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.5680580139160156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.5680580139160156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 214, 256]), torch.Size([1, 214, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.5684661865234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.603160858154297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 214, 256])
m.shape torch.Size([191, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6053433418273926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6053433418273926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6057076454162598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.639223575592041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([176, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6414098739624023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6414098739624023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6417455673217773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.6749792098999023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([176, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.677349090576172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.677349090576172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 176, 256]), torch.Size([1, 176, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.677684783935547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.713268280029297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 176, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.715437889099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.715437889099121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.7157278060913086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.748488426208496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([134, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.750533103942871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.750533103942871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.750788688659668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.781458854675293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([152, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.7840209007263184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.7840209007263184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.784310817718506  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.8211302757263184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([149, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.82370662689209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.82370662689209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.823990821838379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.8620729446411133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([117, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.864180088043213  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.864180088043213  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.864403247833252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.8958687782287598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([111, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.8979978561401367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.8979978561401367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.898209571838379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9295434951782227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([88, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9312987327575684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9312987327575684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.931466579437256  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9574828147888184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9591898918151855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9591898918151855  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9593443870544434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.984372615814209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9862332344055176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.9862332344055176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 3.986393451690674  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.01347017288208  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([2306, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.068799018859863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.068799018859863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2306, 256]), torch.Size([1, 2306, 256])
----------------------------------------3
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.073197364807129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.84870719909668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2306, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.744119644165039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.745880126953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.7478179931640625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.745975017547607  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11035, 40])
input nodes number: 47118
output nodes number: 11035
edges number: 117867
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.746426105499268  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9608154296875 GB
    Memory Allocated: 4.746426582336426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.06293964385986328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 6 input nodes size: 61979
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05237722396850586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05237722396850586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08193111419677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08201456069946289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04250192642211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04438638687133789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04438638687133789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04438638687133789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([61979, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04438638687133789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2858, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13471031188964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13471031188964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2858, 128]), torch.Size([1, 2858, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13776922225952148  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16039037704467773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2858, 128])
m.shape torch.Size([3067, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16195249557495117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16195249557495117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 3067, 128]), torch.Size([1, 3067, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16559410095214844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21170616149902344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 3067, 128])
m.shape torch.Size([2739, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2136521339416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2136521339416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2739, 128]), torch.Size([1, 2739, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21632099151611328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2760763168334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2739, 128])
m.shape torch.Size([2335, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.27999448776245117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.27999448776245117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2335, 128]), torch.Size([1, 2335, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.28302526473999023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3488469123840332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2335, 128])
m.shape torch.Size([2071, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35267114639282227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35267114639282227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2071, 128]), torch.Size([1, 2071, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3552088737487793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.43048095703125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2071, 128])
m.shape torch.Size([1715, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4344000816345215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4344000816345215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1715, 128]), torch.Size([1, 1715, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4360356330871582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5063643455505371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1715, 128])
m.shape torch.Size([1517, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5106101036071777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5106101036071777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1517, 128]), torch.Size([1, 1517, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.512056827545166  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5843930244445801  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1517, 128])
m.shape torch.Size([1331, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5887470245361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5887470245361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1331, 128]), torch.Size([1, 1331, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5900163650512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6623687744140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1331, 128])
m.shape torch.Size([1141, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.666630744934082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.666630744934082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1141, 128]), torch.Size([1, 1141, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6677188873291016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7377467155456543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1141, 128])
m.shape torch.Size([10205, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7858638763427734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7858638763427734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 10205, 128]), torch.Size([1, 10205, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7955961227416992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4888553619384766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 10205, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4110593795776367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4386959075927734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4663324356079102  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4384799003601074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([28979, 256])
first layer input nodes number: 61979
first layer output nodes number: 28979
edges number: 180780
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4667963981628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4944329261779785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5019526481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5019526481628418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1966, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.573537826538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.573537826538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1966, 256]), torch.Size([1, 1966, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.577779769897461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6090803146362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1966, 256])
m.shape torch.Size([1684, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.610548496246338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.610548496246338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1684, 256]), torch.Size([1, 1684, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6140694618225098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6646637916564941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1684, 256])
m.shape torch.Size([1322, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.666883945465088  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.666883945465088  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1322, 256]), torch.Size([1, 1322, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6695528030395508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7269573211669922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1322, 256])
m.shape torch.Size([1042, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7301301956176758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7301301956176758  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1042, 256]), torch.Size([1, 1042, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7324037551879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7927217483520508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1042, 256])
m.shape torch.Size([853, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7958273887634277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7958273887634277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 853, 256]), torch.Size([1, 853, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7974543571472168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.856325626373291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 853, 256])
m.shape torch.Size([637, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8591856956481934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8591856956481934  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 637, 256]), torch.Size([1, 637, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.860400676727295  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.912736415863037  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 637, 256])
m.shape torch.Size([498, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9154796600341797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9154796600341797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9164295196533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9652671813964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([426, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9680681228637695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9680681228637695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 426, 256]), torch.Size([1, 426, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9688806533813477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.015225410461426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 426, 256])
m.shape torch.Size([366, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0179853439331055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0179853439331055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 366, 256]), torch.Size([1, 366, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.018683433532715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0634775161743164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 366, 256])
m.shape torch.Size([294, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0659542083740234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0659542083740234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0665149688720703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1070728302001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([242, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1097755432128906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1097755432128906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 242, 256]), torch.Size([1, 242, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1102371215820312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.146240234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 242, 256])
m.shape torch.Size([212, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1484546661376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1484546661376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 212, 256]), torch.Size([1, 212, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1488590240478516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.183229446411133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 212, 256])
m.shape torch.Size([189, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1853890419006348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1853890419006348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 189, 256]), torch.Size([1, 189, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1857495307922363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.21891450881958  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 189, 256])
m.shape torch.Size([158, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.220860481262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.220860481262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2211618423461914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2509965896606445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([130, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.252720355987549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.252720355987549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2529683113098145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2792515754699707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([117, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2809271812438965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2809271812438965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2811503410339355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3063673973083496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([88, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3076939582824707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3076939582824707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.307861804962158  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.328003406524658  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([86, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3294076919555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3294076919555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3295717239379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3504037857055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3516550064086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3516550064086914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3517942428588867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3704519271850586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([58, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.371497631072998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.371497631072998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.371608257293701  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.387206554412842  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.388382911682129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.388382911682129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3884992599487305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4057188034057617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4064431190490723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4064431190490723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4065136909484863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.417452335357666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4182796478271484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4182796478271484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.418354034423828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4304046630859375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.431384563446045  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.431384563446045  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4314684867858887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4456515312194824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([559, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4590415954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4590415954589844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 559, 256]), torch.Size([1, 559, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4601078033447266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6482467651367188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 559, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5880937576293945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.59039306640625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.59205961227417  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.589676856994629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11181, 40])
input nodes number: 28979
output nodes number: 11181
edges number: 71994
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.59051513671875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.590515613555908  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04858255386352539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 7 input nodes size: 65219
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04304075241088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04304075241088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.07429075241088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.07437372207641602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.044736385345458984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04683351516723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04683351516723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04683351516723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([65219, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04683351516723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([3000, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15067386627197266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15067386627197266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 3000, 128]), torch.Size([1, 3000, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1535348892211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1769723892211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 3000, 128])
m.shape torch.Size([3009, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17841148376464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17841148376464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 3009, 128]), torch.Size([1, 3009, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.18128108978271484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22731590270996094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 3009, 128])
m.shape torch.Size([2534, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22874736785888672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22874736785888672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2534, 128]), torch.Size([1, 2534, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23138189315795898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2866706848144531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2534, 128])
m.shape torch.Size([2193, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2896451950073242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2896451950073242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2193, 128]), torch.Size([1, 2193, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2918992042541504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3545975685119629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2193, 128])
m.shape torch.Size([1902, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35721826553344727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35721826553344727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1902, 128]), torch.Size([1, 1902, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35903215408325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4255199432373047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1902, 128])
m.shape torch.Size([1575, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4291191101074219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4291191101074219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1575, 128]), torch.Size([1, 1575, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4306211471557617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.495208740234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1575, 128])
m.shape torch.Size([1451, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4993009567260742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4993009567260742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1451, 128]), torch.Size([1, 1451, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5006847381591797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5718822479248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1451, 128])
m.shape torch.Size([1329, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5762600898742676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5762600898742676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1329, 128]), torch.Size([1, 1329, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5775275230407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6497712135314941  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1329, 128])
m.shape torch.Size([1107, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6538882255554199  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6538882255554199  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1107, 128]), torch.Size([1, 1107, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6549439430236816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7236666679382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1107, 128])
m.shape torch.Size([13392, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7869968414306641  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7869968414306641  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 13392, 128]), torch.Size([1, 13392, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8001937866210938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7069778442382812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 13392, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6149635314941406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6449966430664062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6750297546386719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.644761562347412  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([31492, 256])
first layer input nodes number: 65219
first layer output nodes number: 31492
edges number: 209024
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6755180358886719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7055511474609375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.713059425354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.713059425354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2130, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7851171493530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7851171493530273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2130, 256]), torch.Size([1, 2130, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.789179801940918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.821681022644043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2130, 256])
m.shape torch.Size([1716, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8232765197753906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8232765197753906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1716, 256]), torch.Size([1, 1716, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8265876770019531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8767247200012207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1716, 256])
m.shape torch.Size([1247, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8785667419433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8785667419433594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1247, 256]), torch.Size([1, 1247, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8809585571289062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9359931945800781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1247, 256])
m.shape torch.Size([965, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9384851455688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9384851455688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 965, 256]), torch.Size([1, 965, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9403257369995117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9954195022583008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 965, 256])
m.shape torch.Size([822, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9984498023986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9984498023986816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0000176429748535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0582070350646973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 822, 256])
m.shape torch.Size([629, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0610523223876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0610523223876953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 629, 256]), torch.Size([1, 629, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0622520446777344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.114175796508789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 629, 256])
m.shape torch.Size([472, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1167516708374023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1167516708374023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 472, 256]), torch.Size([1, 472, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.11765193939209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1636037826538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 472, 256])
m.shape torch.Size([436, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.166506290435791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.166506290435791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 436, 256]), torch.Size([1, 436, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1673378944396973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2151761054992676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 436, 256])
m.shape torch.Size([312, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.217459201812744  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.217459201812744  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 312, 256]), torch.Size([1, 312, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2180542945861816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2572546005249023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 312, 256])
m.shape torch.Size([266, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2595138549804688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2595138549804688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.260021209716797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.297132968902588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([230, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2993111610412598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2993111610412598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2997498512268066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.333967685699463  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([191, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3360466957092285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3360466957092285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3364109992980957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3673768043518066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([145, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.369006633758545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.369006633758545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3692831993103027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3947272300720215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([130, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.39633846282959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.39633846282959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3965864181518555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4211339950561523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([102, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.422480583190918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.422480583190918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.422675132751465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4432973861694336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([104, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4447994232177734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4447994232177734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.444997787475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4674129486083984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([96, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4688825607299805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4688825607299805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4690656661987305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4910383224487305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([86, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4924349784851074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4924349784851074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4925990104675293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5134310722351074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5146822929382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5146822929382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5148215293884277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5334792137145996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([71, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5347747802734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5347747802734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.534910202026367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.554004669189453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.555208683013916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.555208683013916  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.555328845977783  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.573112964630127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([60, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.574321746826172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.574321746826172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5744361877441406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.592174530029297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5931124687194824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5931124687194824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.593198299407959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.607102870941162  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6083908081054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6083908081054688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6084861755371094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.624603271484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([660, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.640414237976074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.640414237976074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 660, 256]), torch.Size([1, 660, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6416730880737305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8632307052612305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 660, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8032803535461426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.805161952972412  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8070693016052246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8051047325134277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11101, 40])
input nodes number: 31492
output nodes number: 11101
edges number: 72393
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8050050735473633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8050055503845215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0503692626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0503692626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0503692626953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.019846022129058838 |0.002094477415084839 |0.11960655450820923 |9.298324584960938e-05 |0.07833847403526306 |0.005234241485595703 |
----------------------------------------------------------pseudo_mini_loss sum 4.637527942657471
Total (block generation + training)time/epoch 23.689680814743042
Training time/epoch 1.8164281845092773
Training time without block to device /epoch 1.7996723651885986
Training time without total dataloading part /epoch 1.589538335800171
load block tensor time/epoch 0.1587681770324707
block to device time/epoch 0.01675581932067871
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  665369
Number of first layer input nodes during this epoch:  428765
Number of first layer output nodes during this epoch:  236604
----------------------------------------before generate dataloader block 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0503687858581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.01696467399597168
global_2_local spend time (sec) 0.046985626220703125
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004448890686035156
A = g.adjacency_matrix() spent  0.014866352081298828
auxiliary_graph
Graph(num_nodes=154600, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08125877380371094
remove nodes length
63659
auxiliary_graph.remove_nodes spent  1.3091230392456055
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=29053681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.1779961585998535

the counter of shared neighbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
28962740
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------[05:15:17] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:78: Partition a graph with 90941 nodes and 28962740 edges into 8 parts and get 4635658 edge cuts


before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 28962737, 28962738, 28962739])
drop edges based on redundancy f6

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 23407770, 2.0: 4034402, 3.0: 1010096, 4.0: 304104, 5.0: 110214, 6.0: 47910, 7.0: 22078, 8.0: 11430, 9.0: 6178, 10.0: 3478, 11.0: 2008, 12.0: 1154, 13.0: 700, 14.0: 422, 15.0: 252, 16.0: 216, 17.0: 174, 18.0: 86, 19.0: 46, 20.0: 16, 21.0: 6})
Convert a graph into a bidirected graph: 1.224 seconds
Metis partitioning: 5.430 seconds
Split the graph: 2.012 seconds
Construct subgraphs: 0.048 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.728471517562866
11588
11667
11454
11513
11263
11086
11035
11335
total k batches seeds list generation spend  18.814520359039307
after graph partition
graph partition algorithm spend time 18.915979862213135
11588
11667
11454
11513
11263
11086
11035
11335
partition_len_list
[20643, 24275, 19848, 20717, 25721, 34137, 47109, 41516]
shared_neighbor_graph_partition_s0 selection method  spend 19.015827894210815
time for parepare:  0.016919374465942383
local_output_nid generation:  0.0021414756774902344
local_in_edges_tensor generation:  0.002221822738647461
mini_batch_src_global generation:  0.0026407241821289062
r_  generation:  0.027319908142089844
local_output_nid generation:  0.002546072006225586
local_in_edges_tensor generation:  0.002273082733154297
mini_batch_src_global generation:  0.0034139156341552734
r_  generation:  0.0307309627532959
local_output_nid generation:  0.0026793479919433594
local_in_edges_tensor generation:  0.0021445751190185547
mini_batch_src_global generation:  0.003248453140258789
r_  generation:  0.030565738677978516
local_output_nid generation:  0.0027604103088378906
local_in_edges_tensor generation:  0.002176523208618164
mini_batch_src_global generation:  0.0030241012573242188
r_  generation:  0.030322790145874023
local_output_nid generation:  0.00272369384765625
local_in_edges_tensor generation:  0.00200653076171875
mini_batch_src_global generation:  0.002629995346069336
r_  generation:  0.02638840675354004
local_output_nid generation:  0.002627849578857422
local_in_edges_tensor generation:  0.002071857452392578
mini_batch_src_global generation:  0.003050088882446289
r_  generation:  0.0320897102355957
local_output_nid generation:  0.0027382373809814453
local_in_edges_tensor generation:  0.0021750926971435547
mini_batch_src_global generation:  0.003888845443725586
r_  generation:  0.03528189659118652
local_output_nid generation:  0.002943277359008789
local_in_edges_tensor generation:  0.003538846969604492
mini_batch_src_global generation:  0.00536656379699707
r_  generation:  0.050075531005859375
----------------------check_connections_block total spend ----------------------------- 0.43854618072509766
generate_one_block  0.048432111740112305
generate_one_block  0.04341006278991699
generate_one_block  0.04131126403808594
generate_one_block  0.04133892059326172
generate_one_block  0.03485512733459473
generate_one_block  0.04632973670959473
generate_one_block  0.05303764343261719
generate_one_block  0.06474161148071289
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.04115128517150879
gen group dst list time:  0.006962776184082031
time for parepare:  0.023508787155151367
local_output_nid generation:  0.003724336624145508
local_in_edges_tensor generation:  0.016754627227783203
mini_batch_src_global generation:  0.003640890121459961
r_  generation:  0.04098629951477051
local_output_nid generation:  0.0061054229736328125
local_in_edges_tensor generation:  0.005781412124633789
mini_batch_src_global generation:  0.00551152229309082
r_  generation:  0.055924177169799805
local_output_nid generation:  0.005223751068115234
local_in_edges_tensor generation:  0.00438237190246582
mini_batch_src_global generation:  0.00427699089050293
r_  generation:  0.048566579818725586
local_output_nid generation:  0.005609750747680664
local_in_edges_tensor generation:  0.004747867584228516
mini_batch_src_global generation:  0.006177186965942383
r_  generation:  0.04779791831970215
local_output_nid generation:  0.0066661834716796875
local_in_edges_tensor generation:  0.006533384323120117
mini_batch_src_global generation:  0.005842447280883789
r_  generation:  0.061823129653930664
local_output_nid generation:  0.008058786392211914
local_in_edges_tensor generation:  0.012079000473022461
mini_batch_src_global generation:  0.012839078903198242
r_  generation:  0.09038496017456055
local_output_nid generation:  0.011414289474487305
local_in_edges_tensor generation:  0.013990402221679688
mini_batch_src_global generation:  0.01475381851196289
r_  generation:  0.13450384140014648
local_output_nid generation:  0.009600400924682617
local_in_edges_tensor generation:  0.012758255004882812
mini_batch_src_global generation:  0.017581701278686523
r_  generation:  0.12234687805175781
----------------------check_connections_block total spend ----------------------------- 0.9787447452545166
generate_one_block  0.056099891662597656
generate_one_block  0.07376384735107422
generate_one_block  0.05841660499572754
generate_one_block  0.05835700035095215
generate_one_block  0.07497525215148926
generate_one_block  0.11802983283996582
generate_one_block  0.1780242919921875
generate_one_block  0.1863563060760498
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0503687858581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

connection checking time:  0.9787447452545166
block generation total time  0.804023027420044
average batch blocks generation time:  0.1005028784275055
block dataloader generation time/epoch 21.837391018867493
pseudo mini batch 0 input nodes size: 33871
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04431772232055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04431772232055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.06046867370605469  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.060555458068847656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029222488403320312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03060150146484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03060150146484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03060150146484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([33871, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03060150146484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2739, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08715152740478516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08715152740478516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2739, 128]), torch.Size([1, 2739, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08976364135742188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11066055297851562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2739, 128])
m.shape torch.Size([2767, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11199331283569336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11199331283569336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2767, 128]), torch.Size([1, 2767, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11463212966918945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15516996383666992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2767, 128])
m.shape torch.Size([2370, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1572408676147461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1572408676147461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2370, 128]), torch.Size([1, 2370, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15969038009643555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21124029159545898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2370, 128])
m.shape torch.Size([1959, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21388483047485352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21388483047485352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1959, 128]), torch.Size([1, 1959, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21575307846069336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.26993227005004883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1959, 128])
m.shape torch.Size([1583, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.27277231216430664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.27277231216430664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1583, 128]), torch.Size([1, 1583, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.27428197860717773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.32984066009521484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1583, 128])
m.shape torch.Size([1308, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.33369970321655273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.33369970321655273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1308, 128]), torch.Size([1, 1308, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3349471092224121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.38858556747436523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1308, 128])
m.shape torch.Size([1094, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3916134834289551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3916134834289551  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1094, 128]), torch.Size([1, 1094, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3926568031311035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.447659969329834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1094, 128])
m.shape torch.Size([933, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4506974220275879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4506974220275879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 933, 128]), torch.Size([1, 933, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4515872001647949  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5034594535827637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 933, 128])
m.shape torch.Size([789, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5064005851745605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5064005851745605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 789, 128]), torch.Size([1, 789, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5071530342102051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5561237335205078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 789, 128])
m.shape torch.Size([5101, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.580070972442627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.580070972442627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 5101, 128]), torch.Size([1, 5101, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5854806900024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9321060180664062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 5101, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8855433464050293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9052300453186035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9249167442321777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9050760269165039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([20643, 256])
first layer input nodes number: 33871
first layer output nodes number: 20643
edges number: 112215
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9251713752746582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9448580741882324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9497799873352051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9497799873352051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1952, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0222458839416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0222458839416504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1952, 256]), torch.Size([1, 1952, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0266122817993164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0576653480529785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1952, 256])
m.shape torch.Size([1748, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.059164047241211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.059164047241211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1748, 256]), torch.Size([1, 1748, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.062692642211914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1136360168457031  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1748, 256])
m.shape torch.Size([1378, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1159424781799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1159424781799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1378, 256]), torch.Size([1, 1378, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.118734359741211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1774959564208984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1378, 256])
m.shape torch.Size([1055, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1802377700805664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1802377700805664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1055, 256]), torch.Size([1, 1055, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1824264526367188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2425317764282227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1055, 256])
m.shape torch.Size([865, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2453827857971191  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2453827857971191  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 865, 256]), torch.Size([1, 865, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.247032642364502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.306694507598877  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 865, 256])
m.shape torch.Size([708, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.309952735900879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.309952735900879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 708, 256]), torch.Size([1, 708, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3113031387329102  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3709535598754883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 708, 256])
m.shape torch.Size([587, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3742280006408691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3742280006408691  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 587, 256]), torch.Size([1, 587, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.37534761428833  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.432288646697998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 587, 256])
m.shape torch.Size([499, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4355659484863281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4355659484863281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 499, 256]), torch.Size([1, 499, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4365177154541016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4920644760131836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 499, 256])
m.shape torch.Size([380, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4948759078979492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4948759078979492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 380, 256]), torch.Size([1, 380, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.495600700378418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5439634323120117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 380, 256])
m.shape torch.Size([348, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5469460487365723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5469460487365723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 348, 256]), torch.Size([1, 348, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.547609806060791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.596315860748291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 348, 256])
m.shape torch.Size([263, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5987648963928223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5987648963928223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 263, 256]), torch.Size([1, 263, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.599266529083252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6397933959960938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 263, 256])
m.shape torch.Size([236, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6422648429870605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6422648429870605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 236, 256]), torch.Size([1, 236, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6427149772644043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.680976390838623  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 236, 256])
m.shape torch.Size([192, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.683150291442871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.683150291442871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.683516502380371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.717207908630371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([169, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7192988395690918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7192988395690918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.719621181488037  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.751533031463623  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7537074089050293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7537074089050293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.754016399383545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7867693901062012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([119, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.788444995880127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.788444995880127  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7886719703674316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8143200874328613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.81585693359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.81585693359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.816049575805664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8391666412353516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8406968116760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8406968116760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8408761024475098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8636460304260254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8649744987487793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8649744987487793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8651118278503418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8835139274597168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8845219612121582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8845219612121582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8846287727355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8996891975402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.900766372680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.900766372680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9008731842041016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9166812896728516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9177489280700684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9177489280700684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9178500175476074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.933518886566162  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9345073699951172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9345073699951172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9345970153808594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9491195678710938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9501819610595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9501819610595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9502735137939453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9657459259033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([400, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9753117561340332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9753117561340332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 400, 256]), torch.Size([1, 400, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9760746955871582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1111912727355957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 400, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.05183744430542  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0540928840637207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0558199882507324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0534777641296387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11588, 40])
input nodes number: 20643
output nodes number: 11588
edges number: 72769
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0535640716552734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.05356502532959  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03321504592895508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 1 input nodes size: 46714
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029068946838378906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029068946838378906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05134391784667969  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05143117904663086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.035193443298339844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03700447082519531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03700447082519531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03700447082519531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([46714, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03700447082519531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2345, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11322593688964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11322593688964844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2345, 128]), torch.Size([1, 2345, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1154623031616211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13338279724121094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2345, 128])
m.shape torch.Size([2437, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13458871841430664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13458871841430664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2437, 128]), torch.Size([1, 2437, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.13765382766723633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17330455780029297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2437, 128])
m.shape torch.Size([2214, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17521142959594727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17521142959594727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2214, 128]), torch.Size([1, 2214, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17758989334106445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22493839263916016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2214, 128])
m.shape torch.Size([1939, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22758102416992188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.22758102416992188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1939, 128]), torch.Size([1, 1939, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2294301986694336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.28305625915527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1939, 128])
m.shape torch.Size([1777, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.28636837005615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.28636837005615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1777, 128]), torch.Size([1, 1777, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.28806304931640625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3494148254394531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1777, 128])
m.shape torch.Size([1433, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35266733169555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35266733169555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1433, 128]), torch.Size([1, 1433, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3540339469909668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4128756523132324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1433, 128])
m.shape torch.Size([1283, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4164748191833496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4164748191833496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1283, 128]), torch.Size([1, 1283, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41769838333129883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.47939538955688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1283, 128])
m.shape torch.Size([1195, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48334217071533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48334217071533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1195, 128]), torch.Size([1, 1195, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4844818115234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5495095252990723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1195, 128])
m.shape torch.Size([968, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5530939102172852  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5530939102172852  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 968, 128]), torch.Size([1, 968, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5540170669555664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6139669418334961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 968, 128])
m.shape torch.Size([8684, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6549139022827148  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6549139022827148  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 8684, 128]), torch.Size([1, 8684, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6638154983520508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2526731491088867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 8684, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.186598777770996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2097492218017578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2328996658325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2095680236816406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([24275, 256])
first layer input nodes number: 46714
first layer output nodes number: 24275
edges number: 153193
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2332496643066406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2564001083374023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2621879577636719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2621879577636719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1666, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3508853912353516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3508853912353516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1666, 256]), torch.Size([1, 1666, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3541316986083984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3797202110290527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1666, 256])
m.shape torch.Size([1492, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3811216354370117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3811216354370117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1492, 256]), torch.Size([1, 1492, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3839941024780273  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4288597106933594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1492, 256])
m.shape torch.Size([1204, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4307866096496582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4307866096496582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1204, 256]), torch.Size([1, 1204, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4333276748657227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4856386184692383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1204, 256])
m.shape torch.Size([1004, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4876790046691895  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4876790046691895  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1004, 256]), torch.Size([1, 1004, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4895939826965332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.545891284942627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1004, 256])
m.shape torch.Size([846, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5489997863769531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5489997863769531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 846, 256]), torch.Size([1, 846, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5506134033203125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.610147476196289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 846, 256])
m.shape torch.Size([654, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.613112449645996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.613112449645996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 654, 256]), torch.Size([1, 654, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6143598556518555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6765127182006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 654, 256])
m.shape torch.Size([574, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.679750919342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.679750919342041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 574, 256]), torch.Size([1, 574, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6808457374572754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7442936897277832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 574, 256])
m.shape torch.Size([515, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.747981071472168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.747981071472168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 515, 256]), torch.Size([1, 515, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7489633560180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.805150032043457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 515, 256])
m.shape torch.Size([399, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8081107139587402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8081107139587402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 399, 256]), torch.Size([1, 399, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8088717460632324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8590245246887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 399, 256])
m.shape torch.Size([362, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8621234893798828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8621234893798828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 362, 256]), torch.Size([1, 362, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.862813949584961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9120349884033203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 362, 256])
m.shape torch.Size([310, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9149675369262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9149675369262695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 310, 256]), torch.Size([1, 310, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9155588150024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9637746810913086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 310, 256])
m.shape torch.Size([264, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9665241241455078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9665241241455078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 264, 256]), torch.Size([1, 264, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9670276641845703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0106186866760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 264, 256])
m.shape torch.Size([232, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.013266086578369  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.013266086578369  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 232, 256]), torch.Size([1, 232, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0137085914611816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0544190406799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 232, 256])
m.shape torch.Size([201, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0569024085998535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0569024085998535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.057285785675049  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0952401161193848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([191, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.09780216217041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.09780216217041  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 191, 256]), torch.Size([1, 191, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0981664657592773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.136782646179199  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 191, 256])
m.shape torch.Size([147, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1388611793518066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1388611793518066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.13914155960083  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1708245277404785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([139, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1729555130004883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1729555130004883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.173220634460449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2050352096557617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([102, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.206667423248291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.206667423248291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.206861972808838  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.231569766998291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2334084510803223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2334084510803223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2336106300354004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.260702610015869  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([110, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2636890411376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2636890411376953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2638988494873047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2934818267822266  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([79, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.294971466064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.294971466064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2951221466064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.317422866821289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3191027641296387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3191027641296387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.319261074066162  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.343799114227295  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([55, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.344935894012451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.344935894012451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.345040798187256  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3620352745056152  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3633899688720703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3633899688720703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.363506317138672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.383169174194336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([871, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4040398597717285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4040398597717285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 871, 256]), torch.Size([1, 871, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.405701160430908  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6984047889709473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 871, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6232986450195312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6252288818359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6271591186523438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6251416206359863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11667, 40])
input nodes number: 24275
output nodes number: 11667
edges number: 89808
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.625613212585449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6256136894226074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0407109260559082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 2 input nodes size: 33561
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.035396575927734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.035396575927734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05139970779418945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05148506164550781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.02912282943725586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([33561, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030736446380615234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1789, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09261608123779297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09261608123779297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1789, 128]), torch.Size([1, 1789, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09432220458984375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.10797119140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1789, 128])
m.shape torch.Size([2052, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.10907506942749023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.10907506942749023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2052, 128]), torch.Size([1, 2052, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11213207244873047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14339351654052734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2052, 128])
m.shape torch.Size([1872, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14535045623779297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14535045623779297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1872, 128]), torch.Size([1, 1872, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14713573455810547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.18672847747802734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1872, 128])
m.shape torch.Size([1699, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.18907642364501953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.18907642364501953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1699, 128]), torch.Size([1, 1699, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19069671630859375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23915386199951172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1699, 128])
m.shape torch.Size([1408, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2422938346862793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2422938346862793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1408, 128]), torch.Size([1, 1408, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2436366081237793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2930140495300293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1408, 128])
m.shape torch.Size([1286, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2960219383239746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2960219383239746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1286, 128]), torch.Size([1, 1286, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.29724836349487305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.34998464584350586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1286, 128])
m.shape torch.Size([1073, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3529529571533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3529529571533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1073, 128]), torch.Size([1, 1073, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3539762496948242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4058260917663574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1073, 128])
m.shape torch.Size([979, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.40904903411865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.40904903411865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 979, 128]), torch.Size([1, 979, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.40998268127441406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.46471309661865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 979, 128])
m.shape torch.Size([839, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4678468704223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4678468704223633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 839, 128]), torch.Size([1, 839, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4686470031738281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5201835632324219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 839, 128])
m.shape torch.Size([6851, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5530095100402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5530095100402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 6851, 128]), torch.Size([1, 6851, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5595431327819824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.023430347442627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 6851, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9699001312255859  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9894313812255859  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.008962631225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9892830848693848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([19848, 256])
first layer input nodes number: 33561
first layer output nodes number: 19848
edges number: 124465
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0092148780822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0287461280822754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0334782600402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0334782600402832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1345, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1239032745361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1239032745361328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1345, 256]), torch.Size([1, 1345, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.126688003540039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.147562026977539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1345, 256])
m.shape torch.Size([1335, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.14937162399292  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.14937162399292  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1335, 256]), torch.Size([1, 1335, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1521124839782715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1908965110778809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1335, 256])
m.shape torch.Size([1188, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.19295072555542  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.19295072555542  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1188, 256]), torch.Size([1, 1188, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.19549560546875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.248795509338379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1188, 256])
m.shape torch.Size([994, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2514843940734863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2514843940734863  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 994, 256]), torch.Size([1, 994, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.253380298614502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3095059394836426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 994, 256])
m.shape torch.Size([822, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3125085830688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3125085830688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 822, 256]), torch.Size([1, 822, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3140764236450195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.37144136428833  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 822, 256])
m.shape torch.Size([730, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3748674392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3748674392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 730, 256]), torch.Size([1, 730, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3762598037719727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.438542366027832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 730, 256])
m.shape torch.Size([571, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.441688060760498  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.441688060760498  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 571, 256]), torch.Size([1, 571, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.442777156829834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4980626106262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 571, 256])
m.shape torch.Size([498, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.501347541809082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.501347541809082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 498, 256]), torch.Size([1, 498, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5022974014282227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5573854446411133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 498, 256])
m.shape torch.Size([452, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5608205795288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5608205795288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 452, 256]), torch.Size([1, 452, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5616827011108398  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.618769645690918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 452, 256])
m.shape torch.Size([396, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6221446990966797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6221446990966797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 396, 256]), torch.Size([1, 396, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6229000091552734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.676534652709961  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 396, 256])
m.shape torch.Size([360, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6799631118774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6799631118774414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 360, 256]), torch.Size([1, 360, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.680649757385254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7353601455688477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 360, 256])
m.shape torch.Size([299, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7384657859802246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7384657859802246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 299, 256]), torch.Size([1, 299, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7390360832214355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7877707481384277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 299, 256])
m.shape torch.Size([261, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7907471656799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7907471656799316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 261, 256]), torch.Size([1, 261, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7912449836730957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8385729789733887  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 261, 256])
m.shape torch.Size([224, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8413381576538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8413381576538086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8417654037475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8840627670288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([175, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8864707946777344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8864707946777344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8868045806884766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9221858978271484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([169, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9246182441711426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9246182441711426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 169, 256]), torch.Size([1, 169, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.924940586090088  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9613652229309082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 169, 256])
m.shape torch.Size([157, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9637694358825684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9637694358825684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.96406888961792  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0000033378601074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([147, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.002397060394287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.002397060394287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 147, 256]), torch.Size([1, 147, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0026774406433105  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.038285732269287  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 147, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.04008150100708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.04008150100708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.040283679962158  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.067375659942627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0694851875305176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0694851875305176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.069704532623291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1006321907043457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.102682590484619  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.102682590484619  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.10288667678833  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.133091449737549  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([78, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.134638786315918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.134638786315918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1347875595092773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1578474044799805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1593427658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1593427658081055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.159478187561035  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1814165115356445  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([67, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1837940216064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1837940216064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1839218139648438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2055187225341797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([787, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.225132942199707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.225132942199707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 787, 256]), torch.Size([1, 787, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2266340255737305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4908246994018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 787, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4117202758789062  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4137845039367676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.415916919708252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4137673377990723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11454, 40])
input nodes number: 19848
output nodes number: 11454
edges number: 91968
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.414134979248047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.414135456085205  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03399372100830078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 3 input nodes size: 33220
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029256820678710938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029256820678710938  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04509735107421875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04518318176269531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.029094696044921875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030714988708496094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030714988708496094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030714988708496094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([33220, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.030714988708496094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2273, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09451580047607422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09451580047607422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2273, 128]), torch.Size([1, 2273, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.09668350219726562  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11490535736083984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2273, 128])
m.shape torch.Size([2235, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11598920822143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11598920822143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2235, 128]), torch.Size([1, 2235, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1190190315246582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1527571678161621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2235, 128])
m.shape torch.Size([1982, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15488862991333008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15488862991333008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1982, 128]), torch.Size([1, 1982, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.15677881240844727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19866275787353516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1982, 128])
m.shape torch.Size([1654, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.20087242126464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.20087242126464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1654, 128]), torch.Size([1, 1654, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.20244979858398438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.24819374084472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1654, 128])
m.shape torch.Size([1505, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2509932518005371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2509932518005371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1505, 128]), torch.Size([1, 1505, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2524285316467285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3041844367980957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1505, 128])
m.shape torch.Size([1237, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3070058822631836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3070058822631836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1237, 128]), torch.Size([1, 1237, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3081855773925781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35891246795654297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1237, 128])
m.shape torch.Size([1058, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.36185407638549805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.36185407638549805  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1058, 128]), torch.Size([1, 1058, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.36286306381225586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41428136825561523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1058, 128])
m.shape torch.Size([921, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41729021072387695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41729021072387695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 921, 128]), torch.Size([1, 921, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4181685447692871  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4689297676086426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 921, 128])
m.shape torch.Size([772, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4718036651611328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4718036651611328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 772, 128]), torch.Size([1, 772, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.47253990173339844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5200510025024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 772, 128])
m.shape torch.Size([7080, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5534429550170898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5534429550170898  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 7080, 128]), torch.Size([1, 7080, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5601949691772461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0395879745483398  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 7080, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9852476119995117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0050048828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0247621536254883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0048503875732422  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([20717, 256])
first layer input nodes number: 33220
first layer output nodes number: 20717
edges number: 126774
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0250120162963867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.044769287109375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0497088432312012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0497088432312012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1741, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1397371292114258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1397371292114258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1741, 256]), torch.Size([1, 1741, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1430578231811523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1696233749389648  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1741, 256])
m.shape torch.Size([1459, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1709961891174316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1709961891174316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1459, 256]), torch.Size([1, 1459, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.1738619804382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.218454360961914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1459, 256])
m.shape torch.Size([1234, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.220621109008789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.220621109008789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1234, 256]), torch.Size([1, 1234, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2231407165527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2758607864379883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1234, 256])
m.shape torch.Size([923, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2780895233154297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2780895233154297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 923, 256]), torch.Size([1, 923, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2798500061035156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3309040069580078  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 923, 256])
m.shape torch.Size([800, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3338685035705566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3338685035705566  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 800, 256]), torch.Size([1, 800, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3353943824768066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3903260231018066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 800, 256])
m.shape torch.Size([604, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3930463790893555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3930463790893555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 604, 256]), torch.Size([1, 604, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3941984176635742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.44901704788208  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 604, 256])
m.shape torch.Size([546, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4521145820617676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4521145820617676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 546, 256]), torch.Size([1, 546, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4531559944152832  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5068955421447754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 546, 256])
m.shape torch.Size([449, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5098276138305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5098276138305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 449, 256]), torch.Size([1, 449, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5106840133666992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5607995986938477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 449, 256])
m.shape torch.Size([381, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5645132064819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5645132064819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 381, 256]), torch.Size([1, 381, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5652399063110352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.613022804260254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 381, 256])
m.shape torch.Size([344, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6159658432006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6159658432006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 344, 256]), torch.Size([1, 344, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.616621971130371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6637086868286133  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 344, 256])
m.shape torch.Size([294, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6664891242980957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6664891242980957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 294, 256]), torch.Size([1, 294, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6670498847961426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.711855411529541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 294, 256])
m.shape torch.Size([244, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7143893241882324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7143893241882324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 244, 256]), torch.Size([1, 244, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7148547172546387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.75441312789917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 244, 256])
m.shape torch.Size([210, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7568044662475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7568044662475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7572050094604492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7940549850463867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([195, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7964787483215332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7964787483215332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 195, 256]), torch.Size([1, 195, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7968506813049316  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.833672046661377  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 195, 256])
m.shape torch.Size([182, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8361101150512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8361101150512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8364572525024414  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8732538223266602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8753256797790527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8753256797790527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8756041526794434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.907071590423584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([161, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9095630645751953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9095630645751953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9098701477050781  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9467201232910156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([109, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9484524726867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9484524726867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9486603736877441  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9750638008117676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([105, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9768776893615723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9768776893615723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9770779609680176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0039143562316895  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0060057640075684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0060057640075684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.006223201751709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.036881923675537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([102, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.038832187652588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.038832187652588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0390267372131348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0678200721740723  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([61, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0690126419067383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0690126419067383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.06912899017334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.087162971496582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([73, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.088718891143799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.088718891143799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.088858127593994  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1114144325256348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1128673553466797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1128673553466797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1129932403564453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.134267807006836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([970, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1575121879577637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1575121879577637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 970, 256]), torch.Size([1, 970, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.159362316131592  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4857077598571777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 970, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4089651107788086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.411616325378418  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.413331985473633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.410594940185547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11513, 40])
input nodes number: 20717
output nodes number: 11513
edges number: 90619
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4104866981506348  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.410487174987793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03350210189819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 4 input nodes size: 53448
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.02874612808227539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.02874612808227539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.054232120513916016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.054316043853759766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03838968276977539  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04005289077758789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04005289077758789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04005289077758789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([53448, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04005289077758789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2818, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11631488800048828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11631488800048828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2818, 128]), torch.Size([1, 2818, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.11945056915283203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1413712501525879  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2818, 128])
m.shape torch.Size([3011, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14368391036987305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.14368391036987305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 3011, 128]), torch.Size([1, 3011, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1468524932861328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19165802001953125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 3011, 128])
m.shape torch.Size([2625, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19374465942382812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19374465942382812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2625, 128]), torch.Size([1, 2625, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19675683975219727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.252199649810791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2625, 128])
m.shape torch.Size([2216, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2558579444885254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2558579444885254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2216, 128]), torch.Size([1, 2216, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2581310272216797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.32068777084350586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2216, 128])
m.shape torch.Size([1938, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.32491445541381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.32491445541381836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1938, 128]), torch.Size([1, 1938, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.32676267623901367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3932986259460449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1938, 128])
m.shape torch.Size([1567, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.39685773849487305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.39685773849487305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1567, 128]), torch.Size([1, 1567, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.39835214614868164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4632582664489746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1567, 128])
m.shape torch.Size([1356, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4670372009277344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4670372009277344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1356, 128]), torch.Size([1, 1356, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.46833038330078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5331277847290039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1356, 128])
m.shape torch.Size([1172, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.536952018737793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.536952018737793  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1172, 128]), torch.Size([1, 1172, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5380697250366211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.603236198425293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1172, 128])
m.shape torch.Size([1018, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6070461273193359  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6070461273193359  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1018, 128]), torch.Size([1, 1018, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6080169677734375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6714925765991211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1018, 128])
m.shape torch.Size([8000, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7091541290283203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7091541290283203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 8000, 128]), torch.Size([1, 8000, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7167835235595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2685413360595703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 8000, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2027745246887207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2273039817810059  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.251833438873291  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2271122932434082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([25721, 256])
first layer input nodes number: 53448
first layer output nodes number: 25721
edges number: 152701
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2522339820861816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2767634391784668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2834839820861816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.2834839820861816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2028, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.353614330291748  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.353614330291748  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2028, 256]), torch.Size([1, 2028, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.357886791229248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.390596866607666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2028, 256])
m.shape torch.Size([1746, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3929615020751953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3929615020751953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1746, 256]), torch.Size([1, 1746, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.3963947296142578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.448953628540039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1746, 256])
m.shape torch.Size([1314, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4515905380249023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4515905380249023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1314, 256]), torch.Size([1, 1314, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.4543700218200684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5118045806884766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1314, 256])
m.shape torch.Size([1044, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5148553848266602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5148553848266602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1044, 256]), torch.Size([1, 1044, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5170869827270508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5786786079406738  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1044, 256])
m.shape torch.Size([896, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5813746452331543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5813746452331543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 896, 256]), torch.Size([1, 896, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.5830836296081543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6446070671081543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 896, 256])
m.shape torch.Size([616, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6473050117492676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.6473050117492676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 616, 256]), torch.Size([1, 616, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.64847993850708  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7001729011535645  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 616, 256])
m.shape torch.Size([516, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7030572891235352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7030572891235352  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 516, 256]), torch.Size([1, 516, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7040414810180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.754185676574707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 516, 256])
m.shape torch.Size([428, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7575035095214844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7575035095214844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 428, 256]), torch.Size([1, 428, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.7583198547363281  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8050346374511719  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 428, 256])
m.shape torch.Size([392, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8080177307128906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8080177307128906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 392, 256]), torch.Size([1, 392, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8087654113769531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8569755554199219  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 392, 256])
m.shape torch.Size([288, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8593697547912598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8593697547912598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 288, 256]), torch.Size([1, 288, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8599190711975098  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9003853797912598  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 288, 256])
m.shape torch.Size([222, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9024581909179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9024581909179688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 222, 256]), torch.Size([1, 222, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9028816223144531  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9359092712402344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 222, 256])
m.shape torch.Size([209, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9381084442138672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9381084442138672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.938507080078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.972391128540039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([182, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9744658470153809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9744658470153809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9748129844665527  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0067496299743652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([177, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.008957862854004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.008957862854004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 177, 256]), torch.Size([1, 177, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0092954635620117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.042717933654785  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 177, 256])
m.shape torch.Size([115, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0442070960998535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0442070960998535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.044426441192627  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0676770210266113  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0692129135131836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0692129135131836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0694169998168945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0924787521362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([93, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0938963890075684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0938963890075684  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.09407377243042  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1153597831726074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([88, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.116793632507324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.116793632507324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1169614791870117  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.138278007507324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1395092010498047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1395092010498047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.139646530151367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.158048629760742  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1594815254211426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1594815254211426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.159607410430908  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1773571968078613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1783246994018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1783246994018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.178420066833496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1925344467163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1933751106262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1933751106262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.193455219268799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.205872058868408  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.206915855407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.206915855407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.207003593444824  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.221217155456543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2220959663391113  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2220959663391113  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.222172260284424  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2350659370422363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([486, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2467055320739746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2467055320739746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 486, 256]), torch.Size([1, 486, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2476325035095215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4113078117370605  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 486, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3527932167053223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3551316261291504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3568100929260254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3543877601623535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11263, 40])
input nodes number: 25721
output nodes number: 11263
edges number: 70484
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.355286121368408  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3552865982055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04396390914916992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 5 input nodes size: 65509
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03901243209838867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.03901243209838867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.07026243209838867  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.07034540176391602  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04477548599243164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04728078842163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04728078842163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04728078842163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([65509, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04728078842163086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2624, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16921472549438477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.16921472549438477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2624, 128]), torch.Size([1, 2624, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.17171716690063477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19265222549438477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2624, 128])
m.shape torch.Size([2597, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19390344619750977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.19390344619750977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2597, 128]), torch.Size([1, 2597, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.1963801383972168  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23368072509765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2597, 128])
m.shape torch.Size([2229, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23615741729736328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23615741729736328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2229, 128]), torch.Size([1, 2229, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2382831573486328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2876262664794922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2229, 128])
m.shape torch.Size([1933, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.29066944122314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.29066944122314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1933, 128]), torch.Size([1, 1933, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2925128936767578  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.34645843505859375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1933, 128])
m.shape torch.Size([1820, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.34987592697143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.34987592697143555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1820, 128]), torch.Size([1, 1820, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3516116142272949  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4140963554382324  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1820, 128])
m.shape torch.Size([1548, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41765737533569336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41765737533569336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1548, 128]), torch.Size([1, 1548, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41913366317749023  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48383474349975586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1548, 128])
m.shape torch.Size([1366, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4876561164855957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4876561164855957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1366, 128]), torch.Size([1, 1366, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48895883560180664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.555274486541748  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1366, 128])
m.shape torch.Size([1307, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5596089363098145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5596089363098145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1307, 128]), torch.Size([1, 1307, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5608553886413574  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6320309638977051  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1307, 128])
m.shape torch.Size([1223, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6366562843322754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6366562843322754  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1223, 128]), torch.Size([1, 1223, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6378226280212402  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7142653465270996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1223, 128])
m.shape torch.Size([17490, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7976665496826172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7976665496826172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 17490, 128]), torch.Size([1, 17490, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8143463134765625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9986095428466797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 17490, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.8878812789916992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9204368591308594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9529924392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.920182228088379  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([34137, 256])
first layer input nodes number: 65509
first layer output nodes number: 34137
edges number: 246550
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9534826278686523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9860382080078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9941773414611816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.9941773414611816  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1842, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0830225944519043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.0830225944519043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1842, 256]), torch.Size([1, 1842, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.086616039276123  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1148829460144043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1842, 256])
m.shape torch.Size([1525, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.116311550140381  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.116311550140381  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1525, 256]), torch.Size([1, 1525, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1195807456970215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1652655601501465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1525, 256])
m.shape torch.Size([1113, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.166747570037842  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.166747570037842  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1113, 256]), torch.Size([1, 1113, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.1697826385498047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.221923351287842  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1113, 256])
m.shape torch.Size([842, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.223405361175537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.223405361175537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 842, 256]), torch.Size([1, 842, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.2250113487243652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.272214412689209  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 842, 256])
m.shape torch.Size([762, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.275073528289795  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.275073528289795  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 762, 256]), torch.Size([1, 762, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.276526927947998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3289923667907715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 762, 256])
m.shape torch.Size([589, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.331662654876709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.331662654876709  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 589, 256]), torch.Size([1, 589, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3327860832214355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.388134002685547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 589, 256])
m.shape torch.Size([434, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3904924392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.3904924392700195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.39132022857666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4369373321533203  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([401, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.439937114715576  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.439937114715576  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 401, 256]), torch.Size([1, 401, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.440701961517334  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.4842982292175293  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 401, 256])
m.shape torch.Size([329, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.486762046813965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.486762046813965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 329, 256]), torch.Size([1, 329, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.48738956451416  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.528047561645508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 329, 256])
m.shape torch.Size([289, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5309715270996094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5309715270996094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 289, 256]), torch.Size([1, 289, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.531522750854492  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.57159423828125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 289, 256])
m.shape torch.Size([262, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5740890502929688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5740890502929688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 262, 256]), torch.Size([1, 262, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5745887756347656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6147947311401367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 262, 256])
m.shape torch.Size([216, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6170363426208496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6170363426208496  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 216, 256]), torch.Size([1, 216, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.617448329925537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6524672508239746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 216, 256])
m.shape torch.Size([167, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6543478965759277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6543478965759277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6546664237976074  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6839709281921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([125, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6854939460754395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6854939460754395  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.685732364654541  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7093358039855957  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([127, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.711047649383545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.711047649383545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.711289882659912  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.736966609954834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([118, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.739367961883545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.739367961883545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.739593029022217  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7650256156921387  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7665634155273438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7665634155273438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.766756057739258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7898731231689453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([111, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7916975021362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7916975021362305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7919092178344727  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8187971115112305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([101, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.820535659790039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.820535659790039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.820728302001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8465423583984375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([91, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8481955528259277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8481955528259277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8483691215515137  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.872842311859131  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([78, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8743300437927246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8743300437927246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.874478816986084  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8964972496032715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8978400230407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8978400230407715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.89796781539917  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9177756309509277  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.918728828430176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.918728828430176  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.918816566467285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.933030128479004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([70, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.934601306915283  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.934601306915283  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.93473482131958  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.957298755645752  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([1280, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.988720417022705  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.988720417022705  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1280, 256]), torch.Size([1, 1280, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.991161823272705  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4215893745422363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1280, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3436636924743652  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3454604148864746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.347257137298584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3453774452209473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11086, 40])
input nodes number: 34137
output nodes number: 11086
edges number: 89532
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3451733589172363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3451738357543945  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.051288604736328125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 6 input nodes size: 86885
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04423379898071289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.04423379898071289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0856637954711914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08574628829956055  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0544133186340332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.057897090911865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.057897090911865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.057897090911865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([86885, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.057897090911865234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([2650, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2385997772216797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2385997772216797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2650, 128]), torch.Size([1, 2650, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.24112701416015625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.26207828521728516  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2650, 128])
m.shape torch.Size([2793, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.26334190368652344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.26334190368652344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2793, 128]), torch.Size([1, 2793, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2660055160522461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3066673278808594  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2793, 128])
m.shape torch.Size([2571, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30901336669921875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30901336669921875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2571, 128]), torch.Size([1, 2571, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.31195735931396484  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.36702394485473633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2571, 128])
m.shape torch.Size([2246, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.37008190155029297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.37008190155029297  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2246, 128]), torch.Size([1, 2246, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.37239837646484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4386472702026367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2246, 128])
m.shape torch.Size([2057, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4429311752319336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4429311752319336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2057, 128]), torch.Size([1, 2057, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.44489288330078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5204081535339355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2057, 128])
m.shape torch.Size([1897, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5252523422241211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5252523422241211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1897, 128]), torch.Size([1, 1897, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5270614624023438  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.604853630065918  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1897, 128])
m.shape torch.Size([1801, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6106724739074707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6106724739074707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1801, 128]), torch.Size([1, 1801, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6123900413513184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6982684135437012  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1801, 128])
m.shape torch.Size([1686, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7038412094116211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7038412094116211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1686, 128]), torch.Size([1, 1686, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.705449104309082  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.797825813293457  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1686, 128])
m.shape torch.Size([1626, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8039999008178711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8039999008178711  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1626, 128]), torch.Size([1, 1626, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8055505752563477  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.9084939956665039  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1626, 128])
m.shape torch.Size([27782, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0405311584472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.0405311584472656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 27782, 128]), torch.Size([1, 27782, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 1.067026138305664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.948169708251953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 27782, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.7821950912475586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8271217346191406  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8720483779907227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.826770305633545  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([47109, 256])
first layer input nodes number: 86885
first layer output nodes number: 47109
edges number: 365149
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8726978302001953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9176244735717773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.928856372833252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.928856372833252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1643, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.029315948486328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.029315948486328  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1643, 256]), torch.Size([1, 1643, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0327110290527344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.058352470397949  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1643, 256])
m.shape torch.Size([1385, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.059493064880371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.059493064880371  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1385, 256]), torch.Size([1, 1385, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.06223726272583  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.104443073272705  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1385, 256])
m.shape torch.Size([1033, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.1059513092041016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.1059513092041016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1033, 256]), torch.Size([1, 1033, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.107952117919922  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.15384578704834  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1033, 256])
m.shape torch.Size([820, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.1554207801818848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.1554207801818848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 820, 256]), torch.Size([1, 820, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.156984806060791  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2075953483581543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 820, 256])
m.shape torch.Size([666, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2100143432617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2100143432617188  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 666, 256]), torch.Size([1, 666, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.211284637451172  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2598114013671875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 666, 256])
m.shape torch.Size([523, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2629055976867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2629055976867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 523, 256]), torch.Size([1, 523, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2639031410217285  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.311431407928467  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 523, 256])
m.shape torch.Size([434, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3138527870178223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3138527870178223  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 434, 256]), torch.Size([1, 434, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.314680576324463  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3566555976867676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 434, 256])
m.shape torch.Size([349, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3589253425598145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3589253425598145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 349, 256]), torch.Size([1, 349, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.359591007232666  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3984265327453613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 349, 256])
m.shape torch.Size([313, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.401670455932617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.401670455932617  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 313, 256]), torch.Size([1, 313, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4022674560546875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4410457611083984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 313, 256])
m.shape torch.Size([265, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4432945251464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4432945251464844  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 265, 256]), torch.Size([1, 265, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4437999725341797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.480386734008789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 265, 256])
m.shape torch.Size([217, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.482428550720215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.482428550720215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.482842445373535  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5151262283325195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([217, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5174221992492676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5174221992492676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.517836093902588  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5530171394348145  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([182, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.555084228515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.555084228515625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 182, 256]), torch.Size([1, 182, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.555431365966797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5873680114746094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 182, 256])
m.shape torch.Size([150, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5892128944396973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5892128944396973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.589498996734619  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6178231239318848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([162, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6200156211853027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6200156211853027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6203246116638184  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6530776023864746  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([131, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.654937744140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.654937744140625  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6551876068115234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.683422088623047  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([122, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6854653358459473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6854653358459473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6856980323791504  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.7136216163635254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([132, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.715789318084717  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.715789318084717  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 132, 256]), torch.Size([1, 132, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.716041088104248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.748015880584717  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 132, 256])
m.shape torch.Size([115, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.749990463256836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.749990463256836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.7502098083496094  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.77960205078125  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.781299591064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.781299591064453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.7814788818359375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8067588806152344  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([103, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.808748245239258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.808748245239258  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8089447021484375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8380203247070312  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([67, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.839339256286621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.839339256286621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8394670486450195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8592748641967773  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8606700897216797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8606700897216797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8607959747314453  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8811893463134766  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8826489448547363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.8826489448547363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.882774829864502  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.9040493965148926  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([1780, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.947282314300537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.947282314300537  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1780, 256]), torch.Size([1, 1780, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.9506773948669434  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.56281042098999  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1780, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.471778392791748  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.473475933074951  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.475173473358154  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.473393440246582  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11035, 40])
input nodes number: 47109
output nodes number: 11035
edges number: 102294
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.473728179931641  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 4.473728656768799  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.06470632553100586  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

pseudo mini batch 7 input nodes size: 68113
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05431413650512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.05431413650512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.0867929458618164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.08687782287597656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.045365333557128906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.049062252044677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.049062252044677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before model layer 0
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.049062252044677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([68113, 128])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.049062252044677734  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1801, 1, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21604347229003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21604347229003906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1801, 128]), torch.Size([1, 1801, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.21776103973388672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23150157928466797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1801, 128])
m.shape torch.Size([1863, 2, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23261690139770508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23261690139770508  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1863, 128]), torch.Size([1, 1863, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.23439359664916992  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2610440254211426  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1863, 128])
m.shape torch.Size([1782, 3, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2631673812866211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.2631673812866211  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1782, 128]), torch.Size([1, 1782, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.26486682891845703  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30233097076416016  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1782, 128])
m.shape torch.Size([1667, 4, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30480194091796875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30480194091796875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1667, 128]), torch.Size([1, 1667, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.30639171600341797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35469818115234375  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1667, 128])
m.shape torch.Size([1577, 5, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35803651809692383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.35803651809692383  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1577, 128]), torch.Size([1, 1577, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.3595404624938965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.4136824607849121  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1577, 128])
m.shape torch.Size([1539, 6, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41757869720458984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41757869720458984  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1539, 128]), torch.Size([1, 1539, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.41904640197753906  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48215770721435547  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1539, 128])
m.shape torch.Size([1454, 7, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48627710342407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48627710342407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1454, 128]), torch.Size([1, 1454, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.48766374588012695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5571703910827637  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1454, 128])
m.shape torch.Size([1361, 8, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.561668872833252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.561668872833252  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1361, 128]), torch.Size([1, 1361, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.5629668235778809  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6374173164367676  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1361, 128])
m.shape torch.Size([1354, 9, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6425790786743164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6425790786743164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1354, 128]), torch.Size([1, 1354, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.6438703536987305  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.7272930145263672  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1354, 128])
m.shape torch.Size([27118, 10, 128])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8559560775756836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8559560775756836  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 27118, 128]), torch.Size([1, 27118, 128])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 0.8818178176879883  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.718001365661621  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 27118, 128])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.5623927116394043  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.601985454559326  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.641578197479248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6016759872436523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([41516, 256])
first layer input nodes number: 68113
first layer output nodes number: 41516
edges number: 339092
----------------------------------------after model layer 0 x = self.bns[i](x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.642087936401367  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.681680679321289  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6915788650512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.6915788650512695  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

m.shape torch.Size([1211, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.824662208557129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.824662208557129  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1211, 256]), torch.Size([1, 1211, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8273820877075195  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8480844497680664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1211, 256])
m.shape torch.Size([1016, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8484621047973633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8484621047973633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 1016, 256]), torch.Size([1, 1016, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.850399971008301  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.879918098449707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 1016, 256])
m.shape torch.Size([813, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8815464973449707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8815464973449707  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 813, 256]), torch.Size([1, 813, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.8830971717834473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.918409824371338  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 813, 256])
m.shape torch.Size([638, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9202322959899902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9202322959899902  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 638, 256]), torch.Size([1, 638, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9214491844177246  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9619460105895996  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 638, 256])
m.shape torch.Size([565, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.964323043823242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.964323043823242  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 565, 256]), torch.Size([1, 565, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 2.9654006958007812  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.010934829711914  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 565, 256])
m.shape torch.Size([444, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0129566192626953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0129566192626953  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 444, 256]), torch.Size([1, 444, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.013803482055664  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0524816513061523  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 444, 256])
m.shape torch.Size([383, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0546350479125977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0546350479125977  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 383, 256]), torch.Size([1, 383, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.055365562438965  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.09561824798584  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 383, 256])
m.shape torch.Size([333, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.097813606262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.097813606262207  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 333, 256]), torch.Size([1, 333, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.0984487533569336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.136843681335449  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 333, 256])
m.shape torch.Size([330, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.139380931854248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.139380931854248  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 330, 256]), torch.Size([1, 330, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.140010356903076  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.182094097137451  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 330, 256])
m.shape torch.Size([307, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.184730052947998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.184730052947998  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 307, 256]), torch.Size([1, 307, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.1853156089782715  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2277626991271973  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 307, 256])
m.shape torch.Size([275, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.230377674102783  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.230377674102783  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 275, 256]), torch.Size([1, 275, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2309021949768066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.273324489593506  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 275, 256])
m.shape torch.Size([252, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2759690284729004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.2759690284729004  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 252, 256]), torch.Size([1, 252, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.276449680328369  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.317305088043213  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 252, 256])
m.shape torch.Size([230, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3199386596679688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3199386596679688  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 230, 256]), torch.Size([1, 230, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3203773498535156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.360736846923828  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 230, 256])
m.shape torch.Size([193, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3638434410095215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3638434410095215  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 193, 256]), torch.Size([1, 193, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.3642115592956543  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4006552696228027  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 193, 256])
m.shape torch.Size([175, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4029946327209473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4029946327209473  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 175, 256]), torch.Size([1, 175, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4033284187316895  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4387097358703613  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 175, 256])
m.shape torch.Size([174, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.441218852996826  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.441218852996826  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 174, 256]), torch.Size([1, 174, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.4415507316589355  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.479053020477295  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 174, 256])
m.shape torch.Size([156, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.481436252593994  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.481436252593994  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.481733798980713  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.517439365386963  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([165, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5201454162597656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5201454162597656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 165, 256]), torch.Size([1, 165, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5204601287841797  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5604286193847656  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 165, 256])
m.shape torch.Size([159, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5631752014160156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.5631752014160156  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.563478469848633  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.604116439819336  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([161, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.607059955596924  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.607059955596924  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6073670387268066  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.650665760040283  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([142, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6535940170288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6535940170288086  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.653864860534668  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6939496994018555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([105, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6960349082946777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.6960349082946777  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.696235179901123  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.7272772789001465  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([115, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.729719638824463  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes
Using backend: pytorch

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.729719638824463  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.7299389839172363  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.765472888946533  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([107, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.767831802368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.767831802368164  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 8.0740966796875 GB
    Memory Allocated: 3.768035888671875  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 3.8025264739990234  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([2886, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 3.871769905090332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 3.871769905090332  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

 h.shape torch.Size([1, 2886, 256]), torch.Size([1, 2886, 256])
----------------------------------------3
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 3.877274513244629  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.850327491760254  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

rst.shape  torch.Size([1, 2886, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.726968765258789  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.729097366333008  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.731225967407227  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.729012489318848  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

torch.Size([11335, 40])
input nodes number: 41516
output nodes number: 11335
edges number: 136776
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.729837894439697  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1092529296875 GB
    Memory Allocated: 4.7298383712768555  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.05597066879272461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.05597066879272461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.1131591796875 GB
    Memory Allocated: 0.05597066879272461  GigaBytes
Max Memory Allocated: 4.965202808380127  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02206328511238098 |0.0034290552139282227 |0.12231868505477905 |9.92119312286377e-05 |0.07615956664085388 |0.004701852798461914 |
----------------------------------------------------------pseudo_mini_loss sum 3.625690460205078
Total (block generation + training)time/epoch 23.675631999969482
Training time/epoch 1.8593966960906982
Training time without block to device /epoch 1.8319642543792725
Training time without total dataloading part /epoch 1.5933215618133545
load block tensor time/epoch 0.17650628089904785
block to device time/epoch 0.02743244171142578
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  655287
Number of first layer input nodes during this epoch:  421321
Number of first layer output nodes during this epoch:  233966
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (bns): ModuleList(
    (0): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  744960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([40, 256])
layers.1.fc_neigh.weight, torch.Size([40, 256])
bns.0.weight, torch.Size([256])
bns.0.bias, torch.Size([256])
----------------------------------------
un-trainable parameters
